/**
 * Copyright OpenJS Foundation and other contributors, https://openjsf.org/
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
!function(){var o;!window.MSInputMethodContext||!document.documentMode||(window.DOMTokenList.prototype.toggle=function(e,t){1===arguments.length&&(t=!this.contains(e)),this[t?"add":"remove"](e)},"classList"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"classList",Object.getOwnPropertyDescriptor(HTMLElement.prototype,"classList")),"children"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"children",Object.getOwnPropertyDescriptor(HTMLElement.prototype,"children")),Array.from=function(){if(1<arguments.length)throw new Error("Node-RED's IE11 Array.from polyfill doesn't support multiple arguments");var e=arguments[0],t=[];if(e.forEach)e.forEach(function(e){t.push(e)});else for(var o=0;o<e.length;o++)t.push(arrayList[o]);return t},0===new Set([0]).size&&(o=Set,Set=function(e){var t=new o;return e&&e.forEach(t.add,t),t},Set.prototype=o.prototype,Set.prototype.constructor=Set))}(),jQuery.propHooks.disabled={set:function(e,t){e.disabled!==t&&((e.disabled=t)?$(e).trigger("disabled"):$(e).trigger("enabled"))}};var RED=function(){var e=!0;function t(){f.reportProgress(RED._("event.loadPlugins"),10),$.ajax({headers:{Accept:"application/json"},cache:!1,url:"plugins",success:function(e){f.reportProgress(RED._("event.loadPlugins"),13),RED.i18n.loadPluginCatalogs(function(){!function(n){f.reportProgress(RED._("event.loadPlugins",{count:""}),17);var e=localStorage.getItem("editor-language")||RED.i18n.detectLanguage();$.ajax({headers:{Accept:"text/html","Accept-Language":e},cache:!1,url:"plugins",success:function(e){var o=e.trim().split(/(?=<!-- --- \[red-plugin:\S+\] --- -->)/),i=(o.length,function(){var e,t;0===o.length?n():(e=o.shift(),t=i,a(e,/<!-- --- \[red-plugin:(\S+)\] --- -->/.exec(e.trim()),"#red-ui-editor-plugin-configs",t))});i()}})}(function(){f.reportProgress(RED._("event.loadPalette"),20),$.ajax({headers:{Accept:"application/json"},cache:!1,url:"nodes",success:function(e){RED.nodes.setNodeList(e),f.reportProgress(RED._("event.loadNodeCatalogs"),25),RED.i18n.loadNodeCatalogs(function(){s(o)})}})})})}})}function a(e,t,n,a){var r;a=a||function(){},t?(r=t[1],RED._loadingModule=r):r="unknown";try{var s=!1,d=$("<div>"+e+"</div>"),o=d.find("script"),l=o.length;o.each(function(e,t){var o,i=$(t).attr("src");i&&!/^\s*(https?:|\/|\.)/.test(i)?($(t).remove(),(o=document.createElement("script")).onload=function(){0===--l&&($(n).append(d),delete RED._loadingModule,a())},"module"===$(t).attr("type")&&(o.type="module"),$(n).append(o),o.src=RED.settings.apiRootUrl+i,s=!0):((/\/ace.js$/.test(i)||/\/ext-language_tools.js$/.test(i))&&(console.warn("Blocked attempt to load",i,"by",r),$(t).remove()),l--)}),s||($(n).append(d),delete RED._loadingModule,a())}catch(e){RED.notify(RED._("notification.errors.failedToAppendNode",{module:r,error:e.toString()}),{type:"error",timeout:1e4}),console.log("["+r+"] "+e.toString()),delete RED._loadingModule,a()}}function r(e,t){a(e,/<!-- --- \[red-module:(\S+)\] --- -->/.exec(e.trim()),"#red-ui-editor-node-configs",t)}function s(t){$.ajax({headers:{Accept:"application/json"},cache:!1,url:"icons",success:function(e){RED.nodes.setIconSets(e),t&&t()}})}function o(){f.reportProgress(RED._("event.loadNodes",{count:""}),30);var e=localStorage.getItem("editor-language")||RED.i18n.detectLanguage();$.ajax({headers:{Accept:"text/html","Accept-Language":e},cache:!1,url:"nodes",success:function(e){var t=e.trim().split(/(?=<!-- --- \[red-module:\S+\] --- -->)/),o=t.length,i=function(){f.reportProgress(RED._("event.loadNodes",{count:o-t.length+"/"+o}),30+(o-t.length)/o*40),0===t.length?($("#red-ui-editor").i18n(),$("#red-ui-palette > .red-ui-palette-spinner").hide(),$(".red-ui-palette-scroll").removeClass("hide"),$("#red-ui-palette-search").removeClass("hide"),RED.settings.theme("projects.enabled",!1)?RED.projects.refresh(function(t){d(function(){RED.sidebar.info.refresh();var e=!1;t||(RED.menu.setDisabled("menu-item-projects-open",!0),RED.menu.setDisabled("menu-item-projects-settings",!0),!1===t||(e=!0)),n(e)})}):d(function(){RED.sidebar.info.refresh(),n()})):r(t.shift(),i)};i()}})}function d(o){f.reportProgress(RED._("event.loadFlows"),80),$.ajax({headers:{Accept:"application/json"},cache:!1,url:"flows",success:function(e){if(e){var t=window.location.hash;RED.nodes.version(e.rev),f.reportProgress(RED._("event.importFlows"),90);try{RED.nodes.import(e.flows),RED.nodes.dirty(!1),RED.view.redraw(!0),/^#flow\/.+$/.test(t)&&RED.workspaces.show(t.substring(6),!0),0===RED.workspaces.active()&&0<RED.workspaces.count()&&RED.workspaces.show(RED.nodes.getWorkspaceOrder()[0])}catch(e){console.warn(e),RED.notify(RED._("event.importError",{message:e.message}),{fixed:!0,type:"error"})}}o()}})}function n(t){var n={};RED.comms.subscribe("notification/#",function(e,t){var o,i=e.split("/")[1];if("runtime-deploy"!==i&&"node"!==i)return"project-update"===i?(f.start(RED._("event.loadingProject"),0),RED.nodes.clear(),RED.history.clear(),RED.view.redraw(!0),void RED.projects.refresh(function(){d(function(){var e=RED.projects.getActiveProject(),e={"change-branch":RED._("notification.project.change-branch",{project:e.git.branches.local}),"merge-abort":RED._("notification.project.merge-abort"),loaded:RED._("notification.project.loaded",{project:t.project}),updated:RED._("notification.project.updated",{project:t.project}),pull:RED._("notification.project.pull",{project:t.project}),revert:RED._("notification.project.revert",{project:t.project}),"merge-complete":RED._("notification.project.merge-complete")}[t.action];f.end(),RED.notify($("<p>").text(e)),RED.sidebar.info.refresh()})})):void(t.text?(t.default=t.text,o=RED._(t.text,t),e={type:t.type,fixed:void 0===t.timeout,timeout:t.timeout,id:i},"runtime-state"===i&&(RED.events.emit("runtime-state",t),"safe-mode"===t.error?e.buttons=[{text:RED._("common.label.close"),click:function(){n[i].hideNotification()}}]:"missing-types"===t.error?(o+="<ul><li>"+t.types.map(RED.utils.sanitize).join("</li><li>")+"</li></ul>",RED.projects.getActiveProject()?e.buttons=[{text:RED._("notification.label.manage-project-dep"),click:function(){n[i].hideNotification(),RED.projects.settings.show("deps")}}]:e.buttons=[{text:RED._("common.label.close"),click:function(){n[i].hideNotification()}}]):"missing-modules"===t.error?(o+="<ul><li>"+t.modules.map(function(e){return RED.utils.sanitize(e.module)+(e.error?" - <small>"+RED.utils.sanitize(""+e.error)+"</small>":"")}).join("</li><li>")+"</li></ul>",e.buttons=[{text:RED._("common.label.close"),click:function(){n[i].hideNotification()}}]):"credentials_load_failed"===t.error?RED.settings.theme("projects.enabled",!1)?RED.user.hasPermission("projects.write")&&(e.buttons=[{text:RED._("notification.project.setupCredentials"),click:function(){n[i].hideNotification(),RED.projects.showCredentialsPrompt()}}]):e.buttons=[{text:RED._("common.label.close"),click:function(){n[i].hideNotification()}}]:"missing_flow_file"===t.error||"missing_package_file"===t.error?RED.user.hasPermission("projects.write")&&(e.buttons=[{text:RED._("notification.project.setupProjectFiles"),click:function(){n[i].hideNotification(),RED.projects.showFilesPrompt()}}]):"project_empty"===t.error?RED.user.hasPermission("projects.write")&&(e.buttons=[{text:RED._("notification.project.no"),click:function(){n[i].hideNotification()}},{text:RED._("notification.project.createDefault"),click:function(){n[i].hideNotification(),RED.projects.createDefaultFileSet()}}]):"git_merge_conflict"===t.error&&(RED.nodes.clear(),RED.sidebar.versionControl.refresh(!0),RED.user.hasPermission("projects.write")&&(e.buttons=[{text:RED._("notification.project.mergeConflict"),click:function(){n[i].hideNotification(),RED.sidebar.versionControl.showLocalChanges()}}]))),n.hasOwnProperty(i)?n[i].update(o,e):n[i]=RED.notify(o,e)):n.hasOwnProperty(i)&&(n[i].close(),delete n[i],"runtime-state"===i&&RED.events.emit("runtime-state",t)))}),RED.comms.subscribe("statusTop/#",function(e,t){e=e.split("/"),e=RED.nodes.node(e[1]);e&&(t.hasOwnProperty("text")&&"."!==t.text[0]&&(t.text=e._(t.text.toString(),{defaultValue:t.text.toString()})),e.statusTop=t,e.dirty=!0,e.dirtyStatus=!0,RED.view.redrawStatus(e))}),RED.comms.subscribe("statusBottom/#",function(e,t){e=e.split("/"),e=RED.nodes.node(e[1]);e&&(t.hasOwnProperty("text")&&/^[a-zA-Z]/.test(t.text)&&(t.text=e._(t.text.toString(),{defaultValue:t.text.toString()})),e.status=t,e.dirty=!0,e.dirtyStatus=!0,RED.view.redrawStatus(e))}),RED.comms.subscribe("status/#",function(e,t){e=e.split("/"),e=RED.nodes.node(e[1]);e&&(t.hasOwnProperty("text")&&/^[a-zA-Z]/.test(t.text)&&(t.text=e._(t.text.toString(),{defaultValue:t.text.toString()})),e.status=t,e.dirty=!0,e.dirtyStatus=!0,RED.view.redrawStatus(e))}),RED.comms.subscribe("highlightLink/#",function(e,t){e=e.split("/")[1];-1<e.indexOf(":")&&(e=e.split(":")[0]);var o=RED.nodes.node(e);if(o){e=0;t.hasOwnProperty("index")&&(e=t.index),activeLinks=RED.nodes.filterLinks({source:o,sourcePort:e});for(var i=0;i<activeLinks.length;i++)activeLinks[i].working=!0;setTimeout(function(e){for(var t=0;t<e.length;t++)e[t].working=!1;o.dirty=!0,RED.view.redraw()},300,activeLinks),o.dirty=!0,RED.view.redraw()}}),RED.comms.subscribe("highlightNode/#",function(e,t){var o=e.split("/")[1];-1<o.indexOf(":")&&(o=o.split(":")[0]);e=RED.nodes.node(o);e&&(o=500,t.hasOwnProperty("timeout")&&(o=t.timeout),e.working=!0,setTimeout(function(e){e.working=!1,e.dirty=!0,RED.view.redraw()},o,e),e.dirty=!0,RED.view.redraw(e))}),RED.comms.subscribe("notification/node/#",function(e,i){var t,o,n;if("notification/node/added"==e)RED.settings.refreshSettings(function(e,t){var o=[];i.forEach(function(e){var t=e.id;RED.nodes.addNodeSet(e),o=o.concat(e.types),RED.i18n.loadNodeCatalog(function(){var e=localStorage.getItem("editor-language")||RED.i18n.detectLanguage();$.ajax({headers:{Accept:"text/html","Accept-Language":e},cache:!1,url:"nodes/"+t,success:function(e){r(e)}})})}),o.length&&(n="<ul><li>"+o.map(RED.utils.sanitize).join("</li><li>")+"</li></ul>",RED.notify(RED._("palette.event.nodeAdded",{count:o.length})+n,"success")),s()});else if("notification/node/removed"==e){for(t=0;t<i.length;t++)o=i[t],RED.nodes.removeNodeSet(o.id).added&&(n="<ul><li>"+o.types.map(RED.utils.sanitize).join("</li><li>")+"</li></ul>",RED.notify(RED._("palette.event.nodeRemoved",{count:o.types.length})+n,"success"));s()}else"notification/node/enabled"==e?i.types&&RED.settings.refreshSettings(function(e,t){var o;RED.nodes.getNodeSet(i.id).added?(RED.nodes.enableNodeSet(i.id),n="<ul><li>"+i.types.map(RED.utils.sanitize).join("</li><li>")+"</li></ul>",RED.notify(RED._("palette.event.nodeEnabled",{count:i.types.length})+n,"success")):(o=localStorage.getItem("editor-language")||RED.i18n.detectLanguage(),$.ajax({headers:{Accept:"text/html","Accept-Language":o},cache:!1,url:"nodes/"+i.id,success:function(e){r(e),n="<ul><li>"+i.types.map(RED.utils.sanitize).join("</li><li>")+"</li></ul>",RED.notify(RED._("palette.event.nodeAdded",{count:i.types.length})+n,"success")}}))}):"notification/node/disabled"==e?i.types&&(RED.nodes.disableNodeSet(i.id),n="<ul><li>"+i.types.map(RED.utils.sanitize).join("</li><li>")+"</li></ul>",RED.notify(RED._("palette.event.nodeDisabled",{count:i.types.length})+n,"success")):"notification/node/upgraded"==e&&(RED.notify(RED._("palette.event.nodeUpgraded",{module:i.module,version:i.version}),"success"),RED.nodes.registry.setModulePendingUpdated(i.module,i.version))}),RED.comms.subscribe("event-log/#",function(e,t){e=e.substring(9);RED.eventLog.log(e,t)}),RED.comms.getEvents(),RED.comms.getFixedInputs(),$(".red-ui-header-toolbar").show(),RED.sidebar.show(":first"),setTimeout(function(){var e;f.end(),!(e=function(){t&&RED.projects.showStartup()})!==RED.settings.theme("tours")&&RED.settings.get("editor.view.view-show-welcome-tours",!0)?RED.actions.invoke("core:show-welcome-tour",RED.settings.get("editor.tours.welcome"),e):e()},100)}function l(){e&&(e=!1,$("#red-ui-main-container").show(),RED.actions.add("core:restart-node-blue",function(){RED.notify(RED._("notification.info",{message:RED._("notification.infoMessages.flowsRestarting")}),"success",!1),$.ajax({url:"flows/restart",type:"POST"}).done(function(){window.location.reload()})}),t())}function c(){var e=[];RED.settings.theme("projects.enabled",!1)&&e.push({id:"menu-item-projects-menu",label:RED._("menu.label.projects"),options:[{id:"menu-item-projects-new",label:RED._("menu.label.projects-new"),disabled:!1,onselect:"core:new-project"},{id:"menu-item-projects-open",label:RED._("menu.label.projects-open"),disabled:!1,onselect:"core:open-project"},{id:"menu-item-projects-settings",label:RED._("menu.label.projects-settings"),disabled:!1,onselect:"core:show-project-settings"}]}),e.push({id:"menu-item-edit-menu",label:RED._("menu.label.edit"),options:[{id:"menu-item-edit-undo",label:RED._("keyboard.undoChange"),disabled:!0,onselect:"core:undo"},{id:"menu-item-edit-redo",label:RED._("keyboard.redoChange"),disabled:!0,onselect:"core:redo"},null,{id:"menu-item-edit-cut",label:RED._("keyboard.cutNode"),onselect:"core:cut-selection-to-internal-clipboard"},{id:"menu-item-edit-copy",label:RED._("keyboard.copyNode"),onselect:"core:copy-selection-to-internal-clipboard"},{id:"menu-item-edit-paste",label:RED._("keyboard.pasteNode"),disabled:!0,onselect:"core:paste-from-internal-clipboard"},null,{id:"menu-item-edit-copy-group-style",label:RED._("keyboard.copyGroupStyle"),onselect:"core:copy-group-style"},{id:"menu-item-edit-paste-group-style",label:RED._("keyboard.pasteGroupStyle"),disabled:!0,onselect:"core:paste-group-style"},null,{id:"menu-item-edit-select-all",label:RED._("keyboard.selectAll"),onselect:"core:select-all-nodes"},{id:"menu-item-edit-select-connected",label:RED._("keyboard.selectAllConnected"),onselect:"core:select-connected-nodes"},{id:"menu-item-edit-select-none",label:RED._("keyboard.selectNone"),onselect:"core:select-none"}]}),e.push({id:"menu-item-view-menu",label:RED._("menu.label.view.view"),options:[{id:"menu-item-palette",label:RED._("menu.label.palette.show"),toggle:!0,onselect:"core:toggle-palette",selected:!0},{id:"menu-item-sidebar",label:RED._("menu.label.sidebar.show"),toggle:!0,onselect:"core:toggle-sidebar",selected:!0},{id:"menu-item-event-log",label:RED._("eventLog.title"),onselect:"core:show-event-log"},{id:"menu-item-action-list",label:RED._("keyboard.actionList"),onselect:"core:show-action-list"},null]}),e.push({id:"menu-item-arrange-menu",label:RED._("menu.label.arrange"),options:[{id:"menu-item-view-tools-move-to-back",label:RED._("menu.label.moveToBack"),disabled:!0,onselect:"core:move-selection-to-back"},{id:"menu-item-view-tools-move-to-front",label:RED._("menu.label.moveToFront"),disabled:!0,onselect:"core:move-selection-to-front"},{id:"menu-item-view-tools-move-backwards",label:RED._("menu.label.moveBackwards"),disabled:!0,onselect:"core:move-selection-backwards"},{id:"menu-item-view-tools-move-forwards",label:RED._("menu.label.moveForwards"),disabled:!0,onselect:"core:move-selection-forwards"},null,{id:"menu-item-view-tools-align-left",label:RED._("menu.label.alignLeft"),disabled:!0,onselect:"core:align-selection-to-left"},{id:"menu-item-view-tools-align-center",label:RED._("menu.label.alignCenter"),disabled:!0,onselect:"core:align-selection-to-center"},{id:"menu-item-view-tools-align-right",label:RED._("menu.label.alignRight"),disabled:!0,onselect:"core:align-selection-to-right"},null,{id:"menu-item-view-tools-align-top",label:RED._("menu.label.alignTop"),disabled:!0,onselect:"core:align-selection-to-top"},{id:"menu-item-view-tools-align-middle",label:RED._("menu.label.alignMiddle"),disabled:!0,onselect:"core:align-selection-to-middle"},{id:"menu-item-view-tools-align-bottom",label:RED._("menu.label.alignBottom"),disabled:!0,onselect:"core:align-selection-to-bottom"},null,{id:"menu-item-view-tools-distribute-horizontally",label:RED._("menu.label.distributeHorizontally"),disabled:!0,onselect:"core:distribute-selection-horizontally"},{id:"menu-item-view-tools-distribute-veritcally",label:RED._("menu.label.distributeVertically"),disabled:!0,onselect:"core:distribute-selection-vertically"}]}),e.push(null),RED.settings.theme("menu.menu-item-import-library",!0)&&e.push({id:"menu-item-import",label:RED._("menu.label.import"),onselect:"core:show-import-dialog"}),RED.settings.theme("menu.menu-item-export-library",!0)&&e.push({id:"menu-item-export",label:RED._("menu.label.export"),onselect:"core:show-export-dialog"}),e.push(null),e.push({id:"menu-item-search",label:RED._("menu.label.search"),onselect:"core:search"}),e.push(null),e.push({id:"menu-item-restart-node-blue",label:RED._("menu.label.restartNodeBlue"),onselect:"core:restart-node-blue"}),e.push(null),e.push({id:"menu-item-config-nodes",label:RED._("menu.label.displayConfig"),onselect:"core:show-config-tab"}),e.push({id:"menu-item-workspace",label:RED._("menu.label.flows"),options:[{id:"menu-item-workspace-add",label:RED._("menu.label.add"),onselect:"core:add-flow"},{id:"menu-item-workspace-edit",label:RED._("menu.label.rename"),onselect:"core:edit-flow"},{id:"menu-item-workspace-delete",label:RED._("menu.label.delete"),onselect:"core:remove-flow"}]}),e.push({id:"menu-item-subflow",label:RED._("menu.label.subflows"),options:[{id:"menu-item-subflow-create",label:RED._("menu.label.createSubflow"),onselect:"core:create-subflow"}]}),e.push({id:"menu-item-group",label:RED._("menu.label.groups"),options:[{id:"menu-item-group-group",label:RED._("menu.label.groupSelection"),disabled:!0,onselect:"core:group-selection"},{id:"menu-item-group-ungroup",label:RED._("menu.label.ungroupSelection"),disabled:!0,onselect:"core:ungroup-selection"},null,{id:"menu-item-group-merge",label:RED._("menu.label.groupMergeSelection"),disabled:!0,onselect:"core:merge-selection-to-group"},{id:"menu-item-group-remove",label:RED._("menu.label.groupRemoveSelection"),disabled:!0,onselect:"core:remove-selection-from-group"}]}),e.push(null),!1!==RED.settings.get("externalModules.palette.allowInstall",!0)&&(e.push({id:"menu-item-edit-palette",label:RED._("menu.label.editPalette"),onselect:"core:manage-palette"}),e.push(null)),e.push({id:"menu-item-user-settings",label:RED._("menu.label.settings"),onselect:"core:show-user-settings"}),e.push(null),RED.settings.theme("menu.menu-item-keyboard-shortcuts",!0)&&e.push({id:"menu-item-keyboard-shortcuts",label:RED._("menu.label.keyboardShortcuts"),onselect:"core:show-help"}),e.push({id:"menu-item-help",label:RED.settings.theme("menu.menu-item-help.label",RED._("menu.label.nodebluewebsite")),href:RED.settings.theme("menu.menu-item-help.url","https://doc.homegear.eu/node-blue/")}),e.push(null),e.push({id:"menu-item-node-red-version",label:"v"+RED.settings.version,onselect:"core:show-about"}),e.push({id:"menu-item-node-red",label:RED.settings.theme("menu.menu-item-logout.label",RED._("menu.label.powered")),href:RED.settings.theme("menu.menu-item-logout.url","https://nodered.org/")}),e.push(null),e.push({id:"menu-item-logout",label:RED.settings.theme("menu.menu-item-logout.label",RED._("menu.label.logout")),hrefLocal:RED.settings.theme("menu.menu-item-logout.url","signin.php?logout=1")}),$('<li><a id="red-ui-header-button-sidemenu" class="button" href="#"><i class="fa fa-bars"></i></a></li>').appendTo(".red-ui-header-toolbar"),RED.menu.init({id:"red-ui-header-button-sidemenu",options:e})}var p=null,u=!1;var f={init:function(){var e=$('<div id="red-ui-loading-progress"></div>').hide(),t=$("<div>").appendTo(e),t=($("<div>",{class:"red-ui-loading-bar-label"}).appendTo(t),$("<div>",{class:"red-ui-loading-bar"}).appendTo(t));$("<span>").appendTo(t);return e},start:function(e,t){e&&f.reportProgress(e,t),$("#red-ui-loading-progress").show()},reportProgress:function(e,t){$(".red-ui-loading-bar-label").text(e),$(".red-ui-loading-bar span").width(t+"%")},end:function(){$("#red-ui-loading-progress").hide(),f.reportProgress("",0)}};return{init:function(e){if(u)throw new Error("RED already initialised");var t,o,i;u=!0,window.ace&&window.ace.require("ace/ext/language_tools"),(e=e||{}).apiRootUrl=e.apiRootUrl||"",e.apiRootUrl&&!/\/$/.test(e.apiRootUrl)&&(e.apiRootUrl=e.apiRootUrl+"/"),e.target=$("#red-ui-editor"),e.target.addClass("red-ui-editor"),t=e,o=$('<div id="red-ui-header"></div>').appendTo(t.target),i=$('<span class="red-ui-header-logo"></span>').appendTo(o),$('<ul class="red-ui-header-toolbar hide"></ul>').appendTo(o),$('<div id="red-ui-header-shade" class="hide"></div>').appendTo(o),$('<div id="red-ui-main-container" class="red-ui-sidebar-closed hide"><div id="red-ui-workspace"></div><div id="red-ui-editor-stack"></div><div id="red-ui-palette"></div><div id="red-ui-sidebar"></div><div id="red-ui-sidebar-separator"></div></div>').appendTo(t.target),$('<div id="red-ui-editor-plugin-configs"></div>').appendTo(t.target),$('<div id="red-ui-editor-node-configs"></div>').appendTo(t.target),$('<div id="red-ui-full-shade" class="hide"></div>').appendTo(t.target),f.init().appendTo("#red-ui-main-container"),f.start("...",0),$.getJSON(t.apiRootUrl+"theme",function(e){e.header&&(e.header.url&&(i=$("<a>",{href:e.header.url}).appendTo(i)),e.header.image&&$("<img>",{src:e.header.image}).appendTo(i),e.header.title&&$("<span>").html(e.header.title).appendTo(i)),e.themes&&(p=e.themes)}),RED.i18n.init(e,function(){RED.settings.init(e,function(){p&&(RED.settings.editorTheme=RED.settings.editorTheme||{},RED.settings.editorTheme.themes=p),RED.workspaces.init(),RED.statusBar.init(),RED.view.init(),RED.userSettings.init(),RED.user.init(),RED.notifications.init(),RED.library.init(),RED.palette.init(),RED.eventLog.init(),!1!==RED.settings.get("externalModules.palette.allowInstall",!0)?RED.palette.editor.init():console.log("Palette editor disabled"),RED.sidebar.init(),RED.settings.theme("projects.enabled",!1)?RED.projects.init():console.log("Projects disabled"),RED.subflow.init(),RED.group.init(),RED.clipboard.init(),RED.search.init(),RED.actionList.init(),RED.editor.init(),RED.diff.init(),RED.deploy.init(RED.settings.theme("deployButton",null)),RED.keyboard.init(c),RED.nodes.init(),f.reportProgress(RED._("event.connectingHomegear"),10),RED.comms.connect(),RED.comms.homegear().ready(l)})})},loader:f}}();RED.events=function(){var n={};return{on:function(e,t){n[e]=n[e]||[],n[e].push(t)},off:function(e,t){var o=n[e];if(o)for(var i=0;i<o.length;i++)if(o[i]===t)return void o.splice(i,1)},emit:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);if(RED.events.DEBUG&&console.warn(t,e),n[t])for(var o=0;o<n[t].length;o++)try{n[t][o].apply(null,e)}catch(e){console.warn("RED.events.emit error: ["+t+"] "+e.toString()),console.warn(e)}}}}(),RED.hooks=function(){var r={},s={};function d(e,t){var o=t.previousHook,i=t.nextHook;o?o.nextHook=i:r[e]=i,i&&(i.previousHook=o),t.removed=!0,o||i||delete r[e]}return{has:function(e){var t=e.split("."),e=t[0];return(t=t[1])?!(!s[t]||!s[t][e]):!!r[e]},clear:function(){r={},s={}},add:function(e,t){var o=e.split("."),i=o[0];if((o=o[1])&&s[o]&&s[o][i])throw new Error("Hook "+e+" already registered");var t={cb:t,previousHook:null,nextHook:null},n=r[i];if(void 0===n)r[i]=t;else{for(;null!==n.nextHook;)n=n.nextHook;(n.nextHook=t).previousHook=n}o&&(s[o]=s[o]||{},s[o][i]=t)},remove:function(e){var t=e.split("."),o=t[0],i=t[1];if(!i)throw new Error("Cannot remove hook without label: "+e);if(s[i])if("*"===o){for(var n=Object.keys(s[i]),a=0;a<n.length;a++)d(n[a],s[i][n[a]]);delete s[i]}else s[i][o]&&(d(o,s[i][o]),delete s[i][o],0===Object.keys(s[i]).length&&delete s[i])},trigger:function(e,i,n){var a=r[e];if(a)return function t(e){if(!a||e)return n&&n(e),e;if(a.removed)return a=a.nextHook,t();e=a.cb;if(1===e.length)try{var o=e(i);return!1===o?(n&&n(!1),o):(a=a.nextHook,t())}catch(e){return console.warn(e),n&&n(e),e}else try{e(i,function(e){void 0===e?(a=a.nextHook,t()):n&&n(e)})}catch(e){return console.warn(e),n&&n(e),e}}();n&&n()}}}(),RED.i18n=function(){var n;function o(){return navigator.language}return{init:function(e,t){n=e.apiRootUrl||"";e=locale?locale[0]:o(),e={compatibilityJSON:"v3",backend:{loadPath:n+"locales/__ns__?lng=__lng__"},lng:e,preload:["en-US"],ns:["editor","node-red","jsonata","infotips"],defaultNS:"editor",fallbackLng:["en-US"],fallbackNS:["node-red","editor"],returnObjects:!0,keySeparator:".",nsSeparator:":",interpolation:{unescapeSuffix:"HTML",escapeValue:!1,prefix:"__",suffix:"__"}};i18next.use(i18nextHttpBackend).init(e,function(){t()}),jqueryI18next.init(i18next,$,{handleName:"i18n"}),RED._=function(){var e=i18next.t.apply(i18next,arguments);return"string"==typeof e?e:arguments[0]}},lang:function(){return(locale||[o()])[0]},loadNodeCatalog:function(e,t){i18next.loadNamespace(e,t)},loadNodeCatalogs:function(e){var t=locale||[o()].concat(i18next.languages),i=t.length;t.forEach(function(o){$.ajax({headers:{Accept:"application/json"},cache:!1,url:n+"locales/nodes?lng="+o,success:function(t){Object.keys(t).forEach(function(e){i18next.addResourceBundle(o,e,t[e])}),0===--i&&e()}})})},loadPluginCatalogs:function(e){var t=[localStorage.getItem("editor-language")||o()].concat(i18next.languages),i=t.length;t.forEach(function(o){$.ajax({headers:{Accept:"application/json"},cache:!1,url:n+"plugins/messages?lng="+o,success:function(t){Object.keys(t).forEach(function(e){i18next.addResourceBundle(o,e,t[e])}),0===--i&&e()}})})},detectLanguage:o}}(),RED.settings=function(){function i(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return}}function o(e){r=e}function n(o){s(function(e,t){e||(RED.settings.user&&!RED.settings.user.anonymous||RED.settings.remove("auth-tokens"),console.log("Node-BLUE: "+t.version),console.groupCollapsed("Versions"),console.log("jQuery",$().jquery),console.log("jQuery UI",$.ui.version),window.ace&&console.log("ACE",ace.version),window.monaco&&console.log("MONACO",monaco.version||"unknown"),console.log("D3",d3.version),console.groupEnd(),d(o))})}var e,a={},r={},s=function(i){$.ajax({headers:{Accept:"application/json"},dataType:"json",cache:!1,url:"settings",success:function(e){!function(e){for(var t in a)a.hasOwnProperty(t)&&RED.settings.hasOwnProperty(t)&&delete RED.settings[t];for(t in e)e.hasOwnProperty(t)&&(RED.settings[t]=e[t]);a=e}(e),i(null,e)},error:function(e,t,o){401===e.status?(/[?&]access_token=(.*?)(?:$|&)/.test(window.location.search)&&(window.location.search=""),RED.user.login(function(){s(i)})):console.log("Unexpected error loading settings:",e.status,t)}})};function d(t){$.ajax({headers:{Accept:"application/json"},dataType:"json",cache:!1,url:"settings/user",success:function(e){o(e),t()},error:function(e,t,o){console.log("Unexpected error loading user settings:",e.status,t)}})}function l(){RED.user.hasPermission("settings.write")&&(e&&clearTimeout(e),e=setTimeout(function(){e=null,$.ajax({method:"POST",contentType:"application/json",url:"settings/user",data:JSON.stringify(r),success:function(e){},error:function(e,t,o){console.log("Unexpected error saving user settings:",e.status,t)}})},300))}return{init:function(o,e){var t=/[?&]access_token=(.*?)(?:$|&)/.exec(window.location.search);t&&(t=t[1],RED.settings.set("auth-tokens",{access_token:t}),window.location.search=""),RED.settings.apiRootUrl=o.apiRootUrl,$.ajaxSetup({beforeSend:function(e,t){/^\s*(https?:|\/|\.)/.test(t.url)||(o.apiRootUrl&&(t.url=o.apiRootUrl+t.url),(t=RED.settings.get("auth-tokens"))&&e.setRequestHeader("Authorization","Bearer "+t.access_token),e.setRequestHeader("Node-BLUE-API-Version","v2"))}}),n(e)},load:n,loadUserSettings:d,refreshSettings:s,set:function(e,t){i()&&("auth-tokens"===e?localStorage.setItem(e,JSON.stringify(t)):(RED.utils.setMessageProperty(r,e,t),l()))},get:function(e,t){if(i()){if("auth-tokens"===e)return JSON.parse(localStorage.getItem(e));var o;try{o=RED.utils.getMessageProperty(r,e)}catch(e){}if(void 0===o)try{o=RED.utils.getMessageProperty(RED.settings,e)}catch(e){}return o=void 0===o?t:o}},remove:function(e){i()&&("auth-tokens"===e?localStorage.removeItem(e):(delete r[e],l()))},theme:function(e,t){if(!RED.settings.editorTheme)return t;var o=e.split("."),i=RED.settings.editorTheme;try{for(var n=0;n<o.length;n++)i=i[o[n]];return void 0===i?t:i}catch(e){return t}},setLocal:function(e,t){localStorage.setItem(e,t)},getLocal:function(e){return localStorage.getItem(e)},removeLocal:function(e){localStorage.removeItem(e)}}}(),RED.user=function(){function u(){$("#red-ui-header-button-user-submenu li").remove(),RED.settings.user.anonymous?RED.menu.addItem("red-ui-header-button-user",{id:"usermenu-item-login",label:RED._("menu.label.login"),onselect:function(){RED.user.login({cancelable:!0},function(){RED.settings.load(function(){RED.notify(RED._("user.loggedInAs",{name:RED.settings.user.username}),"success"),u(),RED.events.emit("login",RED.settings.user.username)})})}}):(RED.menu.addItem("red-ui-header-button-user",{id:"usermenu-item-username",label:"<b>"+RED.settings.user.username+"</b>"}),RED.menu.addItem("red-ui-header-button-user",{id:"usermenu-item-logout",label:RED._("menu.label.logout"),onselect:function(){RED.user.logout()}}))}var n=/^((.+)\.)?read$/,a=/^((.+)\.)?write$/;return{init:function(){var e;RED.settings.user&&(RED.settings.editorTheme&&RED.settings.editorTheme.hasOwnProperty("userMenu")&&!RED.settings.editorTheme.userMenu||(e=$('<li><a id="red-ui-header-button-user" class="button hide" href="#"></a></li>').prependTo(".red-ui-header-toolbar"),(RED.settings.user.image?$('<span class="user-profile"></span>').css({backgroundImage:"url("+RED.settings.user.image+")"}):$('<i class="fa fa-user"></i>')).appendTo(e.find("a")),RED.menu.init({id:"red-ui-header-button-user",options:[]}),u()))},login:function(l,c){"function"==typeof l&&(c=l,l={});var p=$('<div id="node-dialog-login" class="hide" style="display: flex; align-items: flex-end;"><div style="width: 250px; flex-grow: 0;"><img id="node-dialog-login-image" src=""/></div><div style="flex-grow: 1;"><form id="node-dialog-login-fields" class="form-horizontal" style="margin-bottom: 0px; margin-left:20px;"></form></div></div>');p.dialog({autoOpen:!1,classes:{"ui-dialog":"red-ui-editor-dialog","ui-dialog-titlebar-close":"hide","ui-widget-overlay":"red-ui-editor-dialog"},modal:!0,closeOnEscape:!!l.cancelable,width:600,resizable:!1,draggable:!1,close:function(e,t){$("#node-dialog-login").dialog("destroy").remove(),RED.keyboard.enable()}}),$("#node-dialog-login-fields").empty(),$.ajax({dataType:"json",url:"auth/login",success:function(n){var e=0;if("credentials"==n.type){for(;e<n.prompts.length;e++){var t=n.prompts[e],o=$("<div/>",{class:"form-row"});$('<label for="node-dialog-login-'+t.id+'">'+RED._(t.label)+":</label><br/>").appendTo(o);var i=$('<input style="width: 100%" id="node-dialog-login-'+t.id+'" type="'+t.type+'" tabIndex="'+(e+1)+'"/>').appendTo(o);e<n.prompts.length-1&&i.keypress(function(){var t=o;return function(e){13==e.keyCode&&(t.next("div").find("input").trigger("focus"),e.preventDefault())}}()),o.appendTo("#node-dialog-login-fields")}$('<div class="form-row" style="text-align: right; margin-top: 10px;"><span id="node-dialog-login-failed" style="line-height: 2em;float:left;color:var(--red-ui-text-color-error);" class="hide">'+RED._("user.loginFailed")+'</span><img src="red/images/spin.svg" style="height: 30px; margin-right: 10px; " class="login-spinner hide"/>'+(l.cancelable?'<a href="#" id="node-dialog-login-cancel" class="red-ui-button" style="margin-right: 20px;" tabIndex="'+(e+1)+'">'+RED._("common.label.cancel")+"</a>":"")+'<input type="submit" id="node-dialog-login-submit" class="red-ui-button" style="width: auto;" tabIndex="'+(e+2)+'" value="'+RED._("user.login")+'"></div>').appendTo("#node-dialog-login-fields"),$("#node-dialog-login-submit").button(),$("#node-dialog-login-fields").on("submit",function(e){$("#node-dialog-login-submit").button("option","disabled",!0),$("#node-dialog-login-failed").hide(),$(".login-spinner").show();for(var t={client_id:"node-red-editor",grant_type:"password",scope:""},o=0;o<n.prompts.length;o++){var i=n.prompts[o];t[i.id]=$("#node-dialog-login-"+i.id).val()}$.ajax({url:"auth/token",type:"POST",data:t}).done(function(e,t,o){RED.settings.set("auth-tokens",e),l.updateMenu&&u(),$("#node-dialog-login").dialog("close"),c()}).fail(function(e,t,o){RED.settings.remove("auth-tokens"),$("#node-dialog-login-failed").show()}).always(function(){$("#node-dialog-login-submit").button("option","disabled",!1),$(".login-spinner").hide()}),e.preventDefault()})}else if("strategy"==n.type)for(e=0;e<n.prompts.length;e++){var a,t=n.prompts[e],r=/[?&]session_message=(.*?)(?:$|&)/.exec(window.location.search);r&&(RED.sessionMessages=RED.sessionMessages||[],RED.sessionMessages.push(r[1]),history.pushState?(s=window.location.protocol+"//"+window.location.host+window.location.pathname,window.history.replaceState({path:s},"",s)):window.location.search=""),RED.sessionMessages&&(a=$("<div/>",{class:"form-row",style:"text-align: center"}).appendTo("#node-dialog-login-fields"),RED.sessionMessages.forEach(function(e){$("<div>").css("color","var(--red-ui-text-color-error)").text(e).appendTo(a)}),delete RED.sessionMessages);var s,o=$("<div/>",{class:"form-row",style:"text-align: center"}).appendTo("#node-dialog-login-fields"),r=$('<a href="#" class="red-ui-button"></a>',{style:"padding: 10px"}).appendTo(o).on("click",function(){document.location=t.url});t.image?$("<img>",{src:t.image}).appendTo(r):t.label&&(s=$("<span></span>").text(t.label),t.icon&&($("<i></i>",{class:"fa fa-2x "+t.icon,style:"vertical-align: middle"}).appendTo(r),s.css({verticalAlign:"middle",marginLeft:"8px"})),s.appendTo(r)),r.button()}l.cancelable&&$("#node-dialog-login-cancel").button().on("click",function(e){$("#node-dialog-login").dialog("close")});var d=n.image||"red/images/node-red-256.svg";$("#node-dialog-login-image").load(function(){p.dialog("open")}).attr("src",d),RED.keyboard.disable()}})},logout:function(){var e=(e=RED.settings.get("auth-tokens"))?e.access_token:"";$.ajax({url:"auth/revoke",type:"POST",data:{token:e}}).done(function(e,t,o){RED.settings.remove("auth-tokens"),e&&e.redirect?document.location.href=e.redirect:document.location.reload(!0)}).fail(function(e,t,o){401===e.status?document.location.reload(!0):console.log(t)})},hasPermission:function(e){return""===e||(!RED.settings.user||function e(t,o){if(""===o)return!0;var i;if(Array.isArray(o)){for(i=0;i<o.length;i++)if(!e(t,o[i]))return!1;return!0}if(Array.isArray(t)){if(0===t.length)return!1;for(i=0;i<t.length;i++)if(e(t[i],o))return!0;return!1}if("*"===t||t===o)return!0;{if("read"===t||"*.read"===t)return n.test(o);if("write"===t||"*.write"===t)return a.test(o)}return!1}(RED.settings.user.permissions||"",e))}}}(),RED.comms=function(){var r=null,s=null,d={};function l(e){if("nodeEvent"==e.method)if("global"==e.params[0])"flowsStarted"==e.params[1]?(RED.comms.homegear().invoke("setNodeVariable",null,RED.workspaces.active(),"enableEvents",!0),RED.notify(RED._("notification.info",{message:RED._("notification.infoMessages.flowsStarted")}),"success",!1)):"flowStartError"==e.params[1]?"crash"==e.params[2]?RED.notify(RED._("notification.error",{message:RED._("notification.errors.flowStartErrorCrash")}),"error",!1):RED.notify(RED._("notification.error",{message:RED._("notification.errors.flowStartError",{flow:e.params[2]})}),"error",!1):"nodePinkStartError"==e.params[1]?RED.notify(RED._("notification.error",{message:RED._("notification.errors.nodePinkStartError")}),"error",!1):"showNotification"==e.params[1]&&RED.notify(RED._(e.params[2].header,{message:RED._(e.params[2].text)}),e.params[2].type,e.params[2].fixed||!1);else for(var t in e.params[2].format&&!e.params[2].format.match(/string/g)&&(e.params[2].msg=JSON.stringify(e.params[2].msg)),d)if(d.hasOwnProperty(t))if(new RegExp("^"+t.replace(/([\[\]\?\(\)\\\\$\^\*\.|])/g,"\\$1").replace(/\+/g,"[^/]+").replace(/\/#$/,"(/.*)?")+"$").test(e.params[1])){var o=d[t];if(o)for(var i=0;i<o.length;i++)o[i](e.params[1],e.params[2])}}return{homegear:function(){return r},connect:function(){var e="https:"==window.location.protocol,t="",o=e?"443":"80",i=window.location.host.indexOf("]"),n=!1;-1<i?(part2=window.location.host.substring(i),2<part2.length&&":"==part2.charAt(1)&&(o=part2.substring(2)),t=window.location.host.substring(0,i+1)):(t=(a=window.location.host.split(":"))[0],1<a.length&&(o=a[1]));var a=(a="PHPSESSIDADMIN",(a=new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?a[1]:null);r=new HomegearWS(t,o,"hgflows",e,a),$(window).on("beforeunload",function(){n=!0,r.disconnect()}),r.ready(function(){s&&(s.close(),s=null)}),r.disconnected(function(e){n||(s&&s.close(),s=RED.notify(RED._("notification.error",{message:RED._("notification.errors.lostConnection")}),"error",!0))}),r.error(function(e){n||(s&&s.close(),s=RED.notify(RED._("notification.error",{message:RED._("notification.errors.lostConnection")}),"error",!0))}),r.event(l),r.connect()},subscribe:function(e,t){null==d[e]&&(d[e]=[]),d[e].push(t)},unsubscribe:function(e,t){if(d[e]){for(var o=0;o<d[e].length;o++)if(d[e][o]===t){d[e].splice(o,1);break}0===d[e].length&&delete d[e]}},getEvents:function(){r.invoke("getNodeEvents",function(e){for(var t in e.result)if(e.result.hasOwnProperty(t)){var o,i=e.result[t];for(o in i)if(i.hasOwnProperty(o)){var n,a=i[o];for(n in a.format&&!a.format.match(/string/g)&&(a.msg=JSON.stringify(a.msg)),d)if(d.hasOwnProperty(n))if(new RegExp("^"+n.replace(/([\[\]\?\(\)\\\\$\^\*\.|])/g,"\\$1").replace(/\+/g,"[^/]+").replace(/\/#$/,"(/.*)?")+"$").test(o)){var r=d[n];if(r)for(var s=0;s<r.length;s++)r[s](o,a)}}}})},getFixedInputs:function(){r.invoke("getNodesWithFixedInputs",function(e){var t,o,i=!1;for(t in e.result)e.result.hasOwnProperty(t)&&(i=!0,(o=RED.nodes.node(t))&&(o.fixedInputs=e.result[t],o.dirty=!0));i&&(RED.view.redraw(),s&&s.close(),s=RED.notify(RED._("notification.warning",{message:RED._("notification.warnings.fixed_inputs")}),"warning",!1))})}}}(),RED.text={},RED.text.bidi=function(){var t="";function o(e){return"auto"==t?function(e){for(var t,o=e.length,i=0;i<o;i++){if(1488<=(t=e.charCodeAt(i))&&t<=1535||1536<=t&&t<=1631||1642<=t&&t<=1775||1786<=t&&t<=2047||64285<=t&&t<=65023||65136<=t&&t<=65276)return 1;if(64<(t=e.charCodeAt(i))&&t<91||96<t&&t<123)return}}(e)?"rtl":"ltr":t}function i(){$(this).attr("dir",o($(this).val()))}return{setTextDirection:function(e){t=e,RED.nodes.eachNode(function(e){e.dirty=!0}),RED.view.redraw(),RED.palette.refresh(),$("#red-ui-workspace").find("span.red-ui-text-bidi-aware").each(function(){$(this).attr("dir",o($(this).html()))}),$("#red-ui-sidebar").find("span.red-ui-text-bidi-aware").each(function(){$(this).attr("dir",o($(this).text()))})},enforceTextDirectionWithUCC:function(e){if(e){var t=o(e);if("ltr"==t)return"‪"+e+"‬";if("rtl"==t)return"‫"+e+"‬"}return e},resolveBaseTextDir:o,prepareInput:function(e){e.on("keyup",i).on("paste",i).on("cut",i),i.call(e)}}}(),RED.text.format=function(){var e,p=function(e){this.content="",this.actual="",this.textDirection="",this.localGui="",this.isVisible=!0,this.isSeparator=!1,this.isParsed=!1,this.keep=!1,this.inBounds=!1,this.inPoints=!1;var t="";for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},d={handleSubcontents:function(e,t,o,i,n){if(!o.content||"string"!=typeof o.content||0===o.content.length)return e;var a=!0;void 0!==o.loops&&(a=!!o.loops);for(var r=0;;r++){1;{if(r>=e.length)break;if(!(e[r].isParsed||e.keep||e[r].isSeparator)){var s=e[r].content,d=s.indexOf(o.content);if(!(d<0)){var l,c=0;if(o.continued)for(;c++,0===(l=s.indexOf(o.content,d+c*o.content.length)););else c=1;if(l=d+c*o.content.length,e.splice(r,1),0<d&&(e.splice(r,0,new p({content:s.substring(0,d),localGui:t.dir,keep:!0})),r++),e.splice(r,0,new p({content:s.substring(d,l),textDirection:o.subDir,localGui:t.dir})),l<s.length&&e.splice(r+1,0,new p({content:s.substring(l,s.length),localGui:t.dir,keep:!0})),!a)break}}}}},handleBounds:function(e,t,o,i,n){for(var a=0;a<o.length;a++)if(function(e){if(e){void 0===e.start&&(e.start=""),void 0===e.end&&(e.end=""),void 0!==e.startAfter?(e.start=e.startAfter,e.after=!0):e.after=!1,void 0!==e.endBefore?(e.end=e.endBefore,e.before=!0):e.before=!1;var t=parseInt(e.startPos,10);isNaN(t)?e.usePos=!1:e.usePos=!0;t=parseInt(e.length,10);return isNaN(t)?e.useLength=!1:e.useLength=!0,e.loops=void 0===e.loops||!!e.loops,1}}(o[a]))for(var r=0;;r++){1;{if(r>=e.length)break;if(!(e[r].isParsed||e[r].inBounds||e.keep||e[r].isSeparator)){var s=function(e,t){var o,i={};for(o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);var n=e.content;return(e=i.usePos&&i.startPos<n.length)&&(i.start="",i.loops=!1),i.bStart=e?i.startPos:0<i.start.length?n.indexOf(i.start):0,(e=i.useLength&&0<i.length&&i.bStart+i.length<n.length)&&(i.end=""),i.bEnd=e?i.bStart+i.length:0<i.end.length?n.indexOf(i.end,i.bStart+i.start.length)+1:n.length,i.after||(i.start=""),i.before||(i.end=""),i}(e[r],o[a]),d=s.bStart,l=s.bEnd;if(!(d<0||l<0)){var c=e[r].content;if(e.splice(r,1),0<d&&(e.splice(r,0,new p({content:c.substring(0,d),localGui:t.dir,keep:!0})),r++),s.start&&(e.splice(r,0,new p({content:s.start,localGui:t.dir,isSeparator:!0})),r++),e.splice(r,0,new p({content:c.substring(d+s.start.length,l-s.end.length),textDirection:s.subDir,localGui:t.dir,inBounds:!0})),s.end&&(r++,e.splice(r,0,new p({content:s.end,localGui:t.dir,isSeparator:!0}))),l+s.end.length<c.length&&e.splice(r+1,0,new p({content:c.substring(l+s.end.length,c.length),localGui:t.dir,keep:!0})),!s.loops)break}}}}for(a=0;a<e.length;a++)e[a].inBounds=!1;return e},handleCases:function(e,t,o,i,n){if(0===o.length)return e;var a,r={};for(a in t)t.hasOwnProperty(a)&&(r[a]=t[a]);for(var s=0;s<o.length;s++)o[s].handler&&"function"==typeof o[s].handler.handle||(o[s].handler=t.commonHandler),o[s].args?(r.cases=o[s].args.cases,r.points=o[s].args.points,r.bounds=o[s].args.bounds,r.subs=o[s].args.subs):(r.cases=[],r.points=[],r.bounds=[],r.subs={}),o[s].handler.handle(i,e,r,n);return e},handlePoints:function(e,t,o,i,n){for(var a=0;a<o.length;a++)for(var r,s,d=0;;d++){1;{if(d>=e.length)break;e[d].isParsed||e[d].keep||e[d].isSeparator||0<=(s=(r=e[d].content).indexOf(o[a]))&&(e.splice(d,1),0<s&&(e.splice(d,0,new p({content:r.substring(0,s),textDirection:t.subDir,localGui:t.dir,inPoints:!0})),d++),e.splice(d,0,new p({content:o[a],localGui:t.dir,isSeparator:!0})),s+o[a].length+1<=r.length&&e.splice(d+1,0,new p({content:r.substring(s+o[a].length),textDirection:t.subDir,localGui:t.dir,inPoints:!0})))}}for(a=0;a<e.length;a++)e[a].keep?e[a].keep=!1:e[a].inPoints&&(e[a].isParsed=!0,e[a].inPoints=!1);return e}},s={handle:function(e,t,o,i){var n=[];Array.isArray(o.cases)&&(n=o.cases);var a=[];void 0!==o.points&&(Array.isArray(o.points)?a=o.points:"string"==typeof o.points&&(a=o.points.split("")));var r={};"object"==typeof o.subs&&(r=o.subs);var s=[];return Array.isArray(o.bounds)&&(s=o.bounds),d.handleBounds(t,o,s,e,i),d.handleSubcontents(t,o,r,e,i),d.handleCases(t,o,n,e,i),d.handlePoints(t,o,a,e,i),t}},l={LRE:"‪",RLE:"‫",PDF:"‬",LRM:"‎",RLM:"‏",LRO:"‭",RLO:"‮",getLocaleDetails:function(e){if(e=(e=e||("undefined"!=typeof navigator&&(navigator.language||navigator.userLanguage)||"")).toLowerCase(),!(o=(t=e)?t.split("-")[0]:"")||o.length<2||!["iw","he","ar","fa","ur"].some(function(e){return e===o}))return{lang:"not-bidi"};var t,o,e=e.split("-");return{lang:e[0],country:e[1]||""}},removeUcc:function(e){return e&&e.replace(/[\u200E\u200F\u202A-\u202E]/g,"")},removeTags:function(e){return e&&e.replace(/<[^<]*>/g,"")},getDirection:function(e,t,o,i){if("auto"!==t&&/^(rtl|ltr)$/i.test(t))return t;o=/^(rtl|ltr)$/i.test(o)?o:"ltr";e=i?e.split("").reverse().join(""):e,e=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return e?e[0]<="z"?"ltr":"rtl":o},hasArabicChar:function(e){return!!/[\u0600-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e)},showMarks:function(e,t){for(var o="",i=0;i<e.length;i++){var n=""+e.charAt(i);switch(n){case"‎":o+="<LRM>";break;case"‏":o+="<RLM>";break;case"‪":o+="<LRE>";break;case"‫":o+="<RLE>";break;case"‭":o+="<LRO>";break;case"‮":o+="<RLO>";break;case"‬":o+="<PDF>";break;default:o+=n}}t=void 0!==t&&/^(rtl|ltr)$/i.test(t)?"rtl"===t?"‮":"‭":"";return t+o+(t?"‬":"")},hideMarks:function(e){return e.replace(/<LRM>/g,this.LRM).replace(/<RLM>/g,this.RLM).replace(/<LRE>/g,this.LRE).replace(/<RLE>/g,this.RLE).replace(/<LRO>/g,this.LRO).replace(/<RLO>/g,this.RLO).replace(/<PDF>/g,this.PDF)},showTags:function(e){return"<xmp>"+e+"</xmp>"},hideTags:function(e){return e.replace(/<xmp>/g,"").replace(/<\/xmp>/g,"")}},c=((e={}).parseAndDisplayStructure=function(e,t,o,i){return e&&t?r(n(e,t,i),t,o):e},e.parseStructure=n,e.displayStructure=r,e.restore=function(e,t){return e},e);function a(e,t){e=Array.isArray(e)?e[0]:e;return e.guiDir||(e.guiDir="ltr"),e.dir||(e.dir=e.guiDir),t&&(void 0===e.points&&(e.points=[]),e.cases||(e.cases=[]),e.bounds||(e.bounds=[]),e.commonHandler=s),e}function n(e,t,o){if(!e||!t)return new p({content:""});var i=a(t,!0),n=[new p({content:e,actual:e,localGui:i.dir})],t=s.handle;return(t=i.handler&&"function"==typeof i.handler?i.handler.handle:t)(e,n,i,o),n}function r(e,t,o){t=a(t,!1);return(o?function(e,t){for(var o="",i="",n=0;n<e.length;n++){var a,r;stop=!e[n].isVisible||(r=e[n].textDirection,""!==(a=e[n].localGui)&&""===i?o+="<bdi dir='"+("rtl"===a?"rtl":"ltr")+"'>":""===i||""!==a&&a===i&&!stop||(o+="</bdi>"+(n==e.length-1&&""!==a?"":"<span style='unicode-bidi: embed; direction: "+("rtl"===t.dir?"rtl":"ltr")+";'></span>"),""!==a&&(o+="<bdi dir='"+("rtl"===a?"rtl":"ltr")+"'>")),"auto"===r&&(r=l.getDirection(e[n].content,r,t.guiDir)),/^(rtl|ltr)$/i.test(r)?o+="<bdi dir='"+("rtl"===r?"rtl":"ltr")+"'>"+e[n].content+"</bdi>":(o+=e[n].content,l.getDirection(e[n].content,r,t.guiDir,!0)),n<e.length-1?(r=a&&e[n+1].localGui?a:t.dir,o+="<span style='unicode-bidi: embed; direction: "+("rtl"===r?"rtl":"ltr")+";'></span>"):""!==i&&(o+="</bdi>"),i=a,!1)}var s="auto"===t.dir?l.getDirection(e[0].actual,t.dir,t.guiDir):t.dir;s!==t.guiDir&&(o="<bdi dir='"+("rtl"===s?"rtl":"ltr")+"'>"+o+"</bdi>");return o}:function(e,t){for(var o="",i="",n=!1,a=0;a<e.length;a++){var r,s;n=!e[a].isVisible||(s=e[a].textDirection,""!==(r=e[a].localGui)&&""===i?o+="rtl"===r?l.RLE:l.LRE:""===i||""!==r&&r===i&&!n||(o+=l.PDF+(a==e.length-1&&""!==r?"":"rtl"===t.dir?l.RLM:l.LRM),""!==r&&(o+="rtl"===r?l.RLE:l.LRE)),"auto"===s&&(s=l.getDirection(e[a].content,s,t.guiDir)),/^(rtl|ltr)$/i.test(s)?o+=("rtl"===s?l.RLE:l.LRE)+e[a].content+l.PDF:(o+=e[a].content,l.getDirection(e[a].content,s,t.guiDir,!0)),a<e.length-1?(s=r&&e[a+1].localGui?r:t.dir,o+="rtl"===s?l.RLM:l.LRM):""!==i&&(o+=l.PDF),i=r,!1)}var d="auto"===t.dir?l.getDirection(e[0].actual,t.dir,t.guiDir):t.dir;d!==t.guiDir&&(o=("rtl"===d?l.RLE:l.LRE)+o+l.PDF);return o})(e,t)}var t,o,i={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:t.dir||(o?"rtl":"ltr"),subs:{content:">",continued:!0,subDir:o?"rtl":"ltr"},cases:[{args:{subs:{content:"<",continued:!0,subDir:o?"ltr":"rtl"}}}]};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},u={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:"ltr",points:","};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},f={format:function(e,t,o,i,n,a){var r,o={guiDir:o?"rtl":"ltr",dir:(r=e,o=n,"ar"===l.getLocaleDetails(o).lang&&0<(o=r.indexOf("@"))&&o<r.length-1&&l.hasArabicChar(r.substring(o+1))?"rtl":"ltr"),points:"<>.:,;@",cases:[{handler:s,args:{bounds:[{startAfter:'"',endBefore:'"'},{startAfter:"(",endBefore:")"}],points:""}}]};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},h={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:"ltr",points:"/\\:."};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},g={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:"ltr",points:" /%^&[]<>=!?~:.,|()+-*{}"};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},v={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:"ltr",points:"\t!#%&()*+,-./:;<=>?|[]{}",cases:[{handler:s,args:{bounds:[{startAfter:"/*",endBefore:"*/"},{startAfter:"--",end:"\n"},{startAfter:"--"}]}},{handler:s,args:{subs:{content:" ",continued:!0}}},{handler:s,args:{bounds:[{startAfter:"'",endBefore:"'"},{startAfter:'"',endBefore:'"'}]}}]};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},m={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:"ltr",points:"_"};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},b={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:"ltr",points:":?#/@.[]="};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},y={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:t.dir||(o?"rtl":"ltr"),points:" ,.!?;:"};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},w={format:function(e,t,o,i,n,a){o={guiDir:o?"rtl":"ltr",dir:"ltr",points:" /[]<>=!:@.|()+-*",cases:[{handler:s,args:{bounds:[{startAfter:'"',endBefore:'"'},{startAfter:"'",endBefore:"'"}],points:""}}]};return a?c.parseStructure(e,o,!!i,n):c.parseAndDisplayStructure(e,o,!!i,n)}},E={format:function(e,t,o,i,n,a){var r={},s="",d=Array.isArray(t)?t[0]:t;for(s in d)d.hasOwnProperty(s)&&(r[s]=d[s]);return r.guiDir=o?"rtl":"ltr",r.dir=r.dir||r.guiDir,a?c.parseStructure(e,r,!!i,n):c.parseAndDisplayStructure(e,r,!!i,n)}};o=!(t={msgLang:"en",msgDir:"",phLang:"",phDir:"",phPacking:["{","}"],phStt:{type:"none",args:{}},guiDir:""});function D(e){return"he"===e||"iw"===e||"ar"===e?"rtl":"ltr"}function x(e){0===e.msgDir.length&&(e.msgDir=D(e.msgLang)),e.msgDir="ltr"!==e.msgDir&&"rtl"!==e.msgDir&&"auto"!=e.msgDir?"ltr":e.msgDir,0===e.guiDir.length&&(e.guiDir=e.msgDir),e.guiDir="rtl"!==e.guiDir?"ltr":"rtl",0===e.phDir.length&&(e.phDir=0===e.phLang.length?e.msgDir:D(e.phLang)),e.phDir="ltr"!==e.phDir&&"rtl"!==e.phDir&&"auto"!=e.phDir?"ltr":e.phDir,"string"==typeof e.phPacking&&(e.phPacking=e.phPacking.split("")),e.phPacking.length<2&&(e.phPacking=["{","}"])}var R=null;function k(e){switch(e){case"breadcrumb":return i;case"comma":return u;case"email":return f;case"filepath":return h;case"formula":return g;case"sql":return v;case"underscore":return m;case"url":return b;case"word":return y;case"xpath":return w;default:return E}}function _(t,e,o,i,n){if(!t||1!=t.nodeType)return!1;R||(R=document.createEvent("Event")).initEvent("TF",!0,!0),t.setAttribute("data-tf-type",e);o="undefined"===o?"{}":JSON.stringify(Array.isArray(o)?o[0]:o);t.setAttribute("data-tf-args",o);o="ltr";return"undefined"===i&&(t.dir?o=t.dir:t.style&&t.style.direction&&(o=t.style.direction),i="rtl"===o.toLowerCase()),t.setAttribute("data-tf-dir",i),t.setAttribute("data-tf-locale",l.getLocaleDetails(n).lang),!function(e){var t=window.navigator.userAgent;if(!(0<=t.indexOf("MSIE")||0<=t.indexOf("Trident")||0<=t.indexOf("Edge"))){t=document.createElement(e.tagName);t.contentEditable=!0;e="oninput"in t;return e||(t.setAttribute("oninput","return;"),e="function"==typeof t.oninput),t=null,e}}(t)?(t.onkeyup=function(e){$(e.target),t.dispatchEvent(R)},t.onmouseup=function(e){$(e.target),t.dispatchEvent(R)}):(t.oninput,t.oninput=function(e){$(e.target)}),$(t),!0}function $(e){var t=e.textContent||"",o=document.getSelection();if(0===t.length||!o||o.rangeCount<=0)e.dispatchEvent(R);else{var i=o.getRangeAt(0),n=i.cloneRange(),a=i.startContainer,r=i.startOffset,s=0;3===a.nodeType&&(s+=r),n.setStart(e,0),n.setEndBefore(a);a=document.createElement("div");a.appendChild(n.cloneContents()),s+=a.textContent.length,e.innerHTML=k(e.getAttribute("data-tf-type")).format(t,JSON.parse(e.getAttribute("data-tf-args")),"true"===e.getAttribute("data-tf-dir"),!0,e.getAttribute("data-tf-locale"));var d=e,l=e,c=0,p=!1;for(o.removeAllRanges(),i.setStart(e,0),i.setEnd(e,0);l;){if(3===l.nodeType){if(c+l.nodeValue.length>=s){i.setStart(l,s-c);break}c+=l.nodeValue.length,l=l.nextSibling}else{if(l.hasChildNodes()){l=(d=l).firstChild;continue}l=l.nextSibling}for(;!l;){if(d===e){p=!0;break}l=d.nextSibling,d=d.parentNode}if(p)break}o.addRange(i),e.dispatchEvent(R)}}return{getHtml:function(e,t,o,i,n){return k(t).format(e,o,i,!0,n)},attach:_}}(),RED.state={DEFAULT:0,MOVING:1,JOINING:2,MOVING_ACTIVE:3,ADDING:4,EDITING:5,EXPORT:6,IMPORT:7,IMPORT_DRAGGING:8,QUICK_JOINING:9,PANNING:10,SELECTING_NODE:11,GROUP_DRAGGING:12,GROUP_RESIZE:13,DETACHED_DRAGGING:14,SLICING:15},RED.plugins=function(){var t={},o={};return{registerPlugin:function(e,i){(t[e]=i).type&&(o[i.type]=o[i.type]||[],o[i.type].push(i)),RED._loadingModule?(i.module=RED._loadingModule,i._=function(){var e=Array.prototype.slice.call(arguments),t=e[0];/:/.test(e[0])||(e[0]=i.module+":"+e[0]);var o=RED._.apply(null,e);return o===e[0]?t:o}):i._=RED._,i.onadd&&"function"==typeof i.onadd&&i.onadd(),RED.events.emit("registry:plugin-added",e)},getPlugin:function(e){return t[e]},getPluginsByType:function(e){return o[e]||[]}}}(),RED.nodes=function(){var ie,ne,l={},ae={},g=[],c={},re={},d=[],se={},t=null,de={},p={},o=!1;var s,u,a,le=function(){var n={},a=[],r={},s={},d={},t={};d.tab={defaults:{label:{value:""},disabled:{value:!1},info:{value:""},env:{value:[]}}};var i={setModulePendingUpdated:function(e,t){n[e].pending_version=t,RED.events.emit("registry:module-updated",{module:e,version:t})},getModule:function(e){return n[e]},getNodeSetForType:function(e){return i.getNodeSet(s[e])},getModuleList:function(){return n},getNodeList:function(){return a},getNodeTypes:function(){return Object.keys(d)},setNodeList:function(e){a=[];for(var t=0;t<e.length;t++){var o=e[t];i.addNodeSet(o)}},addNodeSet:function(e){if(e.types){e.added=!1,r[e.id]=e;for(var t=0;t<e.types.length;t++)s[e.types[t]]=e.id;a.push(e),n[e.module]=n[e.module]||{name:e.module,version:e.version,local:e.local,sets:{}},e.pending_version&&(n[e.module].pending_version=e.pending_version),n[e.module].sets[e.name]=e,RED.events.emit("registry:node-set-added",e)}},removeNodeSet:function(e){for(var t=r[e],o=0;o<t.types.length;o++)delete s[t.types[o]];delete r[e];for(var i=0;i<a.length;i++)if(a[i].id===e){a.splice(i,1);break}return delete n[t.module].sets[t.name],0===Object.keys(n[t.module].sets).length&&delete n[t.module],RED.events.emit("registry:node-set-removed",t),t},getNodeSet:function(e){return r[e]},enableNodeSet:function(e){e=r[e];e.enabled=!0,RED.events.emit("registry:node-set-enabled",e)},disableNodeSet:function(e){e=r[e];e.enabled=!1,RED.events.emit("registry:node-set-disabled",e)},registerNodeType:function(e,t){if("subflow:"!=e.substring(0,8)){if(!r[s[e]]){var o="",i=e;return RED._loadingModule&&(i="["+RED._loadingModule+"] "+e,o=r[RED._loadingModule]?r[RED._loadingModule].err||"":"Unknown error"),void RED.notify(RED._("palette.event.unknownNodeRegistered",{type:i,error:o}),"error")}var n;t.set=r[s[e]],r[s[e]].added=!0,r[s[e]].enabled=!0,n="node-red"===t.set.module?"node-red":t.set.id,t._=function(){var e=Array.prototype.slice.call(arguments,0),t=e[0];-1===e[0].indexOf(":")&&(e[0]=n+":"+e[0]);var o=RED._.apply(null,e);return o=o===e[0]?t:o}}if(t.type=e,(d[e]=t).defaults)for(var a in t.defaults)if(t.defaults.hasOwnProperty(a)&&t.defaults[a].type)try{t.defaults[a]._type=function(e){var t;e=e.trim();var o=0,i=/\[\]$/.test(e);i&&(e=e.substring(0,e.length-2));var n=e.length,a=!1,r=!1,s="",d=[];for(;o<n;){if(t=e[o],r)"|"===t?(d.push(s.trim()),s="",r=!1):")"===t?(d.push(s.trim()),s="",r=a=!1):s+=t;else if("("===t){if(a)throw new Error("Invalid character '"+t+"' at position "+o);a=!0}else" "!==t&&(r=!0,s=t);o++}0<(s=s.trim()).length&&d.push(s);return{types:d,array:i}}(t.defaults[a].type)}catch(e){console.warn(e)}RED.events.emit("registry:node-type-added",e)},removeNodeType:function(e){if("subflow:"!=e.substring(0,8))throw new Error("this api is subflow only. called with:",e);delete d[e],RED.events.emit("registry:node-type-removed",e)},getNodeType:function(e){return d[e]},setIconSets:function(e){(t=e)["font-awesome"]=RED.nodes.fontAwesome.getIconList(),t["homegear-ui-icons"]=RED.nodes.homegearUiIcons.getIconList()},getIconSets:function(){return t}};return i}(),ce=(s={},u={},a={addTab:function(e){u[e]=[]},hasTab:function(e){return u.hasOwnProperty(e)},removeTab:function(e){delete u[e]},addNode:function(e){s[e.id]=e,u.hasOwnProperty(e.z)?u[e.z].push(e):(console.warn("Node added to unknown tab/subflow:",e),u._=u._||[],u._.push(e))},removeNode:function(e){var t;delete s[e.id],!u.hasOwnProperty(e.z)||-1<(t=u[e.z].indexOf(e))&&u[e.z].splice(t,1)},hasNode:function(e){return s.hasOwnProperty(e)},getNode:function(e){return s[e]},moveNode:function(e,t){a.removeNode(e),e.z=t,a.addNode(e)},moveNodesForwards:function(e){var t=[];Array.isArray(e)||(e=[e]);for(var o=u[e[0].z],i=new Set(e.filter(function(e){return"group"!==e.type&&"subflow"!==e.type})),n=new Set,a=o.length-1;0<=a&&0!==i.size;a--){var r=o[a];i.has(r)&&(a<o.length-1&&!n.has(o[a+1])&&(o.splice(a,1),o.splice(a+1,0,r),r._reordered=!0,t.push(r)),i.delete(r),n.add(r))}return 0<t.length&&RED.events.emit("nodes:reorder",{z:e[0].z,nodes:t}),t},moveNodesBackwards:function(e){var t=[];Array.isArray(e)||(e=[e]);for(var o=u[e[0].z],i=new Set(e.filter(function(e){return"group"!==e.type&&"subflow"!==e.type})),n=new Set,a=0;a<o.length&&0!==i.size;a++){var r=o[a];i.has(r)&&(0<a&&!n.has(o[a-1])&&(o.splice(a,1),o.splice(a-1,0,r),r._reordered=!0,t.push(r)),i.delete(r),n.add(r))}return 0<t.length&&RED.events.emit("nodes:reorder",{z:e[0].z,nodes:t}),t},moveNodesToFront:function(e){var t=[];Array.isArray(e)||(e=[e]);for(var o=u[e[0].z],i=new Set(e.filter(function(e){return"group"!==e.type&&"subflow"!==e.type})),n=o.length-1,a=o.length-1;0<=a&&0!==i.size;a--){var r=o[a];i.has(r)&&(a<n&&(o.splice(a,1),o.splice(n,0,r),r._reordered=!0,t.push(r)),n--,i.delete(r))}return 0<t.length&&RED.events.emit("nodes:reorder",{z:e[0].z,nodes:t}),t},moveNodesToBack:function(e){var t=[];Array.isArray(e)||(e=[e]);for(var o=u[e[0].z],i=new Set(e.filter(function(e){return"group"!==e.type&&"subflow"!==e.type})),n=0,a=0;a<o.length&&0!==i.size;a++){var r=o[a];i.has(r)&&(n<a&&(o.splice(a,1),o.splice(n,0,r),r._reordered=!0,t.push(r)),n++,i.delete(r))}return 0<t.length&&RED.events.emit("nodes:reorder",{z:e[0].z,nodes:t}),t},getNodes:function(e){return u[e]},clear:function(){s={},u={}},eachNode:function(e){var t,o,i;for(o in se)if(se.hasOwnProperty(o))for(t=u[o],i=0;i<t.length;i++)if(!1===e(t[i]))return;for(o=0;o<d.length;o++)for(t=u[d[o]],i=0;i<t.length;i++)if(!1===e(t[i]))return;if(u._)for(t=u._,i=0;i<t.length;i++)if(!1===e(t[i]))return},filterNodes:function(e){var t=[],o=null,i=!1;e.hasOwnProperty("z")&&(u.hasOwnProperty(e.z)?o=u[e.z]:i=!0);var n=!1;null===o&&(o=Object.keys(s),n=!0);for(var a=0;a<o.length;a++){var r=o[a];n&&(r=s[r]),e.hasOwnProperty("type")&&r.type!==e.type||i&&r.z!==e.z||t.push(r)}return t},getNodeOrder:function(e){return u[e].map(function(e){return e.id})},setNodeOrder:function(e,t){var o={};t.forEach(function(e,t){o[e]=t}),u[e].sort(function(e,t){return e._reordered=!0,t._reordered=!0,o[e.id]-o[t.id]})}});function pe(){for(var e=[],t=0;t<8;t++)e.push(Math.round(255*Math.random()).toString(16).padStart(2,"0"));return e.join("")}function ue(e){var t,o;0!==e.type.indexOf("subflow")?e._=e._def._:(t=e.type.substring(8),(t=RED.nodes.subflow(t))&&t.instances.push(t),e._=RED._),"config"==e._def.category?ae[e.id]=e:(e.wires&&e.wires.length>e.outputs&&(e.outputs=e.wires.length),e.dirty=!0,r(e),"subflows"==e._def.category&&void 0===e.i&&(o=0,RED.nodes.eachNode(function(e){o=Math.max(o,e.i||0)}),e.i=o+1),ce.addNode(e),c[e.id]||(c[e.id]={in:[],out:[]})),RED.events.emit("nodes:add",e)}function fe(e){g.push(e),e.source&&(c[e.source.id]||(c[e.source.id]={in:[],out:[]}),c[e.source.id].out.push(e)),e.target&&(c[e.target.id]||(c[e.target.id]={in:[],out:[]}),c[e.target.id].in.push(e)),e.source.z===e.target.z&&l[e.source.z]&&l[e.source.z].push(e),RED.events.emit("links:add",e)}function f(e){return e in ae?ae[e]:ce.getNode(e)}function h(e){var t,o=[],i=[];if(e in ae)t=ae[e],delete ae[e],RED.events.emit("nodes:remove",t),RED.workspaces.refresh();else if(ce.hasNode(e)){t=ce.getNode(e),ce.removeNode(t),delete c[e],(o=g.filter(function(e){return e.source===t||e.target===t})).forEach(v);var a,r,s,d=!1;for(a in t._def.defaults)!t._def.defaults.hasOwnProperty(a)||(r=t._def.defaults[a]).type&&(!(s=le.getNodeType(r.type))||"config"!=s.category||(r=ae[t[a]])&&(d=!0,r._def.exclusive?(h(t[a]),i.push(r)):((s=r.users).splice(s.indexOf(t),1),RED.events.emit("nodes:change",r))));0===t.type.indexOf("subflow:")&&(e=t.type.substring(8),(e=RED.nodes.subflow(e))&&e.instances.splice(e.instances.indexOf(t),1)),d&&RED.workspaces.refresh();try{t._def.oneditdelete&&t._def.oneditdelete.call(t)}catch(e){console.log("oneditdelete",t.id,t.type,e.toString())}RED.events.emit("nodes:remove",t)}return t&&t._def.onremove&&(console.log("Deprecated API warning: node type ",t.type," has an onremove function - should be oneditremove - please report"),t._def.onremove.call(n)),{links:o,nodes:i}}function v(e){var t,o=g.indexOf(e);-1!=o&&(g.splice(o,1),e.source&&c[e.source.id]&&(-1!==(t=c[e.source.id].out.indexOf(e))&&c[e.source.id].out.splice(t,1)),e.target&&c[e.target.id]&&(-1!==(t=c[e.target.id].in.indexOf(e))&&c[e.target.id].in.splice(t,1)),e.source.z===e.target.z&&l[e.source.z]&&-1!==(o=l[e.source.z].indexOf(e))&&l[e.source.z].splice(o,1)),RED.events.emit("links:remove",e)}function he(e,t){re[e.id]=e,ce.addTab(e.id),l[e.id]=[],e._def=RED.nodes.getType("tab"),void 0===t?d.push(e.id):d.splice(t,0,e.id),RED.events.emit("flows:add",e),void 0!==t&&RED.events.emit("flows:reorder",d)}function ge(t,e){var o,i;e&&((e=Object.keys(se).map(function(e){return se[e].name})).sort(),o=1,i=t.name,e.forEach(function(e){i==e&&(o++,i=t.name+" ("+o+")")}),t.name=i),se[t.id]=t,ce.addTab(t.id),l[t.id]=[],RED.nodes.registerType("subflow:"+t.id,{defaults:{name:{value:""},env:{value:[]}},icon:function(){return t.icon||"subflow.svg"},category:t.category||"subflows",inputs:t.in.length,outputs:t.out.length,color:t.color||"#DDAA99",label:function(){return this.name||RED.nodes.subflow(t.id).name},labelStyle:function(){return this.name?"red-ui-flow-node-label-italic":""},paletteLabel:function(){return RED.nodes.subflow(t.id).name},inputLabels:function(e){return t.inputLabels?t.inputLabels[e]:null},outputLabels:function(e){return t.outputLabels?t.outputLabels[e]:null},oneditprepare:function(){"subflow"!==this.type?RED.subflow.buildEditForm("subflow",this):RED.subflow.buildEditForm("subflow-template",this)},oneditresize:function(e){"subflow"===this.type&&$("#node-input-env-container").editableList("height",e.height-80)},set:{module:"node-red"}}),t.instances=[],t._def=RED.nodes.getType("subflow:"+t.id),RED.events.emit("subflows:add",t)}function ve(e){return se[e]}function me(e,t){for(var o=ce.getNodes(e),i=0;i<o.length;i++){var n=o[i],n=/^subflow:(.+)$/.exec(n.type);if(n){if(n[1]===t)return!0;if(me(n[1],t))return!0}}return!1}function e(e,t){RED.view.selection();for(var o=new Set,i=[e],n=!0;0<i.length;){var a=i.shift();o.add(a);var r=[];n&&t&&(!n||"up"!==t)||(r=r.concat(c[a.id].in)),n&&t&&(!n||"down"!==t)||(r=r.concat(c[a.id].out)),n=!1,r.forEach(function(e){o.has(e.source)||i.push(e.source),o.has(e.target)||i.push(e.target)})}return Array.from(o)}function m(e,t){var o=!0;t&&t.hasOwnProperty("credentials")&&(o=t.credentials);var i,n={};for(i in n.id=e.id,n.type=e.type,e.hasOwnProperty("homegearTag")&&(n.homegearTag=e.homegearTag),e._def.defaults)e._def.defaults.hasOwnProperty(i)&&(n[i]=e[i]);if(o){var a={};if(e.credentials){for(var r in e.credentials)e.credentials.hasOwnProperty(r)&&(!e.credentials._||e.credentials["has_"+r]!=e.credentials._["has_"+r]||e.credentials["has_"+r]&&e.credentials[r])&&(a[r]=e.credentials[r]);0<Object.keys(a).length&&(n.credentials=a)}}return n}function b(t,e){var o=!0,i=!1;if(!1===e?o=!1:"object"==typeof e&&(e.hasOwnProperty("credentials")&&(o=e.credentials),e.hasOwnProperty("dimensions")&&(i=e.dimensions)),"tab"===t.type)return m(t,{credentials:o});var n={};if(n.id=t.id,n.type=t.type,t.hasOwnProperty("homegearTag")&&(n.homegearTag=t.homegearTag),n.z=t.z,0!==n.z&&""!==n.z||delete n.z,!0===t.d&&(n.d=!0),t.g&&(n.g=t.g),"unknown"==n.type)for(var a in t._orig)t._orig.hasOwnProperty(a)&&(n[a]=t._orig[a]);else{for(var r in t._def.defaults)t._def.defaults.hasOwnProperty(r)&&(n[r]=t[r]);if(o){var s={};if((/^subflow:/.test(n.type)||"group"===n.type)&&t.credentials)for(var d in t.credentials)t.credentials.hasOwnProperty(d)&&(!t.credentials._||t.credentials["has_"+d]!=t.credentials._["has_"+d]||t.credentials["has_"+d]&&t.credentials[d])&&(s[d]=t.credentials[d]);else if(t.credentials)for(var l in n.credentials={},t._def.credentials)t._def.credentials.hasOwnProperty(l)&&("password"==t._def.credentials[l].type?(!t.credentials._||t.credentials["has_"+l]!=t.credentials._["has_"+l]||t.credentials["has_"+l]&&t.credentials[l])&&(s[l]=t.credentials[l]):null==t.credentials[l]||t.credentials._&&t.credentials[l]==t.credentials._[l]||(s[l]=t.credentials[l]));0<Object.keys(s).length&&(n.credentials=s)}}if("group"===t.type&&(n.x=t.x,n.y=t.y,n.w=t.w,n.h=t.h,n.nodes=n.nodes.filter(function(e){return!!e}).map(function(e){return e.id})),"tab"!==t.type&&"group"!==t.type||n.env&&0===n.env.length&&delete n.env,"config"!=t._def.category){n.x=t.x,n.y=t.y,i&&(t.hasOwnProperty("w")||(p=RED.view.calculateNodeDimensions(t),t.w=p[0],t.h=p[1]),n.w=t.w,n.h=t.h),n.wires=[];for(var c=0;c<t.outputs;c++)n.wires.push([]);for(var p,u=g.filter(function(e){return e.source===t}),f=0;f<u.length;f++){var h=u[f];"subflow"!=h.target.type&&h.sourcePort<n.wires.length&&n.wires[h.sourcePort].push({id:h.target.id,port:h.targetPort})}0<t.inputs&&t.inputLabels&&!/^\s*$/.test(t.inputLabels.join(""))&&(n.inputLabels=t.inputLabels.slice()),0<t.outputs&&t.outputLabels&&!/^\s*$/.test(t.outputLabels.join(""))&&(n.outputLabels=t.outputLabels.slice()),t._def.defaults&&t._def.defaults.hasOwnProperty("icon")||!t.icon||(p=RED.utils.getDefaultNodeIcon(t._def,t),t.icon!==p.module+"/"+p.file&&(n.icon=t.icon)),t._def.defaults&&t._def.defaults.hasOwnProperty("l")||!t.hasOwnProperty("l")||(!t._def.hasOwnProperty("showLabel")||t._def.showLabel)!=t.l&&(n.l=t.l)}return t.info&&(n.info=t.info),n}function y(a,e){var t=!0;!1===e?t=!1:"object"==typeof e&&(e.hasOwnProperty("credentials")&&(t=e.credentials),e.hasOwnProperty("dimensions")&&e.dimensions);var r={};if(r.id=a.id,r.type=a.type,r.name=a.name,r.info=a.info,r.category=a.category,r.in=[],r.out=[],r.env=a.env,r.meta=a.meta,t){var o,n={};for(o in a.credentials)a.credentials.hasOwnProperty(o)&&(!a.credentials._||a.credentials["has_"+o]!=a.credentials._["has_"+o]||a.credentials["has_"+o]&&a.credentials[o])&&(n[o]=a.credentials[o]);0<Object.keys(n).length&&(r.credentials=n)}return r.color=a.color,a.in.forEach(function(t){for(var e={x:t.x,y:t.y,wires:[]},o=g.filter(function(e){return e.source===t}),i=0;i<o.length;i++){var n=o[i];"subflow"!=n.target.type&&e.wires.push({id:n.target.id,port:o[i].targetPort})}r.in.push(e)}),a.out.forEach(function(t,e){var o={x:t.x,y:t.y,wires:[]},n=g.filter(function(e){return e.target===t});for(i=0;i<n.length;i++)"subflow"!=n[i].source.type?o.wires.push({id:n[i].source.id,port:n[i].sourcePort}):o.wires.push({id:a.id,port:n[i].sourcePort});r.out.push(o)}),0<r.in.length&&a.inputLabels&&!/^\s*$/.test(a.inputLabels.join(""))&&(r.inputLabels=a.inputLabels.slice()),0<r.out.length&&a.outputLabels&&!/^\s*$/.test(a.outputLabels.join(""))&&(r.outputLabels=a.outputLabels.slice()),a.icon&&"node-red/subflow.svg"!==a.icon&&(r.icon=a.icon),a.status&&(r.status={x:a.status.x,y:a.status.y,wires:[]},g.forEach(function(e){e.target===a.status&&("subflow"!=e.source.type?r.status.wires.push({id:e.source.id,port:e.sourcePort}):r.status.wires.push({id:a.id,port:0}))})),r}function be(o,t,e,i){var n=[];t=t||{},o=o.filter(function(e){return!t[e.id]&&(t[e.id]=!0)}),i=i||{},e=e||{};for(var a=0;a<o.length;a++){var r,s,d=o[a];if("subflow:"==d.type.substring(0,8)&&(e[r=d.type.substring(8)]||(e[r]=!0,u=ve(r),(s=ce.getNodes(r).slice()).unshift(u),RED.nodes.eachConfig(function(e){e.z==r&&(s.push(e),i[e.id]=!0)}),n=be(s,t,e,i).concat(n))),"subflow"!==d.type){var l,c,p=RED.nodes.convertNode(d);for(l in d._def.defaults)d._def.defaults[l].type&&(c=d[l],0===(c=(c=!Array.isArray(c)?[c]:c).filter(function(e){if(e in ae){var t=ae[e];return!1!==t._def.exportable?(e in i||(i[e]=!0,o.push(t)),!0):!1}return!0})).length?p[l]=Array.isArray(d[l])?[]:"":p[l]=Array.isArray(d[l])?c:c[0]);n.push(p),"group"===d.type&&(n=n.concat(be(d.nodes,t,e,i)))}else{var u=y(d);n.push(u)}}return n}function ye(e){var o={tabs:{},subflows:{},groups:{},configs:{},nodes:{},all:[],conflicted:{},zMap:{}};return e.forEach(function(e){o.all.push(e),"tab"===e.type?o.tabs[e.id]=e:"subflow"===e.type?o.subflows[e.id]=e:"group"===e.type?o.groups[e.id]=e:e.hasOwnProperty("x")&&e.hasOwnProperty("y")?o.nodes[e.id]=e:o.configs[e.id]=e;var t=e.z||"__global__";o.zMap[t]=o.zMap[t]||[],o.zMap[t].push(e),(ce.hasNode(e.id)||ae[e.id]||re[e.id]||se[e.id]||de[e.id])&&(o.conflicted[e.id]=e)}),o}function we(e){var a={},r={},o={},s=[];e.forEach(function(e){"subflow"===e.type?r[e.id]=e:e.hasOwnProperty("x")||e.hasOwnProperty("y")||(o[e.id]=e),e.z&&(a[e.z]=a[e.z]||[],a[e.z].push(e))}),(t=Object.keys(o)).forEach(function(e){var t=o[e];r[t.z]&&delete o[e]});var t=Object.keys(o),e=Object.keys(r);return e.forEach(function(e){var t,o,i,n=r[e];s=s.concat((i=ve(t=e),(t=ce.getNodes(i.id))?(o=t.slice()).unshift(i):o=[i],console.log(o),be(o)));RED.subflow.removeSubflow(n.id,!0),w([n].concat(a[n.id]));r[e]=ve(e)}),RED.nodes.eachNode(function(e){var t;/^subflow:/.test(e.type)&&(t=e.type.substring(8),r[t]&&(r[t].instances.push(e),e._def=RED.nodes.getType(e.type),e.dirty=!0,e.changed=!0,e._colorChanged=!0))}),e.forEach(function(e){e=r[e];RED.events.emit("subflows:change",e)}),RED.utils.clearNodeColorCache(),t.forEach(function(e){s=s.concat(b(f(e))),h(e),w([o[e]])}),{removedNodes:s}}function w(e,o){(o=o||{generateIds:!1,addFlow:!1}).importMap=o.importMap||{};var t,i=o.generateIds,n=o.addFlow,a={};if("string"==typeof e){if(""===e)return;try{p=JSON.parse(e)}catch(x){var r=new Error(RED._("clipboard.invalidFlow",{message:x.message}));throw r.code="NODE_RED",r}}else p=e;$.isArray(p)||(p=[p]);var s,d={},l=[],c=[],p=p.filter(function(e){var t=e.id;if(d[e.id])return!1;if(d[e.id]=!0,!o.generateIds)if(o.importMap[t]){if("replace"===o.importMap[t])return c.push(e),!1}else{t=ce.getNode(t)||ae[t]||re[t]||se[t]||de[t];t&&l.push({existing:t,imported:e})}return!0});if(0<l.length){for(var r=RED._("clipboard.importDuplicate",{count:l.length}),u=$("<ul>"),f=Math.min(5,l.length),h=0;h<f;h++){var g=l[h];$("<li>").text(g.existing.id+" [ "+g.existing.type+(g.imported.type!==g.existing.type?" | "+g.imported.type:"")+" ]").appendTo(u)}f!==l.length&&$("<li>").text(RED._("deploy.confirm.plusNMore",{count:l.length-f})).appendTo(u);e=$("<p>").append(u),e=new Error(r+e.html());throw e.code="import_conflict",e.importConfig=ye(p),e}0<c.length&&(s=we(c).removedNodes);var v=!1;ne||(v=!0,ne=JSON.parse(JSON.stringify(p)));var m,b=[];for(h=0;h<p.length;h++){var y;(y=p[h]).id;"workspace"==y.type||"tab"==y.type||"subflow"==y.type||"group"==y.type||le.getNodeType(y.type)||"subflow:"==y.type.substring(0,8)||-1!=b.indexOf(y.type)||b.push(y.type),y.z?(a[y.z]=a[y.z]||[],a[y.z].push(y)):v&&y.hasOwnProperty("x")&&y.hasOwnProperty("y")&&!y.z&&(t||(he(t={id:RED.nodes.id(),type:"tab",disabled:!1,label:RED._("clipboard.recoveredNodes"),info:RED._("clipboard.recoveredNodesInfo"),env:[]}),RED.workspaces.add(t),a[t.id]=[]),y.z=t.id,a[t.id].push(y))}!v&&0<b.length&&(m=$("<ul>"),b.forEach(function(e){$("<li>").text(e).appendTo(m)}),m=m[0].outerHTML,RED.notify("<p>"+RED._("clipboard.importUnrecognised",{count:b.length})+"</p>"+m,"error",!1,1e4));var w=RED.workspaces.active(),E=ve(w);for(h=0;h<p.length;h++){var D=/^subflow:(.+)$/.exec(p[h].type);if(D){var x,R=D[1],D=ve(w);if(D)if(R===D.id&&(x=new Error(RED._("notification.errors.cannotAddSubflowToItself"))),x=me(R,D.id)?new Error(RED._("notification.errors.cannotAddCircularReference")):x)throw x.code="NODE_RED",x}}var k,_,T,C,j,L=[],z={},S=[],M={},O={},I={},N=[],P=[],A=[],B=new Set,V=null;for(t&&L.push(t),h=0;h<p.length;h++)"workspace"===(y=p[h]).type||"tab"===y.type?("workspace"===y.type&&(y.type="tab"),null==ie&&(ie=y),0===w&&(w=y.id),i||"copy"===o.importMap[y.id]?(k=pe(),z[y.id]=k,y.id=k):z[y.id]=y.id,he(y),RED.workspaces.add(y),L.push(y)):"subflow"===y.type&&((j=!o.importMap[y.id]?function(a,r){var s;r=r||[];var d=null;return RED.nodes.eachSubflow(function(e){if(e.name==a.name&&e.info==a.info&&e.in.length==a.in.length&&e.out.length==a.out.length){var t=RED.nodes.filterNodes({z:e.id});if(t.length==r.length){var o=[a].concat(r),i=[e].concat(t),n=JSON.stringify(o),i=JSON.stringify(be(i));for(s=0;s<t.length;s++)n=n.replace(new RegExp('"'+r[s].id+'"',"g"),'"'+t[s].id+'"');if((n=n.replace(new RegExp('"'+a.id+'"',"g"),'"'+e.id+'"'))===i)return d=e,!1}}}),d}(y,a[y.id]):j)?O[y.id]=j:(M[y.id]=y,!i&&"copy"!==o.importMap[y.id]||(k=pe(),y.id=k),y.in.forEach(function(e,t){e.type="subflow",e.direction="in",e.z=y.id,e.i=t,e.id=pe()}),y.out.forEach(function(e,t){e.type="subflow",e.direction="out",e.z=y.id,e.i=t,e.id=pe()}),y.status&&(y.status.type="subflow",y.status.direction="status",y.status.z=y.id,y.status.id=pe()),S.push(y),ge(y,i||"copy"===o.importMap[y.id])));for(null==ie&&(he(ie={type:"tab",id:pe(),disabled:!1,info:"",label:RED._("workspace.defaultName",{number:1}),env:[]}),RED.workspaces.add(ie),L.push(ie),w=RED.workspaces.active()),h=0;h<p.length;h++)if(y=p[h],(_=le.getNodeType(y.type))&&"config"==_.category){var H=null;if(i||"copy"===o.importMap[y.id]){if(y.z){if(O[y.z])continue;M[y.z]?y.z=M[y.z].id:(y.z=z[y.z],re[y.z]||(n?(null===V&&(V=RED.workspaces.add(null,!0),L.push(V)),y.z=V.id):y.z=w))}if("copy"!==o.importMap[y.id]&&(H=RED.nodes.node(y.id))&&y.z&&H.z!==y.z)for(var G in H=null,ae)if(ae.hasOwnProperty(G)&&ae[G].z===y.z&&function(e,t,o){if((!o||e.id==t.id)&&e.type==t.type){var i,n=e._def;for(i in n.defaults)if(n.defaults.hasOwnProperty(i)){var a=e[i],r=t[i];if(typeof a!=typeof r)return;if(null===a||"string"==typeof a||"number"==typeof a){if(a!==r)return}else if(JSON.stringify(a)!==JSON.stringify(r))return}return 1}}(ae[G],y,!1)){H=ae[G],I[y.id]=ae[G];break}}else!y.z||z[y.z]||M[y.z]||(y.z=w);if(!H||H._def.exclusive){for(C in T={id:y.id,z:y.z,type:y.type,info:y.info,users:[],_config:{}},y.z||delete T.z,y.hasOwnProperty("d")&&(T.d=y.d),_.defaults)_.defaults.hasOwnProperty(C)&&(T[C]=y[C],T._config[C]=JSON.stringify(y[C]));if(_.hasOwnProperty("credentials")&&y.hasOwnProperty("credentials"))for(C in T.credentials={},_.credentials)_.credentials.hasOwnProperty(C)&&y.credentials.hasOwnProperty(C)&&(T.credentials[C]=y.credentials[C]);T.label=_.label,T._def=_,!i&&"copy"!==o.importMap[y.id]||(T.id=pe()),I[y.id]=T,N.push(T)}}for(h=0;h<p.length;h++)if("workspace"!==(y=p[h]).type&&"tab"!==y.type&&"subflow"!==y.type&&(!(_=le.getNodeType(y.type))||"config"!=_.category)){var F={x:parseFloat(y.x||0),y:parseFloat(y.y||0),z:y.z,type:0,info:y.info,changed:!1,_config:{}};if("group"!==y.type&&(F.wires=y.wires||[],F.inputLabels=y.inputLabels,F.outputLabels=y.outputLabels,F.icon=y.icon),y.hasOwnProperty("l")&&(F.l=y.l),y.hasOwnProperty("d")&&(F.d=y.d),y.hasOwnProperty("g")&&(F.g=y.g),i||"copy"===o.importMap[y.id]){if(O[y.z])continue;M[F.z]?F.z=M[F.z].id:(F.z=z[F.z],re[F.z]||(n?(null===V&&(V=RED.workspaces.add(null,!0),L.push(V)),F.z=V.id):F.z=w)),F.id=pe()}else F.id=y.id,null!=F.z&&(z[F.z]||M[F.z])||(n?(null===V&&(V=RED.workspaces.add(null,!0),L.push(V)),F.z=V.id):F.z=w);if(F.type=y.type,y.hasOwnProperty("homegearTag")&&(F.homegearTag=y.homegearTag),F._def=_,"group"===F.type){for(C in F._def=RED.group.def,F._def.defaults)F._def.defaults.hasOwnProperty(C)&&"inputs"!==C&&"outputs"!==C&&(F[C]=y[C],F._config[C]=JSON.stringify(y[C]));F._config.x=F.x,F._config.y=F.y}else if("subflow"===y.type.substring(0,7)){var U=y.type.split(":")[1],J=O[U]||M[U]||ve(U);!i&&"copy"!==o.importMap[y.id]||(U=J.id,F.type="subflow:"+U,F._def=le.getNodeType(F.type),delete F.i),F.name=y.name,F.outputs=J.out.length,F.inputs=J.in.length,F.env=y.env}else{if(!F._def){F.x&&F.y?F._def={color:"#fee",defaults:{},label:"unknown: "+y.type,labelStyle:"red-ui-flow-node-label-italic",outputs:y.outputs||y.wires&&y.wires.length||0,set:le.getNodeSet("node-red/unknown")}:(F._def={category:"config",set:le.getNodeSet("node-red/unknown")},F.users=[],delete F.x,delete F.y,delete F.wires,delete F.inputLabels,delete F.outputLabels,y.z||delete F.z);var q,W={};for(q in y)y.hasOwnProperty(q)&&"x"!=q&&"y"!=q&&"z"!=q&&"id"!=q&&"wires"!=q&&(W[q]=y[q]);F._orig=W,F.name=y.type,F.type="unknown"}if("config"!=F._def.category){for(C in y.hasOwnProperty("inputs")?(F.inputs=y.inputs,F._config.inputs=JSON.stringify(y.inputs)):F.inputs=F._def.inputs,y.hasOwnProperty("outputs")?(F.outputs=y.outputs,F._config.outputs=JSON.stringify(y.outputs)):F.outputs=F._def.outputs,F.hasOwnProperty("wires")&&F.wires.length>F.outputs&&(F._def.defaults.hasOwnProperty("outputs")&&isNaN(parseInt(y.outputs))?F.outputs=F.wires.length:(console.log("Warning: node.wires longer than node.outputs - trimming wires:",F.id," wires:",F.wires.length," outputs:",F.outputs),F.wires=F.wires.slice(0,F.outputs))),F._def.defaults)F._def.defaults.hasOwnProperty(C)&&"inputs"!==C&&"outputs"!==C&&(F[C]=y[C],F._config[C]=JSON.stringify(y[C]));if(F._config.x=F.x,F._config.y=F.y,F._def.hasOwnProperty("credentials")&&y.hasOwnProperty("credentials"))for(C in F.credentials={},F._def.credentials)F._def.credentials.hasOwnProperty(C)&&y.credentials.hasOwnProperty(C)&&(F.credentials[C]=y.credentials[C])}}"unknown"===(I[y.id]=F).type||"config"!==F._def.category?N.push(F):"group"===F.type&&(A.push(F),B.add(F.id))}for(h=0;h<N.length;h++){if((y=N[h]).wires){for(var K=0;K<y.wires.length;K++)for(var X,Y=y.wires[K]instanceof Array?y.wires[K]:[y.wires[K]],Q=0;Q<Y.length;Q++)I.hasOwnProperty(Y[Q].id)&&Y[Q].port<I[Y[Q].id].inputs?y.z===I[Y[Q].id].z?(fe(X={source:y,sourcePort:K,target:I[Y[Q].id],targetPort:Y[Q].port}),P.push(X)):console.log("Warning: dropping link that crosses tabs:",y.id,"->",I[Y[Q]].id):I.hasOwnProperty(Y[Q])&&(y.z===I[Y[Q]].z?(fe(X={source:y,sourcePort:K,target:I[Y[Q]],targetPort:0}),P.push(X)):console.log("Warning: dropping link that crosses tabs:",y.id,"->",I[Y[Q]].id));delete y.wires}for(var Z in y.g&&I[y.g]?y.g=I[y.g].id:delete y.g,y._def.defaults)y._def.defaults.hasOwnProperty(Z)&&y._def.defaults[Z].type&&(u=y[Z],u=(u=!Array.isArray(u)?[u]:u).map(function(e){var t=I[e];return t?("config"===t._def.category&&-1===t.users.indexOf(y)&&t.users.push(y),t.id):e}),y[Z]=Array.isArray(y[Z])?u:u[0]);E&&/^link /.test(y.type)&&y.links&&(y.links=y.links.filter(function(e){e=RED.nodes.node(e);return e&&e.z===w}))}for(h=0;h<S.length;h++)(y=S[h]).in.forEach(function(o){o.wires.forEach(function(e,t){e={source:o,sourcePort:t,target:I[e.id],targetPort:e.port};fe(e),P.push(e)}),delete o.wires}),y.out.forEach(function(t){t.wires.forEach(function(e){e=M[e.id]&&M[e.id].id==y.id?{source:y.in[e.port],sourcePort:e.port,target:t}:{source:I[e.id]||M[e.id],sourcePort:e.port,target:t};fe(e),P.push(e)}),delete t.wires}),y.status&&(y.status.wires.forEach(function(e){e=M[e.id]&&M[e.id].id==y.id?{source:y.in[e.port],sourcePort:e.port,target:y.status}:{source:I[e.id]||M[e.id],sourcePort:e.port,target:y.status};fe(e),P.push(e)}),delete y.status.wires);var ee,te,oe={};for(h=0;h<A.length;h++)(y=A[h]).g&&!B.has(y.g)&&delete y.g,y.nodes=y.nodes.map(function(e){return I[e]}),y.nodes=y.nodes.filter(function(e){return e&&e.g!==y.id&&(e.g=y.id),!!e}),y.g||(oe[y.id]=0);do{for(ee=!1,h=0;h<A.length;h++)(y=A[h]).g&&oe[y.id]!==oe[y.g]+1&&(oe[y.id]=oe[y.g]+1,ee=!0)}while(ee);for(A.sort(function(e,t){return oe[e.id]-oe[t.id]}),h=0;h<A.length;h++)Ee(y=A[h]);for(h=0;h<N.length;h++)ue(F=N[h]);for(h=0;h<N.length;h++){F=N[h];RED.editor.validateNode(F)}return RED.workspaces.refresh(),t&&(te=RED.notify(RED._("clipboard.recoveredNodesNotification",{flowName:RED._("clipboard.recoveredNodes")}),{type:"warning",fixed:!0,buttons:[{text:RED._("common.label.close"),click:function(){te.close()}}]})),{nodes:N,links:P,groups:A,workspaces:L,subflows:S,missingWorkspace:V,removedNodes:s}}function r(e){for(var t in e._def.defaults){var o;!e._def.defaults.hasOwnProperty(t)||(o=e._def.defaults[t]).type&&(!(o=le.getNodeType(o.type))||"config"!=o.category||(t=ae[e[t]])&&-1===t.users.indexOf(e)&&(t.users.push(e),RED.events.emit("nodes:change",t)))}}function Ee(e){p[e.z]=p[e.z]||[],p[e.z].push(e),de[e.id]=e,RED.events.emit("groups:add",e)}function E(e){var t=p[e.z].indexOf(e);p[e.z].splice(t,1),0===p[e.z].length&&delete p[e.z],e.g&&de[e.g]&&(t=de[e.g].nodes.indexOf(e),de[e.g].nodes.splice(t,1)),RED.group.markDirty(e),delete de[e.id],RED.events.emit("groups:remove",e)}return{init:function(){RED.events.on("registry:node-type-added",function(t){le.getNodeType(t);var o={};RED.nodes.eachNode(function(e){"unknown"===e.type&&e.name===t&&(o[e.id]=e)}),RED.nodes.eachConfig(function(e){"unknown"===e.type&&e.name===t&&(o[e.id]=e)});var i,n,a,e=Object.keys(o);0<e.length&&(i=[],e.forEach(function(e){e=o[e];ae.hasOwnProperty(e.id)?delete ae[e.id]:ce.removeNode(e),i.push(b(e)),RED.events.emit("nodes:remove",e)}),n=[],RED.nodes.eachLink(function(e){o.hasOwnProperty(e.source.id)&&o.hasOwnProperty(e.target.id)&&n.push(e)}),n.forEach(v),RED.view.redraw(!0,!0),e=w(i,{generateIds:!1}),a={},e.nodes.forEach(function(e){a[e.id]=e}),RED.nodes.eachLink(function(e){a.hasOwnProperty(e.source.id)&&(e.source=a[e.source.id]),a.hasOwnProperty(e.target.id)&&(e.target=a[e.target.id])}),RED.view.redraw(!0))})},registry:le,setNodeList:le.setNodeList,getNodeSet:le.getNodeSet,addNodeSet:le.addNodeSet,removeNodeSet:le.removeNodeSet,enableNodeSet:le.enableNodeSet,disableNodeSet:le.disableNodeSet,setIconSets:le.setIconSets,getIconSets:le.getIconSets,registerType:le.registerNodeType,getType:le.getNodeType,getNodeHelp:function(e){var t="";return(e=$("script[data-help-name='"+e+"']"))&&(t=e.html(),"text/markdown"===e.attr("type")&&(t=RED.utils.renderMarkdown(t))),t},convertNode:b,add:ue,remove:h,clear:function(){g=[],l={},c={},ae={},d=[],de={},p={},Object.keys(se).forEach(function(e){RED.subflow.removeSubflow(e)}),Object.keys(re).forEach(function(e){RED.workspaces.remove(re[e])}),ne=ie=null,re={},ce.clear(),RED.nodes.dirty(!1),RED.view.redraw(!0,!0),RED.palette.refresh(),RED.workspaces.refresh(),RED.sidebar.config.refresh(),RED.sidebar.info.refresh(),RED.events.emit("workspace:clear")},detachNodes:function(e){let o=[];if(e.forEach(e=>{var t;"group"===e.type?(t=RED.group.getNodes(e,!0,!0),o=o.concat(t)):o.push(e)}),0<o.length){const i=RED.nodes.getNodeIslands(o);let t=[],d=[],l=new Set;return i.forEach(e=>{let s=new Set(e),o=[],i=[];e.forEach(e=>{var t=RED.nodes.getNodeLinks(e,1),e=RED.nodes.getNodeLinks(e,0);t.forEach(e=>{s.has(e.source)||o.push(e)}),e.forEach(e=>{s.has(e.target)||i.push(e)})}),o.forEach(o=>{let i=o.source,t=new Set,n=new Set,a=[o.target];for(;0<a.length;){var r=a.pop(a);n.add(r);let e=RED.nodes.getNodeLinks(r,0);e.forEach(e=>{n.has(e.target)||(n.add(e.target),s.has(e.target)?a.push(e.target):t.add(e.target))})}t.forEach(e=>{var t=`${i.id}[${o.sourcePort}] -> `+e.id;l.has(t)||(l.add(t),e={source:i,sourcePort:o.sourcePort,target:e},0===RED.nodes.filterLinks(e).length&&d.push(e))})}),o.forEach(e=>{RED.nodes.removeLink(e),t.push(e)}),i.forEach(e=>{RED.nodes.removeLink(e),t.push(e)})}),d.forEach(e=>RED.nodes.addLink(e)),{newLinks:d,removedLinks:t}}},moveNodesForwards:function(e){return ce.moveNodesForwards(e)},moveNodesBackwards:function(e){return ce.moveNodesBackwards(e)},moveNodesToFront:function(e){return ce.moveNodesToFront(e)},moveNodesToBack:function(e){return ce.moveNodesToBack(e)},getNodeOrder:function(e){return ce.getNodeOrder(e)},setNodeOrder:function(e,t){ce.setNodeOrder(e,t)},moveNodeToTab:function(e,o){if("group"===e.type)return t=o,i=p[(a=e).z].indexOf(a),p[a.z].splice(i,1),p[t]=p[t]||[],p[t].push(a),a.z=t,void RED.events.emit("groups:change",a);var t,i,n=e.z;ce.moveNode(e,o);var a=c[e.id];a&&(a.in.forEach(function(e){var t=l[n].indexOf(e);-1!=t&&l[n].splice(t,1),e.source.z===o&&l[o]&&l[o].push(e)}),a.out.forEach(function(e){var t=l[n].indexOf(e);-1!=t&&l[n].splice(t,1),e.target.z===o&&l[o]&&l[o].push(e)})),RED.events.emit("nodes:change",e)},addLink:fe,removeLink:v,getNodeLinks:function(e,t){return"string"!=typeof e&&(e=e.id),c[e]?[].concat(1===t?c[e].in:c[e].out):[]},addWorkspace:he,removeWorkspace:function(e){var t,o,i=re[e],n=[],a=[],r=[];if(i){for(t in delete re[e],delete l[e],d.splice(d.indexOf(e),1),ce.hasTab(e)&&(n=ce.getNodes(e).slice()),ae)ae.hasOwnProperty(t)&&(o=ae[t]).z==e&&n.push(o);for(t=0;t<n.length;t++)var s=h(n[t].id),a=a.concat(s.links);for(r=(p[e]||[]).filter(function(e){return!e.g}),t=0;t<r.length;t++)r[t].nodes.forEach(function(e){"group"===e.type&&r.push(e)});for(t=r.length-1;0<=t;t--)E(r[t]);ce.removeTab(e),RED.events.emit("flows:remove",i)}return{nodes:n,links:a,groups:r}},getWorkspaceOrder:function(){return d},setWorkspaceOrder:function(e){d=e},workspace:function(e){return re[e]},addSubflow:ge,removeSubflow:function(e){se[e.id]&&(delete se[e.id],ce.removeTab(e.id),le.removeNodeType("subflow:"+e.id),RED.events.emit("subflows:remove",e))},subflow:ve,subflowContains:me,addGroup:Ee,removeGroup:E,group:function(e){return de[e]},groups:function(e){return p[e]?p[e].slice():[]},eachNode:function(e){ce.eachNode(e)},eachLink:function(e){for(var t=0;t<g.length&&!1!==e(g[t]);t++);},eachConfig:function(e){for(var t in ae)if(ae.hasOwnProperty(t)&&!1===e(ae[t]))break},eachSubflow:function(e){for(var t in se)if(se.hasOwnProperty(t)&&!1===e(se[t]))break},eachWorkspace:function(e){for(var t=0;t<d.length&&!1!==e(re[d[t]]);t++);},node:f,version:function(e){if(void 0===e)return t;t=e},originalFlow:function(e){if(void 0===e)return ne;ne=e},filterNodes:function(e){return ce.filterNodes(e)},filterLinks:function(e){var t,o=[],i=[],n=!1,a=e.source&&e.source.z,r=e.target&&e.target.z;(t=a||r?a!==r&&void 0===a?r:a:t)?(i=l[t]||[],n=!0):e.source&&e.source.hasOwnProperty("id")?c[e.source.id]&&(n=!0,i=i.concat(c[e.source.id].out)):e.target&&e.target.hasOwnProperty("id")&&c[e.target.id]&&(n=!0,i=i.concat(c[e.target.id].in)),n||(i=g);for(var s=0;s<i.length;s++){var d=i[s];if(e.source){if(e.source.hasOwnProperty("id")&&d.source.id!==e.source.id)continue;if(e.source.hasOwnProperty("z")&&d.source.z!==e.source.z)continue}if(e.target){if(e.target.hasOwnProperty("id")&&d.target.id!==e.target.id)continue;if(e.target.hasOwnProperty("z")&&d.target.z!==e.target.z)continue}e.hasOwnProperty("sourcePort")&&d.sourcePort!==e.sourcePort||e.hasOwnProperty("targetPort")&&d.targetPort!==e.targetPort||o.push(d)}return o},import:w,identifyImportConflicts:ye,getAllFlowNodes:e,getAllUpstreamNodes:function(t){return e(t,"up").filter(function(e){return e!==t})},getAllDownstreamNodes:function(t){return e(t,"down").filter(function(e){return e!==t})},getNodeIslands:function(e){var o=new Set(e),n=new Map,a=new Map,i=new Set;e.forEach((e,t)=>{n.set(e,t),a.set(t,[e]);t=RED.nodes.getNodeLinks(e,1),e=RED.nodes.getNodeLinks(e,0);t.forEach(e=>{o.has(e.source)&&i.add(e)}),e.forEach(e=>{o.has(e.target)&&i.add(e)})}),i.forEach(o=>{var i=o.source,o=o.target;if(n.get(i)!==n.get(o)){let t=n.get(i);o=n.get(o);let e=a.get(o);e.forEach(e=>{n.set(e,t),a.get(t).push(e)}),a.delete(o)}});const r=[];return a.forEach((e,t)=>{r.push(e)}),r},createExportableNodeSet:be,createCompleteNodeSet:function(t){for(var o=[],e=0;e<d.length;e++)"tab"==re[d[e]].type&&o.push(m(re[d[e]],t));for(e in se)se.hasOwnProperty(e)&&o.push(y(se[e],t));for(e in de)de.hasOwnProperty(e)&&o.push(b(de[e],t));for(e in ae)ae.hasOwnProperty(e)&&o.push(b(ae[e],t));return RED.nodes.eachNode(function(e){o.push(b(e,t))}),o},updateConfigNodeUsers:r,id:pe,dirty:function(e){if(null==e)return o;o=e,RED.events.emit("workspace:dirty",{dirty:o})}}}(),RED.nodes.fontAwesome=function(){var t={"fa-address-book-o":"","fa-address-book":"","fa-address-card-o":"","fa-address-card":"","fa-adjust":"","fa-align-center":"","fa-align-justify":"","fa-align-left":"","fa-align-right":"","fa-ambulance":"","fa-american-sign-language-interpreting":"","fa-anchor":"","fa-angle-double-down":"","fa-angle-double-left":"","fa-angle-double-right":"","fa-angle-double-up":"","fa-angle-down":"","fa-angle-left":"","fa-angle-right":"","fa-angle-up":"","fa-archive":"","fa-area-chart":"","fa-arrow-circle-down":"","fa-arrow-circle-left":"","fa-arrow-circle-o-down":"","fa-arrow-circle-o-left":"","fa-arrow-circle-o-right":"","fa-arrow-circle-o-up":"","fa-arrow-circle-right":"","fa-arrow-circle-up":"","fa-arrow-down":"","fa-arrow-left":"","fa-arrow-right":"","fa-arrow-up":"","fa-arrows-alt":"","fa-arrows-h":"","fa-arrows-v":"","fa-arrows":"","fa-asl-interpreting":"","fa-assistive-listening-systems":"","fa-asterisk":"","fa-at":"","fa-audio-description":"","fa-automobile":"","fa-backward":"","fa-balance-scale":"","fa-ban":"","fa-bank":"","fa-bar-chart-o":"","fa-bar-chart":"","fa-barcode":"","fa-bars":"","fa-bath":"","fa-bathtub":"","fa-battery-0":"","fa-battery-1":"","fa-battery-2":"","fa-battery-3":"","fa-battery-4":"","fa-battery-empty":"","fa-battery-full":"","fa-battery-half":"","fa-battery-quarter":"","fa-battery-three-quarters":"","fa-battery":"","fa-bed":"","fa-beer":"","fa-bell-o":"","fa-bell-slash-o":"","fa-bell-slash":"","fa-bell":"","fa-bicycle":"","fa-binoculars":"","fa-birthday-cake":"","fa-blind":"","fa-bold":"","fa-bolt":"","fa-bomb":"","fa-book":"","fa-bookmark-o":"","fa-bookmark":"","fa-braille":"","fa-briefcase":"","fa-bug":"","fa-building-o":"","fa-building":"","fa-bullhorn":"","fa-bullseye":"","fa-bus":"","fa-cab":"","fa-calculator":"","fa-calendar-check-o":"","fa-calendar-minus-o":"","fa-calendar-o":"","fa-calendar-plus-o":"","fa-calendar-times-o":"","fa-calendar":"","fa-camera-retro":"","fa-camera":"","fa-car":"","fa-caret-down":"","fa-caret-left":"","fa-caret-right":"","fa-caret-square-o-down":"","fa-caret-square-o-left":"","fa-caret-square-o-right":"","fa-caret-square-o-up":"","fa-caret-up":"","fa-cart-arrow-down":"","fa-cart-plus":"","fa-cc":"","fa-certificate":"","fa-chain-broken":"","fa-chain":"","fa-check-circle-o":"","fa-check-circle":"","fa-check-square-o":"","fa-check-square":"","fa-check":"","fa-chevron-circle-down":"","fa-chevron-circle-left":"","fa-chevron-circle-right":"","fa-chevron-circle-up":"","fa-chevron-down":"","fa-chevron-left":"","fa-chevron-right":"","fa-chevron-up":"","fa-child":"","fa-circle-o-notch":"","fa-circle-o":"","fa-circle-thin":"","fa-circle":"","fa-clipboard":"","fa-clock-o":"","fa-clone":"","fa-close":"","fa-cloud-download":"","fa-cloud-upload":"","fa-cloud":"","fa-cny":"","fa-code-fork":"","fa-code":"","fa-coffee":"","fa-cog":"","fa-cogs":"","fa-columns":"","fa-comment-o":"","fa-comment":"","fa-commenting-o":"","fa-commenting":"","fa-comments-o":"","fa-comments":"","fa-compass":"","fa-compress":"","fa-copy":"","fa-copyright":"","fa-creative-commons":"","fa-credit-card-alt":"","fa-credit-card":"","fa-crop":"","fa-crosshairs":"","fa-cube":"","fa-cubes":"","fa-cut":"","fa-cutlery":"","fa-dashboard":"","fa-database":"","fa-deaf":"","fa-deafness":"","fa-dedent":"","fa-desktop":"","fa-diamond":"","fa-dollar":"","fa-dot-circle-o":"","fa-download":"","fa-drivers-license-o":"","fa-drivers-license":"","fa-edit":"","fa-eject":"","fa-ellipsis-h":"","fa-ellipsis-v":"","fa-envelope-o":"","fa-envelope-open-o":"","fa-envelope-open":"","fa-envelope-square":"","fa-envelope":"","fa-eraser":"","fa-eur":"","fa-euro":"","fa-exchange":"","fa-exclamation-circle":"","fa-exclamation-triangle":"","fa-exclamation":"","fa-expand":"","fa-external-link-square":"","fa-external-link":"","fa-eye-slash":"","fa-eye":"","fa-eyedropper":"","fa-fast-backward":"","fa-fast-forward":"","fa-fax":"","fa-feed":"","fa-female":"","fa-fighter-jet":"","fa-file-archive-o":"","fa-file-audio-o":"","fa-file-code-o":"","fa-file-excel-o":"","fa-file-image-o":"","fa-file-movie-o":"","fa-file-o":"","fa-file-pdf-o":"","fa-file-photo-o":"","fa-file-picture-o":"","fa-file-powerpoint-o":"","fa-file-sound-o":"","fa-file-text-o":"","fa-file-text":"","fa-file-video-o":"","fa-file-word-o":"","fa-file-zip-o":"","fa-file":"","fa-files-o":"","fa-film":"","fa-filter":"","fa-fire-extinguisher":"","fa-fire":"","fa-flag-checkered":"","fa-flag-o":"","fa-flag":"","fa-flash":"","fa-flask":"","fa-floppy-o":"","fa-folder-o":"","fa-folder-open-o":"","fa-folder-open":"","fa-folder":"","fa-font":"","fa-forward":"","fa-frown-o":"","fa-futbol-o":"","fa-gamepad":"","fa-gavel":"","fa-gbp":"","fa-gear":"","fa-gears":"","fa-genderless":"","fa-gift":"","fa-glass":"","fa-globe":"","fa-graduation-cap":"","fa-group":"","fa-h-square":"","fa-hand-grab-o":"","fa-hand-lizard-o":"","fa-hand-o-down":"","fa-hand-o-left":"","fa-hand-o-right":"","fa-hand-o-up":"","fa-hand-paper-o":"","fa-hand-peace-o":"","fa-hand-pointer-o":"","fa-hand-rock-o":"","fa-hand-scissors-o":"","fa-hand-spock-o":"","fa-hand-stop-o":"","fa-handshake-o":"","fa-hard-of-hearing":"","fa-hashtag":"","fa-hdd-o":"","fa-header":"","fa-headphones":"","fa-heart-o":"","fa-heart":"","fa-heartbeat":"","fa-history":"","fa-home":"","fa-hospital-o":"","fa-hotel":"","fa-hourglass-1":"","fa-hourglass-2":"","fa-hourglass-3":"","fa-hourglass-end":"","fa-hourglass-half":"","fa-hourglass-o":"","fa-hourglass-start":"","fa-hourglass":"","fa-i-cursor":"","fa-id-badge":"","fa-id-card-o":"","fa-id-card":"","fa-ils":"","fa-image":"","fa-inbox":"","fa-indent":"","fa-industry":"","fa-info-circle":"","fa-info":"","fa-inr":"","fa-institution":"","fa-intersex":"","fa-italic":"","fa-jpy":"","fa-key":"","fa-keyboard-o":"","fa-krw":"","fa-language":"","fa-laptop":"","fa-leaf":"","fa-legal":"","fa-lemon-o":"","fa-level-down":"","fa-level-up":"","fa-life-bouy":"","fa-life-buoy":"","fa-life-ring":"","fa-life-saver":"","fa-lightbulb-o":"","fa-line-chart":"","fa-link":"","fa-list-alt":"","fa-list-ol":"","fa-list-ul":"","fa-list":"","fa-location-arrow":"","fa-lock":"","fa-long-arrow-down":"","fa-long-arrow-left":"","fa-long-arrow-right":"","fa-long-arrow-up":"","fa-low-vision":"","fa-magic":"","fa-magnet":"","fa-mail-forward":"","fa-mail-reply-all":"","fa-mail-reply":"","fa-male":"","fa-map-marker":"","fa-map-o":"","fa-map-pin":"","fa-map-signs":"","fa-map":"","fa-mars-double":"","fa-mars-stroke-h":"","fa-mars-stroke-v":"","fa-mars-stroke":"","fa-mars":"","fa-medkit":"","fa-meh-o":"","fa-mercury":"","fa-microchip":"","fa-microphone-slash":"","fa-microphone":"","fa-minus-circle":"","fa-minus-square-o":"","fa-minus-square":"","fa-minus":"","fa-mobile-phone":"","fa-mobile":"","fa-money":"","fa-moon-o":"","fa-mortar-board":"","fa-motorcycle":"","fa-mouse-pointer":"","fa-music":"","fa-navicon":"","fa-neuter":"","fa-newspaper-o":"","fa-object-group":"","fa-object-ungroup":"","fa-outdent":"","fa-paint-brush":"","fa-paper-plane-o":"","fa-paper-plane":"","fa-paperclip":"","fa-paragraph":"","fa-paste":"","fa-pause-circle-o":"","fa-pause-circle":"","fa-pause":"","fa-paw":"","fa-pencil-square-o":"","fa-pencil-square":"","fa-pencil":"","fa-percent":"","fa-phone-square":"","fa-phone":"","fa-photo":"","fa-picture-o":"","fa-pie-chart":"","fa-plane":"","fa-play-circle-o":"","fa-play-circle":"","fa-play":"","fa-plug":"","fa-plus-circle":"","fa-plus-square-o":"","fa-plus-square":"","fa-plus":"","fa-podcast":"","fa-power-off":"","fa-print":"","fa-puzzle-piece":"","fa-qrcode":"","fa-question-circle-o":"","fa-question-circle":"","fa-question":"","fa-quote-left":"","fa-quote-right":"","fa-random":"","fa-recycle":"","fa-refresh":"","fa-registered":"","fa-remove":"","fa-reorder":"","fa-repeat":"","fa-reply-all":"","fa-reply":"","fa-retweet":"","fa-rmb":"","fa-road":"","fa-rocket":"","fa-rotate-left":"","fa-rotate-right":"","fa-rouble":"","fa-rss-square":"","fa-rss":"","fa-rub":"","fa-ruble":"","fa-rupee":"","fa-s15":"","fa-save":"","fa-scissors":"","fa-search-minus":"","fa-search-plus":"","fa-search":"","fa-send-o":"","fa-send":"","fa-server":"","fa-share-square-o":"","fa-share-square":"","fa-share":"","fa-shekel":"","fa-sheqel":"","fa-shield":"","fa-ship":"","fa-shopping-bag":"","fa-shopping-basket":"","fa-shopping-cart":"","fa-shower":"","fa-sign-in":"","fa-sign-language":"","fa-sign-out":"","fa-signal":"","fa-signing":"","fa-sitemap":"","fa-sliders":"","fa-smile-o":"","fa-snowflake-o":"","fa-soccer-ball-o":"","fa-sort-alpha-asc":"","fa-sort-alpha-desc":"","fa-sort-amount-asc":"","fa-sort-amount-desc":"","fa-sort-asc":"","fa-sort-desc":"","fa-sort-down":"","fa-sort-numeric-asc":"","fa-sort-numeric-desc":"","fa-sort-up":"","fa-sort":"","fa-space-shuttle":"","fa-spinner":"","fa-spoon":"","fa-square-o":"","fa-square":"","fa-star-half-empty":"","fa-star-half-full":"","fa-star-half-o":"","fa-star-half":"","fa-star-o":"","fa-star":"","fa-step-backward":"","fa-step-forward":"","fa-stethoscope":"","fa-sticky-note-o":"","fa-sticky-note":"","fa-stop-circle-o":"","fa-stop-circle":"","fa-stop":"","fa-street-view":"","fa-strikethrough":"","fa-subscript":"","fa-subway":"","fa-suitcase":"","fa-sun-o":"","fa-superscript":"","fa-support":"","fa-table":"","fa-tablet":"","fa-tachometer":"","fa-tag":"","fa-tags":"","fa-tasks":"","fa-taxi":"","fa-television":"","fa-terminal":"","fa-text-height":"","fa-text-width":"","fa-th-large":"","fa-th-list":"","fa-th":"","fa-thermometer-0":"","fa-thermometer-1":"","fa-thermometer-2":"","fa-thermometer-3":"","fa-thermometer-4":"","fa-thermometer-empty":"","fa-thermometer-full":"","fa-thermometer-half":"","fa-thermometer-quarter":"","fa-thermometer-three-quarters":"","fa-thermometer":"","fa-thumb-tack":"","fa-thumbs-down":"","fa-thumbs-o-down":"","fa-thumbs-o-up":"","fa-thumbs-up":"","fa-ticket":"","fa-times-circle-o":"","fa-times-circle":"","fa-times-rectangle-o":"","fa-times-rectangle":"","fa-times":"","fa-tint":"","fa-toggle-down":"","fa-toggle-left":"","fa-toggle-off":"","fa-toggle-on":"","fa-toggle-right":"","fa-toggle-up":"","fa-trademark":"","fa-train":"","fa-transgender-alt":"","fa-transgender":"","fa-trash-o":"","fa-trash":"","fa-tree":"","fa-trophy":"","fa-truck":"","fa-try":"","fa-tty":"","fa-turkish-lira":"","fa-tv":"","fa-umbrella":"","fa-underline":"","fa-undo":"","fa-universal-access":"","fa-university":"","fa-unlink":"","fa-unlock-alt":"","fa-unlock":"","fa-unsorted":"","fa-upload":"","fa-usd":"","fa-user-circle-o":"","fa-user-circle":"","fa-user-md":"","fa-user-o":"","fa-user-plus":"","fa-user-secret":"","fa-user-times":"","fa-user":"","fa-users":"","fa-vcard-o":"","fa-vcard":"","fa-venus-double":"","fa-venus-mars":"","fa-venus":"","fa-video-camera":"","fa-volume-control-phone":"","fa-volume-down":"","fa-volume-off":"","fa-volume-up":"","fa-warning":"","fa-wheelchair-alt":"","fa-wheelchair":"","fa-wifi":"","fa-window-close-o":"","fa-window-close":"","fa-window-maximize":"","fa-window-minimize":"","fa-window-restore":"","fa-won":"","fa-wrench":"","fa-yen":""},o={"fa-500px":"","fa-adn":"","fa-amazon":"","fa-android":"","fa-angellist":"","fa-apple":"","fa-bandcamp":"","fa-behance-square":"","fa-behance":"","fa-bitbucket-square":"","fa-bitbucket":"","fa-bitcoin":"","fa-black-tie":"","fa-bluetooth-b":"","fa-bluetooth":"","fa-btc":"","fa-buysellads":"","fa-cc-amex":"","fa-cc-diners-club":"","fa-cc-discover":"","fa-cc-jcb":"","fa-cc-mastercard":"","fa-cc-paypal":"","fa-cc-stripe":"","fa-cc-visa":"","fa-chrome":"","fa-codepen":"","fa-codiepie":"","fa-connectdevelop":"","fa-contao":"","fa-css3":"","fa-dashcube":"","fa-delicious":"","fa-deviantart":"","fa-digg":"","fa-dribbble":"","fa-dropbox":"","fa-drupal":"","fa-edge":"","fa-eercast":"","fa-empire":"","fa-envira":"","fa-etsy":"","fa-expeditedssl":"","fa-fa":"","fa-facebook-f":"","fa-facebook-official":"","fa-facebook-square":"","fa-facebook":"","fa-firefox":"","fa-first-order":"","fa-flickr":"","fa-font-awesome":"","fa-fonticons":"","fa-fort-awesome":"","fa-forumbee":"","fa-foursquare":"","fa-free-code-camp":"","fa-ge":"","fa-get-pocket":"","fa-gg-circle":"","fa-gg":"","fa-git-square":"","fa-git":"","fa-github-alt":"","fa-github-square":"","fa-github":"","fa-gitlab":"","fa-gittip":"","fa-glide-g":"","fa-glide":"","fa-google-plus-circle":"","fa-google-plus-official":"","fa-google-plus-square":"","fa-google-plus":"","fa-google-wallet":"","fa-google":"","fa-gratipay":"","fa-grav":"","fa-hacker-news":"","fa-houzz":"","fa-html5":"","fa-imdb":"","fa-instagram":"","fa-internet-explorer":"","fa-ioxhost":"","fa-joomla":"","fa-jsfiddle":"","fa-lastfm-square":"","fa-lastfm":"","fa-leanpub":"","fa-linkedin-square":"","fa-linkedin":"","fa-linode":"","fa-linux":"","fa-maxcdn":"","fa-meanpath":"","fa-medium":"","fa-meetup":"","fa-mixcloud":"","fa-modx":"","fa-odnoklassniki-square":"","fa-odnoklassniki":"","fa-opencart":"","fa-openid":"","fa-opera":"","fa-optin-monster":"","fa-pagelines":"","fa-paypal":"","fa-pied-piper-alt":"","fa-pied-piper-pp":"","fa-pied-piper":"","fa-pinterest-p":"","fa-pinterest-square":"","fa-pinterest":"","fa-product-hunt":"","fa-qq":"","fa-quora":"","fa-ra":"","fa-ravelry":"","fa-rebel":"","fa-reddit-alien":"","fa-reddit-square":"","fa-reddit":"","fa-renren":"","fa-resistance":"","fa-safari":"","fa-scribd":"","fa-sellsy":"","fa-share-alt-square":"","fa-share-alt":"","fa-shirtsinbulk":"","fa-simplybuilt":"","fa-skyatlas":"","fa-skype":"","fa-slack":"","fa-slideshare":"","fa-snapchat-ghost":"","fa-snapchat-square":"","fa-snapchat":"","fa-soundcloud":"","fa-spotify":"","fa-stack-exchange":"","fa-stack-overflow":"","fa-steam-square":"","fa-steam":"","fa-stumbleupon-circle":"","fa-stumbleupon":"","fa-superpowers":"","fa-telegram":"","fa-tencent-weibo":"","fa-themeisle":"","fa-trello":"","fa-tripadvisor":"","fa-tumblr-square":"","fa-tumblr":"","fa-twitch":"","fa-twitter-square":"","fa-twitter":"","fa-usb":"","fa-viacoin":"","fa-viadeo-square":"","fa-viadeo":"","fa-vimeo-square":"","fa-vimeo":"","fa-vine":"","fa-vk":"","fa-wechat":"","fa-weibo":"","fa-weixin":"","fa-whatsapp":"","fa-wikipedia-w":"","fa-windows":"","fa-wordpress":"","fa-wpbeginner":"","fa-wpexplorer":"","fa-wpforms":"","fa-xing-square":"","fa-xing":"","fa-y-combinator-square":"","fa-y-combinator":"","fa-yahoo":"","fa-yc-square":"","fa-yc":"","fa-yelp":"","fa-yoast":"","fa-youtube-play":"","fa-youtube-square":"","fa-youtube":""},e=Object.keys(t);return{getIconUnicode:function(e){return t[e]||o[e]},getIconList:function(){return e}}}(),RED.nodes.homegearUiIcons=function(){var t={"air-quality_1":"<svg height='512pt' viewBox='0 0 512 512' width='512pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m201.886719 416.769531h-201.886719v-39.980469h59.964844v-67.960937h39.980468v67.960937h101.941407zm0-187.894531h-101.941407v-61.96875h-39.980468v61.96875h-59.964844v39.976562h201.886719zm236.011719 94.089844 74.101562-74.101563-74.101562-74.101562-28.269532 28.269531 25.84375 25.84375h-84.667968v-108.941406h84.667968l-25.84375 25.84375 28.269532 28.269531 74.101562-74.101563-74.101562-74.101562-28.269532 28.269531 25.84375 25.84375h-84.667968v-19.992187c0-33.0625-26.898438-59.964844-59.964844-59.964844h-170.90625c-33.066406 0-59.96875 26.902344-59.96875 59.964844v19.992187h-59.964844v39.976563h201.886719v-39.976563h-101.941407v-19.992187c0-11.019532 8.964844-19.988282 19.988282-19.988282h170.90625c11.019531 0 19.988281 8.96875 19.988281 19.988282v391.785156c0 11.019531-8.96875 19.988281-19.988281 19.988281h-170.90625c-11.023438 0-19.988282-8.96875-19.988282-19.988281h-39.980468c0 33.066406 26.902344 59.964844 59.96875 59.964844h170.90625c33.066406 0 59.964844-26.898438 59.964844-59.964844v-34.980469h85.667968l-26.84375 26.84375 28.269532 28.269531 74.101562-74.101562-74.101562-74.101562-28.269532 28.269531 24.847656 24.839843h-83.671874v-107.9375h84.667968l-25.84375 25.84375zm0 0'/></g></svg>",aircondition_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='254.893px' height='254.893px' viewBox='0 0 254.893 254.893' style='enable-background:new 0 0 254.893 254.893;' xml:space='preserve'> <g fill='%23fff'> <path d='M23.896,135.807h10.029c0,0,1.218-5.259,2.73-11.747c1.505-6.485,13.43-11.747,26.624-11.747h131.422 c13.198,0,24.633,5.262,25.543,11.747l1.643,11.747h9.11c13.194,0,23.896-10.701,23.896-23.895V67.309 c0-11.017-7.495-20.197-17.637-22.965c0.574,2.257,0.91,4.604,0.91,7.031v9.558c0,15.814-12.862,28.674-28.675,28.674H45.401 c-15.814,0-28.674-12.86-28.674-28.674v-9.558c0-2.427,0.333-4.774,0.908-7.031C7.493,47.111,0,56.292,0,67.309v44.603 C0,125.11,10.699,135.807,23.896,135.807z'/> <path d='M45.401,80.054h164.076c10.548,0,19.116-8.574,19.116-19.117V51.38c0-2.854-0.663-5.535-1.792-7.967H28.077 c-1.125,2.432-1.792,5.112-1.792,7.967v9.558C26.285,71.48,34.863,80.054,45.401,80.054z M35.918,51.876h180.41 c1.321,0,2.39,1.071,2.39,2.39s-1.068,2.39-2.39,2.39H35.918c-1.318,0-2.39-1.071-2.39-2.39S34.595,51.876,35.918,51.876z M35.918,66.812h180.41c1.321,0,2.39,1.071,2.39,2.389c0,1.319-1.068,2.39-2.39,2.39H35.918c-1.318,0-2.39-1.071-2.39-2.39 C33.528,67.882,34.595,66.812,35.918,66.812z'/> <path d='M212.818,127.047c-0.699-4.837-11.966-8.76-25.169-8.76H68.975c-13.193,0-24.611,3.922-25.487,8.76 c-0.879,4.84-1.591,8.76-1.591,8.76h172.191L212.818,127.047z'/> <path d='M57.879,210.312c0.903,0.784,2.016,1.167,3.125,1.167c1.339,0,2.672-0.561,3.615-1.647 c0.74-0.859,17.978-21.114,4.907-37.561c-7.25-9.129-1.893-14.432-0.726-15.421c2.025-1.651,2.354-4.63,0.721-6.683 c-1.645-2.063-4.651-2.404-6.716-0.761c-5.007,3.99-11.616,15.145-0.763,28.81c8.137,10.239-4.527,25.212-4.651,25.356 C55.671,205.562,55.886,208.581,57.879,210.312z'/> <path d='M99.696,210.312c0.903,0.784,2.016,1.167,3.125,1.167c1.34,0,2.672-0.561,3.615-1.647 c0.74-0.859,17.978-21.114,4.908-37.561c-7.25-9.129-1.893-14.432-0.726-15.421c2.026-1.651,2.355-4.63,0.721-6.683 c-1.645-2.063-4.65-2.404-6.716-0.761c-5.008,3.99-11.616,15.145-0.763,28.81c8.137,10.239-4.527,25.212-4.651,25.356 C97.488,205.562,97.703,208.581,99.696,210.312z'/> <path d='M141.516,210.312c0.9,0.784,2.016,1.167,3.122,1.167c1.339,0,2.674-0.561,3.617-1.647 c0.737-0.859,17.978-21.114,4.905-37.561c-7.248-9.129-1.891-14.432-0.724-15.421c2.025-1.651,2.352-4.63,0.719-6.683 c-1.644-2.063-4.648-2.404-6.716-0.761c-5.008,3.99-11.617,15.145-0.761,28.81c8.134,10.239-4.527,25.212-4.653,25.356 C139.303,205.562,139.518,208.581,141.516,210.312z'/> <path d='M183.332,210.312c0.901,0.784,2.017,1.167,3.123,1.167c1.339,0,2.674-0.561,3.616-1.647 c0.737-0.859,17.978-21.114,4.905-37.561c-7.248-9.129-1.89-14.432-0.724-15.421c2.026-1.651,2.353-4.63,0.719-6.683 c-1.643-2.063-4.648-2.404-6.716-0.761c-5.008,3.99-11.616,15.145-0.761,28.81c8.135,10.239-4.526,25.212-4.653,25.356 C181.12,205.562,181.335,208.581,183.332,210.312z'/> </g></svg>",arrow_down_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='370.81' height='370.81' viewBox='0 0 370.81 370.81'> <g fill='%23fff'> <path d='M24.85 77.9L0 102.03 185.4 292.92 370.81 102.03 345.96 77.9 185.4 243.18z'/> </g></svg>",arrow_down_filled_1:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0' y='0' width='200' height='100' viewBox='0, 0, 200, 100'> <g fill='%23fff'> <path d='M0,-0 L204,-0 L101.747,100.002' /> </g></svg>",arrow_down_step_1:"<svg version='1.1' id='svg' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='370.811px' height='370.809px' viewBox='0 0 370.811 370.809' enable-background='new 0 0 370.811 370.809' xml:space='preserve'><g fill='%23fff'> <path d='M24.84,55.905L0,80.045l185.4,190.88l185.41-190.88L345.96,55.905L185.4,221.185L24.84,55.905z'/> <rect x='0' y='276.925' stroke-miterlimit='10' width='370.811' height='40.995'/></g></svg>",arrow_down_step_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='439.363px' height='439.363px' viewBox='0 0 439.363 439.363' enable-background='new 0 0 439.363 439.363' xml:space='preserve'><g fill='%23fff'> <path d='M0.412,77.216c-1.143,2.471,0.094,5.518,3.709,9.139l202.707,202.699c1.524,1.719,3.333,2.955,5.424,3.715H18.679 c-4.952,0-9.234,1.809-12.85,5.424c-3.617,3.617-5.426,7.9-5.426,12.848v36.547c0,4.951,1.809,9.232,5.426,12.85 c3.619,3.617,7.901,5.426,12.85,5.426h401.987c4.947,0,9.236-1.808,12.846-5.424c3.621-3.621,5.43-7.902,5.43-12.851v-36.543 c0-4.947-1.809-9.229-5.43-12.847c-3.609-3.615-7.896-5.424-12.846-5.424H227.097c1.902-0.764,3.717-2,5.424-3.715L435.234,86.355 c3.617-3.621,4.859-6.668,3.721-9.139c-1.145-2.479-4.189-3.716-9.139-3.716H9.546C4.599,73.5,1.552,74.738,0.412,77.216z'/></g></svg>",arrow_fast_down_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='284.929px' height='284.929px' viewBox='0 0 284.929 284.929' style='enable-background:new 0 0 284.929 284.929;' xml:space='preserve'> <g fill='%23fff'> <path d='M135.899,167.877c1.902,1.902,4.093,2.851,6.567,2.851s4.661-0.948,6.562-2.851L282.082,34.829 c1.902-1.903,2.847-4.093,2.847-6.567s-0.951-4.665-2.847-6.567L267.808,7.417c-1.902-1.903-4.093-2.853-6.57-2.853 c-2.471,0-4.661,0.95-6.563,2.853L142.466,119.622L30.262,7.417c-1.903-1.903-4.093-2.853-6.567-2.853 c-2.475,0-4.665,0.95-6.567,2.853L2.856,21.695C0.95,23.597,0,25.784,0,28.262c0,2.478,0.953,4.665,2.856,6.567L135.899,167.877z' /> <path d='M267.808,117.053c-1.902-1.903-4.093-2.853-6.57-2.853c-2.471,0-4.661,0.95-6.563,2.853L142.466,229.257L30.262,117.05 c-1.903-1.903-4.093-2.853-6.567-2.853c-2.475,0-4.665,0.95-6.567,2.853L2.856,131.327C0.95,133.23,0,135.42,0,137.893 c0,2.474,0.953,4.665,2.856,6.57l133.043,133.046c1.902,1.903,4.093,2.854,6.567,2.854s4.661-0.951,6.562-2.854l133.054-133.046 c1.902-1.903,2.847-4.093,2.847-6.565c0-2.474-0.951-4.661-2.847-6.567L267.808,117.053z'/> </g></svg>",arrow_fast_left_3:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='284.929px' height='284.929px' viewBox='0 0 284.929 284.929' style='enable-background:new 0 0 284.929 284.929;' xml:space='preserve'> <g fill='%23fff'> <path d='M165.304,142.468L277.517,30.267c1.902-1.903,2.847-4.093,2.847-6.567c0-2.475-0.951-4.665-2.847-6.567L263.239,2.857 C261.337,0.955,259.146,0,256.676,0c-2.478,0-4.665,0.955-6.571,2.857L117.057,135.9c-1.903,1.903-2.853,4.093-2.853,6.567 c0,2.475,0.95,4.664,2.853,6.567l133.048,133.043c1.903,1.906,4.086,2.851,6.564,2.851c2.478,0,4.66-0.947,6.563-2.851 l14.277-14.267c1.902-1.903,2.851-4.094,2.851-6.57c0-2.472-0.948-4.661-2.851-6.564L165.304,142.468z'/> <path d='M55.668,142.468L167.87,30.267c1.903-1.903,2.851-4.093,2.851-6.567c0-2.475-0.947-4.665-2.851-6.567L153.6,2.857 C151.697,0.955,149.507,0,147.036,0c-2.478,0-4.668,0.955-6.57,2.857L7.417,135.9c-1.903,1.903-2.853,4.093-2.853,6.567 c0,2.475,0.95,4.664,2.853,6.567l133.048,133.043c1.902,1.906,4.09,2.851,6.57,2.851c2.471,0,4.661-0.947,6.563-2.851 l14.271-14.267c1.903-1.903,2.851-4.094,2.851-6.57c0-2.472-0.947-4.661-2.851-6.564L55.668,142.468z'/> </g></svg>",arrow_fast_right_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='284.936px' height='284.936px' viewBox='0 0 284.936 284.936' style='enable-background:new 0 0 284.936 284.936;' xml:space='preserve'> <g fill='%23fff'> <path d='M277.515,135.9L144.464,2.857C142.565,0.955,140.375,0,137.9,0c-2.472,0-4.659,0.955-6.562,2.857l-14.277,14.275 c-1.903,1.903-2.853,4.089-2.853,6.567c0,2.478,0.95,4.664,2.853,6.567l112.207,112.204L117.062,254.677 c-1.903,1.903-2.853,4.093-2.853,6.564c0,2.477,0.95,4.667,2.853,6.57l14.277,14.271c1.902,1.905,4.089,2.854,6.562,2.854 c2.478,0,4.665-0.951,6.563-2.854l133.051-133.044c1.902-1.902,2.851-4.093,2.851-6.567S279.417,137.807,277.515,135.9z'/> <path d='M170.732,142.471c0-2.474-0.947-4.665-2.857-6.571L34.833,2.857C32.931,0.955,30.741,0,28.267,0s-4.665,0.955-6.567,2.857 L7.426,17.133C5.52,19.036,4.57,21.222,4.57,23.7c0,2.478,0.95,4.664,2.856,6.567L119.63,142.471L7.426,254.677 c-1.906,1.903-2.856,4.093-2.856,6.564c0,2.477,0.95,4.667,2.856,6.57l14.273,14.271c1.903,1.905,4.093,2.854,6.567,2.854 s4.664-0.951,6.567-2.854l133.042-133.044C169.785,147.136,170.732,144.945,170.732,142.471z'/> </g></svg>",arrow_fast_up_4:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='284.929px' height='284.929px' viewBox='0 0 284.929 284.929' style='enable-background:new 0 0 284.929 284.929;' xml:space='preserve'> <g fill='%23fff'> <path d='M17.128,167.872c1.903,1.902,4.093,2.854,6.567,2.854c2.474,0,4.664-0.952,6.567-2.854L142.466,55.666l112.208,112.206 c1.902,1.902,4.093,2.854,6.563,2.854c2.478,0,4.668-0.952,6.57-2.854l14.274-14.277c1.902-1.902,2.847-4.093,2.847-6.563 c0-2.475-0.951-4.665-2.847-6.567L149.028,7.419c-1.901-1.906-4.088-2.853-6.562-2.853s-4.665,0.95-6.567,2.853L2.856,140.464 C0.95,142.367,0,144.554,0,147.034c0,2.468,0.953,4.658,2.856,6.561L17.128,167.872z'/> <path d='M149.028,117.055c-1.901-1.906-4.088-2.856-6.562-2.856s-4.665,0.953-6.567,2.856L2.856,250.1 C0.95,252.003,0,254.192,0,256.67c0,2.472,0.953,4.661,2.856,6.564l14.272,14.276c1.903,1.903,4.093,2.848,6.567,2.848 c2.474,0,4.664-0.951,6.567-2.848l112.204-112.209l112.208,112.209c1.902,1.903,4.093,2.852,6.563,2.852 c2.478,0,4.668-0.948,6.57-2.852l14.274-14.276c1.902-1.903,2.847-4.093,2.847-6.564c0-2.478-0.951-4.667-2.847-6.57 L149.028,117.055z'/> </g></svg>",arrow_left_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='370.81' height='370.81' viewBox='0 0 370.81 370.81' xml:space='preserve' enable-background='new 0 0 370.814 370.814'><g fill='%23fff'> <polygon points='292.92 24.85 268.78 0 77.9 185.4 268.78 370.81 292.92 345.96 127.64 185.4 '/></g></svg>",arrow_left_filled_1:"<svg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='25px' height='25px' viewBox='0 0 25 25' enable-background='new 0 0 25 25' xml:space='preserve'><g fill='%23fff'><polygon points='21.294,23.725 3.806,13.017 21.294,2.307 '/><rect x='3.707' y='2.109' width='1.588' height='21.615'/></g></svg>",arrow_left_step_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='439.362px' height='439.362px' viewBox='0 0 439.362 439.362' style='enable-background:new 0 0 439.362 439.362;' xml:space='preserve'><g fill='%23fff'> <path d='M362.146,0.412c-2.471-1.143-5.517,0.094-9.138,3.709L150.308,206.828c-1.718,1.524-2.955,3.333-3.715,5.424V18.679 c0-4.952-1.809-9.234-5.424-12.85c-3.617-3.617-7.9-5.426-12.847-5.426H91.775c-4.952,0-9.233,1.809-12.85,5.426 C75.308,9.448,73.5,13.73,73.5,18.679v401.986c0,4.948,1.807,9.236,5.424,12.847c3.621,3.62,7.902,5.428,12.85,5.428h36.543 c4.947,0,9.229-1.808,12.847-5.428c3.615-3.61,5.424-7.898,5.424-12.847V227.097c0.763,1.903,2,3.717,3.715,5.425l202.705,202.712 c3.621,3.617,6.667,4.859,9.138,3.72c2.478-1.144,3.716-4.189,3.716-9.138V9.547C365.862,4.599,364.624,1.553,362.146,0.412z'/></g></svg>",arrow_right_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='370.81' height='370.81' viewBox='0 0 370.81 370.81'> <g fill='%23fff'> <path d='M77.9 345.97L102.03 370.81 292.92 185.41 102.03 0 77.9 24.85 243.18 185.41z'/> </g></svg>",arrow_right_filled_1:"<svg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='25px' height='25px' viewBox='0 0 25 25' enable-background='new 0 0 25 25' xml:space='preserve'><g fill='%23fff'><polygon points='3.707,2.11 21.194,12.817 3.707,23.527 '/><rect x='19.706' y='2.109' width='1.588' height='21.615'/></g></svg>",arrow_right_step_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='439.357px' height='439.357px' viewBox='0 0 439.357 439.357' style='enable-background:new 0 0 439.357 439.357;' xml:space='preserve'><g fill='%23fff'> <path d='M360.427,5.833c-3.613-3.617-7.898-5.424-12.847-5.424h-36.545c-4.945,0-9.233,1.807-12.847,5.424 c-3.614,3.621-5.428,7.902-5.428,12.85v193.574c-0.948-2.091-2.19-3.901-3.717-5.424L86.343,4.125 c-3.617-3.617-6.663-4.856-9.136-3.713c-2.474,1.143-3.711,4.189-3.711,9.137v420.262c0,4.948,1.237,7.994,3.711,9.138 c2.473,1.14,5.519-0.1,9.136-3.724L289.048,232.52c1.529-1.711,2.765-3.521,3.72-5.424V420.66c0,4.948,1.81,9.239,5.421,12.847 c3.62,3.62,7.904,5.428,12.847,5.428h36.552c4.948,0,9.236-1.808,12.847-5.428c3.614-3.607,5.428-7.898,5.428-12.847V18.683 C365.854,13.73,364.037,9.45,360.427,5.833z'/></g></svg>",arrow_up_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='370.81' height='370.81' viewBox='0 0 370.81 370.81'> <g fill='%23fff'> <path d='M345.97 292.92L370.81 268.78 185.41 77.9 0 268.78 24.85 292.92 185.41 127.64z'/> </g></svg>",arrow_up_step_1:"<svg version='1.1' id='svg' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='370.811px' height='370.809px' viewBox='0 0 370.811 370.809' enable-background='new 0 0 370.811 370.809' xml:space='preserve'><g fill='%23fff'> <path d='M345.97,317.92l24.84-24.141L185.41,102.9L0,293.78L24.85,317.92l160.56-165.28L345.97,317.92z'/> <rect x='0' y='55.905' stroke-miterlimit='10' width='370.811' height='40.995'/></g></svg>",arrow_up_step_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='439.363px' height='439.363px' viewBox='0 0 439.363 439.363' enable-background='new 0 0 439.363 439.363' xml:space='preserve'><g fill='%23fff'> <path d='M438.951,362.147c1.143-2.471-0.094-5.518-3.709-9.139L232.535,150.309c-1.524-1.719-3.334-2.955-5.424-3.715h193.572 c4.952,0,9.234-1.809,12.85-5.424c3.617-3.617,5.427-7.9,5.427-12.848V91.776c0-4.951-1.81-9.232-5.427-12.85 c-3.619-3.617-7.9-5.426-12.85-5.426H18.697c-4.947,0-9.236,1.808-12.846,5.424c-3.621,3.621-5.43,7.902-5.43,12.851v36.543 c0,4.947,1.809,9.229,5.43,12.847c3.609,3.615,7.896,5.424,12.846,5.424h193.568c-1.902,0.764-3.717,2-5.424,3.715L4.128,353.008 c-3.617,3.621-4.859,6.668-3.721,9.139c1.145,2.479,4.189,3.716,9.139,3.716h420.27 C434.763,365.863,437.81,364.625,438.951,362.147z'/></g></svg>",awning_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='428.103px' height='428.102px' viewBox='0 0 428.103 428.102' style='enable-background:new 0 0 428.103 428.102;' xml:space='preserve'><g fill='%23fff'> <path d='M409.413,99.792h1.832c5.295,0,9.948-2.138,13.105-6.021c3.272-4.024,4.483-9.535,3.32-15.116l-8.756-42.063 c-2.184-10.482-11.538-18.693-21.297-18.693l-244.754,0.002H30.489c-9.759,0-19.114,8.211-21.297,18.693l-8.76,42.061 c-1.162,5.582,0.048,11.092,3.32,15.116c3.158,3.883,7.813,6.022,13.109,6.022h1.833c-4.647,25.018-9.303,50.033-13.958,75.051 l-0.372,2c-4.421,23.089,6.292,44.422,27.446,55.37v151.99c0,14.336,11.663,26,26,26h312.482c14.337,0,26-11.664,26-26V232.256 c21.192-10.938,31.906-32.29,27.454-55.381L409.413,99.792z M138.18,178.417c1.955-26.208,3.914-52.417,5.873-78.625h50.24 c-0.349,26.033-0.701,52.062-1.057,78.071c-0.289,16.09-15.25,26.083-29.012,26.116c-7.609,0-15.11-3.19-20.064-8.534 C141.094,192.136,137.567,186.499,138.18,178.417z M64.364,203.979l-0.307-0.006l-0.383,0.007c-7.362,0-14.396-3.131-18.817-8.376 c-2.747-3.259-5.738-8.787-4.386-16.662l12.966-79.148h50.598l-7.921,77.512C94.452,192.165,80.465,203.882,64.364,203.979z M198.294,304.532c0,5.523-4.478,10-10,10h-86c-5.522,0-10-4.477-10-10v-29c0-5.523,4.478-10,10-10h86c5.522,0,10,4.477,10,10 V304.532z M235.356,177.887l-1.091-78.095h50.24c1.931,25.716,3.865,51.433,5.799,77.148l0.111,1.485 c0.613,8.076-2.912,13.714-5.979,17.023c-4.951,5.341-12.447,8.53-20.12,8.53C250.622,203.947,235.656,193.951,235.356,177.887z M335.81,361.241c0,5.521-4.478,10-10,10h-53.496c-5.521,0-9.999-4.479-9.999-10v-75.996c0-5.523,4.478-10,9.999-10h53.496 c5.522,0,10,4.477,10,10V361.241z M383.248,195.646c-4.398,5.218-11.395,8.334-18.715,8.334l-0.19-0.001 c-16.201-0.115-30.197-11.833-31.857-26.621c-2.654-25.854-5.309-51.71-7.96-77.566h50.146l12.973,79.196 C388.994,186.841,385.999,192.381,383.248,195.646z'/></g></svg>",balcony_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M501.801,410.008h-54.566V220.303h25.498v126.47c0,5.633,4.567,10.199,10.199,10.199c5.632,0,10.199-4.566,10.199-10.199 v-126.47h8.669c5.632,0,10.199-4.566,10.199-10.199c0-5.633-4.567-10.199-10.199-10.199h-99.952V52.016 c0-5.633-4.567-10.199-10.199-10.199H120.351c-5.632,0-10.199,4.566-10.199,10.199v147.888H10.199 C4.567,199.904,0,204.471,0,210.104c0,5.633,4.567,10.199,10.199,10.199h8.669v189.705h-8.669C4.567,410.008,0,414.574,0,420.207 v39.777c0,5.633,4.567,10.199,10.199,10.199h491.602c5.632,0,10.199-4.566,10.199-10.199v-39.777 C512,414.574,507.433,410.008,501.801,410.008z M401.849,220.303h24.988v189.705h-24.988V220.303z M130.55,62.215h250.9v137.689 h-24.541V98.932c0-5.633-4.567-10.199-10.199-10.199H165.29c-5.632,0-10.199,4.566-10.199,10.199v100.972H130.55V62.215z M381.45,220.303v189.705h-24.541V220.303H381.45z M265.689,199.904v-90.773h70.821v90.773H265.689z M336.51,220.303v189.705 h-24.925V220.303H336.51z M291.187,220.303v189.705h-25.498V220.303H291.187z M175.49,199.904v-90.773h69.801v90.773H175.49z M245.291,220.303v189.705h-24.478V220.303H245.291z M200.414,220.303v189.705H175.49V220.303H200.414z M130.55,220.303h24.541 v189.705H130.55V220.303z M84.143,220.303h26.008v189.705H84.143V220.303z M39.267,220.303h24.478v189.705H39.267V220.303z M491.602,449.785H20.398v-19.378h471.203V449.785z'/> <path d='M482.932,369.211c-5.632,0-10.199,4.566-10.199,10.199v7.139c0,5.633,4.567,10.199,10.199,10.199 c5.632,0,10.199-4.566,10.199-10.199v-7.139C493.131,373.777,488.564,369.211,482.932,369.211z'/> </g></svg>",bathtube_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='583.31' height='583.31' viewBox='0 0 583.31 583.31' xml:space='preserve'><g fill='%23fff'> <path d='M125.25 545.51c25.69-5.1 43.28-28.3 53.29-52.26h-13.59c-5.79 0-11.53-0.11-17.2-0.37 -5.89 12.05-14.83 22.47-28.18 24.56 -4.12-3.57-9.42-5.79-15.3-5.79 -12.98 0-23.49 10.52-23.49 23.5s10.52 23.5 23.5 23.5C113.51 558.63 121.42 553.25 125.25 545.51z'/> <path d='M491.69 558.63c12.98 0 23.5-10.52 23.5-23.49s-10.52-23.49-23.49-23.49c-5.18 0-9.94 1.73-13.82 4.58 -11.4-3.8-19.58-13.81-25.27-24.96 -8.7 1.51-16.44 1.99-22.24 1.99h-1.54 -0.89 -7.79c8.2 22.52 23.39 44.39 49.98 51.16C473.71 552.77 482.01 558.63 491.69 558.63z'/> <path d='M453.22 110.15l-48.02-48.03c-8.82 2.25-35.85 19.68-43.93 28.11l63.91 63.91C433.55 146.12 450.8 119.35 453.22 110.15z'/> <path d='M361.98 128.13c1.23 0 2.45-0.47 3.39-1.4l6.76-6.76c0.43-0.43 0.73-0.93 0.96-1.44 0.78-1.76 0.48-3.87-0.96-5.32 -1.43-1.44-3.56-1.74-5.32-0.96 -0.52 0.23-1.01 0.54-1.44 0.96l-6.77 6.75c-1.86 1.87-1.86 4.9 0 6.76C359.53 127.66 360.76 128.13 361.98 128.13z'/> <path d='M341.69 148.42c1.22 0 2.45-0.47 3.39-1.4l6.76-6.76c1.86-1.86 1.86-4.9 0-6.76s-4.9-1.86-6.76 0l-6.76 6.76c-1.86 1.87-1.86 4.9 0 6.76C339.25 147.96 340.46 148.42 341.69 148.42z'/> <path d='M321.4 168.71c1.22 0 2.45-0.47 3.39-1.4l6.76-6.76c1.87-1.86 1.87-4.9 0-6.76 -1.86-1.86-4.9-1.86-6.76 0l-6.76 6.76c-1.86 1.86-1.86 4.9 0 6.76C318.96 168.24 320.18 168.71 321.4 168.71z'/> <path d='M386.59 132.04c0.78-1.76 0.49-3.88-0.96-5.32 -1.44-1.44-3.56-1.74-5.32-0.96 -0.52 0.23-1.01 0.54-1.44 0.96l-6.76 6.77c-1.86 1.87-1.86 4.9 0 6.76 0.94 0.94 2.16 1.4 3.39 1.4 1.23 0 2.45-0.47 3.39-1.4l6.76-6.77C386.07 133.07 386.36 132.57 386.59 132.04z'/> <path d='M365.35 147.02c-1.86-1.86-4.9-1.86-6.76 0l-6.76 6.76c-1.86 1.87-1.86 4.9 0 6.76 0.94 0.94 2.16 1.4 3.39 1.4 1.23 0 2.45-0.47 3.39-1.4l6.76-6.76C367.22 151.92 367.22 148.88 365.35 147.02z'/> <path d='M345.07 167.3c-1.86-1.86-4.9-1.86-6.76 0l-6.76 6.77c-1.86 1.87-1.86 4.9 0 6.76 0.94 0.94 2.16 1.4 3.39 1.4 1.22 0 2.45-0.47 3.39-1.4l6.76-6.77C346.94 172.2 346.94 169.17 345.07 167.3z'/> <path d='M389.02 155.18c1.23 0 2.45-0.47 3.39-1.4l6.76-6.76c0.43-0.43 0.73-0.93 0.96-1.44 0.78-1.76 0.48-3.87-0.96-5.32 -1.43-1.44-3.56-1.74-5.32-0.96 -0.52 0.23-1.02 0.54-1.44 0.96l-6.76 6.76c-1.86 1.87-1.86 4.9 0 6.76C386.57 154.72 387.8 155.18 389.02 155.18z'/> <path d='M368.74 175.47c1.23 0 2.45-0.47 3.39-1.4l6.76-6.76c1.86-1.86 1.86-4.9 0-6.76 -1.86-1.86-4.9-1.86-6.76 0l-6.76 6.76c-1.86 1.87-1.86 4.9 0 6.76C366.29 175 367.52 175.47 368.74 175.47z'/> <path d='M348.45 195.75c1.22 0 2.45-0.47 3.39-1.4l6.76-6.76c1.86-1.86 1.86-4.9 0-6.76s-4.9-1.86-6.76 0l-6.76 6.76c-1.86 1.87-1.86 4.9 0 6.76C346.01 195.28 347.23 195.75 348.45 195.75z'/> <path d='M564.19 254.19h-14.34H535.5V34.25c0-5.28-4.27-9.56-9.56-9.56h-41.54c-2.4 0-4.71 0.9-6.48 2.52l-34.37 31.64c-7.81-1.98-16.73 0.69-22.22 2.93l32.84 32.85c2.37-6.12 4.57-14.48 2.71-22.03l31.27-28.78h28.24v210.38H33.47 19.13C8.56 254.19 0 262.74 0 273.31v19.13c0 10.57 8.56 19.13 19.13 19.13h2.13 4.21 5.56c1.45 7.4 3.33 15.91 5.7 25.72l13.39 64.15c18.73 69.33 56.67 80.58 101.62 82.04 4.35 0.13 8.75 0.22 13.23 0.22h17.22l234.85 0.01c-0.01-0.05-0.02-0.09-0.04-0.13 0.01 0.04 0.02 0.09 0.04 0.12h13.33c5.42 0 11.64-0.34 18.3-1.33l0 0c29.41-4.33 67.6-21.1 85.44-75.88l21.75-94.92h5.66 2.68c0.52 0 0.99-0.11 1.5-0.15 9.85-0.77 17.62-8.92 17.62-18.97v-19.12C583.31 262.74 574.75 254.19 564.19 254.19zM411.76 454.01L411.76 454.01c0 0.06 0.01 0.13 0.02 0.18C411.77 454.14 411.76 454.07 411.76 454.01z'/></g></svg>",bed_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' x='0' y='0' width='500' height='500' viewBox='0 0 500 500'> <g fill='%23fff'> <path d='M58.17 415.94L58.17 438.63 12.8 438.63 12.8 415.94 58.17 415.94z'/> <path d='M58.17 415.94L58.17 438.63 12.8 438.63 12.8 415.94 58.17 415.94z' fill-opacity='0' stroke-width='1'/> <path d='M486.23 415.34L486.23 438.03 440.86 438.03 440.86 415.34 486.23 415.34z'/> <path d='M486.23 415.34L486.23 438.03 440.86 438.03 440.86 415.34 486.23 415.34z' fill-opacity='0' stroke-width='1'/> <path d='M437.51 209.81L499.47 333.72 499.47 401.78 0.39 401.78 0.39 333.72 62.34 209.81 437.51 209.81z'/> <path d='M437.51 209.81L499.47 333.72 499.47 401.78 0.39 401.78 0.39 333.72 62.34 209.81 437.51 209.81z' fill-opacity='0' stroke-width='1'/> <path d='M91.13 61.5L91.13 84.19 408.72 84.19 408.72 61.5 431.41 61.5 431.41 197.59 408.72 197.59 408.72 174.93C408.72 162.4 398.57 152.24 386.04 152.24L295.3 152.24C282.77 152.24 272.61 162.4 272.61 174.93L272.61 197.59 227.24 197.59 227.24 174.93C227.24 162.4 217.09 152.24 204.56 152.24L113.82 152.24C101.29 152.24 91.13 162.4 91.13 174.93L91.13 197.59 68.44 197.59 68.44 61.5 91.13 61.5z'/> <path d='M91.13 61.5L91.13 84.19 408.72 84.19 408.72 61.5 431.41 61.5 431.41 197.59 408.72 197.59 408.72 174.93C408.72 162.4 398.57 152.24 386.04 152.24L295.3 152.24C282.77 152.24 272.61 162.4 272.61 174.93L272.61 197.59 227.24 197.59 227.24 174.93C227.24 162.4 217.09 152.24 204.56 152.24L113.82 152.24C101.29 152.24 91.13 162.4 91.13 174.93L91.13 197.59 68.44 197.59 68.44 61.5 91.13 61.5z' fill-opacity='0' stroke-width='1'/> </g></svg>",bell_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='535.5' height='535.5' viewBox='0 0 535.5 535.5' xml:space='preserve' enable-background='new 0 0 535.5 535.5'> <g fill='%23fff' id='notifications-on'> <path d='M142.8 53.55l-35.7-35.7C45.9 63.75 5.1 135.15 0 216.75h51C56.1 147.9 89.25 89.25 142.8 53.55zM484.5 216.75h51c-5.1-81.6-43.35-153-104.55-198.9l-35.7 35.7C446.25 89.25 479.4 147.9 484.5 216.75zM433.5 229.5c0-79.05-53.55-142.8-127.5-160.65V51c0-20.4-17.85-38.25-38.25-38.25 -20.4 0-38.25 17.85-38.25 38.25v17.85C155.55 86.7 102 150.45 102 229.5v140.25l-51 51v25.5h433.5v-25.5l-51-51V229.5zM267.75 522.75c2.55 0 7.65 0 10.2 0 17.85-2.55 30.6-15.3 35.7-30.6 2.55-5.1 5.1-12.75 5.1-20.4h-102C216.75 499.8 239.7 522.75 267.75 522.75z'/> </g></svg>",bell_2:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='510' height='510' viewBox='0 0 510 510' xml:space='preserve' enable-background='new 0 0 510 510'> <g fill='%23fff' id='notifications'> <path d='M255 510c28.05 0 51-22.95 51-51H204C204 487.05 226.95 510 255 510zM420.75 357V216.75c0-79.05-53.55-142.8-127.5-160.65V38.25C293.25 17.85 275.4 0 255 0c-20.4 0-38.25 17.85-38.25 38.25V56.1c-73.95 17.85-127.5 81.6-127.5 160.65V357l-51 51v25.5h433.5V408L420.75 357z'/> </g></svg>",biceps_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 50.463 50.463' style='enable-background:new 0 0 50.463 50.463;' xml:space='preserve'> <g fill='%23fff'> <path d='M47.923,29.694c0.021-0.601-0.516-1.063-0.901-1.515c-0.676-2.733-2.016-5.864-3.961-8.971 C39.942,14.23,31.688,6.204,28.553,4.966c-0.158-0.062-0.299-0.097-0.429-0.126c-0.313-1.013-0.479-1.708-1.698-2.521 c-3.354-2.236-7.099-2.866-9.578-1.843c-2.481,1.023-3.859,6.687-1.19,8.625c2.546,1.857,7.583-1.888,9.195,0.509 c1.609,2.396,3.386,10.374,6.338,15.473c-0.746-0.102-1.514-0.156-2.307-0.156c-3.406,0-6.467,0.998-8.63,2.593 c-1.85-2.887-5.08-4.806-8.764-4.806c-3.82,0-7.141,2.064-8.95,5.13v22.619h4.879l1.042-1.849 c3.354-1.287,7.32-4.607,10.076-8.147C29.551,44.789,47.676,36.789,47.923,29.694z'/> </g></svg>",blind_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 50 50' style='enable-background:new 0 0 50 50;' xml:space='preserve'><g fill='%23fff'><path d='M10.5,19.041c0-0.829,0.671-1.5,1.5-1.5h26c0.829,0,1.5,0.671,1.5,1.5c0,0.829-0.671,1.5-1.5,1.5H12 C11.171,20.541,10.5,19.87,10.5,19.041z M12,37.334h26c0.829,0,1.5-0.671,1.5-1.5c0-0.829-0.671-1.5-1.5-1.5H12 c-0.829,0-1.5,0.671-1.5,1.5C10.5,36.663,11.171,37.334,12,37.334z M12,26.068h26c0.829,0,1.5-0.671,1.5-1.5s-0.671-1.5-1.5-1.5H12 c-0.829,0-1.5,0.671-1.5,1.5S11.171,26.068,12,26.068z M12,31.807h26c0.829,0,1.5-0.671,1.5-1.5c0-0.829-0.671-1.5-1.5-1.5H12 c-0.829,0-1.5,0.671-1.5,1.5C10.5,31.135,11.171,31.807,12,31.807z M45.5,13.25v28.375h3c0.829,0,1.5,0.671,1.5,1.5 c0,0.829-0.671,1.5-1.5,1.5h-47c-0.829,0-1.5-0.671-1.5-1.5c0-0.829,0.671-1.5,1.5-1.5h3V13.25h-3c-0.829,0-1.5-0.671-1.5-1.5V6.875 c0-0.829,0.671-1.5,1.5-1.5h47c0.829,0,1.5,0.671,1.5,1.5v4.875c0,0.829-0.671,1.5-1.5,1.5H45.5z M42.5,13.25h-35v28.375h35V13.25z' /></g></svg>",blind_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='554.625px' height='554.625px' viewBox='0 0 554.625 554.625' style='enable-background:new 0 0 554.625 554.625;' xml:space='preserve'> <g fill='%23fff'> <polygon points='9.562,90.844 411.188,90.844 411.188,62.156 47.812,62.156 '/> <polygon points='439.875,62.156 439.875,90.844 535.5,90.844 497.25,62.156 '/> <polygon points='411.188,129.094 411.188,100.406 47.812,100.406 9.562,129.094 '/> <polygon points='439.875,100.406 439.875,129.094 535.5,129.094 497.25,100.406 '/> <polygon points='411.188,167.344 411.188,138.656 47.812,138.656 9.562,167.344 '/> <polygon points='439.875,138.656 439.875,167.344 535.5,167.344 497.25,138.656 '/> <polygon points='439.875,176.906 439.875,205.594 535.5,205.594 497.25,176.906 '/> <polygon points='411.188,205.594 411.188,176.906 47.812,176.906 9.562,205.594 '/> <polygon points='411.188,243.844 411.188,215.156 47.812,215.156 9.562,243.844 '/> <polygon points='439.875,215.156 439.875,243.844 535.5,243.844 497.25,215.156 '/> <polygon points='411.188,282.094 411.188,253.406 47.812,253.406 9.562,282.094 '/> <polygon points='439.875,253.406 439.875,282.094 535.5,282.094 497.25,253.406 '/> <polygon points='411.188,320.344 411.188,291.656 47.812,291.656 9.562,320.344 '/> <polygon points='439.875,291.656 439.875,320.344 535.5,320.344 497.25,291.656 '/> <polygon points='411.188,358.594 411.188,329.906 47.812,329.906 9.562,358.594 '/> <polygon points='439.875,329.906 439.875,358.594 535.5,358.594 497.25,329.906 '/> <polygon points='439.875,368.156 439.875,396.844 535.5,396.844 497.25,368.156 '/> <polygon points='411.188,396.844 411.188,368.156 47.812,368.156 9.562,396.844 '/> <polygon points='439.875,406.406 439.875,435.094 535.5,435.094 497.25,406.406 '/> <polygon points='411.188,435.094 411.188,406.406 47.812,406.406 9.562,435.094 '/> <path d='M403.652,473.344c1.654-3.768,4.294-6.98,7.535-9.438v-19.249H47.812l-38.25,28.688H403.652z'/> <path d='M439.875,444.656v19.249c3.251,2.458,5.881,5.671,7.535,9.438h88.09l-38.25-28.688H439.875z'/> <path d='M449.438,482.906c0,13.177-10.72,23.906-23.906,23.906s-23.906-10.729-23.906-23.906H47.812l-38.25,28.688H535.5 l-38.25-28.688H449.438z'/> <polygon points='47.812,521.156 9.562,549.844 535.5,549.844 497.25,521.156 '/> <path d='M430.312,459.487v-14.831v-9.562v-28.688v-9.562v-28.688v-9.562v-28.688v-9.562v-28.688v-9.562v-28.688v-9.562v-28.688 v-9.562v-28.688v-9.562v-28.688v-9.562v-28.688v-9.562V62.156h-9.562v28.688v9.562v28.688v9.562v28.688v9.562v28.688v9.562v28.688 v9.562v28.688v9.562v28.688v9.562v28.688v9.562v28.688v9.562v28.688v9.562v14.831c1.549-0.315,3.146-0.487,4.781-0.487 S428.764,459.172,430.312,459.487z'/> <polygon points='0,52.594 411.188,52.594 420.75,52.594 430.312,52.594 439.875,52.594 554.625,52.594 554.625,4.781 0,4.781 '/> <path d='M414.917,473.344c-2.295,2.544-3.729,5.871-3.729,9.562c0,7.908,6.436,14.344,14.344,14.344s14.344-6.436,14.344-14.344 c0-3.691-1.435-7.019-3.729-9.562c-1.578-1.75-3.566-3.089-5.833-3.901c-1.501-0.536-3.099-0.88-4.781-0.88 s-3.28,0.344-4.781,0.88C418.483,470.255,416.495,471.594,414.917,473.344z'/> </g></svg>",blind_3:"<svg height='512pt' viewBox='-30 0 512 512' width='512pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m0 0v512h452v-512zm422 30v30h-392v-30zm-332 300h272v92h-272zm-60-30v-30h392v30zm0-60v-30h392v30zm0-60v-30h392v30zm0-60v-30h392v30zm0 362v-152h30v122h332v-122h30v152zm0 0'/></g></svg>",blocks_1:"<svg height='512pt' viewBox='0 -78 512 512' width='512pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m271 183.742188h241v-141.351563h-30.410156v-42.390625h-66.703125v42.390625h-47.796875v-42.390625h-66.703125v42.390625h-29.386719zm0 0'/><path d='m120.5 213.742188h271v141.355468h-271zm0 0'/><path d='m241 183.742188v-141.351563h-29.898438v-42.390625h-66.703124v42.390625h-47.796876v-42.390625h-66.703124v42.390625h-29.898438v141.351563zm0 0'/></g></svg>",broom_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='54.306px' height='54.306px' viewBox='0 0 54.306 54.306' style='enable-background:new 0 0 54.306 54.306;' xml:space='preserve'> <g fill='%23fff'> <polygon points='36.254,49.095 37.27,53.095 1.961,53.095 2.976,49.095 1.22,49.095 0,54.095 39.482,54.095 38.262,49.095 '/> <path d='M21.76,3.095c0-1.104-0.896-2-2-2s-2,0.896-2,2v45h4V3.095z'/> <path d='M43.76,22.259v29.836c0,1.104,0.896,2,2,2s2-0.896,2-2v-29.8c-0.659,0.114-1.354,0.194-2.134,0.194 C44.957,22.489,44.339,22.405,43.76,22.259z'/> <path d='M35.223,49.095H4.008l-0.762,3h32.739L35.223,49.095z M4.786,50.667c-0.308,0-0.557-0.25-0.557-0.558 c0-0.309,0.25-0.558,0.557-0.558c0.307,0,0.557,0.249,0.557,0.558C5.343,50.417,5.093,50.667,4.786,50.667z M33.861,50.802 c-0.34,0-0.615-0.274-0.615-0.616c0-0.34,0.275-0.615,0.615-0.615c0.342,0,0.616,0.275,0.616,0.615 C34.478,50.527,34.201,50.802,33.861,50.802z'/> <path d='M44.433,3.252l-1.78,9.526L41.17,2.169l-4.225-1.958c0.013,6.962,0.326,21.278,8.681,21.278 c8.534,0,8.678-7.747,8.68-14.726L44.433,3.252z'/> </g></svg>","calendar-time_1":"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='485.213px' height='485.212px' viewBox='0 0 485.213 485.212' style='enable-background:new 0 0 485.213 485.212;' xml:space='preserve'><g fill='%23fff'> <path d='M60.652,75.816V15.163C60.652,6.781,67.433,0,75.817,0c8.38,0,15.161,6.781,15.161,15.163v60.653 c0,8.38-6.781,15.161-15.161,15.161C67.433,90.978,60.652,84.196,60.652,75.816z M318.424,90.978 c8.378,0,15.163-6.781,15.163-15.161V15.163C333.587,6.781,326.802,0,318.424,0c-8.382,0-15.168,6.781-15.168,15.163v60.653 C303.256,84.196,310.042,90.978,318.424,90.978z M485.212,363.906c0,66.996-54.312,121.307-121.303,121.307 c-66.986,0-121.302-54.311-121.302-121.307c0-66.986,54.315-121.3,121.302-121.3C430.9,242.606,485.212,296.919,485.212,363.906z M454.89,363.906c0-50.161-40.81-90.976-90.98-90.976c-50.166,0-90.976,40.814-90.976,90.976c0,50.171,40.81,90.98,90.976,90.98 C414.08,454.886,454.89,414.077,454.89,363.906z M121.305,181.955H60.652v60.651h60.653V181.955z M60.652,333.584h60.653V272.93 H60.652V333.584z M151.629,242.606h60.654v-60.651h-60.654V242.606z M151.629,333.584h60.654V272.93h-60.654V333.584z M30.328,360.891V151.628h333.582v60.653h30.327V94c0-18.421-14.692-33.349-32.843-33.349h-12.647v15.166 c0,16.701-13.596,30.325-30.322,30.325c-16.731,0-30.326-13.624-30.326-30.325V60.651H106.14v15.166 c0,16.701-13.593,30.325-30.322,30.325c-16.733,0-30.327-13.624-30.327-30.325V60.651H32.859C14.707,60.651,0.001,75.579,0.001,94 v266.892c0,18.36,14.706,33.346,32.858,33.346h179.424v-30.331H32.859C31.485,363.906,30.328,362.487,30.328,360.891z M303.256,242.606v-60.651h-60.648v60.651H303.256z M409.399,363.906h-45.49v-45.49c0-8.377-6.781-15.158-15.163-15.158 s-15.159,6.781-15.159,15.158v60.658c0,8.378,6.777,15.163,15.159,15.163h60.653c8.382,0,15.163-6.785,15.163-15.163 C424.562,370.692,417.781,363.906,409.399,363.906z'/></g></svg>",candy_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='233.521px' height='233.52px' viewBox='0 0 233.521 233.52' style='enable-background:new 0 0 233.521 233.52;' xml:space='preserve'> <g fill='%23fff'> <path d='M198.57,57.213c0,0,22.729-37.422-16.064-18.476c-1.263-9.669-12.564-38.876-20.003-38.725 c-7.438,0.15-8.567,38.999-13.098,55.911c-23.561-9.386-53.539-2.865-74.938,18.535c-21.399,21.398-27.92,51.376-18.534,74.938 c-16.913,4.53-54.968,3.342-55.912,13.096c-0.943,9.754,29.056,18.742,38.726,20.003c-18.946,38.792,18.476,16.065,18.476,16.065 s13.567,48.562,20.998,31.199c6.912-16.154,7.549-36.825,7.863-50.028c23.606,9.564,53.752,3.077,75.242-18.414 c21.492-21.492,27.979-51.638,18.414-75.243c13.203-0.314,33.874-0.951,50.028-7.864C247.134,70.78,198.57,57.213,198.57,57.213z M76.667,192.089c-3.705,8.655-10.957-21.955-10.957-21.955c-4.82-0.628-21.72-2.444-22.425-6.938 c-0.604-3.845,8.919-3.783,16.934-5.262c2.172,3.521,4.766,6.825,7.787,9.846c3.313,3.312,6.965,6.109,10.872,8.402 C79.194,180.753,79.291,185.956,76.667,192.089z M150.16,73.032c-0.005,0.006-0.011,0.012-0.016,0.017 c-0.289,0.288-0.721,0.39-1.083,0.232c-19.614-8.51-44.287-2.733-61.394,14.374c-17.107,17.108-22.884,41.78-14.375,61.396 c0.189,0.435,0.006,0.968-0.422,1.233c-0.429,0.269-0.965,0.184-1.244-0.195c-6.954-9.478-9.867-21.679-8.201-34.356 c1.678-12.775,7.913-25.12,17.555-34.762c9.642-9.642,21.987-15.877,34.763-17.554c12.636-1.661,24.796,1.227,34.261,8.131 c0.071,0.039,0.138,0.087,0.198,0.147C150.558,72.049,150.537,72.646,150.16,73.032z M192.1,76.656 c-6.132,2.624-11.336,2.527-15.907,2.211c-2.293-3.907-5.09-7.56-8.402-10.872c-3.021-3.021-6.324-5.614-9.847-7.787 c1.479-8.015,1.417-17.538,5.264-16.934c4.494,0.705,6.31,17.605,6.938,22.427C170.145,65.7,200.757,72.951,192.1,76.656z'/> </g></svg>",car_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='48.997px' height='48.998px' viewBox='0 0 48.997 48.998' style='enable-background:new 0 0 48.997 48.998;' xml:space='preserve'><g fill='%23fff'> <path d='M45.961,18.702c-0.033-0.038-0.061-0.075-0.1-0.112l-1.717-1.657c1.424-0.323,2.957-1.516,2.957-2.74 c0-1.426-1.979-1.932-3.668-1.932c-1.766,0-1.971,1.21-1.992,2.065l-4.43-4.271c-0.9-0.891-2.607-1.592-3.883-1.592H24.5h-0.002 h-8.63c-1.275,0-2.981,0.701-3.882,1.592l-4.429,4.271c-0.023-0.855-0.228-2.065-1.992-2.065c-1.691,0-3.669,0.506-3.669,1.932 c0,1.224,1.534,2.417,2.958,2.74l-1.717,1.657c-0.039,0.037-0.066,0.074-0.1,0.112C1.2,20.272,0,23.184,0,25.297v6.279 c0,1.524,0.601,2.907,1.572,3.938v2.435c0,1.424,1.192,2.585,2.658,2.585h3.214c1.466,0,2.657-1.159,2.657-2.585v-0.623h14.397 H24.5h14.396v0.623c0,1.426,1.19,2.585,2.658,2.585h3.213c1.467,0,2.657-1.161,2.657-2.585v-2.435 c0.972-1.031,1.572-2.414,1.572-3.938v-6.279C48.998,23.184,47.798,20.272,45.961,18.702z M13.613,11.953 c0.623-0.519,1.712-0.913,2.255-0.913h8.63H24.5h8.63c0.543,0,1.632,0.394,2.255,0.913l5.809,5.63H24.5h-0.002H7.805L13.613,11.953 z M1.993,24.347c0-1.546,1.21-2.801,2.704-2.801c1.493,0,6.372,2.864,6.372,4.41s-4.879,1.188-6.372,1.188 C3.203,27.144,1.993,25.894,1.993,24.347z M10.102,34.573H9.587H9.072l-3.055,0.005c-0.848-0.264-1.446-0.572-1.869-0.903 c-0.214-0.167-0.378-0.341-0.506-0.514c-0.129-0.175-0.223-0.347-0.284-0.519c-0.38-1.074,0.405-2.061,0.405-2.061h5.214 l3.476,3.99L10.102,34.573L10.102,34.573z M31.996,34.575H24.5h-0.002h-7.496c-1.563,0-2.832-1.269-2.832-2.831h10.328H24.5h10.328 C34.828,33.308,33.559,34.575,31.996,34.575z M32.654,29.812H24.5h-0.002h-8.154c-1.7,0-3.08-2.096-3.08-4.681h11.234H24.5h11.234 C35.734,27.717,34.354,29.812,32.654,29.812z M45.641,32.644c-0.062,0.172-0.156,0.344-0.285,0.518 c-0.127,0.173-0.291,0.347-0.506,0.514c-0.422,0.331-1.021,0.641-1.869,0.903l-3.055-0.005h-0.515h-0.515h-2.353l3.478-3.99h5.213 C45.234,30.583,46.02,31.568,45.641,32.644z M44.301,27.144c-1.492,0-6.371,0.356-6.371-1.188s4.879-4.41,6.371-4.41 c1.494,0,2.704,1.255,2.704,2.801C47.005,25.892,45.795,27.144,44.301,27.144z'/></g></svg>",child_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 387.039 387.039' style='enable-background:new 0 0 387.039 387.039;' xml:space='preserve'><g fill='%23fff'> <circle cx='112.809' cy='233.169' r='15.368'/> <circle cx='274.229' cy='233.169' r='15.368'/> <path d='M387.039,226.647c0-22.261-16.136-40.811-37.324-44.602v-6.717c0-86.127-70.069-156.196-156.195-156.196 c-86.127,0-156.196,70.069-156.196,156.196v6.717C16.136,185.837,0,204.387,0,226.647c0,22.453,16.414,41.134,37.871,44.7 c3.02,34.414,18.765,59.834,46.942,75.653c25.058,14.068,60.615,20.906,108.707,20.906c48.091,0,83.649-6.839,108.707-20.906 c28.176-15.819,43.921-41.238,46.941-75.653C370.625,267.782,387.039,249.1,387.039,226.647z M16,226.647 c0-13.395,9.032-24.713,21.323-28.205v56.41C25.032,251.361,16,240.043,16,226.647z M333.715,258.757 c0,35.135-12.862,59.436-39.321,74.291c-22.603,12.69-55.599,18.858-100.874,18.858s-78.272-6.168-100.874-18.858 c-26.46-14.855-39.322-39.156-39.322-74.291v-83.429c0-63.309,42.185-116.941,99.918-134.29 c43.983,0.556,67.407,32.306,67.407,55.296c0,17.608-14.325,31.934-31.934,31.934c-13.204,0-23.947-10.743-23.947-23.947 c0-9.681,7.876-17.558,17.558-17.558c4.418,0,8-3.582,8-8s-3.582-8-8-8c-18.504,0-33.558,15.054-33.558,33.558 c0,22.027,17.92,39.947,39.947,39.947c26.431,0,47.934-21.503,47.934-47.934c0-16.605-8.343-34.47-22.317-47.79 c-5.59-5.328-11.95-9.807-18.89-13.387c76.42,1.034,138.273,63.51,138.273,140.171V258.757z M349.715,254.853v-56.41 c12.292,3.492,21.324,14.81,21.324,28.205S362.006,251.361,349.715,254.853z'/> <path d='M224.459,255.203c-17.059,17.061-44.82,17.061-61.879,0c-3.125-3.124-8.189-3.124-11.314,0 c-3.124,3.124-3.124,8.19,0,11.314c11.649,11.649,26.952,17.474,42.254,17.474s30.604-5.825,42.254-17.474 c3.124-3.124,3.124-8.19,0-11.314C232.648,252.079,227.584,252.079,224.459,255.203z'/></g></svg>",close_house_1:"<svg xmlns='http://www.w3.org/2000/svg' id='svg' version='1.1' x='0' y='0' width='500' height='500' viewBox='0 0 500 500'><g fill='%23fff'> <path d='M250.34 0L449.49 200 449.49 500 51.19 500 51.19 200 250.34 0zM251.16 204.01C224.66 204.47 203.55 226.33 204.01 252.84 204.35 268.81 212.6 283.57 225.97 292.27 222.65 318.85 219.32 345.42 216 372L288 372 278.04 292.31C292.1 283.12 299.86 267.82 299.99 251.16 299.53 224.66 277.67 203.55 251.16 204.01z'/></g></svg>",close_x_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='94.93' height='94.93' viewBox='0 0 94.93 94.93' xml:space='preserve'><g fill='%23fff'> <path d='M55.93 47.46L94.31 9.09c0.83-0.83 0.83-2.17 0-2.99L88.83 0.62C88.44 0.22 87.9 0 87.34 0c-0.56 0-1.1 0.22-1.5 0.62L47.46 38.99 9.09 0.62c-0.79-0.79-2.2-0.79-2.99 0L0.62 6.1c-0.83 0.83-0.83 2.17 0 2.99l38.37 38.37L0.62 85.84c-0.83 0.83-0.83 2.17 0 2.99l5.47 5.48c0.4 0.4 0.94 0.62 1.5 0.62s1.1-0.22 1.5-0.62l38.37-38.37 38.37 38.37c0.4 0.4 0.94 0.62 1.5 0.62s1.1-0.22 1.5-0.62l5.47-5.48c0.83-0.83 0.83-2.17 0-2.99L55.93 47.46z'/></g></svg>",commode_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <rect x='26.205' y='455.627' width='459.593' height='47.533'/> <path d='M0,8.84v138.788h30.417v-0.001h451.166H512V8.84H0z M256,119.086c-14.162,0-25.644-11.482-25.644-25.644 S241.838,67.799,256,67.799c14.162,0,25.644,11.481,25.644,25.644C281.644,107.605,270.162,119.086,256,119.086z'/> <path d='M481.583,178.045H30.417H0v108.372h30.417h451.166H512V178.045H481.583z M256,257.875 c-14.162,0-25.644-11.482-25.644-25.644s11.481-25.644,25.644-25.644c14.162,0,25.644,11.482,25.644,25.644 C281.644,246.393,270.162,257.875,256,257.875z'/> <path d='M481.583,316.834H30.417H0v108.371h30.417h26.205h398.755h26.205H512V316.834H481.583z M256,396.663 c-14.162,0-25.644-11.482-25.644-25.644c0-14.162,11.481-25.644,25.644-25.644c14.162,0,25.644,11.482,25.644,25.644 C281.644,385.182,270.162,396.663,256,396.663z'/> </g></svg>",computer_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' viewBox='0 0 390 390' xml:space='preserve' enable-background='new 0 0 390 390'><g fill='%23fff'> <path d='M383.41 84.9H132.23v31.33h231.24v166.81H132.23v41.23h42.01l-29.6 28.52c-0.98 0.94-1.53 2.24-1.53 3.6v6.4c0 2.76 2.24 5 5 5h151.38c2.76 0 5-2.24 5-5v-6.4c0-1.36-0.55-2.66-1.53-3.6l-29.6-28.52h110.04c3.64 0 6.59-2.95 6.59-6.6V91.49C390 87.85 387.05 84.9 383.41 84.9zM223.8 297.55c4.01 0 7.25 3.25 7.25 7.25 0 4.01-3.25 7.25-7.25 7.25 -4 0-7.25-3.25-7.25-7.25C216.55 300.8 219.8 297.55 223.8 297.55z'/> <path d='M101.61 22.23H8.08C3.62 22.23 0 25.84 0 30.3v329.06c0 4.46 3.62 8.08 8.08 8.08h93.53c4.46 0 8.08-3.61 8.08-8.08V30.3C109.68 25.84 106.07 22.23 101.61 22.23zM46.17 63.25c0-0.7 0.57-1.28 1.28-1.28H62.24c0.71 0 1.28 0.57 1.28 1.28v127.42c0 0.71-0.57 1.28-1.28 1.28H47.45c-0.71 0-1.28-0.57-1.28-1.28V63.25zM62.44 257.65c0 4.2-3.4 7.6-7.6 7.6 -4.2 0-7.6-3.4-7.6-7.6 0-4.2 3.4-7.6 7.6-7.6C59.04 250.05 62.44 253.45 62.44 257.65zM54.84 318.29c-9.88 0-17.89-8.01-17.89-17.89 0-9.88 8.01-17.89 17.89-17.89 9.88 0 17.89 8.01 17.89 17.89C72.73 310.28 64.72 318.29 54.84 318.29z'/></g></svg>",controller_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='612.38' height='612.38' viewBox='0 0 612.38 612.38' xml:space='preserve' enable-background='new 0 0 612.376 612.377'> <g fill='%23fff'> <path d='M499.22 444.72c-5.67 0-10.26 4.64-10.26 10.34 0 5.73 4.59 10.34 10.26 10.34 5.66 0 10.26-4.61 10.26-10.33C509.47 449.36 504.88 444.72 499.22 444.72zM499.22 351.64c-5.67 0-10.26 4.63-10.26 10.32 0 5.71 4.59 10.36 10.26 10.36 5.66 0 10.26-4.64 10.26-10.35C509.47 356.28 504.88 351.64 499.22 351.64zM406.87 424.02c-5.67 0-10.26 4.64-10.26 10.36 0 5.69 4.59 10.34 10.26 10.34 5.66 0 10.26-4.64 10.26-10.33C417.13 428.66 412.53 424.02 406.87 424.02zM406.87 330.94c-5.67 0-10.26 4.62-10.26 10.36 0 5.69 4.59 10.34 10.26 10.34 5.66 0 10.26-4.64 10.26-10.33C417.13 335.58 412.53 330.94 406.87 330.94zM601.5 373.95c-29.71-109.81-112.2-183.35-184.26-164.2 -27.42 7.27-71.6 25.7-102.71 27.8v-30.7h-0.08c0.02-1.76 0.08-3.33 0.08-5.16 0-31.43-25.27-56.88-56.44-56.88h-82.09c-19.83 0-35.91-16.21-35.91-36.2 0-20.01 16.08-36.22 35.91-36.22h118.01c11.33 0 20.52-9.25 20.52-20.68V10.33C314.52 4.62 309.93 0 304.26 0c-5.67 0-10.25 4.63-10.25 10.33v20.7c0 20.5-0.84 20.68-20.53 20.68h-97.48c-31.17 0-56.44 25.46-56.44 56.9 0 31.41 25.27 56.88 56.44 56.88h82.09c19.83 0 35.91 16.21 35.91 36.2 0 1.84 0.06 3.42 0.09 5.16h-0.08v30.86c-30.73-2.17-74.26-20.64-101.3-27.95 -71.16-19.2-152.62 54.67-181.96 165 -29.33 110.34 4.57 215.37 75.73 234.6 53.09 14.32 111.85-23.26 150.48-89.05 21.34 4.54 43.85 7.15 67.31 7.15 23.76 0 46.55-4.14 68.16-8.66 39.12 65.49 98.61 102.9 152.38 88.64C596.86 588.29 631.2 483.76 601.5 373.95zM201.66 393h-41.04v41.38c0 5.69-4.59 10.34-10.26 10.34 -5.67 0-10.26-4.64-10.26-10.33v-41.38H99.04c-5.67 0-10.26-4.62-10.26-10.33s4.59-10.33 10.26-10.33h41.04v-41.38c0-5.69 4.59-10.35 10.26-10.35 5.66 0 10.26 4.66 10.26 10.36v41.38h41.04c5.66 0 10.26 4.62 10.26 10.34S207.32 393 201.66 393zM406.87 465.4c-17 0-30.78-13.9-30.78-31.01 0-17.14 13.78-31.01 30.78-31.01 17 0 30.78 13.89 30.78 31.01C437.65 451.49 423.87 465.4 406.87 465.4zM406.87 372.32c-17 0-30.78-13.9-30.78-31.01 0-17.14 13.78-31.03 30.78-31.03 17 0 30.78 13.9 30.78 31.03C437.65 358.43 423.87 372.32 406.87 372.32zM499.22 486.08c-17.01 0-30.78-13.88-30.78-31.01 0-17.14 13.78-31.03 30.78-31.03 17 0 30.78 13.9 30.78 31.03C530 472.19 516.22 486.08 499.22 486.08zM499.22 393c-17.01 0-30.78-13.9-30.78-31.03 0-17.12 13.78-31.01 30.78-31.01 17 0 30.78 13.9 30.78 31.01C530 379.1 516.22 393 499.22 393z'/> </g></svg>",desk_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' viewBox='0 0 213.94 213.94' xml:space='preserve' enable-background='new 0 0 213.942 213.942'><g fill='%23fff'> <path d='M208.94 44.27H5c-2.76 0-5 2.24-5 5v10.3c0 2.76 2.24 5 5 5h6.58v16.32 47.6 26.95c-3.27 1.78-5.5 5.25-5.5 9.23 0 2.76 2.24 5 5 5h11c0.01 0 0.02 0 0.02 0 2.76 0 5-2.24 5-5 0-0.21-0.01-0.42-0.04-0.62 -0.22-3.72-2.38-6.91-5.48-8.6v-21.96h97.52v31.07c0 2.76 2.24 5 5 5h71.49c2.76 0 5-2.24 5-5V64.57h8.35c2.76 0 5-2.24 5-5V49.27C213.94 46.51 211.7 44.27 208.94 44.27zM186.07 100.83v51.78h-51.33v-51.78H186.07zM134.74 86.03V67.49h51.33v18.53H134.74zM21.58 75.89v-11.32h97.52v11.32H21.58z'/></g></svg>","door-handle_1":"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M476.69,353.103h-8.828v-62.526c0-36.565-29.642-66.207-66.207-66.207s-66.207,29.642-66.207,66.207v62.526h-8.828 c-4.875,0-8.828,3.952-8.828,8.828v97.103c0.034,29.238,23.728,52.931,52.966,52.966h61.793 c29.238-0.034,52.932-23.728,52.966-52.966v-97.103C485.517,357.056,481.565,353.103,476.69,353.103z M432.137,459.034h-60.963 c-4.875,0-8.828-3.952-8.828-8.828c0-4.875,3.952-8.828,8.828-8.828h60.963c4.875,0,8.828,3.952,8.828,8.828 C440.964,455.082,437.012,459.034,432.137,459.034z M432.137,414.897h-60.963c-4.875,0-8.828-3.952-8.828-8.828 c0-4.875,3.952-8.828,8.828-8.828h60.963c4.875,0,8.828,3.952,8.828,8.828C440.964,410.944,437.012,414.897,432.137,414.897z M450.207,353.103h-97.103v-62.526c0-26.814,21.737-48.552,48.552-48.552s48.552,21.737,48.552,48.552V353.103z'/> <circle cx='141.241' cy='326.621' r='8.828'/> <path d='M123.586,123.586c0,9.751,7.905,17.655,17.655,17.655h256c9.751,0,17.655-7.904,17.655-17.655 c0-9.751-7.904-17.655-17.655-17.655h-256C131.491,105.931,123.586,113.836,123.586,123.586z'/> <path d='M141.241,88.276h39.53c-10.016-11.308-24.424-17.743-39.53-17.655c-29.252,0-52.966,23.714-52.966,52.966 c0,29.252,23.713,52.966,52.966,52.966c15.105,0.084,29.512-6.35,39.53-17.655h-39.53c-19.501,0-35.31-15.809-35.31-35.31 C105.931,104.085,121.74,88.276,141.241,88.276z'/> <path d='M141.241,194.207c-39.003,0-70.621-31.618-70.621-70.621c0-39.003,31.618-70.621,70.621-70.621 c25.191-0.095,48.474,13.403,60.91,35.31H256V26.483C256,11.857,244.143,0,229.517,0H52.966 C38.339,0,26.483,11.857,26.483,26.483v441.379c0,14.626,11.857,26.483,26.483,26.483h176.552 c14.626,0,26.483-11.857,26.483-26.483V158.897h-53.848C189.716,180.804,166.432,194.302,141.241,194.207z M150.069,351.47 v28.116c0,4.875-3.952,8.828-8.828,8.828c-4.875,0-8.828-3.952-8.828-8.828V351.47c-12.161-4.27-19.464-16.694-17.279-29.397 c2.184-12.702,13.218-21.973,26.107-21.936c12.889-0.038,23.922,9.233,26.107,21.936 C169.533,334.776,162.23,347.2,150.069,351.47z'/> </g></svg>",door_open_1:"<svg xmlns='http://www.w3.org/2000/svg' id='svg' version='1.1' x='0' y='0' width='492.5' height='492.5' viewBox='0 0 492.5 492.5'> <g fill='%23fff' class='door_close'> <path d='M392.8 22L392.8 455.36 99.7 455.36 99.7 22 392.8 22zM153.5 231C144.94 231 138 237.94 138 246.5 138 255.06 144.94 262 153.5 262 162.06 262 169 255.06 169 246.5 169 237.94 162.06 231 153.5 231z'/> </g> <g fill='%23fff' class='door_open'> <path d='M184.65 0L184.65 21.72 99.7 21.72 99.7 455.08 131.11 455.08 131.11 53.12 184.65 53.12 184.65 492.5 392.8 455.08 392.8 393.84 392.8 37.5 184.65 0zM222.94 263.13C215.94 263.13 210.27 255.75 210.27 246.64 210.27 237.54 215.94 230.16 222.94 230.16 229.94 230.16 235.61 237.54 235.61 246.64 235.61 255.75 229.94 263.13 222.94 263.13z'/> </g></svg>",fire_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='533.33' height='533.33' viewBox='0 0 533.33 533.33' xml:space='preserve' enable-background='new 0 0 533.333 533.333'><g fill='%23fff'> <path d='M165.49 533.33c-35.54-73.96-16.62-116.34 10.7-156.27 29.92-43.73 37.63-87.01 37.63-87.01s23.52 30.57 14.11 78.39c41.55-46.25 49.39-119.94 43.12-148.16 93.91 65.63 134.05 207.74 79.96 313.05 287.7-162.78 71.56-406.34 33.93-433.77 12.54 27.44 14.92 73.88-10.42 96.42C331.64 33.33 225.58 0 225.58 0c12.54 83.88-45.47 175.6-101.4 244.13 -1.96-33.45-4.05-56.52-21.64-88.53C98.59 216.36 52.16 265.88 39.58 326.76 22.55 409.2 52.34 469.56 165.49 533.33z'/></g></svg>",fitnessbike_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='482.356px' height='482.356px' viewBox='0 0 482.356 482.356' style='enable-background:new 0 0 482.356 482.356;' xml:space='preserve'> <g fill='%23fff'> <path d='M156.777,295.579c-7.682,0-13.91,6.228-13.91,13.912c0,7.684,6.228,13.912,13.91,13.912 c7.685,0,13.914-6.229,13.914-13.912C170.69,301.806,164.462,295.579,156.777,295.579z'/> <path d='M478.281,44.204l-4.918-4.917c-5.434-5.434-14.238-5.432-19.672,0L416.77,76.209h-80.607 c-7.686,0-13.91,6.226-13.91,13.91v6.955c0,7.683,6.225,13.91,13.91,13.91h31.148l-68.475,164.374l-100.638-61.681 c-4.514-3.253-9.281-6.175-14.263-8.743l-0.299-0.155c-8.622-4.41-17.897-7.707-27.62-9.799l-20.829-49.222 c0,0,31.299-5.07,41.007-6.956c9.708-1.884,13.91-6.226,13.91-13.91v-20.285c0-7.682-6.226-13.91-13.91-13.91H44.048 c-7.683,0-13.91,6.228-13.91,13.91v27.242c0,7.684,6.227,13.91,13.91,13.91h64.971l19.778,46.744 c-60.816,1.831-109.562,51.67-109.562,112.931c0,49.639,32.014,91.757,76.512,106.935H13.91c-7.684,0-13.91,6.228-13.91,13.909 v6.956c0,7.682,6.227,13.91,13.91,13.91h372.094c7.682,0,13.91-6.229,13.91-13.91v-6.957c0-7.682-6.229-13.909-13.91-13.909 H327.08c22.525-10.38,38.168-33.118,38.168-59.553c0-23.456-12.346-43.981-30.854-55.59l0.018-0.064l-14.775-9.058l73.785-177.12 h31.414c0.098,0,0.186-0.025,0.279-0.029c3.66,0.078,7.342-1.253,10.135-4.046l43.031-43.031 C483.715,58.444,483.715,49.637,478.281,44.204z M211.259,399.471H126.64c-5.282,0-9.563-4.281-9.563-9.562 c0-5.283,4.28-9.563,9.563-9.563h16.284v-33.653c-15.093-5.622-25.847-20.148-25.847-37.2c0-21.926,17.774-39.701,39.699-39.701 c21.928,0,39.703,17.774,39.703,39.701c0,17.034-10.737,31.535-25.805,37.164v33.689h40.585c5.282,0,9.563,4.28,9.563,9.563 C220.822,395.19,216.541,399.471,211.259,399.471z'/> </g></svg>",floor_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 47.759 47.759' style='enable-background:new 0 0 47.759 47.759;' xml:space='preserve'><g fill='%23fff'> <path d='M46.814,44.587c-3.983-1.199-7.967-2.4-11.949-3.602c-5.262-1.586-10.524-3.172-15.787-4.758 c-0.34-0.102-0.68-0.205-1.02-0.307c-0.591-0.178-1.358-0.098-1.963-0.128c-3.001-0.151-6.002-0.304-9.003-0.456 c-1.933-0.098-3.866-0.195-5.8-0.294c0.43,0.431,0.861,0.861,1.291,1.291c0-3.823,0-7.646,0-11.468c0-6.154,0-12.308,0-18.462 c0-1.497,0-2.994,0-4.491c-0.43,0.43-0.861,0.861-1.291,1.291c3.158,0,6.316,0,9.474,0c6.382,0,12.764,0,19.146,0 c4.967,0,9.934,0,14.9,0c0.553,0,1.104,0,1.656,0c-0.43-0.43-0.861-0.861-1.291-1.291c0,4.979,0,9.959,0,14.938 c0,3.285,0,6.571,0,9.856c0,5.836,0,11.673,0,17.509c0,0.538,0,1.077,0,1.615c0,1.665,2.582,1.665,2.582,0 c0-4.436,0-8.869,0-13.305c0-4.467,0-8.936,0-13.402c0-4.956,0-9.912,0-14.868c0-0.781,0-1.562,0-2.343 c0-0.704-0.587-1.291-1.291-1.291c-3.158,0-6.316,0-9.475,0c-6.381,0-12.763,0-19.145,0c-4.967,0-9.934,0-14.901,0 c-0.552,0-1.104,0-1.656,0C0.587,0.621,0,1.208,0,1.912C0,5.735,0,9.557,0,13.38c0,6.154,0,12.308,0,18.462 c0,1.497,0,2.994,0,4.491c0,0.731,0.588,1.255,1.291,1.291c4.955,0.251,9.909,0.502,14.864,0.752c0.397,0.021,0.793,0.04,1.19,0.06 c0.275,0.015,0.591,0.144,0.031-0.024c0.377,0.114,0.754,0.228,1.131,0.341c2.21,0.666,4.42,1.332,6.631,1.998 c5.856,1.766,11.712,3.53,17.568,5.295c1.139,0.344,2.278,0.688,3.418,1.03C47.725,47.558,48.403,45.065,46.814,44.587z'/></g></svg>",fork_knife_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='380.72' height='380.72' viewBox='0 0 380.72 380.72' xml:space='preserve' enable-background='new 0 0 380.721 380.721'><g fill='%23fff'> <path d='M344.31 327.39l0.12-0.05c0 0-82.89-84.12-91.02-92.25 -5.04-1.49-34.53-14.45-35.04-38.83 12.58-14.42 30.88-28.27 57.91-28.54 0.05-0.02 0.19-0.04 0.26-0.04 12.22 0.33 24.56-3.72 34.38-12.3 0.69-0.6 2.3-2.25 2.3-2.25l67.52-85.09 -8.11-8.14 -82.6 87.45 -9.75-9.78 85.01-85.01 -7.15-7.1 -85.51 85.53 -8.09-8.09 85.53-85.53 -7.86-7.85 -85.52 85.52 -9.59-9.57 88.28-82.82 -7.41-7.41 -81.35 63.38c0 0-2.95 2.49-3.97 3.52 -11.17 11.16-15.96 26.31-14.36 40.89 -1.13 18.5-7.11 32.24-14.87 42.69C61.72 17.34 4.53 33.22 4.53 33.22L0 37.81c0 0 101.98 102.26 165 165.4 -22.11 22.13-128.7 128.72-128.7 128.72l0.01 0.02c-0.09 0.09-0.21 0.13-0.32 0.24 -7.62 7.62-7.59 19.96 0.01 27.57 7.6 7.61 19.98 7.61 27.57 0.02 0.12-0.12 0.16-0.24 0.23-0.31l0.02 0.02c0 0 106.72-106.69 128.71-128.66 11.53 11.54 19.22 19.24 20.73 20.75 9.34 9.39 103.38 103.43 103.38 103.43h0.12c0 0.12 0.1 0.22 0.21 0.27 7.6 7.66 20.08 7.66 27.66 0 7.7-7.59 7.7-20.02 0-27.66C344.53 327.5 344.42 327.46 344.31 327.39z'/></g></svg>",fridge_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 556.961 556.961' style='enable-background:new 0 0 556.961 556.961;' xml:space='preserve'> <g fill='%23fff'> <polygon points='96.863,0 96.863,193.725 387.451,193.725 387.451,108.971 411.667,108.971 411.667,193.725 460.098,193.725 460.098,0 '/> <polygon points='411.667,387.451 387.451,387.451 387.451,217.941 96.863,217.941 96.863,532.745 121.078,532.745 121.078,556.961 193.725,556.961 193.725,532.745 363.235,532.745 363.235,556.961 435.882,556.961 435.882,532.745 460.098,532.745 460.098,217.941 411.667,217.941 '/> </g></svg>",garage_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='112' height='112' viewBox='0 0 112 112' xml:space='preserve' enable-background='new 0 0 112 112'><g fill='%23fff'> <path d='M93.34 81.97v3.44c0 2.84-4.47 3.44-8.94 3.44h-5c-3.77 0-4.88-0.91-4.88-2.9 0-2.15 3.23-3.23 6.11-4.51 2.65-1.19 6.66-2.9 8.69-2.9C91.41 78.53 93.33 78.65 93.34 81.97zM79.33 108.64v-6.04H32.67v6.04c0 1.82-1.48 3.3-3.29 3.3h53.26C80.81 111.93 79.33 110.46 79.33 108.64zM109.41 38.66c-9.11-6.91-39.56-29.68-49.92-37.43 -2.08-1.55-4.89-1.55-6.96 0.01 -10.32 7.79-40.65 30.65-49.86 37.42C0.98 39.91 0 41.86 0 43.96v67.97h17.29c-1.82 0-3.29-1.48-3.29-3.3v-9.48V97.93 80.3c0-0.62 0.22-2.95 0.51-3.46 0 0 0.3-0.87 0.77-2.24h-3.73c-1.72 0-2.63-1.39-2.04-3.11l1.06-3.11c0.59-1.72 2.46-3.11 4.18-3.11h3.78c2.93-8.36 6.52-18.45 7.38-20.08 1.82-3.47 6.4-5.03 9.7-6.13 0 0 4.7-1.79 20.38-1.79 15.68 0 20.38 1.79 20.38 1.79 2.81 0.78 7.94 2.4 9.53 5.97 1.03 2.3 4.57 12.11 7.47 20.24h3.86c1.72 0 3.59 1.39 4.18 3.11l1.06 3.11c0.59 1.72-0.32 3.11-2.04 3.11h-3.75c0.49 1.38 0.79 2.24 0.79 2.24C97.79 77.35 98 79.67 98 80.3v17.63 1.23 9.48c0 1.82-1.47 3.3-3.29 3.3H112V43.9C112 41.83 111.06 39.91 109.41 38.66zM37.48 85.94c0-2.15-3.23-3.23-6.11-4.52 -2.65-1.18-6.66-2.9-8.69-2.9 -2.08 0-4.01 0.12-4.01 3.44v3.44c0 2.84 4.47 3.44 8.94 3.44h5C36.36 88.84 37.48 87.93 37.48 85.94zM86.29 66.52c-2.32-9.4-5.22-15.99-5.95-18.17 -0.06-0.05-0.61-4.17-24.34-4.17 -23.72 0-24.17 3.61-24.64 4.77 -0.59 1.61-3.26 7.36-5.72 17.57 0 0 10.09 3.41 30.36 3.41C76.27 69.93 86.29 66.52 86.29 66.52z'/></g></svg>",groundplan_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 151.91 151.91' style='enable-background:new 0 0 151.91 151.91;' xml:space='preserve'><g fill='%23fff'><path d='M143.972,150.268c-0.64,0-1.28-0.244-1.768-0.732c-0.977-0.977-0.977-2.559,0-3.535l1.107-1.107 H29.133L30.24,146c0.977,0.977,0.977,2.559,0,3.535c-0.976,0.977-2.56,0.977-3.535,0l-5.313-5.313 c-0.496-0.496-0.74-1.148-0.732-1.799c0-0.01,0-0.021,0-0.031c0-0.86,0.434-1.618,1.095-2.068l5.075-5.074 c0.976-0.977,2.56-0.977,3.535,0c0.977,0.977,0.977,2.559,0,3.535l-1.107,1.107h114.179l-1.107-1.107 c-0.977-0.977-0.977-2.559,0-3.535c0.976-0.977,2.56-0.977,3.535,0l5.313,5.313c0.497,0.496,0.74,1.148,0.732,1.799 c0,0.011,0,0.021,0,0.031c0,0.86-0.434,1.618-1.095,2.068l-5.075,5.074C145.252,150.024,144.612,150.268,143.972,150.268z M7.875,132.893c-0.86,0-1.619-0.435-2.068-1.096l-5.074-5.074c-0.977-0.977-0.977-2.559,0-3.535c0.976-0.977,2.56-0.977,3.535,0 l1.107,1.107V10.115l-1.107,1.107c-0.976,0.977-2.56,0.977-3.535,0c-0.977-0.977-0.977-2.559,0-3.535l5.313-5.313 c0.496-0.496,1.144-0.749,1.798-0.732c0.886,0.021,1.645,0.426,2.1,1.096l5.074,5.074c0.977,0.977,0.977,2.559,0,3.535 c-0.976,0.977-2.56,0.977-3.535,0l-1.107-1.107v114.18l1.107-1.107c0.976-0.977,2.56-0.977,3.535,0c0.977,0.977,0.977,2.559,0,3.535 l-5.313,5.313c-0.496,0.496-1.154,0.746-1.798,0.732C7.896,132.893,7.886,132.893,7.875,132.893z M149.41,125.82H28.597 c-1.381,0-2.5-1.119-2.5-2.5V4.143c0-1.381,1.119-2.5,2.5-2.5h72.194c1.381,0,2.5,1.119,2.5,2.5v48.523h46.118 c1.381,0,2.5,1.119,2.5,2.5v68.153C151.91,124.7,150.791,125.82,149.41,125.82z M103.184,120.82h43.726V57.666h-43.726V120.82z M55.292,120.82h42.893V87.332H55.292V120.82z M31.097,120.82h19.194V87.332H31.097V120.82z M52.792,82.332h45.393V55.166 c0-0.253,0.038-0.497,0.107-0.728V28.332H31.097v54H52.792z M67.141,23.332h31.151V6.643H67.141V23.332z M31.097,23.332h31.043 V6.643H31.097V23.332z'/></g></svg>",hanger_1:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 315 315' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 315 315'><g fill='%23fff'> <path d='m301.952,202.988l-114.422-65.263c-6.537-3.755-14.663-6.248-23.03-7.158v-7.932c12.986-3.154 22.656-14.88 22.656-28.822 0-16.352-13.304-29.656-29.656-29.656s-29.656,13.304-29.656,29.656c0,3.866 3.134,7 7,7 3.866,0 7-3.134 7-7 0-8.633 7.023-15.656 15.656-15.656s15.656,7.023 15.656,15.656-7.023,15.656-15.656,15.656c-3.866,0-7,3.134-7,7v14.097c-8.368,0.909-16.484,3.397-22.994,7.14l-114.296,65.189c-8.148,4.503-13.21,13.082-13.21,22.386 0,14.096 11.467,25.563 25.563,25.563h263.874c14.096,0 25.564-11.467 25.564-25.563-0.001-9.306-5.032-17.867-13.049-22.293zm-12.516,33.856h-263.873c-6.376,0-11.563-5.187-11.563-11.563 0-4.211 2.292-8.094 6.063-10.18l114.398-65.247c2.317-1.332 10.828-5.679 23.038-5.679 12.203,0 20.734,4.354 23.077,5.699l114.523,65.321c3.639,2.01 5.899,5.874 5.899,10.085 0.002,6.377-5.185,11.564-11.562,11.564z'/></g></svg>",heater_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M83.32,423.132c-5.261,0-10.357-0.711-15.209-2.022v37.279h30.417V421.11C93.676,422.421,88.581,423.132,83.32,423.132z'/> <path d='M428.68,423.132c-5.261,0-10.357-0.711-15.209-2.022v37.279h30.417V421.11 C439.036,422.421,433.941,423.132,428.68,423.132z'/> <path d='M169.66,53.611c-15.418,0-27.961,12.544-27.961,27.961v283.181c0,15.419,12.544,27.961,27.961,27.961 c15.417,0,27.961-12.544,27.961-27.961V81.573C197.621,66.155,185.077,53.611,169.66,53.611z'/> <path d='M256,53.611c-15.418,0-27.961,12.544-27.961,27.961v283.181c0,15.419,12.544,27.961,27.961,27.961 s27.961-12.544,27.961-27.961V81.573C283.961,66.155,271.417,53.611,256,53.611z'/> <path d='M342.34,53.611c-15.418,0-27.961,12.544-27.961,27.961v283.181c0,15.419,12.544,27.961,27.961,27.961 c15.417,0,27.961-12.544,27.961-27.961V81.573C370.302,66.155,357.759,53.611,342.34,53.611z'/> <path d='M83.32,53.612c-15.418,0-27.961,12.543-27.961,27.961v41.998H24.941H0v49.803h24.941h30.417v191.379 c0,15.419,12.544,27.961,27.961,27.961c15.417,0,27.962-12.544,27.962-27.961V81.573C111.281,66.155,98.738,53.612,83.32,53.612z' /> <path d='M487.059,91.355h-5.476v32.215h-24.941V81.573c0-15.418-12.544-27.961-27.961-27.961 c-15.417,0-27.961,12.544-27.961,27.961v283.18c0,15.419,12.543,27.961,27.961,27.961s27.961-12.544,27.961-27.961v-191.38h24.941 v32.215h5.476H512v-32.215V123.57V91.355H487.059z'/> </g></svg>",history_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 448 448' style='enable-background:new 0 0 448 448;' xml:space='preserve'> <g fill='%23fff'> <polygon points='234.667,138.667 234.667,245.333 325.973,299.52 341.333,273.6 266.667,229.333 266.667,138.667 '/> <path d='M255.893,32C149.76,32,64,117.973,64,224H0l83.093,83.093l1.493,3.093L170.667,224h-64 c0-82.453,66.88-149.333,149.333-149.333S405.333,141.547,405.333,224S338.453,373.333,256,373.333 c-41.28,0-78.507-16.853-105.493-43.84L120.32,359.68C154.987,394.453,202.88,416,255.893,416C362.027,416,448,330.027,448,224 S362.027,32,255.893,32z'/> </g></svg>",hokeyplayer_1:"<svg id='Capa_1' enable-background='new 0 0 512 512' height='512' viewBox='0 0 512 512' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m353.619 262.961c-11.666 4.532-24.338 7.039-37.619 7.039h-120c-13.281 0-25.953-2.507-37.619-7.039 9.781 25.197 28.398 45.489 52.619 56.931v10.108h-14.676c-.005 14.802 4.991 28.841 14.998 40.005 22.793 25.4 66.548 25.415 89.341.015 10.012-11.171 15.009-25.21 15.009-40.02h-14.672v-10.107c24.221-11.443 42.838-31.734 52.619-56.932z'/><path d='m389.482 180h-266.964c6.969 34.191 37.266 60 73.482 60h120c36.216 0 66.513-25.809 73.482-60z'/><path d='m241 0h30v90h-30z'/><path d='m197.278 397.516c-2.813-2.443-5.781-4.684-8.295-7.487-14.797-16.514-22.419-37.974-22.474-60.029h-30.509c-41.353 0-75 33.647-75 75v15h71.221c19.131 0 37.661-5.61 53.569-16.216 3.657-2.441 7.63-4.235 11.488-6.268z'/><path d='m121 120h270v30h-270z'/><path d='m61 497c0 8.291 6.709 15 15 15h45v-62h-60z'/><path d='m280.895 416.008c-8.068 2.348-16.351 3.992-24.895 3.992s-16.829-1.644-24.897-3.992c-10.17 2.714-19.852 6.855-28.672 12.737-15.597 10.395-33.107 17.117-51.431 19.852v63.403h210v-63.403c-18.323-2.736-35.834-9.457-51.431-19.852-8.82-5.881-18.504-10.023-28.674-12.737z'/><path d='m391 512h45c8.291 0 15-6.709 15-15v-47h-60z'/><path d='m211 1.516c-45.807 6.641-81.843 42.677-88.484 88.484h88.484z'/><path d='m376 330h-30.513c-.055 22.072-7.681 43.546-22.5 60.059-2.505 2.792-5.466 5.023-8.267 7.456 3.86 2.034 7.833 3.829 11.49 6.27 15.908 10.605 34.438 16.215 53.569 16.215h71.221v-15c0-41.353-33.647-75-75-75z'/><path d='m301 1.516v88.484h88.484c-6.641-45.807-42.677-81.843-88.484-88.484z'/></g></svg>",hood_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512.003 512.003' style='enable-background:new 0 0 512.003 512.003;' xml:space='preserve'> <g fill='%23fff'> <polygon points='348.506,167.415 163.493,167.415 11.887,236.943 500.112,236.943'/> <rect y='267.359' width='512.003' height='78.324'/> <rect x='180.344' y='18.604' width='151.305' height='118.394'/> <path d='M152.285,411.41c0-6.791,1.288-9.476,3.419-13.923c2.704-5.641,6.409-13.367,6.409-27.074h-30.417 c0,6.792-1.288,9.476-3.419,13.924c-2.705,5.641-6.409,13.366-6.409,27.073c0,13.707,3.704,21.433,6.409,27.073 c2.132,4.447,3.419,7.132,3.419,13.924c0,6.79-1.288,9.474-3.419,13.92c-2.705,5.64-6.409,13.366-6.409,27.071h30.417 c0-6.79,1.288-9.474,3.419-13.92c2.705-5.64,6.409-13.365,6.409-27.071c0-13.707-3.704-21.433-6.409-27.073 C153.572,420.887,152.285,418.202,152.285,411.41z'/> <path d='M228.292,411.41c0-6.791,1.288-9.476,3.419-13.923c2.704-5.641,6.409-13.367,6.409-27.074h-30.417 c0,6.792-1.288,9.476-3.419,13.924c-2.705,5.641-6.409,13.366-6.409,27.073c0,13.707,3.704,21.433,6.409,27.073 c2.132,4.447,3.419,7.132,3.419,13.924c0,6.79-1.288,9.474-3.419,13.92c-2.705,5.64-6.409,13.366-6.409,27.071h30.417 c0-6.79,1.288-9.474,3.419-13.92c2.705-5.64,6.409-13.365,6.409-27.071c0-13.707-3.704-21.433-6.409-27.073 C229.579,420.887,228.292,418.202,228.292,411.41z'/> <path d='M304.297,411.41c0-6.791,1.288-9.476,3.419-13.923c2.705-5.641,6.409-13.367,6.409-27.074h-30.417 c0,6.792-1.288,9.476-3.419,13.924c-2.705,5.641-6.409,13.366-6.409,27.073c0,13.707,3.704,21.433,6.409,27.073 c2.132,4.447,3.419,7.132,3.419,13.924c0,6.79-1.288,9.474-3.419,13.92c-2.705,5.64-6.409,13.366-6.409,27.071h30.417 c0-6.79,1.288-9.474,3.419-13.92c2.705-5.64,6.409-13.365,6.409-27.071c0-13.707-3.704-21.433-6.409-27.073 C305.584,420.887,304.297,418.202,304.297,411.41z'/> <path d='M380.305,411.41c0-6.791,1.288-9.476,3.419-13.923c2.705-5.641,6.409-13.367,6.409-27.074h-30.417 c0,6.792-1.288,9.476-3.419,13.924c-2.705,5.641-6.409,13.366-6.409,27.073c0,13.707,3.704,21.433,6.409,27.073 c2.132,4.447,3.419,7.132,3.419,13.924c0,6.79-1.288,9.474-3.419,13.92c-2.705,5.64-6.409,13.366-6.409,27.071h30.417 c0-6.79,1.288-9.474,3.419-13.92c2.705-5.64,6.409-13.365,6.409-27.071c0-13.707-3.704-21.433-6.409-27.073 C381.591,420.887,380.305,418.202,380.305,411.41z'/> </g></svg>",house_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='500' height='500' viewBox='0 0 500 500' xml:space='preserve' enable-background='new 0 0 510 510'> <g fill='%23fff'> <path d='M51.19 500L51.19 200 250.34 0 449.49 200 449.49 500 51.19 500z'/> <path d='M40.5 526.5L40.5 209.7 251.7-1.5 462.9 209.7 462.9 526.5 40.5 526.5z'/> </g></svg>",information_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 330 330' style='enable-background:new 0 0 330 330;' xml:space='preserve'><g fill='%23fff'> <path d='M165,0C74.019,0,0,74.02,0,165.001C0,255.982,74.019,330,165,330s165-74.018,165-164.999C330,74.02,255.981,0,165,0z M165,300c-74.44,0-135-60.56-135-134.999C30,90.562,90.56,30,165,30s135,60.562,135,135.001C300,239.44,239.439,300,165,300z'/> <path d='M164.998,70c-11.026,0-19.996,8.976-19.996,20.009c0,11.023,8.97,19.991,19.996,19.991 c11.026,0,19.996-8.968,19.996-19.991C184.994,78.976,176.024,70,164.998,70z'/> <path d='M165,140c-8.284,0-15,6.716-15,15v90c0,8.284,6.716,15,15,15c8.284,0,15-6.716,15-15v-90C180,146.716,173.284,140,165,140z '/></g></svg>",library_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M403.064,32.681H108.936c-4.512,0-8.17,3.658-8.17,8.17v121.646c0,4.512,3.658,8.17,8.17,8.17h294.128 c4.513,0,8.17-3.658,8.17-8.17V40.851C411.234,36.339,407.577,32.681,403.064,32.681z M166.128,154.327h-16.34V81.702h16.34 V154.327z M296.851,154.327h-16.34V81.702h16.34V154.327z M362.213,154.327h-16.34V81.702h16.34V154.327z M394.894,154.327h-16.34 V73.532c0-4.512-3.657-8.17-8.17-8.17h-32.681c-4.513,0-8.17,3.658-8.17,8.17v80.795h-16.34V73.532c0-4.512-3.657-8.17-8.17-8.17 H272.34c-4.513,0-8.17,3.658-8.17,8.17v80.795h-81.702V73.532c0-4.512-3.658-8.17-8.17-8.17h-32.681 c-4.512,0-8.17,3.658-8.17,8.17v80.795h-16.34V49.021h277.787V154.327z'/> <path d='M435.745,0H76.255c-4.512,0-8.17,3.658-8.17,8.17v495.66c0,4.512,3.658,8.17,8.17,8.17h359.489 c4.513,0,8.17-3.658,8.17-8.17V8.17C443.915,3.658,440.258,0,435.745,0z M427.574,495.66H84.426V16.34h343.149V495.66z'/> <path d='M403.064,341.333H108.936c-4.512,0-8.17,3.658-8.17,8.17v44.482c0,4.512,3.658,8.17,8.17,8.17 c4.512,0,8.17-3.658,8.17-8.17v-36.312h277.787v105.305h-16.34v-80.795c0-4.512-3.657-8.17-8.17-8.17h-32.681 c-4.513,0-8.17,3.658-8.17,8.17v80.795h-16.34v-80.795c0-4.512-3.657-8.17-8.17-8.17H272.34c-4.513,0-8.17,3.658-8.17,8.17v80.795 h-16.34v-80.795c0-4.512-3.658-8.17-8.17-8.17h-32.681c-4.512,0-8.17,3.658-8.17,8.17v80.795h-81.702v-36.312 c0-4.512-3.658-8.17-8.17-8.17c-4.512,0-8.17,3.658-8.17,8.17v44.482c0,4.512,3.658,8.17,8.17,8.17h294.128 c4.513,0,8.17-3.658,8.17-8.17V349.503C411.234,344.991,407.577,341.333,403.064,341.333z M231.489,462.979h-16.34v-72.624h16.34 V462.979z M296.851,462.979h-16.34v-72.624h16.34V462.979z M362.213,462.979h-16.34v-72.624h16.34V462.979z'/> <path d='M403.064,187.007H108.936c-4.512,0-8.17,3.658-8.17,8.17v121.646c0,4.511,3.658,8.169,8.17,8.169h294.128 c4.513,0,8.17-3.658,8.17-8.17V195.178C411.234,190.666,407.577,187.007,403.064,187.007z M166.128,308.652h-16.34v-72.625h16.34 V308.652z M231.489,308.652h-16.34v-72.625h16.34V308.652z M296.851,308.652h-16.34v-72.625h16.34V308.652z M362.213,308.652 h-16.34v-72.625h16.34V308.652z M394.894,308.653h-16.34v-80.795c0-4.512-3.657-8.17-8.17-8.17h-32.681 c-4.513,0-8.17,3.658-8.17,8.17v80.795h-16.34v-80.795c0-4.512-3.657-8.17-8.17-8.17H272.34c-4.513,0-8.17,3.658-8.17,8.17v80.795 h-16.34v-80.795c0-4.512-3.658-8.17-8.17-8.17h-32.681c-4.512,0-8.17,3.658-8.17,8.17v80.795h-16.34v-80.795 c0-4.512-3.658-8.17-8.17-8.17h-32.681c-4.512,0-8.17,3.658-8.17,8.17v80.795h-16.34V203.348h277.787V308.653z'/> </g></svg>",light_dim_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='46.999px' height='46.999px' viewBox='0 0 46.999 46.999' style='enable-background:new 0 0 46.999 46.999;' xml:space='preserve'> <g fill='%23fff'> <path d='M27.402,28.439c0-3.198,3.809-4.595,3.809-10.086c0-4.625-3.912-8.373-8.738-8.373c-4.822,0-8.739,3.748-8.739,8.373 c0,5.491,3.816,6.888,3.816,10.086c0,0.785,0.6,1.519,1.508,2.065c-0.189,0.152-0.295,0.324-0.295,0.51 c0,0.24,0.191,0.466,0.521,0.666c-0.308,0.191-0.488,0.412-0.488,0.646c0,0.237,0.188,0.461,0.496,0.653 c-0.319,0.187-0.509,0.415-0.509,0.655c0,0.294,0.281,0.561,0.743,0.777c-0.184,0.168-0.287,0.344-0.287,0.532 c0,0.56,0.872,1.037,2.102,1.226c0.216,0.395,0.647,0.676,1.16,0.676c0.512,0,0.944-0.278,1.159-0.676 c1.234-0.187,2.115-0.666,2.115-1.226c0-0.187-0.099-0.36-0.272-0.522c0.478-0.217,0.754-0.488,0.754-0.789 c0-0.236-0.183-0.459-0.498-0.653c0.324-0.19,0.513-0.414,0.513-0.653c0-0.248-0.191-0.475-0.521-0.668 c0.308-0.191,0.487-0.414,0.487-0.646c0-0.188-0.12-0.372-0.323-0.527C26.812,29.943,27.402,29.22,27.402,28.439z M25.12,28.241 c-0.302,0.336-1.366,0.881-2.644,0.881c-1.278,0-2.349-0.545-2.643-0.881c-0.065-1.984-1.052-3.434-1.924-4.711 c-0.972-1.422-1.889-2.769-1.889-5.176c0-3.36,2.892-6.085,6.451-6.085s6.454,2.725,6.454,6.085c0,2.407-0.917,3.754-1.889,5.178 C26.166,24.81,25.179,26.255,25.12,28.241z'/> <path d='M36.822,20.124l3.938,6.563c0.566,0.941,1.491,0.941,2.055,0l3.938-6.562c0.563-0.942,0.128-1.713-0.972-1.713h-1.43 C42.04,8.463,33.113,1.026,22.473,1.026C10.081,1.026,0,11.107,0,23.499c0,12.393,10.081,22.474,22.473,22.474 c10.563,0,19.442-7.327,21.835-17.164c-0.689,0.694-1.568,1.081-2.52,1.081h-0.001c-0.999,0-1.919-0.432-2.624-1.196 c-2.217,7.108-8.861,12.285-16.691,12.285c-9.638,0-17.479-7.842-17.479-17.479c0-9.637,7.841-17.479,17.479-17.479 c7.864,0,14.503,5.232,16.688,12.391h-1.368C36.693,18.412,36.256,19.182,36.822,20.124z'/> </g></svg>",light_off_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='47' height='47' viewBox='0 0 47 47'> <g fill='%23fff'> <path d='M23.5 11.45C17.11 11.45 11.94 16.41 11.94 22.53 11.94 29.79 16.98 31.64 16.98 35.87 16.98 36.92 17.78 37.89 18.98 38.6 18.73 38.81 18.59 39.04 18.59 39.28 18.59 39.6 18.84 39.9 19.28 40.16 18.87 40.41 18.63 40.7 18.63 41.02 18.63 41.33 18.88 41.62 19.29 41.88 18.87 42.13 18.62 42.43 18.62 42.75 18.62 43.14 18.98 43.49 19.6 43.78 19.36 44 19.22 44.24 19.22 44.49 19.22 45.23 20.38 45.85 22 46.11 22.28 46.63 22.86 47 23.53 47 24.21 47 24.78 46.64 25.07 46.11 26.71 45.86 27.87 45.23 27.87 44.49 27.87 44.24 27.74 44.01 27.51 43.79 28.13 43.5 28.51 43.14 28.51 42.75 28.51 42.44 28.27 42.14 27.85 41.89 28.27 41.63 28.52 41.34 28.52 41.02 28.52 40.7 28.27 40.4 27.83 40.14 28.24 39.88 28.48 39.59 28.48 39.28 28.48 39.03 28.33 38.8 28.06 38.58 29.24 37.87 30.03 36.91 30.03 35.87 30.03 31.64 35.06 29.79 35.06 22.53 35.06 16.41 29.89 11.45 23.5 11.45zM29.54 29.38C28.39 31.07 27.08 32.99 27 35.61 26.61 36.05 25.19 36.77 23.5 36.77 21.81 36.77 20.4 36.05 20 35.61 19.92 32.98 18.62 31.07 17.47 29.38 16.18 27.49 14.96 25.71 14.96 22.53 14.96 18.09 18.79 14.47 23.5 14.47 28.21 14.47 32.04 18.09 32.04 22.53 32.04 25.71 30.82 27.5 29.54 29.38z'/> </g></svg>",light_on_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='47' height='47' viewBox='0 0 47 47' xml:space='preserve' enable-background='new 0 0 47 47'><g fill='%23fff'> <path d='M23.5 11.45c-6.38 0-11.56 4.96-11.56 11.08 0 7.27 5.05 9.12 5.05 13.34 0 1.05 0.8 2.02 2 2.73 -0.25 0.21-0.39 0.44-0.39 0.68 0 0.32 0.25 0.62 0.69 0.88 -0.41 0.25-0.64 0.54-0.64 0.86 0 0.31 0.24 0.61 0.66 0.86 -0.43 0.26-0.67 0.56-0.67 0.87 0 0.39 0.37 0.74 0.98 1.03 -0.24 0.22-0.37 0.45-0.37 0.7 0 0.74 1.15 1.37 2.77 1.62C22.28 46.63 22.86 47 23.53 47c0.67 0 1.25-0.36 1.54-0.89 1.64-0.25 2.8-0.88 2.8-1.62 0-0.25-0.13-0.48-0.36-0.69 0.63-0.29 1-0.65 1-1.04 0-0.31-0.24-0.61-0.66-0.86 0.43-0.26 0.67-0.55 0.67-0.87 0-0.32-0.25-0.62-0.69-0.88 0.41-0.25 0.65-0.54 0.65-0.85 0-0.25-0.15-0.48-0.42-0.7 1.18-0.71 1.97-1.67 1.97-2.71 0-4.23 5.04-6.08 5.04-13.34C35.06 16.41 29.89 11.45 23.5 11.45zM29.54 29.38c-1.15 1.69-2.45 3.6-2.53 6.23 -0.4 0.44-1.81 1.16-3.5 1.16 -1.69 0-3.1-0.72-3.5-1.16 -0.08-2.63-1.38-4.54-2.54-6.23 -1.29-1.89-2.5-3.67-2.5-6.85 0-4.44 3.83-8.05 8.54-8.05 4.71 0 8.54 3.61 8.54 8.05C32.04 25.71 30.82 27.5 29.54 29.38z'/> <path class='svg_state' d='M23.5 7.56c0.83 0 1.51-0.9 1.51-2V2c0-1.1-0.68-2-1.51-2s-1.51 0.9-1.51 2v3.56C21.99 6.67 22.67 7.56 23.5 7.56z'/> <path class='svg_state' d='M15.75 9.64c0.72-0.42 0.86-1.54 0.31-2.49l-1.78-3.09c-0.55-0.95-1.59-1.39-2.31-0.98 -0.72 0.42-0.86 1.54-0.31 2.49l1.78 3.09C13.99 9.62 15.03 10.06 15.75 9.64z'/> <path class='svg_state' d='M9.1 13.01L6.01 11.23c-0.95-0.55-2.07-0.41-2.49 0.31 -0.42 0.72 0.02 1.76 0.98 2.31l3.09 1.78c0.95 0.55 2.07 0.41 2.49-0.31C10.49 14.6 10.05 13.56 9.1 13.01z'/> <path class='svg_state' d='M42.5 32.3l-3.09-1.78c-0.95-0.55-2.07-0.41-2.49 0.31 -0.42 0.72 0.02 1.76 0.98 2.31l3.08 1.78c0.95 0.55 2.07 0.41 2.49-0.31C43.9 33.88 43.46 32.85 42.5 32.3z'/> <path class='svg_state' d='M7.99 23.07c0-0.83-0.9-1.51-2-1.51H2.43c-1.1 0-2 0.68-2 1.51 0 0.83 0.9 1.51 2 1.51h3.56C7.09 24.58 7.99 23.9 7.99 23.07z'/> <path class='svg_state' d='M44.57 21.56h-3.56c-1.1 0-2 0.68-2 1.51 0 0.83 0.9 1.51 2 1.51h3.56c1.1 0 2-0.68 2-1.51C46.57 22.24 45.67 21.56 44.57 21.56z'/> <path class='svg_state' d='M7.58 30.51l-3.09 1.78c-0.95 0.55-1.39 1.59-0.98 2.31 0.42 0.72 1.54 0.86 2.49 0.31l3.09-1.78c0.95-0.55 1.39-1.59 0.98-2.31C9.65 30.1 8.54 29.96 7.58 30.51z'/> <path class='svg_state' d='M39.42 15.63l3.09-1.78c0.95-0.55 1.39-1.59 0.98-2.31 -0.42-0.72-1.54-0.86-2.49-0.31l-3.08 1.78c-0.95 0.55-1.39 1.59-0.98 2.31C37.35 16.04 38.47 16.18 39.42 15.63z'/> <path class='svg_state' d='M35.04 3.09c-0.72-0.42-1.76 0.02-2.31 0.98l-1.78 3.09c-0.55 0.95-0.41 2.07 0.31 2.49 0.72 0.42 1.76-0.02 2.31-0.98l1.78-3.09C35.9 4.63 35.76 3.51 35.04 3.09z'/></g></svg>",lock_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' viewBox='0 0 23.3 23.3' xml:space='preserve'><g fill='%23fff'> <path d='M18.71 10.25V7.06C18.72 3.17 15.55 0 11.66 0 7.76 0 4.59 3.17 4.59 7.06v3.19H3.08v13.06h17.15V10.25H18.71zM7.25 7.06c0-2.42 1.97-4.4 4.4-4.4 2.42 0 4.4 1.97 4.4 4.4v3.19H7.25V7.06zM12.87 19.72h-2.42l0.36-3.58c-0.45-0.28-0.75-0.78-0.75-1.35 0-0.88 0.71-1.59 1.6-1.59 0.88 0 1.59 0.71 1.59 1.59 0 0.57-0.3 1.07-0.75 1.35L12.87 19.72z'/></g></svg>",lunchbox_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512.001 512.001' style='enable-background:new 0 0 512.001 512.001;' xml:space='preserve'> <g fill='%23fff'> <path d='M504.447,60.308H375.456c-4.172,0-7.554,3.381-7.554,7.554v70.614c0,0.002,0,0.003,0,0.005v138.265 c-1.328-2.093-2.896-4.061-4.696-5.862c-1.659-1.66-3.461-3.123-5.375-4.388v-88.241c0-15.059-12.251-27.311-27.312-27.311 h-52.103c-0.403-36.413-30.135-65.916-66.641-65.916h-65.719c-36.508,0-66.24,29.502-66.642,65.916H27.312 C12.252,150.943,0,163.194,0,178.253v200.376c0,15.059,12.252,27.312,27.312,27.312h262.576 c12.058,26.933,39.095,45.752,70.461,45.752s58.404-18.82,70.462-45.752h53.61c15.207,0,27.579-12.372,27.579-27.579V138.48 c0-0.002,0-0.003,0-0.005V67.861C512,63.689,508.619,60.308,504.447,60.308z M352.523,281.565 c4.537,4.538,6.432,10.985,5.227,17.142c-0.303,0.059-0.606,0.115-0.911,0.159c-0.082,0.012-0.164,0.024-0.245,0.036 c-5.782,0.784-11.851-1.253-15.989-5.368c-4.447-4.422-6.467-11.04-5.254-17.189c0.082-0.016,0.167-0.023,0.25-0.038 c3.383-0.614,6.899-0.263,10.105,0.923C348.249,278.171,350.596,279.637,352.523,281.565z M146.057,100.135h65.719 c28.178,0,51.148,22.724,51.547,50.808h-22.052c-0.397-15.926-13.476-28.76-29.496-28.76h-65.719 c-16.02,0-29.1,12.834-29.497,28.76H94.508C94.908,122.858,117.878,100.135,146.057,100.135z M226.136,150.943h-94.44 c0.392-7.591,6.673-13.653,14.362-13.653h65.719C219.463,137.29,225.744,143.352,226.136,150.943z M27.312,390.833v0.001 c-6.73,0-12.205-5.475-12.205-12.205V178.253c0-6.729,5.475-12.203,12.205-12.203h60.042h37.837h107.451h37.836h60.043 c6.73,0,12.205,5.475,12.205,12.203v82.824c-1.212-0.129-2.436-0.2-3.671-0.2c-0.127,0-0.255,0.007-0.382,0.009 c-0.089,0.001-0.177,0.004-0.267,0.006c-4.886,0.09-11.246,0.731-14.69,4.618c-1.635,1.846-2.465,4.267-2.999,6.675 c-2.302,10.376,0.395,21.818,7.285,29.937c0.257,0.303,0.53,0.594,0.799,0.889c0.228,0.251,0.442,0.511,0.679,0.755 c-0.373,0.161-0.737,0.337-1.106,0.504c-4.561,2.068-8.929,4.578-13.001,7.495v-97.051c0-11.751-9.56-21.311-21.312-21.311H63.775 c-11.751,0-21.311,9.56-21.311,21.311v127.451c0,11.751,9.56,21.312,21.311,21.312h220.191c-0.007,0.052-0.014,0.105-0.02,0.157 c-1.17,8.858-0.97,17.929,0.862,26.686c0.035,0.17,0.059,0.342,0.097,0.512H27.312z M296.708,330.809 c-1.17,1.705-2.272,3.456-3.301,5.248c-2.059,3.586-3.833,7.338-5.288,11.209c-0.137,0.363-0.269,0.73-0.404,1.104H63.775 c-3.421,0-6.203-2.784-6.203-6.204V214.717c0-3.421,2.782-6.203,6.203-6.203h230.283c3.421,0,6.204,2.782,6.204,6.203v111.325 c0,0.43-1.349,1.717-1.659,2.13c-0.617,0.823-1.218,1.658-1.802,2.504C296.77,330.72,296.739,330.764,296.708,330.809z M422.263,377.512c-0.889,16.934-8.703,33.299-21.98,44.485c-11.123,9.371-25.387,14.589-39.934,14.589 c-21.849,0-42.492-11.893-53.553-30.721c-10.611-18.058-11.231-41.071-1.658-59.71c7.5-14.603,21.007-25.994,36.684-30.865 c0.612-0.189,1.227-0.372,1.847-0.543c0.266-0.073,0.532-0.144,0.8-0.214c0.628-0.165,1.258-0.32,1.895-0.466 c0.267-0.062,0.535-0.12,0.804-0.178c0.333-0.072,0.67-0.134,1.006-0.2c1.922,0.331,3.885,0.511,5.877,0.511 c3.534,0,7.002-0.545,10.341-1.605c3.146,0.201,6.221,0.638,9.215,1.283c0.073,0.018,0.143,0.042,0.218,0.058 c21.172,4.627,38.718,20.852,45.492,41.363C421.712,362.552,422.653,370.087,422.263,377.512z M496.893,378.363 c0,6.878-5.595,12.471-12.471,12.471h-48.626c0.036-0.17,0.061-0.342,0.096-0.512c2.741-13.153,1.987-26.999-2.158-39.78 c-3.342-10.303-8.884-19.857-16.154-27.885c-7.249-8.003-16.181-14.446-26.069-18.787c-0.771-0.339-8.499-2.925-8.499-3.146 V146.029h113.882V378.363z M496.893,130.922H383.01V75.415h113.882V130.922z'/> </g></svg>",microwave_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='45px' height='45px' viewBox='0 0 45 45' style='enable-background:new 0 0 45 45;' xml:space='preserve'><g fill='%23fff'> <path d='M43.373,8.675H1.627C0.729,8.675,0,9.403,0,10.301V34.7c0,0.897,0.729,1.625,1.627,1.625h41.746 c0.898,0,1.627-0.728,1.627-1.625V10.301C45,9.403,44.271,8.675,43.373,8.675z M36.186,14.796h2.541v2.541h-2.541V14.796z M36.186,17.956h2.541v2.541h-2.541V17.956z M36.186,21.112h2.541v2.542h-2.541V21.112z M32.938,14.796h2.543v2.541h-2.543V14.796z M32.938,17.956h2.543v2.541h-2.543V17.956z M30.091,33.073h-2.813c0.445-0.251,0.758-0.843,0.758-1.529h-5.288 c2.704-1.651,4.476-4.365,4.476-7.438H6.076c0,3.073,1.771,5.787,4.475,7.438H5.264c0,0.688,0.312,1.278,0.754,1.529H3.253V11.927 h26.838V33.073L30.091,33.073z M32.938,21.112h2.543v2.542h-2.543V21.112z M37.389,32.236c-1.535,0-2.779-1.243-2.779-2.776 c0-1.535,1.244-2.778,2.779-2.778c1.533,0,2.777,1.243,2.777,2.778C40.166,30.993,38.922,32.236,37.389,32.236z M41.973,23.654 h-2.541v-2.542h2.541V23.654z M41.973,20.497h-2.541v-2.541h2.541V20.497z M41.973,17.337h-2.541v-2.541h2.541V17.337z'/></g></svg>",mower_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 511.999 511.999' style='enable-background:new 0 0 511.999 511.999;' xml:space='preserve'> <g fill='%23fff'> <path d='M226.507,216.026l-74.851-11.99l-24.68-54.146l36.791,40.874v-55.647c0-16.945-13.737-30.682-30.682-30.682H78.371 c-16.945,0-30.682,13.737-30.682,30.682c0,0-1.309,147.1-0.749,151.613c2.182,17.603,10.679,86.141,10.679,86.141l-43.075,104.55 c-5.266,12.784,0.827,27.415,13.61,32.682c12.779,5.267,27.415-0.825,32.682-13.609l45.582-110.635 c1.643-3.988,2.229-8.335,1.698-12.617l-7.833-63.183h19.443l7.049,53.972l-24.934,117.743 c-2.864,13.525,5.778,26.812,19.304,29.677c13.525,2.864,26.812-5.78,29.677-19.304l25.821-121.927 c0.586-2.77,0.699-5.62,0.332-8.429l-12.518-95.84c-0.012-0.091-0.029-0.18-0.042-0.271l-33.667-5.393 c-17.285-2.769-27.317-16.863-28.829-24.44l-12.524-62.732l27.254,59.792c2.933,6.433,8.993,11.351,16.475,12.55 c26.857,4.301,59.61,9.548,86.453,13.847c0.001,0,0.002,0,0.003,0c11.98,1.918,23.193-6.253,25.101-18.173 C246.594,229.179,238.457,217.94,226.507,216.026z'/> <circle cx='105.971' cy='45.418' r='45.418'/> <path d='M494.522,447.506v-10.405c0-4.408-2.738-8.351-6.867-9.893c-170.711-63.685-159.548-59.866-162.429-59.853 l-65.828-123.286c-1.58,8.974-6.371,16.81-13.161,22.304l58.53,109.619l-18.412,8.789l-58.967-110.439 c-6.63,0.784-9.743-0.133-26.581-2.831l66.498,124.541c-1.051,1.889-0.163-1.253-11.077,46.649 c-4.829,7.105-7.656,15.677-7.656,24.896c0,24.484,19.918,44.402,44.402,44.402c21.088,0,38.778-14.782,43.282-34.526h75.408 c4.504,19.744,22.193,34.526,43.281,34.526c24.484,0,44.403-19.918,44.403-44.402 C499.348,460.369,497.601,453.544,494.522,447.506z M292.975,488.779c-11.68,0-21.182-9.502-21.182-21.182 c0-11.68,9.502-21.182,21.182-21.182c11.68,0,21.183,9.502,21.183,21.182C314.157,479.277,304.655,488.779,292.975,488.779z M454.945,488.779c-11.679,0-21.181-9.502-21.181-21.182c0-11.68,9.502-21.182,21.181-21.182c11.681,0,21.183,9.502,21.183,21.182 C476.129,479.277,466.625,488.779,454.945,488.779z'/> </g></svg>",mower_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 612.003 612.003' style='enable-background:new 0 0 612.003 612.003;' xml:space='preserve'> <g fill='%23fff'> <path d='M598.875,373.125c-0.163-13.29-10.899-25.548-24.025-27.4l-98.208-14.777v-31.005c0-13.711-11.091-24.882-24.773-25.011 l-153.323-13.104l-0.454-0.02c-13.793,0-25.014,11.22-25.014,25.013v13.5l-91.271-13.732L155.091,113.45 c-1.959-12.693-12.787-24.788-25.188-28.134L16.796,54.807C9.69,52.887,2.379,57.095,0.463,64.2s2.289,14.416,9.393,16.333 l113.108,30.511c2.245,0.605,5.439,4.174,5.794,6.471l26.951,174.668c-3.697,3.943-5.938,9.316-5.985,15.436l-13.111,186.167 l-0.013,0.375c0,13.792,11.221,25.013,25.014,25.013h10.789l-1.569-6.568c-1.729-7.234-2.605-14.625-2.605-21.968 c0-52.128,42.408-94.536,94.536-94.536s94.536,42.408,94.536,94.536c0,7.344-0.876,14.734-2.605,21.968l-1.569,6.568h70.799 l-0.521-5.806c-0.117-1.309-0.198-2.456-0.246-3.526c-0.061-1.234-0.092-2.446-0.092-3.603c0-43.524,35.409-78.934,78.934-78.934 c43.523,0,78.934,35.409,78.934,78.934c0,1.492-0.054,3.065-0.172,4.951l-0.489,7.861l7.479-2.468 c11.723-3.87,24.248-11.792,24.248-22.421v-0.289L598.875,373.125z'/> <path d='M262.765,428.53c-34.246,0-62.107,27.862-62.107,62.107s27.862,62.107,62.107,62.107s62.107-27.862,62.107-62.107 S297.01,428.53,262.765,428.53z M262.765,520.77c-16.615,0-30.132-13.518-30.132-30.132c0-16.614,13.518-30.132,30.132-30.132 c16.614,0,30.132,13.518,30.132,30.132C292.897,507.252,279.379,520.77,262.765,520.77z'/> <path d='M502,454.822c-28.353,0-51.419,23.067-51.419,51.418c0,28.353,23.067,51.42,51.419,51.42 c28.352,0,51.419-23.068,51.419-51.42S530.353,454.822,502,454.822z M502,531.014c-13.66,0-24.773-11.115-24.773-24.774 c0-13.659,11.113-24.772,24.773-24.772s24.773,11.113,24.773,24.772C526.773,519.9,515.66,531.014,502,531.014z'/> </g></svg>",on_off_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='83.5' height='49' viewBox='0 0 83.5 49' enable-background='new 0 0 83.5 49' xml:space='preserve'><g fill='%23fff'> <path d='M59.88 3.25l-18-0.12 -18 0.12c-11.8 0-21.37 9.57-21.37 21.37 0 11.8 9.57 21.37 21.37 21.37 7.57 0 18 0.12 18 0.12s10.43-0.12 18-0.12c11.8 0 21.37-9.57 21.37-21.37C81.25 12.82 71.68 3.25 59.88 3.25z'/> <circle cx='59.75' cy='24.5' r='19.5'/></g></svg>",oven_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='380.721px' height='380.721px' viewBox='0 0 380.721 380.721' style='enable-background:new 0 0 380.721 380.721;' xml:space='preserve'> <g fill='%23fff'> <path d='M361.155,86.855H16.777c-8.819,0-15.97,7.151-15.97,15.958v241.604c0,8.796,7.151,15.965,15.97,15.965h344.377 c8.807,0,15.941-7.169,15.941-15.965V102.814C377.096,93.995,369.985,86.855,361.155,86.855z M358.459,265.226 c0,7.924-6.425,14.349-14.338,14.349H34.624c-7.924,0-14.337-6.425-14.337-14.349V123.907c0-7.924,6.414-14.349,14.337-14.349 h309.498c7.913,0,14.338,6.425,14.338,14.349V265.226z'/> <path d='M365.012,20.338H15.726C7.052,20.338,0,27.379,0,36.07v26.932c0,8.673,7.052,15.731,15.726,15.731h349.263 c8.691,0,15.732-7.058,15.732-15.731V36.07C380.721,27.379,373.68,20.338,365.012,20.338z M63.095,66.203 c-8.412,0-15.232-6.814-15.232-15.226s6.82-15.232,15.232-15.232c8.406,0,15.215,6.82,15.215,15.232S71.501,66.203,63.095,66.203z M114.99,66.203c-8.412,0-15.231-6.814-15.231-15.226s6.82-15.232,15.231-15.232c8.412,0,15.227,6.82,15.227,15.232 S123.402,66.203,114.99,66.203z M195.821,66.203c-8.412,0-15.226-6.814-15.226-15.226s6.813-15.232,15.226-15.232 s15.221,6.82,15.221,15.232S204.233,66.203,195.821,66.203z M279.336,66.203c-8.412,0-15.221-6.814-15.221-15.226 s6.809-15.232,15.221-15.232s15.232,6.82,15.232,15.232S287.772,66.203,279.336,66.203z M331.249,66.203 c-8.412,0-15.221-6.814-15.221-15.226s6.809-15.232,15.221-15.232s15.232,6.82,15.232,15.232S339.661,66.203,331.249,66.203z'/> <path d='M330.482,126.585H50.698c-5.606,0-10.149,4.531-10.149,10.137c0,5.601,4.543,10.143,10.149,10.143h279.784 c5.611,0,10.143-4.542,10.143-10.143C340.625,131.117,336.082,126.585,330.482,126.585z'/> </g></svg>",plant_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' viewBox='0 0 612 612' xml:space='preserve' enable-background='new 0 0 612.003 612.003'><g fill='%23fff'> <path d='M546.17 592.87c-0.15-0.41-0.3-0.8-0.41-1.14 -14.49-44.23-55.52-73.95-102.09-73.95 -16.82 0-32.88 3.95-47.23 11 -1.49-1.42-3.02-2.8-4.58-4.16 -21.28-18.39-47.82-29.48-75.7-31.83v-41.02c8.27-3.99 19.71-4.68 32.81-5.46 26.22-1.57 58.85-3.52 86.56-33.8 35.64-38.96 43.22-109.39 35.36-127.22 -2.71-6.15-7.03-7.07-9.37-7.07 -2.28 0-4.48 0.84-6.53 2.49 -7.19 5.77-20.06 6.46-34.97 7.27 -26.14 1.41-58.67 3.16-85.43 32.41 -7.35 8.04-13.45 17.25-18.44 26.99v-95.12c6.7-7 16.64-13.01 27.8-19.74 25.92-15.64 58.18-35.1 70.22-80.72C428.18 98.68 404.44 30.58 387.79 8.97 383.14 2.94 378.74 0 374.33 0c-1.91 0-6.65 0.65-9.27 6.65 -4.4 10.09-17.38 17.82-32.4 26.76 -25.92 15.43-58.18 34.64-69.8 78.68 -14.64 55.51 10.5 120.38 26.56 141.23 0.42 0.55 0.84 1.06 1.25 1.56v51.46c-4.75-17.66-13.7-35.81-32.98-51.57 -29.24-23.91-73.42-32.4-102.36-32.4 -28.05 0-31.33 7.35-32.4 9.76 -0.74 1.65-2.01 5.98 2.08 10.53 6.16 6.86 7.57 19.67 9.2 34.51 2.86 26.02 6.42 58.4 37.11 83.5 28.69 23.46 70.43 31.82 99.94 31.82 7.76 0 14.22-0.54 19.42-1.58v102.21c-26.72 2.89-52.07 13.81-72.55 31.51 -1.56 1.35-3.09 2.74-4.58 4.16 -14.35-7.05-30.42-11-47.23-11 -22.12 0-43.36 6.67-61.43 19.29 -17.65 12.33-31.07 29.43-38.8 49.44 -2.88 7.46-2.69 13.91 0.56 18.65 3.12 4.55 8.5 6.85 16.01 6.85h89.88 100.68 63.56 100.68 96.41c5.75 0 9.86-1.71 12.2-5.07C549.53 601.95 547.34 596.04 546.17 592.87zM263.24 350.16c-0.34-0.33-0.69-0.66-1.02-1.01l-0.51-0.52 -0.13-0.13 -0.03-0.03c-0.04-0.04 0.21 0.26 0.09 0.12l-0.06-0.05 -0.25-0.21c-0.65-0.57-1.31-1.15-1.97-1.73 -1.4-1.1-2.76-2.26-4.27-3.34 -5.92-4.38-12.88-8.39-20.34-12.29 -7.43-3.93-15.31-7.81-22.61-12.36 -3.65-2.26-7.13-4.7-10.31-7.3 -3.17-2.59-5.99-5.44-8.28-8.33 -2.27-2.91-4.08-5.81-5.21-8.6 -0.32-0.67-0.56-1.35-0.78-2.01 -0.23-0.65-0.44-1.29-0.63-1.89 -0.3-1.25-0.57-2.37-0.74-3.4 -0.14-1.06-0.24-1.99-0.3-2.79 -0.06-0.79 0-1.44 0-1.98 0.05-1.08 0.07-1.66 0.07-1.66s0.32 0.48 0.92 1.38c0.3 0.44 0.63 1.03 1.08 1.65 0.44 0.59 0.95 1.26 1.51 2.02 0.6 0.71 1.27 1.49 2 2.34 0.84 0.77 1.55 1.67 2.53 2.47 1.8 1.71 4.06 3.34 6.57 4.94 2.53 1.61 5.38 3.15 8.56 4.64 3.16 1.51 6.63 2.96 10.3 4.49 7.33 3.05 15.51 6.35 23.64 10.6 4.06 2.13 8.09 4.52 11.92 7.22 3.83 2.69 7.44 5.72 10.64 9 1.61 1.62 3.09 3.35 4.46 5.08 0.66 0.89 1.31 1.78 1.95 2.65l0.24 0.33 0.06 0.08c-0.1-0.12 0.17 0.21 0.15 0.19l0.03 0.04 0.1 0.15 0.39 0.61c0.26 0.4 0.5 0.82 0.75 1.23 1.98 3.25 3.78 6.38 5.4 9.31 0.79 1.48 1.57 2.88 2.27 4.24 0.69 1.38 1.34 2.69 1.91 3.95 1.16 2.5 2.14 4.72 2.89 6.57 1.53 3.69 2.24 5.93 2.24 5.93s-1.95-1.27-5.05-3.71c-3.15-2.42-7.31-6.07-12.33-10.51C268.58 355.3 265.95 352.83 263.24 350.16zM305.46 234.84c0.72-2.16 1.66-4.74 2.78-7.67 1.14-2.92 2.44-6.21 3.84-9.81 1.45-3.58 3.08-7.41 4.88-11.43 0.23-0.5 0.45-1.01 0.68-1.51l0.35-0.76 0.09-0.19 0.02-0.05c0.03-0.05-0.16 0.28-0.07 0.12l0.03-0.09 0.14-0.36c0.36-0.95 0.73-1.91 1.1-2.88 0.65-1.99 1.36-3.98 1.93-6.08 2.38-8.34 3.84-17.67 4.91-27.42 1.11-9.74 1.93-19.9 3.64-29.65 0.85-4.87 1.94-9.64 3.33-14.13 1.38-4.49 3.16-8.7 5.22-12.37 2.08-3.66 4.35-6.83 6.77-9.25 0.56-0.63 1.17-1.19 1.77-1.71 0.59-0.53 1.16-1.03 1.71-1.5 1.18-0.87 2.24-1.65 3.24-2.3 1.06-0.62 1.99-1.14 2.79-1.56 0.8-0.42 1.52-0.66 2.09-0.91 1.16-0.45 1.77-0.69 1.77-0.69s-0.4 0.53-1.15 1.51c-0.36 0.49-0.88 1.07-1.38 1.79 -0.48 0.7-1.02 1.51-1.63 2.42 -0.54 0.93-1.14 1.96-1.8 3.09 -0.52 1.21-1.25 2.34-1.74 3.73 -0.27 0.67-0.55 1.36-0.84 2.07 -0.24 0.73-0.49 1.47-0.74 2.24 -0.27 0.75-0.45 1.57-0.68 2.37 -0.24 0.8-0.45 1.63-0.61 2.51 -0.77 3.42-1.33 7.19-1.68 11.29 -0.38 4.09-0.56 8.48-0.72 13.1 -0.31 9.24-0.47 19.46-1.63 29.98 -0.59 5.25-1.45 10.57-2.71 15.79 -1.25 5.22-2.94 10.34-5.06 15.13 -1.03 2.4-2.24 4.7-3.48 6.9 -0.66 1.08-1.32 2.15-1.97 3.2l-0.24 0.39 -0.06 0.1 -0.12 0.21 -0.03 0.04 -0.12 0.17 -0.49 0.68c-0.33 0.45-0.66 0.9-0.99 1.34 -2.61 3.55-5.16 6.86-7.56 9.88 -1.22 1.5-2.37 2.95-3.5 4.31 -1.15 1.35-2.26 2.62-3.33 3.8 -2.13 2.36-4.03 4.39-5.64 6.03 -3.2 3.29-5.21 5.06-5.21 5.06S304 239.14 305.46 234.84zM340.2 412.11l0.06-0.05 0.24-0.22c0.64-0.58 1.29-1.17 1.94-1.77 1.25-1.27 2.55-2.5 3.79-3.87 5.01-5.4 9.76-11.87 14.46-18.86 4.73-6.95 9.46-14.35 14.78-21.11 2.65-3.38 5.46-6.57 8.4-9.44 2.93-2.87 6.06-5.35 9.19-7.31 3.15-1.94 6.23-3.41 9.12-4.23 0.7-0.24 1.41-0.41 2.09-0.56 0.68-0.16 1.33-0.29 1.95-0.41 1.28-0.16 2.42-0.3 3.46-0.36 1.07-0.02 2-0.01 2.8 0.01 0.79 0.02 1.43 0.16 1.97 0.22 1.07 0.17 1.64 0.25 1.64 0.25s-0.51 0.27-1.47 0.76c-0.47 0.25-1.1 0.51-1.76 0.89 -0.63 0.37-1.36 0.8-2.17 1.28 -0.77 0.52-1.62 1.1-2.55 1.73 -0.85 0.75-1.83 1.35-2.74 2.24 -1.89 1.6-3.76 3.66-5.64 5.98 -1.87 2.33-3.73 5-5.56 7.99 -1.85 2.98-3.68 6.27-5.6 9.74 -3.84 6.95-8.02 14.71-13.14 22.32 -2.57 3.8-5.39 7.54-8.49 11.05 -3.1 3.51-6.51 6.76-10.12 9.58 -1.79 1.42-3.67 2.7-5.54 3.88 -0.96 0.56-1.91 1.1-2.85 1.65l-0.35 0.2 -0.09 0.05c0.13-0.08-0.22 0.14-0.2 0.13l-0.04 0.02 -0.16 0.08 -0.65 0.32c-0.43 0.22-0.87 0.41-1.3 0.61 -3.45 1.61-6.76 3.06-9.85 4.34 -1.56 0.62-3.03 1.24-4.46 1.79 -1.44 0.53-2.82 1.03-4.13 1.46 -2.62 0.88-4.92 1.6-6.85 2.15 -3.84 1.11-6.14 1.57-6.14 1.57s1.48-1.79 4.25-4.61c2.75-2.86 6.84-6.6 11.81-11.09 2.5-2.21 5.25-4.55 8.2-6.95 0.37-0.3 0.73-0.61 1.11-0.91l0.57-0.45 0.14-0.11 0.03-0.03C340.37 412.01 340.05 412.21 340.2 412.11z'/></g></svg>",play_1:"<svg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='25px' height='25px' viewBox='0 0 25 25' enable-background='new 0 0 25 25' xml:space='preserve'><g fill='%23fff'><polygon points='5.833,2.903 19.432,12.5 5.833,22.098 '/></g></svg>","plus-minus_1":"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='459px' height='459px' viewBox='0 0 459 459' style='enable-background:new 0 0 459 459;' xml:space='preserve'> <g fill='%23fff'> <path d='M408,0H51C22.95,0,0,22.95,0,51v357c0,28.05,22.95,51,51,51h357c28.05,0,51-22.95,51-51V51C459,22.95,436.05,0,408,0z M63.75,114.75h51v-51H153v51h51V153h-51v51h-38.25v-51h-51V114.75z M408,408H51L408,51V408z M357,357v-38.25H229.5V357H357z'/> </g></svg>",plus_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='357' height='357' viewBox='0 0 357 357' xml:space='preserve'> <g fill='%23fff'> <path d='M357 204H204v153h-51V204H0v-51h153V0h51v153h153V204z'/> </g></svg>",police_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' viewBox='0 0 492 492' xml:space='preserve'><g fill='%23fff'> <path d='M442.02 231c-9.33-28-13.33-49.67-12-65 2.67-35.33 13-67.67 31-97l-69-69c-21.33 18.67-46 29-74 31 -26 2.67-50.33-2.33-73-15 -24 12-48.33 17-73 15 -26.67-2-50.33-11.33-71-28l-69 69c16.67 30 26 61.33 28 94 0.67 15.33-3.67 36.33-13 63 -5.33 14.67-9.33 27.33-12 38 -2 10.67-3.33 19.33-4 26 -0.67 28.67 7.33 54.33 24 77 12.67 16.67 34 35.33 64 56 32 16.67 56.67 27 74 31 2 1.33 4.67 2.67 8 4s5.33 2.33 6 3 5.67 3 15 7c11.33 6.67 19 13.67 23 21 4.67-8 12.33-15 23-21 8-4 14.33-7 19-9 5.33-2 9-3.67 11-5 3.33-1.33 8-3.33 14-6 8.67-3.33 16-6 22-8 16.67-6 29.33-11.67 38-17 28-20.67 48.67-39 62-55 17.34-22.67 25.67-48.67 25-78C458.35 279.67 452.68 259 442.02 231zM304.02 260c-11.33 7.33-28.33 11-51 11h-32v88h-49V133h69c19.33 0 35 1.5 47 4.5s22 9.83 30 20.5c9.33 11.33 14 25.33 14 42C332.02 227.33 322.69 247.33 304.02 260z'/> <path d='M275.02 179c-5.33-4.66-10.16-7.33-14.5-8 -4.33-0.67-9.83-1-16.5-1h-24v65h19c5.33 0 9.83-0.17 13.5-0.5s8.17-1.5 13.5-3.5 9.5-5.67 12.5-11 4.5-12 4.5-20C283.02 190.67 280.35 183.67 275.02 179z'/></g></svg>",power_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 529.286 529.286' style='enable-background:new 0 0 529.286 529.286;' xml:space='preserve'> <g fill='%23fff'> <path d='M358.099,74.604c0,0-28.097-12.644-28.097,16.896s27.837,49.363,28.19,49.3c49.147,32.081,81.629,87.559,81.629,150.629 c0,97.746-78.016,177.269-175.177,179.7c-97.161-2.431-175.177-81.954-175.177-179.7c0-63.071,32.483-118.547,81.629-150.629 c0.353,0.063,28.189-19.761,28.189-49.3s-28.097-16.896-28.097-16.896C88.7,111.958,31.31,194.983,31.31,291.429 c0,129.865,104.053,235.413,233.334,237.857c129.281-2.445,233.332-107.992,233.332-237.857 C497.977,194.983,440.587,111.958,358.099,74.604z'/> <path d='M266.278,0c-26.143,0-34.312,19.141-34.312,26.627v117.159v117.159c0,7.487,8.17,26.627,34.312,26.627 c26.143,0,31.045-19.141,31.045-26.627V143.786V26.627C297.322,19.14,292.421,0,266.278,0z'/> </g></svg>",powerplug_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='99.012px' height='99.012px' viewBox='0 0 99.012 99.012' style='enable-background:new 0 0 99.012 99.012;' xml:space='preserve'> <g fill='%23fff'> <path d='M25.08,15.648c-0.478-0.478-1.135-0.742-1.805-0.723c-0.675,0.017-1.314,0.309-1.768,0.808 c-14.829,16.325-6.762,51.623-5.916,55.115L0.723,85.717C0.26,86.18,0,86.808,0,87.463c0,0.654,0.26,1.283,0.723,1.746 l8.958,8.957c0.482,0.48,1.114,0.723,1.746,0.723c0.631,0,1.264-0.24,1.745-0.723l14.865-14.864 c7.237,1.859,16.289,2.968,24.28,2.968c9.599,0,22.739-1.543,30.836-8.886c0.5-0.454,0.793-1.093,0.809-1.769 c0.018-0.676-0.245-1.328-0.723-1.805L25.08,15.648z'/> <path d='M46.557,30.345c0.482,0.482,1.114,0.723,1.746,0.723c0.632,0,1.264-0.241,1.746-0.724l18.428-18.428 c1.305-1.305,2.023-3.04,2.023-4.885c0-1.846-0.719-3.582-2.023-4.886c-1.305-1.305-3.039-2.022-4.885-2.022 c-1.845,0-3.581,0.718-4.887,2.022L40.277,20.574c-0.964,0.964-0.964,2.527,0,3.492L46.557,30.345z'/> <path d='M96.99,30.661c-1.305-1.305-3.039-2.024-4.885-2.024c-1.847,0-3.582,0.718-4.886,2.023L68.79,49.089 c-0.464,0.463-0.724,1.091-0.724,1.746s0.26,1.282,0.724,1.746l6.28,6.278c0.481,0.482,1.113,0.724,1.746,0.724 c0.631,0,1.264-0.241,1.746-0.724l18.43-18.429C99.686,37.735,99.686,33.353,96.99,30.661z'/> </g></svg>",profile_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='485.21' height='485.21' viewBox='0 0 485.21 485.21' xml:space='preserve'><g fill='%23fff'> <path d='M394.24 333.59h-30.33c-33.49 0-60.65-27.16-60.65-60.65v-19.48c13.42-15.95 23.04-34.81 29.02-54.74 0.62-3.36 3.86-5.02 6.01-7.33 11.61-11.61 13.89-31.2 5.19-45.15 -1.19-2.12-3.32-3.95-3.2-6.58 0-17.78 0.09-35.6-0.02-53.37 -0.48-21.45-6.61-43.77-21.65-59.66 -12.14-12.84-28.82-20.48-46.02-23.75 -21.74-4.15-44.48-3.94-66.01 1.54 -18.66 4.71-36.19 15.64-47.03 31.84 -9.6 14.08-13.8 31.18-14.51 48.04 -0.27 18.09-0.06 36.23-0.12 54.37 0.41 3.63-2.67 6.09-4.06 9.09 -8.2 14.88-4.59 35.16 8.59 45.98 3.34 2.31 3.97 6.52 5.18 10.14 5.75 17.92 15.28 34.49 27.34 48.93v20.14c0 33.5-27.16 60.65-60.65 60.65H90.98c0 0-54.96 15.16-90.98 90.98v30.33c0 16.76 13.56 30.32 30.33 30.32h424.56c16.76 0 30.32-13.56 30.32-30.32V424.56C449.2 348.75 394.24 333.59 394.24 333.59z'/></g></svg>",question_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' x='0' y='0' width='500' height='500' viewBox='0 0 500 500'><g fill='%23fff'> <path d='M227.52 320.99L227.52 301.54Q227.52 289.25 229.31 279.52 231.1 269.79 234.94 261.09 238.78 252.38 245.18 244.19 251.58 236 261.31 226.78L284.35 204.77Q294.08 196.06 300.99 185.31 307.9 174.56 307.9 159.2 307.9 139.23 295.36 125.66 282.82 112.1 259.78 112.1 248 112.1 238.53 116.45 229.06 120.8 222.14 128.22 215.23 135.65 211.65 145.38 208.06 155.1 207.55 165.34L144.58 159.71Q147.65 135.14 157.63 115.94 167.62 96.74 183.49 83.42 199.36 70.11 219.84 63.2 240.32 56.29 263.87 56.29 285.89 56.29 305.6 62.69 325.31 69.09 340.42 81.63 355.52 94.18 364.22 112.61 372.93 131.04 372.93 155.1 372.93 171.49 369.34 183.78 365.76 196.06 359.1 206.3 352.45 216.54 342.98 226.02 333.5 235.49 321.73 245.73 311.49 254.43 305.09 261.09 298.69 267.74 294.85 274.4 291.01 281.06 289.47 288.74 287.94 296.42 287.94 307.68L287.94 320.99zM217.28 392.16Q217.28 375.78 229.31 364 241.34 352.22 258.24 352.22 274.62 352.22 286.91 363.49 299.2 374.75 299.2 391.14 299.2 407.52 287.17 419.3 275.14 431.07 258.24 431.07 250.05 431.07 242.62 428 235.2 424.93 229.57 419.81 223.94 414.69 220.61 407.52 217.28 400.35 217.28 392.16z'/></g></svg>",reload_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' viewBox='0 0 367.38 367.38' xml:space='preserve' enable-background='new 0 0 367.379 367.379'><g fill='%23fff'> <path d='M194.55 10.86c-94.3 0-171.19 75.93-172.8 169.84L0 181.66l46.88 74.76 40.03-78.63 -21.59 0.97c2.59-69.04 59.56-124.4 129.23-124.4 71.33 0 129.34 58.02 129.34 129.34 0 71.31-58.02 129.34-129.34 129.34 -32.59 0-63.72-12.15-87.64-34.24l-29.48 32c31.98 29.5 73.58 45.73 117.13 45.73 95.3 0 172.83-77.52 172.83-172.82C367.38 88.4 289.85 10.86 194.55 10.86z'/></g></svg>",rockinghorse_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M490.161,214.239l20.21-30.914c2.141-3.274,2.175-7.497,0.088-10.806c-16.108-25.543-53.881-69.247-77.352-87.315 l2.019-28.501c0.2-2.832-0.812-5.615-2.785-7.657c-1.973-2.041-4.726-3.149-7.558-3.043 c-109.011,4.012-112.455,56.707-114.969,95.184c-1.239,18.961-2.431,30.665-10.241,37.269c-0.023,0.018-0.043,0.039-0.066,0.057 c-2.616,2.192-5.97,3.818-10.309,4.956c-44.231,11.61-63.758,3.51-84.432-5.068c-11.654-4.835-23.706-9.834-39.572-10.853 c-44.403-2.847-66.026,18.351-83.398,35.387c-13.893,13.623-24.869,24.384-44.946,23.07c-4.04-0.257-7.843,1.935-9.628,5.569 c-1.786,3.635-1.203,7.988,1.476,11.024c19.201,21.766,40.168,25.189,54.373,24.223c3.312-0.225,6.4-0.689,9.216-1.284 L74.61,384.46c-8.716-2.272-17.392-4.713-26.011-7.37c-5.206-1.604-10.307-2.418-15.163-2.418 c-17.188,0-30.811,10.53-33.126,25.609c-1.93,12.574,4.995,28.052,24.819,34.286c66.337,20.861,135.455,31.438,205.437,31.438 c8.412,0,16.939-0.157,25.345-0.466c77.504-2.853,153.059-18.56,224.564-46.686c23.515-9.249,29.253-26.274,27.022-38.044 c-2.632-13.883-15.274-23.211-31.459-23.211c-6.132,0-12.579,1.319-19.162,3.922c-14.038,5.549-28.251,10.565-42.617,15.048 l-11.786-173.677c36.866,1.272,75.484,15.122,75.902,15.274C482.738,219.75,487.621,218.125,490.161,214.239z M294.277,202.813 c1.067-0.28,2.096-0.585,3.098-0.906c0.417,17.585-5.056,30.714-16.166,38.355c-14.184,9.755-36.751,9.057-54.876-1.696 c-15.544-9.222-24.958-23.663-26.985-40.762C220.581,206.574,245.263,215.679,294.277,202.813z M464.228,380.12 c4.232-1.673,8.206-2.522,11.81-2.522c6.375,0,11.009,2.723,11.808,6.936c0.872,4.599-3.333,11.238-14.692,15.706 c-69.398,27.298-142.737,42.543-217.979,45.312c-8.162,0.3-16.441,0.453-24.61,0.453c-67.944,0-135.045-10.267-199.438-30.517 c-7.601-2.39-11.834-7.054-11.049-12.171c0.661-4.302,5.047-8.644,13.356-8.644c2.857,0,5.977,0.515,9.271,1.531 c12.382,3.817,24.873,7.229,37.447,10.276c0.236,0.067,0.477,0.121,0.721,0.171c9.19,2.216,18.427,4.228,27.707,6.03 c0.153,0.036,0.307,0.063,0.461,0.091c39.902,7.723,80.56,11.639,121.521,11.639c7.832,0,15.771-0.146,23.599-0.434 C326.689,421.309,397.365,406.553,464.228,380.12z M125.294,395.422l21.945-47.825c21.184,3.191,46.312-2.051,63.243-34.962 c9.775,7.334,23.344,15.984,41.059,20.978c26.056,7.344,53.927,4.611,82.972-8.116l7.551,14.074 c0.001,0.003,0.003,0.004,0.004,0.007l26.463,49.328c-37.595,8.595-76.07,13.65-115.104,15.086 c-7.583,0.279-15.274,0.42-22.863,0.42C195.134,404.412,159.94,401.39,125.294,395.422z M391.406,182.899 c-2.704,0.1-5.253,1.291-7.063,3.301c-1.811,2.011-2.729,4.669-2.546,7.369l12.81,188.767c-2.009,0.556-4.017,1.1-6.028,1.631 l-40.927-76.288c-0.001-0.001-0.002-0.002-0.002-0.003l-7.361-13.722c-2.611-4.866-8.672-6.696-13.54-4.085 c-4.867,2.611-6.695,8.673-4.084,13.54l2.359,4.397c-58.297,24.858-93.251-3.466-110.494-17.44l-1.697-1.372 c-2.496-2.01-5.807-2.701-8.897-1.859c-3.092,0.842-5.594,3.115-6.727,6.113c-11.186,29.595-27.616,39.859-53.268,33.285 c-4.684-1.202-9.556,1.121-11.572,5.516l-27.321,59.542c-3.648-0.755-7.289-1.546-10.924-2.368l20.396-137.216 c0.567-3.818-1.113-7.622-4.318-9.773c-3.205-2.152-7.362-2.266-10.68-0.295c-0.071,0.042-7.36,4.218-17.801,4.926 c-7.435,0.506-14.499-0.885-21.139-4.144c14.468-5.163,24.963-15.45,35.22-25.508c16.774-16.448,32.617-31.991,68.115-29.707 c5.448,0.35,10.333,1.296,15.023,2.63c-0.156,27.36,13.36,51.493,37.19,65.63c12.79,7.588,27.077,11.395,40.755,11.395 c13.049,0,25.547-3.466,35.659-10.42c11.366-7.816,29.068-26.727,23.934-66.827c11.013-12.514,12.206-30.733,13.297-47.425 c2.354-36.017,4.589-70.123,84.604-75.902l-1.612,22.75c-0.254,3.585,1.436,7.031,4.426,9.025 c17.649,11.773,53.926,51.593,72.86,79.496l-12.403,18.972C462.099,191.892,425.324,181.65,391.406,182.899z'/> <path d='M410.987,120.299c-6.137,0.226-10.916,5.06-10.674,10.799c0.242,5.739,5.412,10.207,11.549,9.981 s10.915-5.06,10.674-10.799C422.294,124.542,417.124,120.073,410.987,120.299z'/> <path d='M326.714,268.654l-0.111-0.208c-2.602-4.872-8.661-6.713-13.531-4.111c-4.872,2.602-6.712,8.66-4.111,13.531l0.111,0.208 c1.801,3.372,5.257,5.292,8.83,5.292c1.589,0,3.202-0.38,4.701-1.181C327.475,279.584,329.315,273.526,326.714,268.654z'/> </g></svg>",rockinghorse_2:"<svg height='511pt' viewBox='-24 1 511 511.999' width='511pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m211.898438 205.808594h67.199218v43.421875h-67.199218zm0 0'/><path d='m110.570312 60.15625c45.40625 0 82.347657 36.941406 82.347657 82.347656v33.277344h58.003906l-.050781-53.148438c-.066406-67.617187-55.132813-122.632812-122.753906-122.632812h-61.261719c-12.066407 0-23.40625 4.707031-31.929688 13.253906-8.519531 8.542969-13.191406 19.898438-13.15625 31.964844.011719 5.238281.945313 10.257812 2.613281 14.9375zm0 0'/><path d='m451.746094 374.011719c-9.507813-10.792969-23.21875-16.988281-37.621094-16.988281-.152344 0-.304688.007812-.460938.007812l-8.804687-69.792969h44.378906v-94.144531c0-33.074219-26.910156-59.984375-59.984375-59.984375h-13.554687c-27.082031 0-50.019531 18.054687-57.441407 42.753906v29.945313h-9.136718v73.445312h-127.246094v-73.445312h-18.980469v-63.304688c0-28.851562-23.472656-52.324218-52.324219-52.324218h-75.105468l-20.816406 25.878906c-17.960938 22.332031-18.917969 54.253906-2.320313 77.621094 8.953125 12.605468 22.15625 21.574218 37.175781 25.25 12.679688 3.101562 25.953125 2.265624 38.0625-2.308594l-17.714844 140.410156c-.15625 0-.308593-.007812-.460937-.007812-14.402344 0-28.113281 6.191406-37.621094 16.988281-9.226562 10.480469-13.6875 24.457031-12.230469 38.347656 1.464844 13.941406 8.761719 26.75 20.03125 35.136719 24.109376 17.941406 51.296876 32.519531 80.8125 43.316406 38.410157 14.058594 79.246094 21.1875 121.375 21.1875 42.125 0 82.964844-7.128906 121.378907-21.1875 29.511719-10.796875 56.699219-25.371094 80.808593-43.316406 11.269532-8.386719 18.566407-21.195313 20.03125-35.136719 1.457032-13.890625-3.003906-27.867187-12.230468-38.347656zm-340.589844-226.019531h-30.027344v-30.023438h30.027344zm130.601562 263.6875c-36.050781 0-71.019531-7.390626-101.960937-21.234376l38.679687-69.058593s28.097657 25.3125 67.21875 25.3125c39.121094 0 66.246094-25.3125 66.246094-25.3125l24.410156 72.207031c-29.078124 11.8125-61.375 18.085938-94.59375 18.085938zm0 0'/></g></svg>",settings_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' viewBox='0 0 268.77 268.77' xml:space='preserve' enable-background='new 0 0 268.765 268.765'> <g fill='%23fff' id='Settings'> <path d='M267.92 119.46c-0.42-3.78-4.83-6.62-8.64-6.62 -12.31 0-23.24-7.23-27.83-18.41 -4.68-11.45-1.66-24.81 7.52-33.23 2.89-2.64 3.24-7.06 0.82-10.13 -6.3-8-13.47-15.23-21.29-21.5 -3.06-2.46-7.56-2.12-10.21 0.83 -8.01 8.87-22.4 12.17-33.52 7.53 -11.57-4.87-18.87-16.59-18.15-29.18 0.24-3.95-2.65-7.39-6.59-7.85 -10.04-1.16-20.16-1.2-30.23-0.08 -3.9 0.43-6.78 3.79-6.65 7.69 0.44 12.46-6.95 23.98-18.4 28.67 -10.98 4.49-25.27 1.22-33.27-7.57 -2.64-2.9-7.06-3.25-10.14-0.85 -8.05 6.32-15.38 13.56-21.74 21.49 -2.48 3.09-2.12 7.56 0.8 10.21 9.35 8.47 12.37 21.94 7.51 33.53 -4.64 11.05-16.11 18.17-29.24 18.17 -4.26-0.14-7.3 2.72-7.76 6.6 -1.18 10.1-1.2 20.38-0.06 30.56 0.42 3.79 4.96 6.61 8.81 6.61 11.7-0.3 22.94 6.95 27.65 18.42 4.7 11.45 1.68 24.8-7.51 33.23 -2.87 2.64-3.24 7.06-0.82 10.13 6.24 7.95 13.41 15.19 21.26 21.51 3.08 2.48 7.56 2.13 10.23-0.81 8.04-8.89 22.43-12.18 33.5-7.54 11.6 4.85 18.9 16.58 18.18 29.17 -0.23 3.96 2.67 7.4 6.6 7.85 5.14 0.6 10.3 0.9 15.48 0.9 4.92 0 9.84-0.27 14.75-0.82 3.9-0.43 6.78-3.79 6.65-7.7 -0.45-12.45 6.95-23.97 18.39-28.66 11.06-4.52 25.29-1.21 33.28 7.57 2.66 2.89 7.05 3.24 10.14 0.85 8.04-6.3 15.35-13.53 21.74-21.49 2.48-3.08 2.13-7.56-0.8-10.21 -9.35-8.47-12.39-21.95-7.53-33.52 4.57-10.9 15.61-18.22 27.49-18.22l1.66 0.04c3.85 0.31 7.4-2.65 7.87-6.59C269.04 139.92 269.06 129.64 267.92 119.46zM134.6 179.49c-24.72 0-44.82-20.11-44.82-44.82 0-24.72 20.11-44.82 44.82-44.82 24.72 0 44.82 20.11 44.82 44.82C179.42 159.39 159.31 179.49 134.6 179.49z' style='clip-rule:evenodd;fill-rule:evenodd'/> </g></svg>",shelter_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512.001 512.001' style='enable-background:new 0 0 512.001 512.001;' xml:space='preserve'> <g fill='%23fff'> <path d='M478.377,86.928L269.374,2.608c-8.625-3.478-18.125-3.477-26.749,0.001L33.623,86.928 c-18.28,7.375-27.153,28.247-19.778,46.528c7.375,18.28,28.247,27.152,46.529,19.779l19.35-7.806v356.374 c0,5.632,4.566,10.199,10.199,10.199h88.54h155.075h88.54c5.633,0,10.199-4.567,10.199-10.199V145.428l19.354,7.808 c4.284,1.726,8.779,2.602,13.364,2.602c14.66,0,27.677-8.785,33.162-22.382C505.53,115.175,496.658,94.302,478.377,86.928z M168.264,491.602h-68.142v-44.875h68.142V491.602z M168.264,426.329h-68.142v-41.851h68.142V426.329z M168.264,364.081h-68.142 v-44.769h68.142V364.081z M168.264,298.914h-68.142v-41.85h68.142V298.914z M323.339,491.602H188.662V231.968h134.677V491.602z M411.878,491.602h-68.142v-44.875h68.142V491.602z M411.878,426.329h-68.142v-41.851h68.142V426.329z M411.878,364.081h-68.142 v-44.769h68.142V364.081z M411.878,298.914h-68.142v-41.85h68.142V298.914z M411.878,236.664h-68.142v-14.896 c0-5.632-4.566-10.199-10.199-10.199H178.462c-5.633,0-10.199,4.567-10.199,10.199v14.896h-68.141v-45.931h184.3 c5.633,0,10.199-4.567,10.199-10.199s-4.566-10.199-10.199-10.199h-184.3v-33.138l21.117-8.677h269.129l21.511,8.678V236.664z M172.192,108.122L256,74.312l83.807,33.81H172.192z M479.239,125.824c-2.357,5.842-7.948,9.616-14.245,9.616 c-1.958,0-3.889-0.377-5.736-1.122L259.816,53.855c-1.224-0.494-2.52-0.741-3.815-0.741c-1.295,0-2.592,0.247-3.815,0.741 L52.743,134.317c-7.851,3.166-16.815-0.643-19.981-8.493c-3.167-7.85,0.643-16.813,8.493-19.981l209.001-84.318 c3.704-1.494,7.785-1.494,11.489-0.001l209.002,84.319C478.596,109.01,482.406,117.973,479.239,125.824z'/> <path d='M360.914,170.336h-33.656c-5.633,0-10.199,4.567-10.199,10.199s4.566,10.199,10.199,10.199h33.656 c5.633,0,10.199-4.567,10.199-10.199S366.547,170.336,360.914,170.336z'/> <path d='M219.149,334.538c-7.311,0-13.259,5.948-13.259,13.259s5.948,13.259,13.259,13.259s13.259-5.948,13.259-13.259 S226.46,334.538,219.149,334.538z'/> </g></svg>",shower_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='554.625px' height='554.625px' viewBox='0 0 554.625 554.625' style='enable-background:new 0 0 554.625 554.625;' xml:space='preserve'> <g fill='%23fff'> <path d='M75.862,344.25c-10.2,0-17.85,7.65-17.85,17.851v52.274c0,10.2,8.925,17.851,17.85,17.851 c8.925,0,17.85-7.65,17.85-17.851v-52.274C93.712,353.175,86.062,344.25,75.862,344.25z'/> <path d='M181.687,344.25c-10.2,0-17.85,7.65-17.85,17.851v52.274c0,10.2,7.65,17.851,17.85,17.851 c10.2,0,17.85-7.65,17.85-17.851v-52.274C199.537,353.175,190.612,344.25,181.687,344.25z'/> <path d='M286.237,344.25c-10.2,0-17.85,7.65-17.85,17.851v52.274c0,10.2,8.925,17.851,17.85,17.851 c10.199,0,17.85-7.65,17.85-17.851v-52.274C305.362,353.175,296.437,344.25,286.237,344.25z'/> <path d='M128.137,461.55c-10.2,0-17.85,7.65-17.85,17.851v52.274c0,10.2,8.925,17.851,17.85,17.851 c10.2,0,17.85-7.65,17.85-17.851V479.4C147.262,469.2,138.337,461.55,128.137,461.55z'/> <path d='M233.962,461.55c-10.2,0-17.85,7.65-17.85,17.851v52.274c0,10.2,7.65,17.851,17.85,17.851 c10.2,0,17.85-7.65,17.85-17.851V479.4C251.812,469.2,244.162,461.55,233.962,461.55z'/> <path d='M508.087,178.5c0-98.175-80.324-178.5-178.5-178.5c-85.425,0-158.1,61.2-174.675,141.525 c-63.75,12.75-110.925,68.85-110.925,136.425l0,0c0,22.95,19.125,42.075,42.075,42.075h193.8 c22.949,0,42.074-19.125,42.074-42.075l0,0c0-61.2-39.524-112.2-93.074-131.325c14.025-43.35,53.55-73.95,102-73.95 c58.65,0,105.824,47.175,105.824,105.825v340.425c0,20.4,16.576,35.7,36.977,35.7c20.398,0,36.975-16.575,36.975-35.7 C508.087,518.925,508.087,178.5,508.087,178.5z'/> </g></svg>",slider_1:"<svg height='1065pt' viewBox='-33 -181 1065.0001 1065' width='1065pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m829.347656 65.886719c-12.75-44.542969-53.796875-77.238281-102.371094-77.238281-48.574218 0-89.625 32.695312-102.382812 77.238281h-626.613281v58.5h626.621093c12.75 44.535156 53.800782 77.242187 102.375 77.242187 48.574219 0 89.621094-32.707031 102.375-77.242187h167.066407v-58.5zm0 0'/><path d='m185.488281 233.34375c-48.574219 0-89.628906 32.703125-102.371093 77.238281h-85.136719v58.503907h85.136719c12.742187 44.542968 53.800781 77.242187 102.375 77.242187 48.574218 0 89.628906-32.699219 102.375-77.242187h708.550781v-58.503907h-708.550781c-12.746094-44.535156-53.804688-77.238281-102.378907-77.238281zm0 0'/><path d='m513.601562 478.046875c-48.574218 0-89.636718 32.699219-102.382812 77.242187h-413.238281v58.5h413.238281c12.746094 44.527344 53.808594 77.242188 102.382812 77.242188 48.570313 0 89.628907-32.714844 102.371094-77.242188h380.445313v-58.5h-380.445313c-12.742187-44.542968-53.800781-77.242187-102.371094-77.242187zm0 0'/></g></svg>","soccer-ball_1":"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='952.1px' height='952.1px' viewBox='0 0 952.1 952.1' style='enable-background:new 0 0 952.1 952.1;' xml:space='preserve' > <g fill='%23fff'> <path d='M812.55,139.4c-43.7-43.7-94.6-78-151.3-102C602.55,12.6,540.25,0,475.95,0c-64.2,0.1-126.5,12.6-185.2,37.5 c-56.7,24-107.6,58.3-151.3,102c-43.7,43.7-78,94.6-102,151.3c-24.8,58.7-37.4,121-37.4,185.3c0,64.201,12.6,126.6,37.4,185.301 c24,56.699,58.3,107.6,102,151.299c43.7,43.701,94.6,78,151.3,102c58.7,24.801,121,37.4,185.3,37.4 c64.2,0,126.601-12.6,185.3-37.4c56.7-24,107.601-58.299,151.301-102c43.699-43.699,78-94.6,102-151.299 c24.8-58.701,37.399-121,37.399-185.301c0-64.2-12.6-126.6-37.399-185.3C890.55,234,856.25,183.2,812.55,139.4z M212.55,107.5 c4.3-3.3,8.5-6.8,12.9-9.9c23.1-16.2,48.7-29.3,74.7-40.2C355.55,34.2,415.75,22,475.95,22c40.1,0,81.2,5.4,119.899,16 c-15.3,6.2-34,18-65.399,44.8c-26.101-2.8-52.5-2.9-79-0.4c-34.601,3.3-69.4,11-103.4,23c-30.7,10.8-55,23.1-71.4,32.5 c-25.1-9-57.5-19.6-73.5-24.8C205.65,113.9,210.85,108.8,212.55,107.5z M646.15,226.5l-81.4,222.2l-195.3,37.5L208.05,319.5 c10.9-75.6,62.7-142.6,62.7-142.6c0.3-0.2,34.1-24.6,88.3-43.5c31.601-11.1,63.8-18.2,95.9-21.2c26.2-2.4,52.3-2,78.1,1.1 L646.15,226.5z M39.35,460.2c-5,32.3-6.1,65.8-3.5,99.5c-3.9-7.799-7-14.398-9.3-19.699c-3-20.9-4.5-42.301-4.5-64.1 c0-67,14.5-130.7,40.6-188c-2.9,30-1.5,61.1,0.6,84.7C52.05,400.7,44.05,430,39.35,460.2z M78.85,633.301 c-4.6-16.9-10-41.5-12.7-71c-3-33.301-2.1-66.4,2.9-98.101c3.8-24.3,9.9-47.899,18.3-70.6c32.9-27.8,76.5-44.1,100.6-51.6 L346.35,505.6L329.75,684.9L174.95,736.6C135.55,707.6,103.35,669.199,78.85,633.301z M549.25,892.9 c-34.5,22.6-121.7,28-157.1,29.299c-39-7.299-76.9-19.799-112.601-37c-31.2-15-60.8-33.6-87.8-55.398c0.5-0.9-4.2-48.602-4-66 l156.4-52.201l180.5,78.1l24.899,102.9C549.35,892.801,549.25,892.9,549.25,892.9z M849.15,734.6 C822.25,773.4,790.05,809.5,751.35,836.9c-36.3,25.6-84.899,34.4-128.1,41.5c-3.3,0.5-44.6,7.299-44.9,5.9l-24.899-103L680.55,649 l168.3-15.5c2.601,26.801,6,65.9,8,89.801C854.25,727.1,851.75,730.9,849.15,734.6z M851.75,600c-0.6,1-1.2,2.1-1.8,3.301 L682.35,618.699L592.15,460.9l81.6-222.7l115.2,7.3c24.5,20.5,46.2,43.3,64.6,67.9c23,30.9,40.9,64.8,53.101,100.7 C893.85,525.301,864.35,580.699,851.75,600z M911.85,349.8c-9.899-19.1-21.5-37.5-34.6-55c-20.7-27.7-45.3-53.2-73.2-75.9 c-5.1-25.3-19.1-65.1-56.7-106.9c0.7,0.5,1.4,1.1,2.101,1.6c2.3,1.7,4.5,3.5,6.8,5.2c25.9,20.4,49.5,43.5,70.4,68.9 c38.8,47.3,68.1,102.2,85.3,161.1C911.85,349.2,911.85,349.5,911.85,349.8z'/> </g></svg>",socket_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 503.607 503.607' style='enable-background:new 0 0 503.607 503.607;' xml:space='preserve'> <g fill='%23fff'> <path d='M444.852,0H58.754C26.308,0,0,26.305,0,58.754v386.098c0,32.443,26.311,58.754,58.754,58.754h386.098 c32.443,0,58.754-26.311,58.754-58.754V58.754C503.607,26.305,477.298,0,444.852,0z M486.82,444.852 c0,23.172-18.795,41.967-41.967,41.967H58.754c-23.172,0-41.967-18.795-41.967-41.967V58.754 c0-23.177,18.792-41.967,41.967-41.967h386.098c23.175,0,41.967,18.79,41.967,41.967V444.852z'/> <path d='M58.754,41.966c-9.266,0-16.787,7.521-16.787,16.787s7.521,16.787,16.787,16.787s16.787-7.521,16.787-16.787 S68.02,41.966,58.754,41.966z'/> <path d='M444.852,41.966c-9.266,0-16.787,7.521-16.787,16.787s7.521,16.787,16.787,16.787c9.266,0,16.787-7.521,16.787-16.787 S454.119,41.966,444.852,41.966z'/> <path d='M58.754,428.066c-9.266,0-16.787,7.512-16.787,16.787c0,9.266,7.521,16.787,16.787,16.787s16.787-7.521,16.787-16.787 C75.541,435.578,68.02,428.066,58.754,428.066z'/> <path d='M444.852,428.066c-9.266,0-16.787,7.512-16.787,16.787c0,9.266,7.521,16.787,16.787,16.787 c9.266,0,16.787-7.521,16.787-16.787C461.639,435.578,454.119,428.066,444.852,428.066z'/> <path d='M184.656,209.834c-23.177,0-41.967,18.791-41.967,41.967s18.791,41.967,41.967,41.967 c23.177,0,41.967-18.791,41.967-41.967S207.832,209.834,184.656,209.834z M184.656,276.982c-13.906,0-25.18-11.275-25.18-25.18 c0-13.906,11.275-25.18,25.18-25.18c13.906,0,25.18,11.275,25.18,25.18C209.836,265.707,198.561,276.982,184.656,276.982z'/> <path d='M276.984,251.802c0,23.177,18.791,41.967,41.967,41.967c23.177,0,41.967-18.791,41.967-41.967 s-18.791-41.967-41.967-41.967C295.774,209.834,276.984,228.625,276.984,251.802z M344.131,251.802 c0,13.906-11.275,25.18-25.18,25.18c-13.906,0-25.18-11.275-25.18-25.18c0-13.906,11.275-25.18,25.18-25.18 C332.856,226.621,344.131,237.896,344.131,251.802z'/> <path d='M278.457,103.203c-5.144-0.917-9.867,3.038-9.867,8.263v22.83h-33.574v-22.83c0-5.225-4.723-9.181-9.867-8.263 c-71.585,12.768-124.428,75.135-124.428,148.601c0,73.462,52.847,135.835,124.429,148.593c5.144,0.917,9.866-3.038,9.866-8.263 v-22.822h33.574v22.822c0,5.225,4.722,9.18,9.866,8.263c71.581-12.758,124.429-75.131,124.429-148.593 C402.885,178.338,350.042,115.97,278.457,103.203z M285.377,381.728v-20.809c0-4.636-3.758-8.393-8.393-8.393h-50.361 c-4.636,0-8.393,3.758-8.393,8.393v20.809c-58.544-15.037-100.721-68.062-100.721-129.924 c0-61.867,42.174-114.887,100.721-129.931v20.817c0,4.636,3.758,8.393,8.393,8.393h50.361c4.636,0,8.393-3.758,8.393-8.393 v-20.817c58.547,15.044,100.721,68.065,100.721,129.931C386.098,313.667,343.921,366.691,285.377,381.728z'/> <circle cx='251.803' cy='251.802' r='8.393'/> </g></svg>",socket_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='344.25px' height='344.25px' viewBox='0 0 344.25 344.25' style='enable-background:new 0 0 344.25 344.25;' xml:space='preserve'><g fill='%23fff'> <path d='M339.469,0H4.781v344.25h334.688V0z M176.906,51.265V76.5h-19.125V51.503v-3.691h19.125V51.265z M157.781,303.705v-26.393 h19.125v26.632V306h-19.125V303.705z M186.469,303.074V267.75h-38.25v9.562v25.034C88.511,292.115,43.031,240.229,43.031,177.604 S88.511,63.093,148.219,52.861v33.201h28.688h9.562V52.135c62.041,8.205,109.969,61.181,109.969,125.47 C296.438,241.893,248.51,294.869,186.469,303.074z'/> <circle cx='100.464' cy='181.037' r='19.106'/> <circle cx='243.901' cy='181.037' r='19.106'/> <path d='M170.327,160.746c-9.572,0-17.346,7.784-17.346,17.356s7.774,17.355,17.346,17.355c9.572,0,17.347-7.783,17.347-17.355 S179.899,160.746,170.327,160.746z M170.327,185.895c-4.293,0-7.784-3.5-7.784-7.793s3.49-7.793,7.784-7.793 c4.294,0,7.784,3.5,7.784,7.793S174.631,185.895,170.327,185.895z'/></g></svg>",sofa_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='497.25' height='497.25' viewBox='0 0 497.25 497.25' xml:space='preserve'><g fill='%23fff'> <path d='M478.13 205.59v-86.06c0-10.57-8.56-19.12-19.12-19.12H38.25c-10.57 0-19.12 8.56-19.12 19.13v86.1c0.13 0 0.26-0.04 0.4-0.04H478.13z'/> <path d='M497.25 243.84c0-10.57-8.46-19.12-19.03-19.12h-0.1H19.53c-0.14 0-0.27 0.04-0.4 0.04C8.74 224.98 0 233.42 0 243.84v114.75h497.25V243.84z'/> <rect x='19.13' y='377.72' width='47.81' height='19.13'/> <rect x='430.31' y='377.72' width='47.81' height='19.13'/></g></svg>",speaker_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='510' height='510' viewBox='0 0 510 510' xml:space='preserve' enable-background='new 0 0 510 510'> <g fill='%23fff' id='speaker'> <path d='M382.5 0h-255c-28.05 0-51 22.95-51 51v408c0 28.05 22.95 51 51 51h255c28.05 0 51-22.95 51-51V51C433.5 22.95 410.55 0 382.5 0zM255 51c28.05 0 51 22.95 51 51s-22.95 51-51 51 -51-22.95-51-51S226.95 51 255 51zM255 459c-71.4 0-127.5-56.1-127.5-127.5S183.6 204 255 204c71.4 0 127.5 56.1 127.5 127.5S326.4 459 255 459zM255 255c-43.35 0-76.5 33.15-76.5 76.5S211.65 408 255 408c43.35 0 76.5-33.15 76.5-76.5S298.35 255 255 255z'/> </g></svg>",speaker_2:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='svg' x='0' y='0' width='510' height='510' viewBox='0 0 510 510'> <g fill='%23fff' id='Ebene_1'> <path d='M382.5 0L127.5 0C99.45 0 76.5 22.95 76.5 51L76.5 459C76.5 487.05 99.45 510 127.5 510L382.5 510C410.55 510 433.5 487.05 433.5 459L433.5 51C433.5 22.95 410.55 0 382.5 0zM255 51C283.05 51 306 73.95 306 102 306 130.05 283.05 153 255 153 226.95 153 204 130.05 204 102 204 73.95 226.95 51 255 51zM255 459C183.6 459 127.5 402.9 127.5 331.5 127.5 260.1 183.6 204 255 204 326.4 204 382.5 260.1 382.5 331.5 382.5 402.9 326.4 459 255 459zM255 255C211.65 255 178.5 288.15 178.5 331.5 178.5 374.85 211.65 408 255 408 298.35 408 331.5 374.85 331.5 331.5 331.5 288.15 298.35 255 255 255z'/> <path d='M12 420L51 405.38' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round'/> <path d='M109.77 383.34L167.77 361.59' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round' display='none'/> <path d='M315.06 306.35L372.89 284.67' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round' display='none'/> <path d='M458.03 252.74L492 240' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round'/> <path d='M52.06 332L12 332' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round'/> <path d='M176.57 332L115.07 332' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round' display='none'/> <path d='M396.07 332L334.57 332' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round' display='none'/> <path d='M492 332L459.08 332' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round'/> <path d='M459.08 407.66L492 420' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round'/> <path d='M342.55 363.95L400.1 385.54' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round' display='none'/> <path d='M135.93 286.47L193.37 308.01' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round' display='none'/> <path d='M12 240L52.06 255.02' fill-opacity='0' stroke-width='23' stroke-linecap='round' stroke-linejoin='round'/> </g></svg>",speaker_3:"<svg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='25px' height='18.625px' viewBox='0 0 25 18.625' enable-background='new 0 0 25 18.625' xml:space='preserve'> <g fill='%23fff'> <path fill='none' stroke-miterlimit='10' d='M20.018,0.709c2.193,2.246,3.545,5.318,3.545,8.706 c0,3.378-1.346,6.444-3.528,8.688'/> <path fill='none' stroke-miterlimit='10' d='M15.627,5.098c1.102,1.124,1.779,2.662,1.779,4.36 c0,1.667-0.654,3.181-1.719,4.3'/> <path fill='none' stroke-miterlimit='10' d='M17.814,2.913c1.629,1.682,2.633,3.975,2.633,6.502 c0,2.519-0.998,4.806-2.617,6.485'/> <path d='M13.063,0.521c-0.542-0.042-8.25,5.792-8.25,5.792s-3.917-0.292-4.083,0s-0.417,5.625,0,5.625 s4.083,0,4.083,0s7.708,6.082,8.25,6.166C13.604,18.188,13.604,0.563,13.063,0.521z'/> </g></svg>",speaker_4:"<svg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='15.25px' height='18.625px' viewBox='0 0 15.25 18.625' enable-background='new 0 0 15.25 18.625' xml:space='preserve'><g fill='%23fff'><path d='M13.063,0.521C12.52,0.479,4.812,6.313,4.812,6.313s-3.917-0.292-4.083,0s-0.417,5.625,0,5.625 s4.083,0,4.083,0s7.708,6.082,8.251,6.166C13.604,18.188,13.604,0.563,13.063,0.521z'/></g></svg>",speech_bubble_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='271.31' height='271.31' viewBox='0 0 271.31 271.31' xml:space='preserve'><g fill='%23fff'> <path d='M227.91 13.98c24.75 0 43.4 17.98 43.4 43.39v96.45c0 22.08-17.28 43.44-43.4 43.44h-73.61c-6.78 0-16.16 3.92-20.94 8.76l-47.85 48.47c-4.77 4.83-9.68 3.34-10.96-3.33l-8.02-41.82c-1.28-6.66-6.97-12.08-12.72-12.08H43.4c-26.74 0-43.4-19.37-43.4-43.44V57.37C0 31.24 17.98 13.98 43.4 13.98H227.91z'/></g></svg>",speedometer_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 539.077 539.077' style='enable-background:new 0 0 539.077 539.077;' xml:space='preserve'> <g fill='%23fff'> <path d='M269.538,539.077C120.917,539.077,0,418.171,0,269.538C0,120.917,120.917,0,269.538,0 c148.632,0,269.538,120.917,269.538,269.538C539.077,418.171,418.171,539.077,269.538,539.077z M269.538,22.462 C133.3,22.462,22.462,133.3,22.462,269.538S133.3,516.615,269.538,516.615s247.077-110.838,247.077-247.077 S405.777,22.462,269.538,22.462z'/> <path d='M269.538,314.462c-24.776,0-44.923-20.158-44.923-44.923c0-24.776,20.147-44.923,44.923-44.923 c24.765,0,44.923,20.147,44.923,44.923C314.462,294.303,294.303,314.462,269.538,314.462z M269.538,247.077 c-12.382,0-22.462,10.079-22.462,22.462c0,12.393,10.079,22.462,22.462,22.462C281.932,292,292,281.932,292,269.538 C292,257.156,281.932,247.077,269.538,247.077z'/> <path d='M466.647,362.434c-1.448,0-2.895-0.263-4.299-0.855l-41.479-17.197c-5.725-2.369-8.445-8.95-6.076-14.675 c2.391-5.747,9.015-8.489,14.675-6.076l41.479,17.197c5.725,2.369,8.445,8.95,6.076,14.675 C475.224,359.823,471.056,362.434,466.647,362.434z M72.397,362.412c-4.409,0-8.588-2.61-10.375-6.931 c-2.369-5.725,0.351-12.306,6.076-14.675l41.479-17.175c5.736-2.413,12.306,0.351,14.675,6.076 c2.369,5.725-0.351,12.306-6.076,14.675l-41.479,17.175C75.292,362.148,73.834,362.412,72.397,362.412z M99.794,284.937H54.871 c-6.208,0-11.231-5.023-11.231-11.231c0-6.208,5.023-11.231,11.231-11.231h44.923c6.208,0,11.231,5.023,11.231,11.231 C111.024,279.914,106.001,284.937,99.794,284.937z M482.901,280.791L482.901,280.791L438,280.769 c-6.208,0-11.231-5.023-11.231-11.242c0-6.197,5.023-11.22,11.231-11.22l0,0l44.901,0.022c6.208,0,11.231,5.034,11.231,11.231 C494.132,275.768,489.109,280.791,482.901,280.791z M293.36,256.937c-2.874,0-5.747-1.097-7.941-3.29 c-4.387-4.387-4.387-11.494,0-15.881l111.167-111.156c4.387-4.387,11.494-4.387,15.881,0c4.387,4.387,4.387,11.494,0,15.881 L301.3,253.646C299.107,255.84,296.233,256.937,293.36,256.937z M113.876,216.302c-1.437,0-2.895-0.274-4.31-0.855l-41.457-17.208 c-5.725-2.38-8.445-8.95-6.065-14.686c2.391-5.736,8.939-8.434,14.686-6.065l41.457,17.208c5.725,2.38,8.445,8.95,6.065,14.686 C122.453,213.703,118.274,216.302,113.876,216.302z M425.168,216.302c-4.409,0-8.577-2.61-10.375-6.931 c-2.369-5.736,0.351-12.306,6.076-14.675l41.501-17.175c5.747-2.347,12.306,0.362,14.675,6.076 c2.369,5.736-0.351,12.306-6.076,14.675l-41.501,17.175C428.063,216.028,426.594,216.302,425.168,216.302z M150.398,161.629 c-2.873,0-5.747-1.097-7.94-3.29l-31.729-31.751c-4.387-4.387-4.387-11.505,0-15.881c4.387-4.387,11.494-4.387,15.881,0 l31.729,31.751c4.387,4.387,4.387,11.505,0,15.881C156.145,160.532,153.271,161.629,150.398,161.629z M205.071,125.107 c-4.398,0-8.588-2.61-10.375-6.931l-17.175-41.479c-2.369-5.736,0.351-12.306,6.076-14.675c5.692-2.347,12.306,0.351,14.675,6.076 l17.175,41.479c2.369,5.736-0.351,12.306-6.076,14.675C207.967,124.833,206.508,125.107,205.071,125.107z M334.006,125.107 c-1.448,0-2.895-0.274-4.299-0.855c-5.725-2.38-8.445-8.95-6.076-14.675l17.197-41.457c2.391-5.736,8.971-8.445,14.675-6.076 c5.725,2.38,8.445,8.95,6.076,14.675l-17.197,41.457C342.582,122.497,338.415,125.107,334.006,125.107z M268.255,116.486 c-6.208,0-11.231-5.023-11.231-11.231V60.332c0-6.208,5.023-11.231,11.231-11.231c6.197,0,11.242,5.023,11.242,11.231v44.923 C279.497,111.463,274.452,116.486,268.255,116.486z'/> <path d='M370.615,449.231H168.462c-6.208,0-11.231-5.023-11.231-11.231v-67.385c0-6.208,5.023-11.231,11.231-11.231h202.154 c6.208,0,11.231,5.023,11.231,11.231V438C381.846,444.208,376.823,449.231,370.615,449.231z M179.692,426.769h179.692v-44.923 H179.692V426.769z'/> </g></svg>",sport_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 398.75 398.75' style='enable-background:new 0 0 398.75 398.75;' xml:space='preserve'><g fill='%23fff'> <polygon points='343.033,187.871 372.576,155.299 346.65,131.785 317.095,164.371 240.642,182.38 248.667,216.447 305.716,203.009 290.542,317.352 26.174,364.017 29.216,398.75 353.506,398.75 353.506,306.237 326.696,310.97 '/> <polygon points='104.704,122.262 137.299,122.262 117.398,205.67 183.909,221.909 201.938,313.488 236.28,306.727 213.931,193.21 159.523,179.927 181.632,87.262 91.678,87.262 36.792,134.687 59.675,161.17 '/> <polygon points='146.113,236.92 112.008,229.056 107.884,246.939 43.536,230.286 34.767,264.169 133.914,289.829 '/> <polygon points='191.849,136.14 236.602,146.37 294.451,114.41 277.525,83.774 231.374,109.272 199.648,102.02 '/> <circle cx='188.415' cy='35.629' r='35.629'/></g></svg>",stairs_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M490.667,170.667H416V21.333h74.667c5.867,0,10.667-4.8,10.667-10.667C501.333,4.8,496.533,0,490.667,0h-85.333 c-0.32,0-0.64,0.107-0.96,0.213c-0.64,0.107-1.28,0.213-1.92,0.427c-1.067,0.32-2.133,0.853-3.093,1.493h-0.107 c-0.533,0.32-1.067,0.747-1.6,1.173l-84.16,63.147c-0.427,0.213-0.747,0.533-1.173,0.853l-84.48,63.36 c-0.213,0.213-0.533,0.32-0.747,0.64l-84.907,63.68c-0.107,0.107-0.32,0.213-0.427,0.32L56.427,259.2l-41.493,31.04 c-4.693,3.52-5.653,10.24-2.133,14.933c3.52,4.693,10.24,5.653,14.933,2.133l25.6-19.2v138.56h-32 c-5.867,0-10.667,4.8-10.667,10.667v64c0,5.867,4.8,10.667,10.667,10.667h469.333c5.867,0,10.667-4.8,10.667-10.667v-320 C501.333,175.467,496.533,170.667,490.667,170.667z M330.667,80.213l64-48v138.453H384c-5.867,0-10.667,4.8-10.667,10.667v53.333 h-42.667V80.213z M245.333,144.213l64-48v138.453h-10.667c-5.867,0-10.667,4.8-10.667,10.667V288h-42.667V144.213z M160,208.107 l64-48V288h-21.333C196.8,288,192,292.8,192,298.667v64h-32V208.107z M74.667,272.107l64-48v138.56h-21.333 c-5.867,0-10.667,4.8-10.667,10.667v53.333h-32V272.107z M480,490.667H32V448h85.333C123.2,448,128,443.2,128,437.333V384h74.667 c5.867,0,10.667-4.8,10.667-10.667v-64h85.333c5.867,0,10.667-4.8,10.667-10.667V256H384c5.867,0,10.667-4.8,10.667-10.667V192 H480V490.667z'/> </g></svg>",stairs_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='485.142px' height='485.142px' viewBox='0 0 485.142 485.142' style='enable-background:new 0 0 485.142 485.142;' xml:space='preserve'> <g fill='%23fff'> <path d='M460.49,95.645h-88.625c-13.617,0-24.652,11.027-24.652,24.648v63.984H283.23c-13.621,0-24.656,11.023-24.656,24.645 v63.988H194.59c-13.621,0-24.652,11.039-24.652,24.646v67.07h-67.055c-6.543,0-12.813,2.594-17.434,7.211 c-4.625,4.62-7.219,10.918-7.219,17.435l0.008,51.569c0,13.634,11.039,24.66,24.652,24.66h357.6 c13.621,0,24.651-11.026,24.651-24.66V120.292C485.143,106.672,474.111,95.645,460.49,95.645z'/> <path d='M330.756,24.605c-6.344-6.504-16.736-6.629-23.236-0.301C202.097,127,101.804,227.305,4.816,324.284 C1.73,327.37,0,331.562,0,335.913v112.47c0,9.064,7.355,16.438,16.434,16.438c9.07,0,16.438-7.371,16.438-16.438V342.714 c95.414-95.418,194.059-194.012,297.578-294.871C336.947,41.516,337.08,31.105,330.756,24.605z'/> </g></svg>",stairs_3:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0' y='0' width='516.375' height='516.375' viewBox='0, 0, 516.375, 516.375'> <g fill='%23fff' id='Ebene_1'> <path d='M124.312,377.719 L219.938,377.719 L219.938,282.094 L315.562,282.094 L315.562,176.906 L420.75,176.906 L420.75,81.281 L516.375,81.281 L516.375,43.031 L382.5,43.031 L382.5,138.656 L277.312,138.656 L277.312,243.844 L181.688,243.844 L181.688,339.469 L86.062,339.469 L86.062,435.094 L0,435.094 L0,473.344 L124.312,473.344 z' /> </g></svg>",statistic_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' viewBox='0 0 331.37 331.37' xml:space='preserve'><g fill='%23fff'> <rect x='7.49' y='123.83' width='68.68' height='207.54'/> <rect x='131.35' y='0' width='68.67' height='331.37'/> <rect x='255.2' y='123.83' width='68.68' height='207.54'/></g></svg>",stop_1:"<svg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='25px' height='25px' viewBox='0 0 25 25' enable-background='new 0 0 25 25' xml:space='preserve'><g fill='%23fff'><rect x='1.5' y='1.5' width='22' height='22'/></g></svg>",switches_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='47.793px' height='47.793px' viewBox='0 0 47.793 47.793' style='enable-background:new 0 0 47.793 47.793;' xml:space='preserve'> <g fill='%23fff'> <path d='M13.747,20.831h20.207c5.752,0,10.416-4.663,10.416-10.416S39.706,0,33.953,0H13.747C7.995,0,3.331,4.663,3.331,10.416 S7.994,20.831,13.747,20.831z M13.747,3.769c3.671,0,6.647,2.976,6.647,6.647s-2.976,6.647-6.647,6.647S7.1,14.087,7.1,10.416 S10.076,3.769,13.747,3.769z'/> <path d='M34.046,26.961H13.84c-5.752,0-10.416,4.663-10.416,10.416S8.087,47.793,13.84,47.793h20.206 c5.752,0,10.416-4.663,10.416-10.416S39.799,26.961,34.046,26.961z M34.046,44.023c-3.671,0-6.646-2.978-6.646-6.647 s2.977-6.647,6.646-6.647s6.647,2.978,6.647,6.647S37.717,44.023,34.046,44.023z'/> </g></svg>",table_1:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 315 315' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 315 315'> <g fill='%23fff'> <path d='m308,93.368h-219.272c-3.866,0-7,3.134-7,7v41.282c0,3.866 3.134,7 7,7h102.636v126.43h-39.359c-3.866,0-7,3.134-7,7 0,3.866 3.134,7 7,7h92.72c3.866,0 7-3.134 7-7 0-3.866-3.134-7-7-7h-39.36v-126.43h102.635c3.866,0 7-3.134 7-7v-41.282c0-3.866-3.134-7-7-7zm-7,41.282h-205.272v-27.282h205.272v27.282z'/> <path d='m107.839,170.859h-93.839v-49.389h10.595c2.489,0 4.792-1.322 6.047-3.473 0.426-0.73 10.429-18.179 10.429-44.304s-10.004-43.571-10.43-44.301c-1.254-2.15-3.557-3.473-6.046-3.473h-17.595c-3.866,0-7,3.134-7,7v81.55 63.389 29.777 74.443c0,3.866 3.134,7 7,7s7-3.134 7-7v-67.443h86.839v67.443c0,3.866 3.134,7 7,7 3.866,0 7-3.134 7-7v-74.443-29.777c0-3.865-3.134-6.999-7-6.999zm-93.839-130.939h6.249c2.486,5.623 6.821,17.729 6.821,33.773 0,15.9-4.354,28.103-6.843,33.776h-6.227v-67.549zm0,144.939h86.839v15.777h-86.839v-15.777z'/> </g></svg>",table_2:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M128,268.8H17.067V123.733H0v153.6V320v68.267h17.067v-59.733h102.4v59.733h17.067V320v-8.533v-34.133 C136.533,272.617,132.713,268.8,128,268.8z M119.467,311.467h-102.4v-25.6h102.4V311.467z'/> <path d='M494.933,123.733V268.8H384c-4.713,0-8.533,3.817-8.533,8.533v34.133V320v68.267h17.067v-59.733h102.4v59.733H512V320 v-42.667v-153.6H494.933z M494.933,311.467h-102.4v-25.6h102.4V311.467z'/> <path d='M383.938,132.267H128.063c-18.854,0-34.196,15.308-34.196,34.133s15.342,34.133,34.196,34.133h119.404v98.6 l-82.508,74.258c-3.504,3.15-3.788,8.55-0.633,12.05c3.15,3.508,8.55,3.783,12.05,0.633l71.092-63.979v66.171h17.067v-66.171 l71.092,63.979c1.629,1.467,3.671,2.192,5.704,2.192c2.338,0,4.663-0.95,6.346-2.825c3.154-3.5,2.871-8.9-0.633-12.05 l-82.508-74.258v-98.6h119.404c18.854,0,34.196-15.308,34.196-34.133S402.792,132.267,383.938,132.267z M383.938,183.467H264.533 h-17.067H128.063c-9.446,0-17.129-7.658-17.129-17.067c0-9.408,7.683-17.067,17.129-17.067h255.875 c9.446,0,17.129,7.658,17.129,17.067C401.067,175.808,393.383,183.467,383.938,183.467z'/> </g></svg>",table_outside_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M162.263,367.214H38.427V210.095c0-5.104-4.138-9.242-9.242-9.242c-5.104,0-9.242,4.138-9.242,9.242v166.361 c0,5.104,4.138,9.242,9.242,9.242h2.773v110.895c0,5.104,4.138,9.242,9.242,9.242s9.242-4.138,9.242-9.242v-69.317h90.562v69.317 c0,5.104,4.138,9.242,9.242,9.242c5.104,0,9.242-4.138,9.242-9.242V385.699h2.773c5.104,0,9.242-4.138,9.242-9.242 C171.504,371.352,167.367,367.214,162.263,367.214z M141.006,408.794H50.443V385.7h90.562V408.794z'/> <path d='M482.822,200.853c-5.104,0-9.242,4.138-9.242,9.242v157.119H349.732c-5.104,0-9.242,4.138-9.242,9.242 c0,5.104,4.138,9.242,9.242,9.242h2.773v110.895c0,5.104,4.138,9.242,9.242,9.242c5.104,0,9.242-4.138,9.242-9.242v-69.317h90.575 v69.317c0,5.104,4.138,9.242,9.242,9.242c5.104,0,9.242-4.138,9.242-9.242V385.699h2.773c5.104,0,9.242-4.138,9.242-9.242V210.095 C492.064,204.991,487.927,200.853,482.822,200.853z M461.564,408.794H370.99V385.7h90.575V408.794z'/> <path d='M394.46,279.106H265.245V154.039c0-5.104-4.137-9.242-9.242-9.242c-5.104,0-9.242,4.138-9.242,9.242v125.067H117.54 c-5.104,0-9.242,4.138-9.242,9.242c0,5.104,4.138,9.242,9.242,9.242h9.067v22.822c0,5.104,4.138,9.242,9.242,9.242h240.3 c5.104,0,9.242-4.138,9.242-9.242V297.59h9.069c5.104,0,9.242-4.138,9.242-9.242C403.703,283.244,399.564,279.106,394.46,279.106z M366.907,311.169H145.092v-13.58h221.815V311.169z'/> <path d='M298.345,487.354h-33.099V351.219c0-5.104-4.138-9.242-9.242-9.242c-5.104,0-9.242,4.138-9.242,9.242v136.134h-33.107 c-5.104,0-9.242,4.138-9.242,9.242s4.138,9.242,9.242,9.242h84.69c5.104,0,9.242-4.138,9.242-9.242 S303.449,487.354,298.345,487.354z'/> <path d='M508.595,116.06c-68.646-55.926-154.887-87.16-243.353-88.282V15.404c0-5.104-4.138-9.242-9.242-9.242 c-5.104,0-9.242,4.138-9.242,9.242v12.375C158.292,28.901,72.051,60.136,3.405,116.062c-3.031,2.47-4.18,6.579-2.87,10.264 c1.31,3.683,4.797,6.144,8.708,6.144h364.118c0.006,0,0.012,0.001,0.018,0.001s0.012-0.001,0.018-0.001h129.359 c3.91,0,7.396-2.461,8.707-6.144C512.775,122.64,511.627,118.53,508.595,116.06z M36.8,113.984 c45.029-31.497,96.555-52.701,150.479-62.156c-19.461,14.55-37.699,35.467-53.896,62.156H36.8z M155.263,113.984 c29.102-43.846,63.751-67.774,98.686-67.774h4.102c34.935,0,69.582,23.928,98.686,67.774H155.263z M378.617,113.984 c-16.197-26.689-34.436-47.607-53.896-62.156c53.924,9.455,105.451,30.66,150.479,62.156H378.617z'/> </g></svg>",telephone_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 202.918 202.918' style='enable-background:new 0 0 202.918 202.918;' xml:space='preserve'><g fill='%23fff'><path d='M185.815,168.463c-0.641,2.686-3.338,4.348-6.023,3.703c-2.687-0.641-4.345-3.338-3.703-6.023 c2.783-11.662,1.322-21.9-3.907-27.386c-3.482-3.652-8.442-4.899-14.737-3.716c-12.512,2.359-20.484,13.166-29.716,25.68 c-7.73,10.477-16.491,22.352-29.351,30.305c-12.503,7.732-26.774,11.893-40.589,11.893c-1.304,0-2.602-0.036-3.895-0.111 c-15.025-0.866-27.414-6.857-33.988-16.438c-8.301-12.096-3.537-24.684,2.934-33.277l-5.057-6.758 c-3.798-5.074-2.803-12.353,2.218-16.223l32.649-25.162c2.058-1.587,4.518-2.426,7.113-2.426c3.659,0,7.151,1.748,9.342,4.675 l12.042,16.092c9.594-4.324,20.569-11.658,32.472-23.738c12.029-12.207,19.245-23.423,23.482-33.092l-16.074-12.388 c-5.022-3.87-6.017-11.148-2.218-16.224l24.825-33.175C145.825,1.748,149.317,0,152.976,0c2.596,0,5.055,0.839,7.114,2.426 l18.787,14.479c0.024,0.019,0.042,0.043,0.066,0.062c0.145,0.118,0.275,0.249,0.405,0.382c0.117,0.117,0.235,0.23,0.338,0.356 c0.07,0.086,0.128,0.179,0.191,0.27c0.136,0.191,0.265,0.384,0.371,0.589c0.024,0.048,0.043,0.098,0.066,0.146 c0.125,0.261,0.229,0.528,0.307,0.804c0.002,0.006,0.005,0.012,0.007,0.018c0.475,1.748,10.961,43.469-45.93,101.204 c-40.888,41.493-73.748,47.69-89.697,47.69c-0.001,0-0.001,0-0.002,0c-6.224-0.001-9.797-0.948-10.184-1.057 c-0.011-0.003-0.02-0.009-0.03-0.012c-0.264-0.077-0.515-0.179-0.761-0.298c-0.07-0.033-0.143-0.061-0.211-0.098 c-0.185-0.1-0.357-0.218-0.528-0.341c-0.109-0.077-0.22-0.15-0.322-0.235c-0.117-0.099-0.223-0.211-0.331-0.321 c-0.132-0.133-0.261-0.265-0.377-0.411c-0.023-0.03-0.053-0.052-0.075-0.082l-3.043-4.067c-3.37,5.259-5.698,12.339-0.986,19.204 c9.55,13.914,39.363,17.646,64.967,1.809c11.218-6.937,19.019-17.511,26.564-27.736c10.047-13.618,19.537-26.481,35.909-29.568 c9.564-1.803,18.026,0.555,23.829,6.643C186.998,139.806,189.389,153.49,185.815,168.463z'/></g></svg>",thermometer_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' viewBox='0 0 612 612' xml:space='preserve'><g fill='%23fff'> <path d='M385.09 52.42c-4.32-10.23-10.51-19.4-18.39-27.28s-17.05-14.06-27.28-18.39C328.82 2.27 317.58 0 306 0s-22.82 2.27-33.42 6.76c-10.23 4.33-19.4 10.51-27.28 18.39 -7.87 7.87-14.06 17.05-18.39 27.28 -4.48 10.6-6.76 21.85-6.76 33.42v289.85c-12.61 10.58-23.26 23.45-31.24 37.86 -10.9 19.7-16.67 42.07-16.67 64.7 0 18.04 3.54 35.56 10.52 52.07 6.74 15.93 16.38 30.23 28.65 42.51 12.27 12.27 26.58 21.92 42.51 28.65 16.51 6.98 34.03 10.52 52.07 10.52s35.56-3.54 52.07-10.52c15.93-6.74 30.23-16.38 42.51-28.65 12.27-12.27 21.92-26.58 28.65-42.51 6.98-16.51 10.52-34.03 10.52-52.07 0-22.63-5.76-45-16.67-64.7 -7.98-14.41-18.63-27.28-31.24-37.86V85.85C391.84 74.27 389.57 63.02 385.09 52.42zM411.52 478.25c0 58.28-47.24 105.52-105.52 105.52s-105.52-47.24-105.52-105.52c0-37.02 19.07-69.57 47.91-88.41V85.85c0-31.82 25.8-57.61 57.61-57.61l0 0c31.82 0 57.61 25.8 57.61 57.61v4.25H312.9c-7.79 0-14.11 6.32-14.11 14.12s6.32 14.12 14.12 14.12h50.71v28.23H312.9c-7.79 0-14.11 6.32-14.11 14.12s6.32 14.12 14.12 14.12h50.71v28.23H312.9c-7.79 0-14.11 6.32-14.11 14.12 0 7.8 6.32 14.12 14.12 14.12h50.71v158.59C392.46 408.67 411.52 441.23 411.52 478.25z'/> <path class='svg_state' d='M351.61 408.22l-9.95-6.5v-11.89 -101.88c0-19.66-16-35.66-35.66-35.66s-35.66 16-35.66 35.66v101.88 11.89l-9.95 6.5c-23.77 15.52-37.95 41.7-37.95 70.03 0 22.32 8.69 43.31 24.48 59.09 15.78 15.78 36.77 24.48 59.09 24.48s43.31-8.69 59.09-24.47c15.78-15.78 24.48-36.77 24.48-59.09C389.56 449.92 375.37 423.74 351.61 408.22z'/></g></svg>",tools_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 283.46 283.46' style='enable-background:new 0 0 283.46 283.46;' xml:space='preserve'><g fill='%23fff'><path d='M200.133,157.32c-2.105-2.105-4.904-3.264-7.881-3.264c-2.977,0-5.776,1.159-7.881,3.264l-9.678,9.678l-14.194-14.194 l43.496-43.494c7.016,3.017,14.634,4.613,22.498,4.613c0.001,0,0,0,0.001,0c15.248,0,29.576-5.948,40.341-16.746 c14.694-14.74,20.177-36.316,14.308-56.309c-0.341-1.163-1.272-2.06-2.446-2.359c-1.174-0.3-2.42,0.044-3.276,0.903l-35.874,35.983 c-2.153-0.873-7.577-3.85-17.615-13.858c-10.038-10.008-13.034-15.423-13.915-17.574l35.872-35.985 c0.856-0.859,1.195-2.105,0.893-3.279c-0.303-1.174-1.202-2.102-2.367-2.44C237.244,0.76,231.886,0,226.489,0 c-15.249,0-29.574,5.946-40.337,16.744c-16.893,16.946-20.87,41.948-11.981,62.704l-43.515,43.514L86.118,78.424 c-0.039-0.076-0.066-0.154-0.109-0.229L65.651,43.294c-0.352-0.603-0.83-1.12-1.403-1.518L29.906,17.948 c-1.899-1.318-4.467-1.086-6.1,0.547l-15.3,15.3c-1.634,1.633-1.864,4.202-0.547,6.1l23.828,34.342 c0.398,0.573,0.915,1.052,1.518,1.403l34.902,20.358c0.077,0.045,0.158,0.078,0.237,0.118l44.528,44.528l-33.508,33.508 c-7.016-3.017-14.633-4.613-22.497-4.613c-15.25,0-29.577,5.947-40.342,16.746C1.931,201.025-3.551,222.602,2.319,242.592 c0.341,1.163,1.271,2.06,2.446,2.359c1.174,0.298,2.42-0.044,3.276-0.903l35.874-35.984c2.153,0.874,7.576,3.853,17.613,13.858 c10.04,10.009,13.036,15.423,13.916,17.574l-35.872,35.985c-0.856,0.859-1.195,2.105-0.893,3.279 c0.303,1.174,1.202,2.102,2.367,2.439c5.17,1.5,10.528,2.261,15.926,2.261c15.247,0,29.573-5.947,40.336-16.745 c10.742-10.776,16.645-25.089,16.622-40.305c-0.012-7.841-1.609-15.433-4.617-22.424l33.502-33.501l14.194,14.194l-9.677,9.677 c-2.105,2.106-3.265,4.905-3.265,7.882c0,2.978,1.159,5.776,3.264,7.881l68.364,68.363c2.105,2.105,4.903,3.264,7.88,3.264 c2.977,0,5.776-1.159,7.882-3.264l37.036-37.037c2.106-2.105,3.266-4.904,3.266-7.882c0-2.977-1.159-5.776-3.264-7.881 L200.133,157.32z M224.331,254.164c-2.437,2.438-6.386,2.438-8.821,0l-43.859-43.858c-2.436-2.435-2.436-6.384,0-8.821 c2.436-2.436,6.385-2.436,8.821,0.002l43.858,43.857C226.766,247.779,226.767,251.729,224.331,254.164z M244.177,234.318 c-2.435,2.436-6.386,2.436-8.821,0l-43.857-43.859c-2.436-2.435-2.436-6.385-0.001-8.82c2.436-2.436,6.386-2.436,8.821,0 l43.858,43.859C246.612,227.934,246.612,231.883,244.177,234.318z'/></g></svg>",traveler_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512.001 512.001' style='enable-background:new 0 0 512.001 512.001;' xml:space='preserve'> <g fill='%23fff'> <path d='M156.683,411.479h-22.274v-19.652c0-8.907-7.246-16.153-16.153-16.153H82.367c-8.907,0-16.153,7.246-16.153,16.153v19.652 H43.941c-6.244,0-11.307,5.063-11.307,11.307v77.906c0,6.245,5.063,11.307,11.307,11.307h112.741 c6.244,0,11.307-5.063,11.307-11.307v-77.906C167.989,416.541,162.927,411.479,156.683,411.479z M116.845,411.479h-0.001H83.78 v-18.24h33.065V411.479z'/> <circle cx='259.839' cy='42.141' r='42.141'/> <path d='M467.168,326.163h-9.066v-54.005h7.442c2.221,0,4.022-1.801,4.022-4.022v-13.406c0-2.221-1.801-4.022-4.022-4.022H412.71 c2.989-8.683-0.201-18.595-8.286-23.747l-41.732-26.595l-0.331-54.776c-0.133-26.399-21.718-47.876-48.118-47.876 c-11.299,0-97.821,0-109.159,0c-26.4,0-47.985,21.477-48.118,47.876l-0.751,149.38c-0.057,11.23,9.001,20.379,20.23,20.435 c0.036,0,0.07,0,0.104,0c11.181,0,20.275-9.037,20.331-20.23l0.751-149.38c0.011-2.166,1.772-3.913,3.936-3.908 c2.165,0.006,3.915,1.762,3.915,3.926l0.009,341.787c0,13.476,10.924,24.4,24.4,24.4c13.476,0,24.4-10.924,24.4-24.4V292.57 h10.534v195.029c0,13.476,10.924,24.4,24.4,24.4c13.476,0,24.4-10.924,24.4-24.4c0-318.415-0.432-143.909-0.443-341.647 c0-2.323,1.863-4.217,4.186-4.256c2.323-0.038,4.249,1.794,4.324,4.116c0,0,0,0.001,0,0.002l0.398,65.869 c0.041,6.903,3.582,13.314,9.405,17.024l45.98,29.302v10.125c0,2.221,1.801,4.022,4.022,4.022h7.442v54.005h-9.066 c-6.738,0-12.199,5.462-12.199,12.199v139.941c0,6.738,5.462,12.199,12.199,12.199h9.066v13.177c0,4.595,3.726,8.321,8.321,8.321 c4.595,0,8.321-3.726,8.321-8.321v-13.177h35.877v13.177c0,4.595,3.726,8.321,8.321,8.321c4.595,0,8.321-3.726,8.321-8.321 v-13.177h9.065c6.738,0,12.199-5.462,12.199-12.199v-139.94C479.366,331.624,473.906,326.163,467.168,326.163z M441.46,326.163 h-35.873v-54.005h35.873V326.163z'/> </g></svg>",tv_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='32' height='32' viewBox='0 0 32 32' xml:space='preserve'><g fill='%23fff'> <path d='M32 24V4H0v20h15v2h-4v2h10v-2h-4v-2H32zM2 22V6h28v16H2z'/></g></svg>",vacuum_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='55.254px' height='55.253px' viewBox='0 0 55.254 55.253' style='enable-background:new 0 0 55.254 55.253;' xml:space='preserve'> <g fill='%23fff'> <path d='M41.702,29.582c-1.519-7.248-5.13-13.871-13.693-14.206c-0.777-1.279-1.261-2.188-1.391-2.438 c-2.188-5.041-7.3-8.419-12.759-8.419C6.217,4.519,0,10.736,0,18.377c0,2.071,0.472,4.03,1.292,5.795c2.193,4.716,6.96,8,12.49,8 h9.472c1.657,0,3-1.342,3-3c0-1.657-1.343-3-3-3h-9.47c-1.994,0-3.809-0.761-5.187-2c-1.589-1.428-2.596-3.493-2.596-5.795 c0-4.333,3.525-7.858,7.859-7.858c3.121,0,6.047,1.957,7.281,4.868l0.083,0.178c0.047,0.094,0.209,0.411,0.469,0.885 c-3.395,1.476-5.626,4.31-7.079,7.721h9.363c2.362,0.001,4.277,2.096,4.277,4.68v0.642c0,2.583-1.915,4.679-4.278,4.679H12.262 c-0.396,3.75-0.4,7.347-0.4,10c0,1.461,1.039,2.65,2.724,3.578c-0.004,0.061-0.018,0.117-0.018,0.18 c0,1.55,1.256,2.806,2.805,2.806c0.981,0,1.842-0.506,2.343-1.271c4.885,0.979,11.113,0.938,15.875-0.129 c0.486,0.834,1.38,1.398,2.413,1.398c1.549,0,2.805-1.256,2.805-2.807c0-0.196-0.021-0.389-0.061-0.574 c1.292-0.862,2.061-1.924,2.061-3.182c0-2.123-0.002-4.849-0.205-7.771c1.653,0.49,3.377,0.777,5.17,0.777 c0.157,0,0.32-0.014,0.48-0.02v-6.005C45.963,31.244,43.755,30.621,41.702,29.582z M27.728,44.666 c-1.906,0-3.451-1.545-3.451-3.451c0-1.905,1.545-3.451,3.451-3.451c1.906,0,3.451,1.546,3.451,3.451 C31.179,43.121,29.634,44.666,27.728,44.666z'/> <path d='M53.895,27.172h-3.281c-0.75,0-1.359,0.609-1.359,1.359v13.282c0,0.75,0.609,1.358,1.359,1.358h3.281 c0.75,0,1.359-0.608,1.359-1.358V28.531C55.254,27.781,54.645,27.172,53.895,27.172z'/> </g></svg>",ventilator_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' viewBox='0 0 25.81 25.81' xml:space='preserve'><g fill='%23fff'> <path d='M12.91 1.11c4.79 0 8.69 3.9 8.69 8.7 0 4.8-3.9 8.7-8.7 8.7 -4.8 0-8.7-3.9-8.7-8.7 0-4.8 3.9-8.7 8.7-8.7L12.91 1.11M12.91 0h0c0 0 0 0 0 0C7.49 0 3.09 4.39 3.09 9.81c0 5.42 4.4 9.81 9.81 9.81 5.42 0 9.81-4.4 9.81-9.81C22.72 4.39 18.32 0 12.91 0L12.91 0z'/> <path d='M13.91 7.88c0.88-3.25-0.98-5.33-3.47-5.09 -1.18 0.12-2.35 1.62-1.63 2.99 0.68 1.28 2.1 1.17 2.54 2.63C11.75 7.85 12.55 7.22 13.91 7.88z'/> <path d='M10.73 9.91c-3.25 0.87-4.13 3.51-2.67 5.55 0.69 0.96 2.58 1.23 3.4-0.08 0.77-1.23-0.04-2.4 1.01-3.51C11.79 11.8 10.84 11.41 10.73 9.91z'/> <path d='M14.08 11.65c2.38 2.38 5.1 1.82 6.15-0.46 0.49-1.07-0.22-2.85-1.77-2.91 -1.45-0.05-2.06 1.24-3.54 0.88C15.19 9.79 15.33 10.8 14.08 11.65z'/> <circle cx='12.91' cy='9.81' r='1.3'/> <path d='M14.91 20.81c0 0-0.38 0.31-2 0.31s-2-0.31-2-0.31c0 2-4 2.34-4 4v1h12v-1C18.91 23.16 14.91 22.81 14.91 20.81z'/></g></svg>",ventilator_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 496 496' style='enable-background:new 0 0 496 496;' xml:space='preserve'> <g fill='%23fff'> <path d='M248,208c-22.056,0-40,17.944-40,40c0,22.056,17.944,40,40,40c22.056,0,40-17.944,40-40C288,225.944,270.056,208,248,208 z M248,272c-13.232,0-24-10.768-24-24s10.768-24,24-24s24,10.768,24,24S261.232,272,248,272z'/> <path d='M424,192H293.152c-2.312-1.872-4.776-3.56-7.312-5.136c21.304-16.512,34.16-41.912,34.16-69.352V0h-56 c-39.696,0-72,32.304-72,72v130.848c-1.872,2.312-3.56,4.776-5.136,7.312c-16.512-21.304-41.92-34.16-69.352-34.16H0v56 c0,39.704,32.304,72,72,72h130.848c2.32,1.872,4.776,3.56,7.312,5.136c-21.304,16.512-34.16,41.912-34.16,69.36V496h56 c39.696,0,72-32.296,72-72V293.152c1.872-2.32,3.56-4.776,5.136-7.312c16.512,21.304,41.912,34.16,69.352,34.16H496v-56 C496,224.304,463.696,192,424,192z M208,72c0-30.88,25.12-56,56-56h40v101.512c0,25.368-13.44,48.6-35.144,61.592 c-6.608-2-13.6-3.104-20.856-3.104c-2.704,0-5.368,0.176-8,0.472V128c0-12.52,5.984-24.488,16-32l12.8-9.6l-9.6-12.8l-12.8,9.6 C232.376,93.72,224,110.464,224,128v52.2c-5.688,2.016-11.072,4.664-16,7.976V72z M72,288c-30.88,0-56-25.128-56-56v-40h101.512 c25.368,0,48.6,13.44,61.592,35.144c-2,6.608-3.104,13.6-3.104,20.856c0,2.704,0.176,5.368,0.472,8H128 c-12.52,0-24.488-5.984-32-16l-9.6-12.8l-12.8,9.6l9.6,12.8C93.72,263.624,110.464,272,128,272h52.2 c2.016,5.688,4.664,11.072,7.976,16H72z M288,424c0,30.872-25.12,56-56,56h-40V378.496c0-25.368,13.448-48.608,35.152-61.6 c6.6,2,13.6,3.104,20.848,3.104c2.704,0,5.368-0.176,8-0.472V368c0,12.52-5.984,24.488-16,32l-12.8,9.6l9.6,12.8l12.8-9.6 c14.024-10.512,22.4-27.264,22.4-44.8v-52.2c5.688-2.016,11.072-4.664,16-7.976V424z M248,304c-30.88,0-56-25.128-56-56 c0-30.88,25.12-56,56-56s56,25.12,56,56C304,278.872,278.88,304,248,304z M480,304H378.488c-25.368,0-48.6-13.44-61.592-35.144 c2-6.608,3.104-13.6,3.104-20.856c0-2.704-0.176-5.368-0.472-8H368c12.52,0,24.488,5.984,32,16l9.6,12.8l12.8-9.592l-9.6-12.808 C402.28,232.376,385.536,224,368,224h-52.2c-2.016-5.688-4.664-11.072-7.976-16H424c30.88,0,56,25.12,56,56V304z'/> <path d='M441.128,134.552l13.792-8.12c-26.504-45.024-67.656-80.72-115.88-100.512l-6.072,14.808 C377.976,59.192,416.384,92.512,441.128,134.552z'/> <path d='M455.272,163.04l14.8-6.08c-2.112-5.136-4.432-10.272-6.896-15.272l-14.344,7.096 C451.128,153.448,453.296,158.248,455.272,163.04z'/> <path d='M393.192,148.504l13.184-9.056c-17.08-24.888-40.096-45.664-66.544-60.096L332.168,93.4 C356.424,106.632,377.52,125.688,393.192,148.504z'/> <path d='M410.008,179.136l14.72-6.272c-2.416-5.672-5.136-11.288-8.08-16.688L402.6,163.84 C405.304,168.792,407.792,173.936,410.008,179.136z'/> <path d='M155.312,44.072l-6.632-14.56c-55.872,25.44-99.472,70.696-122.76,127.456l14.808,6.072 C62.464,110.064,103.16,67.816,155.312,44.072z'/> <path d='M178.48,35.056l-4.96-15.216c-4.432,1.44-8.8,3.016-13.112,4.704l5.832,14.896 C170.272,37.864,174.344,36.4,178.48,35.056z'/> <path d='M79.352,156.168l14.048,7.664c13.232-24.256,32.296-45.368,55.128-61.032l-9.048-13.2 C114.576,106.688,93.792,129.712,79.352,156.168z'/> <path d='M70.336,384.36l-12.688,9.752c25.856,33.648,60.2,59.92,99.32,75.968l6.072-14.8 C126.536,440.296,94.48,415.776,70.336,384.36z'/> <path d='M51.864,356.168l-14,7.752c3.096,5.6,6.464,11.152,10,16.48l13.336-8.832C57.896,366.584,54.76,361.408,51.864,356.168z' /> <path d='M102.808,347.496l-13.184,9.064c17.088,24.872,40.096,45.656,66.544,60.096l7.664-14.048 C139.584,389.368,118.48,370.312,102.808,347.496z'/> <path d='M347.2,448.832l7.096,14.344c52.472-25.96,93.592-70.048,115.784-124.136l-14.808-6.08 C434.56,383.448,396.176,424.592,347.2,448.832z'/> <path d='M317.512,460.952l4.968,15.2c5.632-1.832,11.2-3.888,16.56-6.096l-6.096-14.8 C327.968,457.32,322.768,459.232,317.512,460.952z'/> <path d='M416.648,339.832l-14.048-7.656c-14.76,27.056-36.472,49.872-62.776,66l8.36,13.64 C376.872,394.224,400.544,369.336,416.648,339.832z'/> </g></svg>",warning_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' viewBox='0 0 15.91 15.91' xml:space='preserve'><g fill='%23fff'> <path d='M15.79 13.98l-6.94-13C8.68 0.66 8.34 0.45 7.97 0.45H7.97c-0.37 0-0.71 0.2-0.88 0.53l-6.97 13c-0.17 0.31-0.16 0.69 0.02 0.99C0.32 15.27 0.65 15.45 1 15.45h13.91c0.35 0 0.68-0.18 0.86-0.49C15.95 14.67 15.95 14.29 15.79 13.98zM7.97 13.45c-0.55 0-1-0.45-1-1s0.45-1 1-1c0.55 0 1 0.45 1 1S8.52 13.45 7.97 13.45zM8.97 9.47c0 0.55-0.45 1-1 1 -0.55 0-1-0.45-1-1v-4c0-0.55 0.45-1 1-1 0.55 0 1 0.45 1 1V9.47z'/></g></svg>",washer_1:"<svg xmlns='http://www.w3.org/2000/svg' version='1.1' id='svg' x='0' y='0' width='27.08' height='27.08' viewBox='0 0 27.08 27.08' xml:space='preserve'><g fill='%23fff'> <path d='M21.88 0H5.21C3.48 0 2.08 1.4 2.08 3.13v20.83c0 1.73 1.4 3.13 3.13 3.13h16.67c1.73 0 3.13-1.4 3.13-3.12V3.13C25 1.4 23.6 0 21.88 0zM16.15 1.96c0.93 0 1.69 0.76 1.69 1.69 0 0.93-0.76 1.69-1.69 1.69 -0.93 0-1.69-0.76-1.69-1.69C14.46 2.71 15.21 1.96 16.15 1.96zM13.54 21.94c-4.06 0-7.35-3.29-7.35-7.35 0-4.06 3.29-7.35 7.35-7.35 4.06 0 7.35 3.29 7.35 7.35C20.9 18.65 17.6 21.94 13.54 21.94zM21.35 5.33c-0.93 0-1.69-0.76-1.69-1.69 0-0.93 0.76-1.69 1.69-1.69s1.69 0.76 1.69 1.69C23.04 4.58 22.29 5.33 21.35 5.33z'/> <path d='M13.54 8.53c-3.34 0-6.05 2.71-6.05 6.06 0 3.34 2.71 6.05 6.06 6.05 3.34 0 6.06-2.71 6.06-6.05C19.6 11.24 16.89 8.53 13.54 8.53zM13.54 9.57c2.61 0 4.74 2.01 4.97 4.56 -1.86-0.99-2.75 0.41-4.97 0.41 -2.23 0-2.88-1.52-4.97-0.41C8.81 11.59 10.93 9.57 13.54 9.57z'/></g></svg>",waterdrops_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 359.145 359.145' style='enable-background:new 0 0 359.145 359.145;' xml:space='preserve'><g fill='%23fff'> <path d='M329.897,145.391L282.363,10.03C280.253,4.021,274.579,0,268.21,0s-12.043,4.021-14.152,10.03l-47.534,135.36 c-7.117,20.267-4.075,41.941,8.346,59.467c12.42,17.524,31.861,27.575,53.341,27.575s40.923-10.051,53.343-27.576 C333.973,187.332,337.014,165.657,329.897,145.391z M297.077,187.51c-6.722,9.483-17.242,14.923-28.866,14.923 c-11.623,0-22.144-5.438-28.865-14.922c-6.721-9.484-8.367-21.214-4.517-32.181l33.382-95.059l33.382,95.059 C305.443,166.298,303.797,178.026,297.077,187.51z'/> <path d='M168.592,170.863c-2.109-6.009-7.784-10.03-14.152-10.03s-12.043,4.021-14.152,10.03l-39.521,112.545 c-6.102,17.375-3.388,36.718,7.26,51.742c10.648,15.024,27.999,23.994,46.414,23.994s35.766-8.97,46.414-23.994 c10.647-15.024,13.361-34.367,7.26-51.742L168.592,170.863z M176.377,317.804c-5.108,7.207-13.104,11.341-21.938,11.341 s-16.829-4.134-21.938-11.341c-5.107-7.207-6.358-16.121-3.432-24.456l25.369-72.242l25.369,72.242 C182.736,301.683,181.485,310.597,176.377,317.804z'/> <path d='M108.712,157.256c8.581-12.107,10.769-27.695,5.852-41.697L85.462,32.688c-2.109-6.009-7.784-10.03-14.152-10.03 s-12.043,4.021-14.152,10.03l-29.102,82.871c-4.917,14.002-2.729,29.59,5.852,41.697c8.58,12.107,22.563,19.336,37.402,19.336 S100.132,169.363,108.712,157.256z M84.237,139.909c-3.01,4.247-7.722,6.683-12.927,6.683s-9.917-2.436-12.927-6.683 s-3.747-9.5-2.022-14.411L71.31,82.93l14.949,42.568C87.984,130.409,87.246,135.662,84.237,139.909z'/></g></svg>",waves_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 611.998 611.998' style='enable-background:new 0 0 611.998 611.998;' xml:space='preserve'> <g fill='%23fff'> <path d='M23.538,156.923c16.412,0,23.419,4.67,34.023,11.739c13.128,8.752,29.465,19.646,60.129,19.646 c30.665,0,47.003-10.893,60.13-19.646c10.601-7.069,17.607-11.737,34.014-11.737c16.411,0,23.415,4.67,34.019,11.737 c13.13,8.754,29.467,19.646,60.135,19.646c30.663,0,47.004-10.893,60.134-19.646c10.601-7.068,17.607-11.737,34.018-11.737 c16.414,0,23.422,4.67,34.026,11.739c13.13,8.752,29.469,19.646,60.136,19.646c30.665,0,47.003-10.893,60.132-19.646 c10.606-7.069,17.612-11.739,34.026-11.739c13,0,23.538-10.539,23.538-23.538c0-13-10.538-23.54-23.538-23.54 c-30.67,0-47.009,10.893-60.139,19.646c-10.604,7.069-17.61,11.737-34.019,11.737c-16.414,0-23.419-4.67-34.023-11.739 c-13.13-8.752-29.47-19.646-60.139-19.646c-30.665,0-47.004,10.893-60.134,19.646c-10.602,7.069-17.607,11.739-34.018,11.739 c-16.414,0-23.419-4.67-34.023-11.739c-13.128-8.752-29.469-19.646-60.132-19.646c-30.665,0-47.003,10.893-60.13,19.646 c-10.601,7.069-17.607,11.737-34.014,11.737s-23.414-4.67-34.014-11.737c-13.13-8.754-29.469-19.648-60.137-19.648 C10.538,109.846,0,120.385,0,133.385S10.538,156.923,23.538,156.923z'/> <path d='M588.462,266.769c-30.67,0-47.009,10.893-60.139,19.646c-10.604,7.069-17.61,11.737-34.019,11.737 c-16.414,0-23.419-4.67-34.023-11.739c-13.13-8.752-29.47-19.646-60.139-19.646c-30.665,0-47.004,10.893-60.134,19.646 c-10.602,7.068-17.607,11.737-34.018,11.737c-16.414,0-23.419-4.67-34.023-11.739c-13.128-8.752-29.469-19.646-60.132-19.646 c-30.665,0-47.003,10.893-60.13,19.646c-10.601,7.069-17.607,11.737-34.014,11.737s-23.414-4.67-34.014-11.737 c-13.13-8.752-29.469-19.646-60.137-19.646C10.538,266.769,0,277.308,0,290.307c0,13,10.538,23.538,23.538,23.538 c16.412,0,23.419,4.67,34.023,11.739c13.128,8.752,29.465,19.646,60.129,19.646c30.665,0,47.003-10.893,60.13-19.646 c10.601-7.069,17.607-11.737,34.014-11.737c16.411,0,23.415,4.67,34.019,11.737c13.13,8.754,29.467,19.646,60.135,19.646 c30.663,0,47.004-10.893,60.134-19.646c10.601-7.069,17.607-11.739,34.018-11.739c16.414,0,23.422,4.67,34.026,11.739 c13.13,8.752,29.469,19.646,60.136,19.646c30.665,0,47.003-10.892,60.132-19.646c10.606-7.069,17.612-11.739,34.026-11.739 c13,0,23.538-10.539,23.538-23.538C612,277.308,601.462,266.769,588.462,266.769z'/> <path d='M588.462,423.692c-30.67,0-47.009,10.893-60.139,19.646c-10.604,7.069-17.61,11.739-34.019,11.739 c-16.414,0-23.419-4.67-34.023-11.739c-13.13-8.752-29.47-19.646-60.139-19.646c-30.665,0-47.004,10.893-60.134,19.646 c-10.602,7.068-17.607,11.739-34.018,11.739c-16.414,0-23.419-4.67-34.023-11.739c-13.128-8.752-29.469-19.646-60.132-19.646 c-30.665,0-47.003,10.893-60.13,19.646c-10.601,7.069-17.607,11.739-34.014,11.739s-23.414-4.67-34.014-11.739 c-13.13-8.752-29.469-19.646-60.137-19.646C10.538,423.692,0,434.231,0,447.23c0,13,10.538,23.54,23.538,23.54 c16.412,0,23.419,4.67,34.023,11.739c13.128,8.752,29.465,19.646,60.129,19.646c30.665,0,47.003-10.893,60.13-19.646 c10.601-7.069,17.607-11.737,34.014-11.737c16.411,0,23.415,4.67,34.019,11.737c13.13,8.752,29.467,19.646,60.135,19.646 c30.663,0,47.004-10.893,60.134-19.646c10.601-7.069,17.607-11.739,34.018-11.739c16.414,0,23.422,4.67,34.026,11.739 c13.13,8.752,29.469,19.644,60.136,19.644c30.665,0,47.003-10.892,60.132-19.644c10.606-7.069,17.612-11.739,34.026-11.739 c13,0,23.538-10.539,23.538-23.54C612,434.231,601.462,423.692,588.462,423.692z'/> </g></svg>",weather_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 311.091 311.091' style='enable-background:new 0 0 311.091 311.091;' xml:space='preserve'><g fill='%23fff'> <path d='M117.49,62.227v-0.836L98.801,42.435c-1.113-1.128-2.631-1.764-4.216-1.764s-3.103,0.636-4.216,1.764l-18.69,18.956v0.836 c7.24-2.271,14.931-3.509,22.912-3.509C102.565,58.719,110.256,59.951,117.49,62.227z'/> <path d='M26.791,99.861c7.245-13.826,18.575-25.152,32.396-32.401l-0.634-0.635L31.933,66.64c-1.584-0.011-3.107,0.613-4.228,1.733 c-1.12,1.12-1.745,2.643-1.734,4.227l0.181,26.624L26.791,99.861z'/> <path d='M20.723,112.348L1.765,131.033C0.636,132.145,0,133.664,0,135.249c0,1.585,0.635,3.104,1.764,4.217l18.959,18.692h0.832 c-2.277-7.233-3.508-14.931-3.508-22.904c0-7.976,1.231-15.672,3.508-22.906H20.723z'/> <path d='M181.121,124.825l-12.659-12.478h-0.842c1.841,5.861,2.91,12.041,3.281,18.409 C173.902,128.414,177.345,126.422,181.121,124.825z'/> <path d='M162.383,99.851l0.634-0.633l0.186-26.626c0.011-1.585-0.613-3.107-1.734-4.229c-1.121-1.12-2.643-1.744-4.228-1.733 l-26.621,0.187l-0.64,0.638C143.803,74.699,155.134,86.031,162.383,99.851z'/> <path d='M26.787,170.65l-0.634,0.633l-0.186,26.622c-0.011,1.585,0.613,3.107,1.734,4.228c1.121,1.121,2.643,1.745,4.228,1.734 l26.626-0.186l0.629-0.629C45.362,195.801,34.031,184.47,26.787,170.65z'/> <path d='M94.59,74.294c-33.669,0-60.97,27.296-60.97,60.96c0,27.605,18.362,50.9,43.535,58.404 c3.843-1.882,8.055-3.14,12.512-3.549c2.916-17.142,17.871-30.231,35.828-30.231h10.631c2.764-9.526,9.983-17.146,19.22-20.544 c0.091-1.358,0.208-2.701,0.208-4.08C155.554,101.59,128.253,74.294,94.59,74.294z'/> <path d='M290.325,205.525h-8.786c1.419-2.809,2.297-5.941,2.297-9.307c0-11.469-9.298-20.767-20.766-20.767h-11.097 c1.044-2.089,1.688-4.421,1.688-6.916c0-8.599-6.971-15.574-15.575-15.574h-5.857c-1.683-9.48-14.023-16.872-29.186-16.872 c-15.165,0-27.505,7.393-29.189,16.872h-7.801c-8.603,0-15.574,6.976-15.574,15.574c0,2.495,0.644,4.827,1.688,6.916h-26.673 c-11.468,0-20.765,9.298-20.765,20.767c0,3.365,0.877,6.498,2.296,9.307H93.049c-11.468,0-20.766,9.298-20.766,20.766 c0,11.469,9.298,20.767,20.766,20.767h27.793c-1.338,2.302-2.16,4.938-2.16,7.787c0,8.6,6.971,15.574,15.574,15.574h72.032 c8.604,0,15.575-6.975,15.575-15.574c0-2.85-0.822-5.485-2.16-7.787h70.622c11.468,0,20.766-9.298,20.766-20.767 C311.091,214.823,301.793,205.525,290.325,205.525z'/></g></svg>",weights_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 484.535 484.535' style='enable-background:new 0 0 484.535 484.535;' xml:space='preserve'> <g fill='%23fff'> <path d='M170.267,446.269c4.664,4.665,4.33,9.331-1,13.998l-22,21c-4.667,4.667-9.333,4.334-14-1 l-130-138.998c-4.667-5.334-4.333-10.334,1-15l22-20.999c4.667-4.664,9.333-4.332,14,0.999L170.267,446.269z'/> <path d='M335.267,183.268c4.668,4.668,4.668,9.334,0,14l-139.999,131c-5.333,4.666-10.333,4.666-15,0 l-33-36c-4.667-5.334-4.667-10.334,0-15l140-131c5.332-4.667,10.332-4.333,15,1L335.267,183.268z'/> <path d='M218.267,401.269c4.663,4.666,4.33,9.332-1,14l-22,21c-5.333,4.666-10.333,4.666-15,0l-129-139.999 c-4.667-4.668-4.667-9.334,0-14l23-21c4.667-4.668,9.333-4.668,14,0L218.267,401.269z'/> <path d='M433.269,188.268c4.666,4.669,4.666,9.335,0,14l-23,21c-4.67,4.667-9.338,4.667-14,0l-128.999-140 c-4.668-4.667-4.668-9.333,0-14l22-21c5.332-4.667,10.332-4.667,15,0L433.269,188.268z'/> <path d='M481.269,143.268c4.666,5.333,4.332,10.333-1,15l-22,21c-4.67,4.658-9.338,4.325-14-1l-130-139 c-4.657-5.333-4.323-10.333,1-15l22-21c4.666-4.667,9.332-4.333,14,1L481.269,143.268z'/> </g></svg>",wheelbarrow_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 511.999 511.999' style='enable-background:new 0 0 511.999 511.999;' xml:space='preserve'><g fill='%23fff'> <path d='M510.432,318.615c-3.895-8.351-13.82-11.964-22.169-8.069c-1.747,0.815-197.877,92.273-204.292,95.264 c-10.573-10.747-25.561-16.196-40.566-14.745L105.541,97.725C94.257,73.527,70.668,58.043,43.98,57.314l-26.843-0.733 C7.9,56.307,0.258,63.591,0.006,72.801s7.011,16.88,16.22,17.13l26.843,0.733c13.975,0.383,26.327,8.49,32.257,21.206 l137.841,293.292c-14.43,14.165-19.616,36.778-10.256,56.852c11.64,24.963,41.331,35.945,66.506,24.206 c20.111-9.378,30.647-30.07,28.682-50.186l154.337-71.969l11.038,22.075c4.126,8.252,14.154,11.576,22.381,7.46 c8.241-4.12,11.58-14.14,7.46-22.38l-10.631-21.26l19.679-9.176C510.713,336.89,514.325,326.965,510.432,318.615z M255.316,455.981c-8.355,3.896-18.271,0.29-22.168-8.067c-3.897-8.357-0.289-18.272,8.068-22.17 c8.34-3.887,18.283-0.265,22.169,8.068C267.281,442.169,263.674,452.083,255.316,455.981z'/> <path d='M446.847,274.639l-56.399-120.948c-3.892-8.351-13.819-11.965-22.169-8.069l-15.119,7.05l-35.249-75.592 c-3.893-8.351-13.82-11.964-22.169-8.069l-15.118,7.05l-21.15-45.355c-3.893-8.351-13.82-11.965-22.169-8.069l-90.712,42.299 c-8.344,3.891-11.962,13.819-8.068,22.169c3.978,8.53,124.112,266.159,126.899,272.136c3.895,8.352,13.819,11.963,22.169,8.069 l151.186-70.5C447.122,292.917,450.74,282.989,446.847,274.639z M175.811,88.122l60.475-28.201l14.099,30.237 c-6.357,2.964-52.253,24.366-60.475,28.2L175.811,88.122z M204.012,148.596c11.204-5.225,79.194-36.93,90.711-42.3l28.2,60.474 l-90.711,42.299L204.012,148.596z M288.61,330.02l-42.299-90.712c4.412-2.057,116.187-54.18,120.949-56.399l42.3,90.712 L288.61,330.02z'/></g></svg>",widgets_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 57 57' style='enable-background:new 0 0 57 57;' xml:space='preserve'><g fill='%23fff'> <path d='M22.66,0H3.34C1.498,0,0,1.498,0,3.34v19.32C0,24.502,1.498,26,3.34,26h19.32c1.842,0,3.34-1.498,3.34-3.34V3.34 C26,1.498,24.502,0,22.66,0z'/> <path d='M33.34,26h19.32c1.842,0,3.34-1.498,3.34-3.34V3.34C56,1.498,54.502,0,52.66,0H33.34C31.498,0,30,1.498,30,3.34v19.32 C30,24.502,31.498,26,33.34,26z'/> <path d='M22.66,30H3.34C1.498,30,0,31.498,0,33.34v19.32C0,54.502,1.498,56,3.34,56h19.32c1.842,0,3.34-1.498,3.34-3.34V33.34 C26,31.498,24.502,30,22.66,30z'/> <path d='M55,41H45V31c0-1.104-0.896-2-2-2s-2,0.896-2,2v10H31c-1.104,0-2,0.896-2,2s0.896,2,2,2h10v10c0,1.104,0.896,2,2,2 s2-0.896,2-2V45h10c1.104,0,2-0.896,2-2S56.104,41,55,41z'/></g></svg>",wind_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 612 612' style='enable-background:new 0 0 612 612;' xml:space='preserve'><g fill='%23fff'> <path d='M43.411,335.593h437.203c63.387,0,114.952-51.568,114.952-114.952c0-63.291-51.417-114.8-114.677-114.95 c-6.232-0.094-46.697,0.466-76.913,29.927c-20.244,19.737-30.506,46.857-30.506,80.603c0,14.901,12.078,26.98,26.98,26.98 c14.901,0,26.978-12.08,26.978-26.98c0-18.482,4.697-32.516,13.955-41.709c14.429-14.33,36.875-14.846,38.67-14.864 c0.252,0.008,0.22,0.004,0.56,0.004c33.631,0,60.993,27.36,60.993,60.989c0,33.631-27.36,60.991-60.993,60.991H43.411 c-14.901,0-26.98,12.08-26.98,26.98C16.431,323.513,28.51,335.593,43.411,335.593z'/> <path d='M43.411,229.908h208.393c63.383,0,114.95-51.568,114.95-114.952c0-63.295-51.415-114.806-114.677-114.95 c-6.306-0.088-46.707,0.474-76.915,29.927c-20.242,19.739-30.506,46.859-30.506,80.605c0,14.901,12.078,26.982,26.98,26.982 s26.978-12.08,26.978-26.982c0-18.482,4.697-32.516,13.955-41.709c14.427-14.328,36.873-14.848,38.674-14.866 c0.252,0.008,0.218,0.004,0.56,0.004c33.629,0,60.991,27.36,60.991,60.989c0,33.631-27.36,60.991-60.991,60.991H43.411 c-14.901,0-26.98,12.08-26.98,26.982S28.51,229.908,43.411,229.908z'/> <path d='M480.614,382.093H43.411c-14.901,0-26.98,12.08-26.98,26.98c0,14.899,12.078,26.98,26.98,26.98h437.203 c33.631,0,60.993,27.36,60.993,60.989c0,33.631-27.36,60.991-60.993,60.991c-0.339,0-0.308-0.006-0.56,0.004 c-1.797-0.018-24.243-0.536-38.67-14.864c-9.258-9.193-13.955-23.227-13.955-41.711c0-14.901-12.077-26.982-26.978-26.982 c-14.901,0-26.98,12.08-26.98,26.982c0,33.748,10.262,60.868,30.506,80.605c28.999,28.277,67.407,29.935,75.994,29.933 c0.361,0,0.667-0.002,0.919-0.006c63.26-0.15,114.677-51.659,114.677-114.95C595.567,433.659,544.001,382.093,480.614,382.093z'/></g></svg>",windhose_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 60 60' style='enable-background:new 0 0 60 60;' xml:space='preserve'><g fill='%23fff'><path d='M56.073,12.001L19.567,7.067C19.384,7.023,19.194,7,19,7c-0.969,0-1.797,0.581-2.49,1.55L6,16.057V9.899 C8.279,9.434,10,7.414,10,5c0-2.757-2.243-5-5-5S0,2.243,0,5c0,2.414,1.721,4.434,4,4.899V48H2v6H0v6h10v-6H8v-6H6V20.414 l9.797,9.797C16.603,31.916,17.671,33,19,33c0.194,0,0.384-0.023,0.567-0.067l36.506-4.934C57.574,27.965,60,26.848,60,20 S57.574,12.035,56.073,12.001z M8,58H2v-2h6V58z M4,54v-4h2v4H4z M50,20c0,2.511-0.283,4.924-0.781,6.915l-4.063,0.548 C45.701,25.309,46,22.726,46,20c0-2.723-0.298-5.304-0.843-7.456l4.063,0.549C49.718,15.083,50,17.492,50,20z M44,20 c0,2.871-0.364,5.649-0.999,7.753l-4.08,0.55C39.611,26.019,40,23.101,40,20c0-3.098-0.388-6.015-1.077-8.299l4.08,0.551 C43.637,14.356,44,17.131,44,20z M21.978,21.265c-0.005,0.137-0.014,0.265-0.02,0.399c-0.012,0.268-0.024,0.536-0.042,0.793 c-0.011,0.153-0.025,0.298-0.038,0.447c-0.019,0.226-0.037,0.454-0.06,0.671c-0.016,0.155-0.036,0.301-0.055,0.452 c-0.024,0.199-0.048,0.399-0.075,0.59c-0.022,0.15-0.046,0.291-0.069,0.436c-0.029,0.18-0.058,0.361-0.09,0.533 c-0.026,0.14-0.053,0.272-0.08,0.407c-0.033,0.164-0.067,0.328-0.102,0.484c-0.029,0.13-0.06,0.254-0.091,0.379 c-0.036,0.148-0.073,0.294-0.111,0.435c-0.032,0.119-0.066,0.233-0.099,0.347c-0.039,0.133-0.079,0.263-0.119,0.389 c-0.035,0.107-0.07,0.211-0.105,0.312c-0.041,0.118-0.083,0.234-0.125,0.345c-0.036,0.094-0.073,0.186-0.109,0.275 c-0.043,0.104-0.086,0.205-0.13,0.301c-0.037,0.082-0.074,0.163-0.111,0.239c-0.044,0.09-0.088,0.175-0.132,0.257 c-0.037,0.069-0.074,0.137-0.111,0.201c-0.045,0.077-0.089,0.147-0.134,0.215c-0.036,0.055-0.072,0.111-0.107,0.16 c-0.045,0.063-0.089,0.118-0.134,0.172c-0.034,0.042-0.068,0.085-0.102,0.121c-0.045,0.049-0.089,0.088-0.132,0.127 c-0.031,0.028-0.063,0.059-0.094,0.083c-0.032,0.024-0.063,0.039-0.094,0.058l-1.859-1.859C16.679,27.212,16,24.165,16,20 c0-5.033,0.99-8.439,1.931-10.008l1.298-0.927c0.014,0.006,0.027,0.015,0.041,0.023c0.042,0.023,0.085,0.046,0.129,0.079 c0.031,0.023,0.062,0.054,0.094,0.083c0.044,0.039,0.087,0.078,0.132,0.127c0.033,0.036,0.068,0.08,0.102,0.121 c0.044,0.054,0.089,0.109,0.134,0.172c0.036,0.05,0.072,0.105,0.107,0.16c0.044,0.068,0.089,0.138,0.134,0.215 c0.037,0.063,0.074,0.132,0.111,0.201c0.044,0.082,0.088,0.167,0.132,0.257c0.037,0.076,0.074,0.157,0.111,0.239 c0.044,0.096,0.087,0.197,0.13,0.301c0.037,0.089,0.073,0.181,0.109,0.275c0.042,0.111,0.084,0.226,0.125,0.345 c0.036,0.102,0.071,0.205,0.105,0.312c0.041,0.125,0.08,0.256,0.119,0.389c0.034,0.113,0.067,0.228,0.099,0.347 c0.038,0.14,0.075,0.287,0.111,0.435c0.031,0.125,0.062,0.249,0.091,0.379c0.035,0.156,0.069,0.32,0.102,0.484 c0.027,0.134,0.055,0.267,0.08,0.407c0.032,0.172,0.061,0.353,0.09,0.533c0.023,0.145,0.047,0.286,0.069,0.436 c0.027,0.191,0.051,0.391,0.075,0.59c0.018,0.15,0.038,0.297,0.055,0.452c0.023,0.217,0.041,0.445,0.06,0.671 c0.013,0.149,0.027,0.294,0.038,0.447c0.018,0.257,0.03,0.526,0.042,0.793c0.006,0.134,0.015,0.262,0.02,0.399 C21.992,19.145,22,19.566,22,20S21.992,20.855,21.978,21.265z M2,5c0-1.654,1.346-3,3-3s3,1.346,3,3S6.654,8,5,8S2,6.654,2,5z M6.542,18.127l8.409-6.006C14.322,14.408,14,17.21,14,20c0,2.116,0.188,4.237,0.551,6.137L6.542,18.127z M22.066,30.501 c0.133-0.26,0.26-0.538,0.379-0.83c0.044-0.106,0.084-0.219,0.125-0.329c0.087-0.23,0.171-0.466,0.251-0.712 c0.041-0.126,0.08-0.253,0.119-0.382c0.077-0.259,0.149-0.526,0.218-0.799c0.03-0.119,0.061-0.234,0.09-0.356 c0.093-0.396,0.179-0.802,0.254-1.22c0.001-0.004,0.001-0.008,0.002-0.011c0.075-0.416,0.139-0.843,0.197-1.276 c0.018-0.135,0.033-0.273,0.049-0.409c0.037-0.31,0.071-0.622,0.1-0.938c0.014-0.156,0.027-0.312,0.04-0.469 c0.025-0.318,0.044-0.638,0.06-0.96c0.007-0.142,0.016-0.283,0.021-0.426C23.989,20.922,24,20.461,24,20s-0.011-0.922-0.029-1.382 c-0.005-0.143-0.014-0.284-0.021-0.426c-0.016-0.322-0.036-0.642-0.06-0.96c-0.012-0.157-0.025-0.313-0.04-0.469 c-0.029-0.316-0.063-0.628-0.1-0.938c-0.016-0.137-0.031-0.274-0.049-0.409c-0.058-0.433-0.122-0.861-0.197-1.276 c-0.001-0.004-0.001-0.008-0.002-0.011c-0.076-0.419-0.162-0.824-0.254-1.22c-0.028-0.121-0.06-0.237-0.09-0.356 c-0.069-0.273-0.141-0.54-0.218-0.799c-0.039-0.13-0.078-0.256-0.119-0.382c-0.079-0.246-0.163-0.482-0.251-0.712 c-0.042-0.11-0.082-0.223-0.125-0.329c-0.12-0.292-0.246-0.57-0.379-0.83c-0.013-0.025-0.024-0.056-0.037-0.081l14.685,1.985 C37.521,13.554,38,16.703,38,20c0,3.299-0.48,6.45-1.288,8.602l-14.683,1.98C22.042,30.557,22.053,30.526,22.066,30.501z M56,26 l-4.657,0.628C51.764,24.642,52,22.353,52,20c0-2.35-0.235-4.636-0.655-6.62l4.521,0.611L56,14c0.923,0,2,1.571,2,6S56.923,26,56,26 z'/></g></svg>",window_1:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' id='svg' version='1.1' x='0' y='0' width='500' height='500' viewBox='0 0 500 500'> <g fill='%23fff' class='window' stroke-width='34'> <path d='M70.152 391.714L428.048 391.714 428.048 455.727 70.152 455.727 70.152 391.714z'/> <path d='M100.02 50.31L100.02 391.714 398.749 391.714 398.749 221.012 398.749 50.31 100.02 50.31z' /> <g fill='%23fff' class='window_close'> <path d='M100.436 50.31L249.8 50.31 249.8 221.012 100.436 221.012 100.436 50.31z' /> <path d='M100.436 221.012L249.8 221.012 249.8 391.714 100.436 391.714 100.436 221.012z' /> <path d='M248.969 50.31L398.333 50.31 398.333 221.012 248.969 221.012 248.969 50.31z' /> <path d='M248.969 221.012L398.333 221.012 398.333 391.714 248.969 391.714 248.969 221.012z' /> </g> <g fill='%23fff' class='window_open'> <path d='M491.675 13.663L397.798 49.315 397.798 220.017 491.675 220.017 491.675 13.663z' /> <path d='M491.675 220.017L397.798 220.017 397.798 390.719 491.675 418.682 491.675 220.017z' /> <path d='M9.453 11.934L100.302 47.586 100.302 218.288 9.453 218.288 9.453 11.934z' /> <path d='M9.453 218.288L100.302 218.288 100.302 388.99 9.453 416.953 9.453 218.288z' /> </g> </g></svg>",window_2:"<svg height='682pt' viewBox='-37 -21 682 682.66669' width='682pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m585.90625 640h-469.332031c-11.78125 0-21.332031-9.550781-21.332031-21.332031v-277.335938c0-5.886719 4.773437-10.664062 10.664062-10.664062s10.667969 4.777343 10.667969 10.664062v277.335938h469.332031v-597.335938h-469.332031v120.640625c0 5.894532-4.777344 10.667969-10.667969 10.667969s-10.664062-4.773437-10.664062-10.667969v-120.640625c0-11.78125 9.550781-21.332031 21.332031-21.332031h469.332031c11.78125 0 21.332031 9.550781 21.332031 21.332031v597.335938c0 11.78125-9.550781 21.332031-21.332031 21.332031zm-32-42.664062h-405.335938c-5.886718 0-10.664062-4.777344-10.664062-10.671876v-138.664062c0-5.890625 4.777344-10.664062 10.664062-10.664062h405.335938c5.890625 0 10.664062 4.773437 10.664062 10.664062v138.664062c0 5.894532-4.773437 10.671876-10.664062 10.671876zm-394.667969-21.335938h384v-117.332031h-384zm394.667969-160h-405.335938c-5.886718 0-10.664062-4.773438-10.664062-10.667969v-64c0-5.886719 4.777344-10.664062 10.664062-10.664062 5.894532 0 10.667969 4.777343 10.667969 10.664062v53.335938h384v-330.667969h-394.667969c-5.886718 0-10.664062-4.777344-10.664062-10.664062 0-5.894532 4.777344-10.671876 10.664062-10.671876h405.335938c5.890625 0 10.664062 4.777344 10.664062 10.671876v351.996093c0 5.894531-4.773437 10.667969-10.664062 10.667969zm0 0'/><path d='m553.90625 416h-405.335938c-5.886718 0-10.664062-4.773438-10.664062-10.667969v-64c0-5.886719 4.777344-10.664062 10.664062-10.664062 5.894532 0 10.667969 4.777343 10.667969 10.664062v53.335938h384v-330.667969h-394.667969c-5.886718 0-10.664062-4.777344-10.664062-10.664062 0-5.894532 4.777344-10.671876 10.664062-10.671876h405.335938c5.890625 0 10.664062 4.777344 10.664062 10.671876v351.996093c0 5.894531-4.773437 10.667969-10.664062 10.667969zm0 0'/><path d='m553.90625 597.335938h-405.335938c-5.886718 0-10.664062-4.777344-10.664062-10.671876v-138.664062c0-5.890625 4.777344-10.664062 10.664062-10.664062h405.335938c5.890625 0 10.664062 4.773437 10.664062 10.664062v138.664062c0 5.894532-4.773437 10.671876-10.664062 10.671876zm-394.667969-21.335938h384v-117.332031h-384zm0 0'/><path d='m553.90625 416h-405.335938c-5.886718 0-10.664062-4.773438-10.664062-10.667969v-64c0-5.886719 4.777344-10.664062 10.664062-10.664062 5.894532 0 10.667969 4.777343 10.667969 10.664062v53.335938h384v-330.667969h-394.667969c-5.886718 0-10.664062-4.777344-10.664062-10.664062 0-5.894532 4.777344-10.671876 10.664062-10.671876h405.335938c5.890625 0 10.664062 4.777344 10.664062 10.671876v351.996093c0 5.894531-4.773437 10.667969-10.664062 10.667969zm0 0'/><path d='m415.242188 352h-405.332032c-3.667968-.003906-7.082031-1.890625-9.03125-5-1.945312-3.101562-2.160156-6.992188-.574218-10.296875l138.667968-287.996094c1.777344-3.691406 5.507813-6.035156 9.597656-6.042969h405.335938c3.667969.007813 7.078125 1.890626 9.023438 4.996094 1.949218 3.113282 2.167968 6.996094.578124 10.304688l-138.667968 287.996094c-1.777344 3.6875-5.507813 6.035156-9.597656 6.039062zm-388.367188-21.332031h381.667969l128.390625-266.667969h-381.664063zm0 0'/><path d='m388.425781 309.332031h-310.625c-3.667969 0-7.078125-1.890625-9.023437-4.996093-1.949219-3.105469-2.167969-6.996094-.578125-10.296876l97.589843-202.667968c1.777344-3.691406 5.507813-6.035156 9.597657-6.039063h310.625c3.667969.003907 7.074219 1.890625 9.023437 5 1.953125 3.105469 2.167969 6.992188.578125 10.296875l-97.589843 202.667969c-1.777344 3.6875-5.507813 6.035156-9.597657 6.035156zm-293.644531-21.332031h286.933594l87.304687-181.335938h-286.933593zm0 0'/><path d='m553.90625 597.335938h-405.335938c-5.886718 0-10.664062-4.777344-10.664062-10.671876v-138.664062c0-5.890625 4.777344-10.664062 10.664062-10.664062h405.335938c5.890625 0 10.664062 4.773437 10.664062 10.664062v138.664062c0 5.894532-4.773437 10.671876-10.664062 10.671876zm-394.667969-21.335938h384v-117.332031h-384zm0 0'/><path d='m553.90625 266.664062c-2.832031 0-5.539062-1.121093-7.542969-3.125l-64-64c-4.042969-4.183593-3.984375-10.835937.132813-14.949218 4.113281-4.117188 10.765625-4.175782 14.953125-.132813l63.996093 64c3.054688 3.050781 3.964844 7.640625 2.316407 11.625-1.652344 3.984375-5.542969 6.582031-9.855469 6.582031zm0 0'/><path d='m287.238281 416c-2.828125 0-5.539062-1.125-7.539062-3.125l-64-64c-4.042969-4.1875-3.984375-10.835938.128906-14.953125 4.113281-4.113281 10.769531-4.171875 14.953125-.128906l64 64c3.046875 3.050781 3.960938 7.636719 2.308594 11.621093-1.648438 3.984376-5.535156 6.585938-9.851563 6.585938zm0 0'/></g></svg>",wine_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 20.751 20.751' style='enable-background:new 0 0 20.751 20.751;' xml:space='preserve'><g fill='%23fff'> <path d='M9.962,10.465c0-0.855-0.211-1.682-0.616-2.392L9.25,7.905H3.24L3.146,8.073 C2.742,8.782,2.53,9.61,2.53,10.465c0,2.181,1.388,3.988,3.189,4.287v5.093c-1.039,0.042-1.813,0.2-1.813,0.387 c0,0.222,1.055,0.4,2.357,0.4c1.303,0,2.36-0.178,2.36-0.4c0-0.187-0.774-0.345-1.813-0.387v-5.097 C8.593,14.43,9.962,12.63,9.962,10.465z M6.245,14.131c-1.682,0-3.052-1.644-3.052-3.668c0-0.674,0.151-1.325,0.44-1.896h5.225 c0.288,0.571,0.441,1.223,0.441,1.896C9.3,12.488,7.928,14.131,6.245,14.131z M16.325,2.292h-2.643V0h2.643V2.292z M16.325,5.132 V2.997h-2.643v2.136c-1.116,0.503-1.896,1.625-1.896,2.931v2.093v6.673v3.921h6.434V16.83v-6.673V8.064 C18.221,6.758,17.443,5.636,16.325,5.132z M17.652,17.516h-5.241v-6.288h5.241V17.516z M9.022,10.534c0,0-0.139,3.325-2.732,3.325 s-2.943-3.325-2.943-3.325H9.022z'/></g></svg>",abort_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M256,0C114.844,0,0,114.844,0,256s114.844,256,256,256s256-114.844,256-256S397.156,0,256,0z M256,448 c-105.865,0-192-86.135-192-192c0-40.406,12.25-78.604,35.542-111.198l267.656,267.656C334.604,435.75,296.406,448,256,448z M412.458,367.198L144.802,99.542C177.396,76.25,215.594,64,256,64c105.865,0,192,86.135,192,192 C448,296.406,435.75,334.604,412.458,367.198z'/> </g></svg>",camera_1:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <circle cx='256' cy='277.333' r='106.667'/> <path d='M469.333,106.667h-67.656c-8.552,0-16.583-3.333-22.635-9.375l-39-39c-10.073-10.073-23.469-15.625-37.719-15.625 h-92.646c-14.25,0-27.646,5.552-37.719,15.625l-39,39c-6.052,6.042-14.083,9.375-22.635,9.375H42.667 C19.135,106.667,0,125.802,0,149.333v277.333c0,23.531,19.135,42.667,42.667,42.667h426.667 c23.531,0,42.667-19.135,42.667-42.667V149.333C512,125.802,492.865,106.667,469.333,106.667z M256,405.333 c-70.583,0-128-57.417-128-128s57.417-128,128-128s128,57.417,128,128S326.583,405.333,256,405.333z M426.667,213.333 c-11.76,0-21.333-9.573-21.333-21.333s9.573-21.333,21.333-21.333S448,180.24,448,192S438.427,213.333,426.667,213.333z'/> </g></svg>",cctv_1:"<svg height='512' viewBox='0 0 192 192' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m144 90.472 41.9-11.954a8.081 8.081 0 0 0 5.5-9.888l-17.555-61.545a8 8 0 0 0 -9.888-5.5l-115.395 32.924a8.078 8.078 0 0 0 -4.239 12.449l40.637 54.96a8.065 8.065 0 0 0 8.627 2.936l34.413-9.817v64.963a8 8 0 0 0 8 8h16v-16h-8zm19.851-34.835a8 8 0 1 1 -5.5 9.888 8 8 0 0 1 5.5-9.888zm-30.772 8.779a8 8 0 1 1 -5.5 9.888 8 8 0 0 1 5.5-9.888z'/><path d='m188.206 129.2a8 8 0 0 0 -7.784-.35l-16 8a8 8 0 0 0 -4.422 7.15v32a8 8 0 0 0 4.422 7.155l16 8a8.077 8.077 0 0 0 11.578-7.155v-48a8 8 0 0 0 -3.794-6.8z'/><path d='m35.372 46.591a8 8 0 0 0 -5.5 9.888l10.973 38.465a8.079 8.079 0 0 0 9.887 5.5l19.149-5.464-31.99-43.266a15.976 15.976 0 0 1 -2.519-5.123z'/><path d='m22.178 58.674-7.694 2.2a8.08 8.08 0 0 0 -5.5 9.887l6.585 23.079a8.074 8.074 0 0 0 9.889 5.5l7.691-2.194z'/></g></svg>",checkbox_1:"<svg height='682.66669pt' viewBox='-21 -21 682.66669 682.66669' width='682.66669pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m322.820312 387.933594 279.949219-307.273438 36.957031 33.671875-314.339843 345.023438-171.363281-162.902344 34.453124-36.238281zm297.492188-178.867188-38.988281 42.929688c5.660156 21.734375 8.675781 44.523437 8.675781 68.003906 0 148.875-121.125 270-270 270s-270-121.125-270-270 121.125-270 270-270c68.96875 0 131.96875 26.007812 179.746094 68.710938l33.707031-37.113282c-58.761719-52.738281-133.886719-81.597656-213.453125-81.597656-85.472656 0-165.835938 33.285156-226.273438 93.726562-60.441406 60.4375-93.726562 140.800782-93.726562 226.273438s33.285156 165.835938 93.726562 226.273438c60.4375 60.441406 140.800782 93.726562 226.273438 93.726562s165.835938-33.285156 226.273438-93.726562c60.441406-60.4375 93.726562-140.800782 93.726562-226.273438 0-38.46875-6.761719-75.890625-19.6875-110.933594zm0 0'/></g></svg>",clock_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M256,233.5c-1.404,0-2.776,0.136-4.109,0.383l-68.646-118.897c-2.07-3.588-6.659-4.816-10.245-2.746 c-3.587,2.071-4.816,6.658-2.745,10.245l68.652,118.908c-3.367,3.934-5.407,9.035-5.407,14.606c0,9.777,6.271,18.114,15,21.21 V444.5c0,4.143,3.357,7.5,7.5,7.5s7.5-3.357,7.5-7.5V277.21c8.729-3.096,15-11.433,15-21.21 C278.5,243.594,268.406,233.5,256,233.5z M256,263.5c-4.136,0-7.5-3.364-7.5-7.5s3.364-7.5,7.5-7.5s7.5,3.364,7.5,7.5 S260.136,263.5,256,263.5z'/> <path d='M437.02,74.98C388.668,26.629,324.38,0,256,0S123.332,26.629,74.98,74.98C26.628,123.331,0,187.62,0,256 s26.629,132.668,74.98,181.02C123.331,485.372,187.62,512,256,512s132.668-26.629,181.02-74.98 C485.372,388.669,512,324.38,512,256S485.371,123.332,437.02,74.98z M256,497C123.112,497,15,388.888,15,256S123.112,15,256,15 s241,108.112,241,241S388.888,497,256,497z'/> <circle cx='256' cy='67.5' r='7.5'/> <circle cx='161.75' cy='92.75' r='7.5'/> <circle cx='92.75' cy='161.75' r='7.5'/> <circle cx='67.5' cy='256' r='7.5'/> <circle cx='92.75' cy='350.25' r='7.5'/> <circle cx='161.75' cy='419.25' r='7.5'/> <circle cx='350.25' cy='419.25' r='7.5'/> <circle cx='419.25' cy='350.25' r='7.5'/> <circle cx='444.5' cy='256' r='7.5'/> <circle cx='419.25' cy='161.75' r='7.5'/> <circle cx='350.25' cy='92.75' r='7.5'/> <path d='M415.806,96.194C373.12,53.508,316.366,30,256,30c-54.611,0-107.335,19.748-148.458,55.604 c-3.122,2.723-3.446,7.46-0.725,10.582c2.723,3.123,7.461,3.446,10.582,0.724C155.791,63.436,205.013,45,256,45 c116.346,0,211,94.654,211,211s-94.654,211-211,211S45,372.346,45,256c0-50.987,18.436-100.209,51.91-138.601 c2.723-3.122,2.398-7.859-0.724-10.582c-3.12-2.722-7.858-2.399-10.582,0.725C49.748,148.665,30,201.389,30,256 c0,60.366,23.508,117.12,66.194,159.806C138.88,458.492,195.634,482,256,482c60.366,0,117.12-23.508,159.806-66.194 C458.492,373.12,482,316.366,482,256C482,195.634,458.492,138.88,415.806,96.194z'/> </g></svg>",clock_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 480.011 480.011' style='enable-background:new 0 0 480.011 480.011;' xml:space='preserve'> <g fill='%23fff'> <path d='M7.873,239.899h0.28c4.314,0.003,7.853-3.416,8-7.728C20.481,108.535,124.216,11.817,247.852,16.144 c47.556,1.665,93.346,18.43,130.733,47.867h-42.576c-4.418,0-8,3.582-8,8s3.582,8,8,8h64h0.112 c0.626-0.051,1.243-0.174,1.84-0.368c0.409-0.059,0.812-0.147,1.208-0.264c0.224-0.096,0.392-0.296,0.608-0.416 c0.718-0.351,1.377-0.813,1.952-1.368l0.08-0.056c0.203-0.278,0.388-0.569,0.552-0.872c0.419-0.51,0.772-1.072,1.048-1.672 c0.22-0.638,0.355-1.302,0.4-1.976c0.092-0.33,0.159-0.667,0.2-1.008v-64c0-4.418-3.582-8-8-8s-8,3.582-8,8v46.336 C289.508-29.635,138.332-14.623,54.35,87.879C21.017,128.563,1.975,179.072,0.153,231.635 C0.005,236.048,3.46,239.747,7.873,239.899z'/> <path d='M72.641,388.883c-2.936-3.314-8.002-3.62-11.316-0.684c-3.314,2.936-3.62,8.002-0.684,11.316 c5.507,6.18,11.325,12.076,17.432,17.664c3.321,2.915,8.375,2.585,11.29-0.735c2.832-3.227,2.612-8.113-0.498-11.073 C83.179,400.156,77.764,394.653,72.641,388.883z'/> <path d='M168.113,452.227c-7.314-2.476-14.494-5.331-21.512-8.552c-3.959-1.961-8.759-0.341-10.72,3.618 c-1.961,3.959-0.341,8.759,3.618,10.72c0.136,0.067,0.274,0.131,0.414,0.19c7.524,3.464,15.226,6.529,23.072,9.184 c4.186,1.416,8.728-0.83,10.144-5.016C174.546,458.185,172.3,453.643,168.113,452.227z'/> <path d='M126.089,432.923v-0.008c-6.649-3.939-13.094-8.211-19.312-12.8c-3.469-2.737-8.499-2.143-11.236,1.326 c-2.737,3.469-2.143,8.499,1.326,11.236c0.13,0.102,0.262,0.201,0.398,0.295c6.65,4.923,13.547,9.502,20.664,13.72 c3.802,2.253,8.711,0.998,10.964-2.804C131.147,440.085,129.891,435.176,126.089,432.923z'/> <path d='M58.153,370.827c-4.51-6.27-8.696-12.767-12.544-19.464c-2.209-3.833-7.107-5.149-10.94-2.94 c-3.833,2.209-5.149,7.107-2.94,10.94c4.122,7.161,8.608,14.106,13.44,20.808c2.653,3.533,7.668,4.246,11.201,1.593 C59.802,379.187,60.589,374.361,58.153,370.827z'/> <path d='M35.839,334.017c0-1.115-0.234-2.218-0.685-3.237l-0.016-0.056c-3.131-7.052-5.895-14.262-8.28-21.6 c-1.16-4.263-5.557-6.779-9.82-5.618c-4.263,1.16-6.779,5.557-5.618,9.82c0.068,0.248,0.147,0.493,0.238,0.734 c2.553,7.881,5.512,15.625,8.864,23.2c1.283,2.896,4.153,4.762,7.32,4.76C32.26,342.018,35.84,338.435,35.839,334.017z'/> <path d='M14.717,296.22c0.001,0,0.003-0.001,0.004-0.001v0c4.317-0.92,7.073-5.162,6.16-9.48 c-1.594-7.557-2.801-15.191-3.616-22.872c-0.466-4.396-4.408-7.582-8.804-7.116s-7.582,4.408-7.116,8.804 c0.876,8.227,2.173,16.403,3.888,24.496C6.149,294.374,10.395,297.135,14.717,296.22z'/> <path d='M467.219,288.053c-0.003-0.001-0.006-0.001-0.009-0.002c-4.288-1.062-8.625,1.552-9.688,5.84 c-1.854,7.5-4.094,14.899-6.712,22.168c-1.498,4.158,0.658,8.742,4.816,10.24c4.158,1.498,8.742-0.658,10.24-4.816 c2.807-7.785,5.21-15.711,7.2-23.744C474.126,293.45,471.508,289.114,467.219,288.053z'/> <path d='M213.217,462.411c-7.668-0.913-15.283-2.221-22.816-3.92c-4.31-0.974-8.594,1.73-9.568,6.04 c-0.974,4.31,1.73,8.594,6.04,9.568c8.074,1.82,16.237,3.222,24.456,4.2c0.319,0.039,0.639,0.057,0.96,0.056 c4.418-0.009,7.992-3.599,7.983-8.017C220.264,466.292,217.236,462.889,213.217,462.411z'/> <path d='M452.466,333.683C452.466,333.683,452.466,333.683,452.466,333.683c-3.977-1.92-8.757-0.255-10.681,3.72 c-3.363,6.954-7.085,13.729-11.152,20.296c-2.262,3.796-1.018,8.706,2.778,10.967c3.703,2.207,8.49,1.082,10.822-2.543 c4.354-7.039,8.341-14.3,11.944-21.752C458.104,340.395,456.442,335.61,452.466,333.683z'/> <path d='M428.831,375.29c-3.458-2.75-8.491-2.176-11.241,1.283c-0.048,0.06-0.095,0.121-0.141,0.182l0-0.016 c-4.72,6.123-9.753,11.997-15.08,17.6c-3.046,3.203-2.919,8.27,0.284,11.316c3.203,3.046,8.27,2.919,11.316-0.284 c5.696-6.003,11.085-12.291,16.144-18.84C432.863,383.073,432.289,378.04,428.831,375.29z'/> <path d='M472.145,240.387c-4.346-0.222-8.05,3.122-8.271,7.468c-0.004,0.081-0.007,0.163-0.009,0.244 c-0.271,7.72-0.942,15.421-2.008,23.072c-0.603,4.371,2.447,8.404,6.816,9.016c0.371,0.054,0.745,0.081,1.12,0.08 c3.987-0.006,7.362-2.947,7.912-6.896c1.139-8.195,1.857-16.443,2.152-24.712C480.01,244.246,476.559,240.543,472.145,240.387z' /> <path d='M385.609,410.251v0.024c-5.888,5.026-12.029,9.747-18.4,14.144c-3.643,2.518-4.554,7.513-2.036,11.156 c2.518,3.643,7.513,4.554,11.156,2.036c6.813-4.731,13.381-9.804,19.68-15.2c3.358-2.872,3.752-7.922,0.88-11.28 C394.018,407.773,388.967,407.379,385.609,410.251z'/> <path d='M304.897,454.475L304.897,454.475c-7.393,2.228-14.896,4.07-22.48,5.52c-4.339,0.835-7.18,5.028-6.345,9.367 c0.723,3.761,4.011,6.482,7.841,6.489c0.507,0.002,1.013-0.044,1.512-0.136c8.13-1.554,16.173-3.532,24.096-5.928 c4.196-1.383,6.477-5.906,5.094-10.102C313.281,455.637,309.007,453.346,304.897,454.475z'/> <path d='M259.889,463.142c-0.147,0.008-0.293,0.021-0.439,0.037l0.04,0.032c-6.4,0.544-12.952,0.8-19.48,0.8h-3.656 c-4.363,0.062-7.929,3.498-8.152,7.856c-0.08,4.418,3.436,8.064,7.853,8.144c0.001,0,0.002,0,0.003,0h3.952 c6.992,0,14-0.312,20.8-0.896c4.411-0.254,7.781-4.036,7.526-8.447C268.081,466.257,264.299,462.887,259.889,463.142z'/> <path d='M347.521,436.563h0.008c-6.773,3.709-13.731,7.068-20.848,10.064c-4.094,1.661-6.067,6.326-4.407,10.42 s6.326,6.067,10.42,4.407c0.06-0.024,0.119-0.049,0.178-0.075c7.626-3.209,15.081-6.808,22.336-10.784 c3.875-2.123,5.295-6.985,3.172-10.86C356.259,435.86,351.396,434.44,347.521,436.563z'/> <path d='M240.009,72.011c-92.784,0-168,75.216-168,168s75.216,168,168,168s168-75.216,168-168 C407.904,147.271,332.749,72.117,240.009,72.011z M368.009,248.011h23.592c-4.156,77.517-66.075,139.436-143.592,143.592v-23.592 c0-4.418-3.582-8-8-8s-8,3.582-8,8v23.592c-77.517-4.156-139.436-66.075-143.592-143.592h23.592c4.418,0,8-3.582,8-8 s-3.582-8-8-8H88.417c4.156-77.517,66.075-139.436,143.592-143.592v23.592c0,4.418,3.582,8,8,8s8-3.582,8-8V88.419 c77.517,4.156,139.436,66.075,143.592,143.592h-23.592c-4.418,0-8,3.582-8,8S363.591,248.011,368.009,248.011z'/> <path d='M248.009,217.483v-73.472c0-4.418-3.582-8-8-8s-8,3.582-8,8v73.472c-6.775,2.42-12.108,7.753-14.528,14.528h-41.472 c-4.418,0-8,3.582-8,8s3.582,8,8,8h41.472c4.384,12.476,18.052,19.036,30.528,14.652c12.476-4.384,19.036-18.052,14.652-30.528 C260.253,225.281,254.863,219.892,248.009,217.483z M240.009,248.011c-4.418,0-8-3.582-8-8s3.582-8,8-8s8,3.582,8,8 S244.428,248.011,240.009,248.011z'/> </g></svg>",clock_3:"<svg id='Capa_1' enable-background='new 0 0 512.003 512.003' height='512' viewBox='0 0 512.003 512.003' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m213.045 104.077c4.143 0 7.5-3.357 7.5-7.5v-10.601c0-4.143-3.357-7.5-7.5-7.5s-7.5 3.357-7.5 7.5v10.602c0 4.142 3.358 7.499 7.5 7.499z'/><path d='m300.704 135.993 7.497-7.497c2.929-2.93 2.929-7.678 0-10.607-2.93-2.928-7.678-2.928-10.607 0l-7.497 7.497c-2.929 2.93-2.929 7.678 0 10.607 2.93 2.929 7.677 2.928 10.607 0z'/><path d='m117.89 308.199c2.931 2.929 7.678 2.928 10.607 0l7.497-7.497c2.929-2.93 2.929-7.678 0-10.607-2.93-2.928-7.678-2.928-10.607 0l-7.497 7.497c-2.929 2.929-2.929 7.678 0 10.607z'/><path d='m96.579 220.544c4.143 0 7.5-3.357 7.5-7.5s-3.357-7.5-7.5-7.5h-10.603c-4.143 0-7.5 3.357-7.5 7.5s3.357 7.5 7.5 7.5z'/><path d='m125.387 135.993c2.931 2.929 7.678 2.928 10.607 0 2.929-2.93 2.929-7.678 0-10.607l-7.497-7.497c-2.93-2.928-7.678-2.928-10.607 0-2.929 2.93-2.929 7.678 0 10.607z'/><path d='m205.545 216.129c0 7.001 8.709 10.129 13.203 4.871l27.103-31.729c2.689-3.149 2.317-7.884-.832-10.574-3.149-2.688-7.884-2.316-10.574.832l-13.899 16.272v-50.649c0-4.143-3.357-7.5-7.5-7.5s-7.5 3.357-7.5 7.5v70.977z'/><path d='m505.281 354.474-19.515-17.119c-.754-.661-1.271-1.528-1.494-2.506l-6.689-29.312c-.223-.979-.134-1.982.259-2.905l10.154-23.892c2.838-6.678 1.79-14.35-2.732-20.021l-19.537-24.499c-4.525-5.672-11.768-8.401-18.911-7.117l-21.496 3.855c.497-5.962.771-11.957.771-17.915 0-54.784-20.758-106.841-58.449-146.581-2.851-3.005-7.598-3.131-10.603-.28-3.006 2.851-3.131 7.598-.28 10.603 35.036 36.941 54.332 85.332 54.332 136.259 0 4.814-.197 9.653-.547 14.477l-19.257-9.274c-.903-.435-1.633-1.13-2.109-2.013l-11.931-22.063c-4.53-39.808-23.381-76.549-53.216-103.601-30.442-27.604-69.857-42.807-110.984-42.807-91.137 0-165.282 74.145-165.282 165.281 0 18.365 3 36.421 8.917 53.665 1.067 3.112 3.978 5.068 7.094 5.068.807 0 1.628-.131 2.434-.408 3.918-1.344 6.005-5.609 4.66-9.527-5.378-15.675-8.104-32.093-8.104-48.798 0-82.865 67.416-150.281 150.282-150.281 37.395 0 73.231 13.821 100.908 38.918 23.903 21.674 40.054 50.179 46.375 81.4-1.268-.055 3.8-.01-32.191-.029-7.256 0-13.907 3.965-17.358 10.348l-12.348 22.835c-.477.882-1.206 1.577-2.108 2.013l-27.089 13.044c-.904.436-1.904.569-2.89.396l-25.551-4.583c-7.134-1.28-14.387 1.445-18.913 7.119l-19.533 24.495c-4.526 5.673-5.573 13.346-2.734 20.023l10.153 23.89c.393.924.482 1.929.26 2.906l-6.69 29.312c-.224.978-.74 1.845-1.494 2.506l-19.515 17.119c-1.596 1.4-2.92 3.025-3.967 4.795-40.147-9.479-74.723-35.137-95.538-71.168-2.073-3.588-6.66-4.814-10.246-2.742-3.586 2.071-4.814 6.659-2.742 10.246 23.111 40.008 61.662 68.39 106.377 78.566l6.864 30.074c.39 1.707 1.001 3.326 1.796 4.831-95.905-13.72-169.871-96.394-169.871-196.032-.002-109.203 88.84-198.045 198.042-198.045 44.858 0 87.161 14.624 122.335 42.291 3.254 2.561 7.97 1.998 10.531-1.258s1.998-7.971-1.258-10.531c-37.843-29.768-83.353-45.502-131.608-45.502-117.473 0-213.044 95.571-213.044 213.044 0 117.474 95.571 213.045 213.045 213.045 2.985 0 6.059-.079 9.147-.21.898.284 1.684.812 2.275 1.553l18.745 23.505c.626.784.981 1.728 1.027 2.729l1.218 25.93c.34 7.247 4.611 13.706 11.149 16.854l28.229 13.596c6.536 3.146 14.251 2.46 20.129-1.792l21.033-15.217c.812-.587 1.771-.897 2.772-.897h30.066c1.002 0 1.961.311 2.774.898l21.032 15.216c3.43 2.481 7.482 3.749 11.564 3.749 2.913 0 5.841-.646 8.563-1.958l28.229-13.594c6.537-3.148 10.81-9.606 11.15-16.854l1.216-25.93c.048-1.002.403-1.946 1.026-2.729l2.451-3.072c2.584-3.238 2.053-7.957-1.185-10.54-3.238-2.584-7.957-2.054-10.54 1.185l-2.453 3.074c-2.605 3.268-4.086 7.202-4.283 11.378l-1.217 25.93c-.081 1.739-1.106 3.288-2.674 4.044l-28.229 13.595c-1.568.754-3.417.589-4.828-.43l-21.031-15.215c-3.387-2.451-7.387-3.747-11.567-3.747h-30.066c-4.181 0-8.181 1.296-11.566 3.746l-21.032 15.216c-1.41 1.02-3.261 1.185-4.828.43l-28.229-13.595c-1.568-.756-2.593-2.304-2.674-4.043l-1.218-25.929c-.195-4.175-1.677-8.11-4.284-11.381l-18.745-23.505c-6.306-7.909-12.886-6.552-35.149-13.665-1.677-.467-2.959-1.811-3.347-3.507l-6.972-30.547c-.387-1.697.186-3.464 1.493-4.611l19.515-17.119c3.142-2.757 5.295-6.368 6.225-10.443l6.69-29.312c.931-4.073.559-8.261-1.077-12.11l-10.154-23.892c-.681-1.602-.43-3.44.656-4.802l19.534-24.496c1.086-1.36 2.822-2.011 4.536-1.708l25.551 4.583c4.113.738 8.279.171 12.047-1.645l27.09-13.045c3.767-1.814 6.808-4.717 8.795-8.393l12.348-22.834c.827-1.531 2.423-2.482 4.163-2.482h31.332c1.74 0 3.336.951 4.163 2.482l12.348 22.833c1.987 3.678 5.029 6.58 8.797 8.394 24.748 10.903 28.928 16.521 39.134 14.689l25.553-4.583c1.722-.306 3.451.348 4.535 1.707l19.536 24.498c1.085 1.36 1.336 3.2.655 4.802l-10.154 23.89c-1.636 3.847-2.008 8.035-1.077 12.111l6.689 29.312c.93 4.075 3.083 7.687 6.225 10.443l19.515 17.119c1.309 1.148 1.881 2.915 1.494 4.611l-6.974 30.548c-.387 1.696-1.668 3.039-3.345 3.506l-25.011 6.956c-1.822.508-3.574 1.285-5.207 2.311-3.508 2.204-4.563 6.834-2.36 10.341 2.206 3.508 6.836 4.563 10.341 2.36.404-.254.824-.442 1.247-.561l25.01-6.956c6.991-1.945 12.336-7.548 13.949-14.62l6.973-30.547c1.617-7.071-.769-14.437-6.223-19.223z'/><path d='m343.804 421.222c38.45 0 69.731-31.281 69.731-69.731 0-38.449-31.281-69.73-69.731-69.73-38.443 0-69.721 31.272-69.73 69.713v.009.003.006c0 38.448 31.281 69.73 69.73 69.73zm-7.5-123.935v16.859h-8.8c-4.143 0-7.5 3.357-7.5 7.5s3.357 7.5 7.5 7.5h16.3c4.143 0 7.5-3.357 7.5-7.5v-24.359c24.187 3.331 43.374 22.516 46.705 46.704h-31.709v-5.441c0-4.143-3.357-7.5-7.5-7.5s-7.5 3.357-7.5 7.5v12.941c0 4.143 3.357 7.5 7.5 7.5h39.209c-3.331 24.188-22.517 43.374-46.705 46.705v-14.646h5.495c4.143 0 7.5-3.357 7.5-7.5s-3.357-7.5-7.5-7.5h-12.995c-4.143 0-7.5 3.357-7.5 7.5v22.146c-24.184-3.331-43.368-22.512-46.703-46.696l24.064.027h.009c4.138 0 7.495-3.353 7.5-7.491.005-4.143-3.35-7.504-7.491-7.509l-24.084-.027c3.328-24.192 22.515-43.382 46.705-46.713z'/></g></svg>",clock_4:"<svg id='Capa_1' enable-background='new 0 0 511.999 511.999' height='512' viewBox='0 0 511.999 511.999' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m213.044 83.786c-4.143 0-7.5 3.357-7.5 7.5v10.602c0 4.143 3.357 7.5 7.5 7.5s7.5-3.357 7.5-7.5v-10.602c0-4.143-3.357-7.5-7.5-7.5z'/><path d='m300.701 141.303 7.497-7.496c2.93-2.929 2.93-7.678.001-10.606s-7.678-2.93-10.606-.001l-7.497 7.496c-2.93 2.929-2.93 7.678-.001 10.606 2.928 2.929 7.676 2.931 10.606.001z'/><path d='m340.113 225.854c4.143 0 7.5-3.357 7.5-7.5s-3.357-7.5-7.5-7.5h-10.603c-4.143 0-7.5 3.357-7.5 7.5s3.357 7.5 7.5 7.5z'/><path d='m208.629 337.906v10.603c0 4.143 3.357 7.5 7.5 7.5s7.5-3.357 7.5-7.5v-10.603c0-4.143-3.357-7.5-7.5-7.5s-7.5 3.357-7.5 7.5z'/><path d='m117.889 313.509c2.931 2.929 7.678 2.928 10.607 0l7.497-7.497c2.929-2.93 2.929-7.678 0-10.607-2.93-2.928-7.678-2.928-10.607 0l-7.497 7.497c-2.929 2.93-2.929 7.678 0 10.607z'/><path d='m96.577 225.854c4.143 0 7.5-3.357 7.5-7.5s-3.357-7.5-7.5-7.5h-10.602c-4.143 0-7.5 3.357-7.5 7.5s3.357 7.5 7.5 7.5z'/><path d='m125.387 141.303c2.928 2.928 7.677 2.929 10.606-.001 2.929-2.929 2.929-7.678-.001-10.606l-7.497-7.496c-2.928-2.928-7.677-2.929-10.606.001-2.929 2.929-2.929 7.678.001 10.606z'/><path d='m205.544 203.667-13.646-13.287c-2.968-2.891-7.717-2.827-10.605.141-2.89 2.968-2.827 7.716.141 10.605l26.378 25.686c4.714 4.592 12.732 1.29 12.732-5.373v-70.977c0-4.143-3.357-7.5-7.5-7.5s-7.5 3.357-7.5 7.5z'/><path d='m424.727 242.365c.899-7.992 1.362-16.042 1.362-24.01 0-54.784-20.758-106.842-58.45-146.582-2.851-3.006-7.599-3.13-10.603-.28-3.006 2.851-3.131 7.598-.28 10.603 35.037 36.941 54.333 85.333 54.333 136.26 0 6.389-.322 12.837-.946 19.258-10.405-2.751-21.291-4.302-32.503-4.5.439-4.924.686-9.861.686-14.759 0-91.137-74.146-165.282-165.282-165.282s-165.281 74.145-165.281 165.282c0 18.367 3 36.423 8.917 53.665 1.067 3.111 3.978 5.067 7.093 5.067.808 0 1.629-.131 2.436-.408 3.918-1.345 6.004-5.61 4.659-9.528-5.378-15.671-8.104-32.089-8.104-48.796 0-82.866 67.416-150.282 150.281-150.282 82.866 0 150.282 67.416 150.282 150.282 0 5.082-.273 10.212-.792 15.319-68.406 6.309-122.388 63.184-124.098 132.805-8.373 1.424-16.887 2.158-25.392 2.158-53.52 0-103.418-28.824-130.223-75.226-2.072-3.588-6.66-4.812-10.246-2.742-3.586 2.072-4.814 6.659-2.742 10.246 28.624 49.55 82.145 82.722 143.211 82.722 8.652 0 17.316-.68 25.857-2.022.949 11.128 3.227 21.884 6.691 32.099-10.734 1.775-21.644 2.687-32.547 2.687-109.204-.002-198.046-88.844-198.046-198.046s88.842-198.045 198.044-198.045c44.857 0 87.16 14.624 122.335 42.291 3.254 2.562 7.971 1.998 10.531-1.258 2.562-3.256 1.998-7.971-1.258-10.531-37.844-29.768-83.354-45.502-131.608-45.502-117.473 0-213.044 95.571-213.044 213.045 0 117.473 95.571 213.044 213.044 213.044 12.841 0 25.696-1.164 38.3-3.453 21.879 46.484 69.166 78.743 123.852 78.743 28.344 0 55.542-8.599 78.653-24.866 3.388-2.384 4.201-7.062 1.816-10.449-2.383-3.388-7.063-4.201-10.449-1.816-20.571 14.479-44.783 22.132-70.021 22.132-66.339 0-121.804-53.76-121.804-121.804 0-67.162 54.641-121.803 121.804-121.803 67.162 0 121.803 54.641 121.803 121.803 0 29.821-10.896 58.521-30.68 80.813-2.75 3.099-2.467 7.839.631 10.588 3.101 2.751 7.84 2.468 10.588-.631 22.223-25.04 34.461-57.276 34.461-90.771.001-57.973-36.249-107.634-87.271-127.52z'/><path d='m397.696 296.109c0-12.406-10.094-22.5-22.5-22.5s-22.5 10.094-22.5 22.5v89.555c0 12.406 10.094 22.5 22.5 22.5s22.5-10.094 22.5-22.5zm-15 89.555c0 4.136-3.364 7.5-7.5 7.5s-7.5-3.364-7.5-7.5v-89.555c0-4.136 3.364-7.5 7.5-7.5s7.5 3.364 7.5 7.5z'/><path d='m375.196 411.607c-12.406 0-22.5 10.094-22.5 22.5v9.555c0 12.406 10.094 22.5 22.5 22.5s22.5-10.094 22.5-22.5v-9.555c0-12.406-10.093-22.5-22.5-22.5zm7.5 32.055c0 4.136-3.364 7.5-7.5 7.5s-7.5-3.364-7.5-7.5v-9.555c0-4.136 3.364-7.5 7.5-7.5s7.5 3.364 7.5 7.5z'/></g></svg>",hand_1:"<svg height='456pt' viewBox='-65 0 455 456' width='456pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m76.320312 456h98.015626c27.351562 0 52.660156-15.882812 66.046874-41.601562l84.785157-162.835938-4.785157-3.917969c-.089843-.078125-.179687-.15625-.265624-.234375-7.367188-6.929687-17.28125-10.488281-27.371094-9.816406-10.304688.785156-19.820313 5.820312-26.269532 13.898438l-24.457031 29.773437c-1.875 2.28125-4.984375 3.140625-7.765625 2.144531-2.785156-.996094-4.640625-3.628906-4.644531-6.585937l-.140625-204.832031c-.011719-13.960938-10.410156-25.316407-23.183594-25.316407-12.492187 0-22.699218 10.828125-23.171875 24.34375 0 20.6875-.011719 43.207031-.015625 64.640625-.007812 48.476563-.015625 90.316406 0 94.375.007813 1.851563-.726562 3.628906-2.035156 4.9375-1.3125 1.304688-3.089844 2.035156-4.941406 2.027344h-.023438c-1.847656.015625-3.621094-.707031-4.9375-2.003906-1.3125-1.296875-2.054687-3.066406-2.0625-4.910156-.015625-4.085938-.007812-45.902344 0-94.402344 0-20.921875.007813-42.890625.011719-63.171875-.011719-.164063-.019531-.316407-.019531-.480469 0-.398438.007812-.78125.019531-1.179688 0-17.027343 0-32.753906 0-45.628906.007813-13.957031-10.394531-25.222656-23.175781-25.222656h-.710938c-12.78125 0-23.386718 11.175781-23.386718 25.144531v204.972657c0 3.863281-3.136719 7-7 7-3.867188 0-7-3.136719-7-7v-178.472657c0-13.96875-10.183594-25.332031-22.964844-25.332031-12.855469 0-23.035156 11.363281-23.035156 25.332031v178.472657c0 3.863281-3.136719 7-7 7-3.867188 0-7-3.136719-7-7v-105.203126c0-13.972656-10.628907-24.914062-23.414063-24.914062h-.667969c-12.75 0-23.152344 11.074219-23.183594 25-.132812 57.488281-.050781 158.84375.035157 249.570312.039062 44.953126 34.007812 81.429688 75.714843 81.429688zm0 0'/></g></svg>",heart_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M376,30c-27.783,0-53.255,8.804-75.707,26.168c-21.525,16.647-35.856,37.85-44.293,53.268 c-8.437-15.419-22.768-36.621-44.293-53.268C189.255,38.804,163.783,30,136,30C58.468,30,0,93.417,0,177.514 c0,90.854,72.943,153.015,183.369,247.118c18.752,15.981,40.007,34.095,62.099,53.414C248.38,480.596,252.12,482,256,482 s7.62-1.404,10.532-3.953c22.094-19.322,43.348-37.435,62.111-53.425C439.057,330.529,512,268.368,512,177.514 C512,93.417,453.532,30,376,30z'/> </g></svg>",notification_1:"<svg id='Capa_1' enable-background='new 0 0 512 512' height='512' viewBox='0 0 512 512' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m298.748 168.073c0-4.142-3.357-7.5-7.5-7.5h-208.868c-4.143 0-7.5 3.358-7.5 7.5s3.357 7.5 7.5 7.5h208.868c4.143 0 7.5-3.358 7.5-7.5z'/><path d='m255.902 229.496h-173.522c-4.143 0-7.5 3.358-7.5 7.5s3.357 7.5 7.5 7.5h173.521c4.143 0 7.5-3.358 7.5-7.5s-3.357-7.5-7.499-7.5z'/><path d='m255.902 298.419h-173.522c-4.143 0-7.5 3.358-7.5 7.5s3.357 7.5 7.5 7.5h173.521c4.143 0 7.5-3.358 7.5-7.5s-3.357-7.5-7.499-7.5z'/><path d='m505.458 214.869c-25.223-20.342-39.689-50.595-39.689-83.001v-8.891c0-24.836-13.919-46.481-34.364-57.55v-10.305c0-17.112-13.922-31.033-31.034-31.033-17.111 0-31.033 13.922-31.033 31.033v10.305c-20.445 11.069-34.364 32.714-34.364 57.551v8.891c0 32.407-14.467 62.659-39.687 82.999-6.815 5.492-8.594 15.076-3.976 22.627 3.182 5.202 8.722 8.308 14.819 8.308h47.944c6.444 19.781 25.009 33.573 46.298 33.573s39.853-13.792 46.297-33.573h47.944c6.098 0 11.637-3.105 14.818-8.307 4.627-7.567 2.825-17.151-3.973-22.627zm-121.12-159.747c0-8.841 7.193-16.034 16.034-16.034s16.033 7.193 16.033 16.034v4.454c-10.411-2.634-21.446-2.687-32.067 0zm16.034 209.253c-12.997 0-24.523-7.428-30.12-18.573h60.239c-5.596 11.145-17.121 18.573-30.119 18.573zm94.241-33.573c-21.35 0-154.924 0-188.482 0-2.125 0-3.34-2.715-1.43-4.257 28.772-23.203 45.273-57.712 45.273-94.677v-8.891c0-27.789 22.608-50.397 50.397-50.397 27.79 0 50.398 22.608 50.398 50.397v8.891c0 36.965 16.501 71.474 45.275 94.679 1.909 1.538.694 4.255-1.431 4.255z'/><path d='m445.596 269.099c-4.143 0-7.5 3.358-7.5 7.5v64.184c0 24.82-20.192 45.013-45.012 45.013h-227.451c-6.31 0-12.306 2.393-16.882 6.737l-81.169 77.052 11.954-66.377c1.636-9.079-5.346-17.411-14.555-17.411h-4.969c-24.82 0-45.012-20.193-45.012-45.013v-204.986c0-24.82 20.192-45.012 45.012-45.012h260.791c4.143 0 7.5-3.358 7.5-7.5s-3.357-7.5-7.5-7.5h-260.791c-33.09 0-60.012 26.921-60.012 60.012v204.985c0 33.091 26.922 60.013 60.012 60.013h4.717l-12.893 71.593c-1.013 5.623 1.686 11.224 6.713 13.936 5.005 2.699 11.17 1.912 15.334-2.041l85.195-80.873c1.777-1.687 4.105-2.616 6.556-2.616h227.451c33.091 0 60.012-26.922 60.012-60.013v-64.184c-.001-4.141-3.359-7.499-7.501-7.499z'/></g></svg>",notification_2:"<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' id='Layer_1' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve' width='512' height='512'><g fill='%23fff'><path d='M483,351.5v-30c0-23.591-9.086-45.861-25.585-62.708c-12.055-12.309-27.055-20.66-43.415-24.424V206.5h-40v27.868 c-16.36,3.764-31.36,12.115-43.415,24.424C314.086,275.638,305,297.908,305,321.5v33.244c0,4.564-1.258,8.366-3.543,10.707 C285.041,382.266,276,404.039,276,426.757v21.816h116.564C382.207,449.314,374,457.957,374,468.5c0,11.027,8.973,20,20,20 s20-8.973,20-20c0-10.543-8.207-19.186-18.564-19.927H512v-23.375c0-22.057-8.822-43.171-24.842-59.454 C484.516,363.059,483,357.867,483,351.5z M319.81,408.573c2.381-5.498,5.84-10.643,10.27-15.181 C339.701,383.536,345,369.81,345,354.743V321.5c0-26.847,21.616-48.986,48.209-49.41h1.581C421.384,272.514,443,294.653,443,321.5 v30c0,21.818,8.508,35.044,15.645,42.298c4.334,4.405,7.688,9.417,9.951,14.775H319.81z M452,23.5H60c-33.084,0-60,26.916-60,60v256 c0,33.084,26.916,60,60,60h178.99c3.138-14.118,8.704-27.62,16.49-40H60c-11.028,0-20-8.972-20-20V95.763l216,160.663L472,95.763 v122.656c4.91,3.757,9.588,7.888,13.993,12.385c11.049,11.282,19.795,24.248,26.007,38.304V83.5C512,50.416,485.084,23.5,452,23.5z M63.647,63.5h384.706L256,206.574L63.647,63.5z'/></g></svg>",notification_update_1:"<svg height='512pt' viewBox='0 0 512.01157 512' width='512pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m238.351562 335.453125h35.308594c4.875 0 8.828125 3.953125 8.828125 8.828125v35.3125c0 4.875-3.953125 8.824219-8.828125 8.824219h-35.308594c-4.875 0-8.828124-3.949219-8.828124-8.824219v-35.3125c0-4.875 3.953124-8.828125 8.828124-8.828125zm0 0'/><path d='m238.351562 114.765625h35.308594c4.875 0 8.828125 3.949219 8.828125 8.828125v158.894531c0 4.875-3.953125 8.828125-8.828125 8.828125h-35.308594c-4.875 0-8.828124-3.953125-8.828124-8.828125v-158.894531c0-4.878906 3.953124-8.828125 8.828124-8.828125zm0 0'/><path d='m108.585938 465.21875-31.714844 31.714844c-2.527344 2.527344-3.28125 6.324218-1.917969 9.621094 1.367187 3.300781 4.585937 5.453124 8.160156 5.449218h102.273438c4.875 0 8.824219-3.949218 8.824219-8.824218v-102.277344c0-3.570313-2.148438-6.789063-5.449219-8.152344-3.296875-1.367188-7.09375-.613281-9.617188 1.910156l-32.425781 32.425782c-12.363281-7.9375-23.847656-17.167969-34.25-27.542969-49.300781-49.257813-69.875-120.371094-54.492188-188.34375 15.386719-67.972657 64.578126-123.292969 130.289063-146.515625 3.539063-1.210938 5.925781-4.527344 5.945313-8.269532v-37.246093c.019531-2.761719-1.261719-5.371094-3.457032-7.046875-2.195312-1.675782-5.046875-2.226563-7.707031-1.480469-86.480469 25.683594-153.050781 95.007813-175.203125 182.460937-22.15625 87.449219 3.375 180.109376 67.195312 243.871094 10.375 10.332032 21.597657 19.78125 33.546876 28.246094zm0 0'/><path d='m328.964844 501.371094c86.480468-25.683594 153.050781-95.007813 175.203125-182.460938 22.15625-87.453125-3.375-180.109375-67.195313-243.871094-10.375-10.332031-21.597656-19.78125-33.546875-28.246093l31.714844-31.71875c2.527344-2.523438 3.28125-6.320313 1.914063-9.617188-1.367188-3.300781-4.585938-5.45312475-8.15625-5.45312475h-102.273438c-4.875 0-8.824219 3.95312475-8.824219 8.82812475v102.277344c0 3.570313 2.148438 6.785156 5.449219 8.152344 3.296875 1.367187 7.09375.613281 9.617188-1.910157l32.425781-32.425781c12.363281 7.9375 23.847656 17.167969 34.25 27.542969 49.300781 49.257812 69.875 120.371094 54.492187 188.339844-15.386718 67.972656-64.578125 123.292968-130.289062 146.519531-3.539063 1.210937-5.925782 4.527344-5.945313 8.269531v37.246094c-.019531 2.761719 1.261719 5.371094 3.457031 7.046875 2.191407 1.675781 5.046876 2.226563 7.707032 1.480469zm0 0'/></g></svg>",star_1:"<svg id='Bold' enable-background='new 0 0 24 24' height='512' viewBox='0 0 24 24' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m5.574 15.362-1.267 7.767c-.101.617.558 1.08 1.103.777l6.59-3.642 6.59 3.643c.54.3 1.205-.154 1.103-.777l-1.267-7.767 5.36-5.494c.425-.435.181-1.173-.423-1.265l-7.378-1.127-3.307-7.044c-.247-.526-1.11-.526-1.357 0l-3.306 7.043-7.378 1.127c-.606.093-.848.83-.423 1.265z'/></g></svg>",wc_1:"<svg id='Capa_1' enable-background='new 0 0 512 512' height='512' viewBox='0 0 512 512' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m411.5 211.667h-215v-74.667h15c8.284 0 15-6.716 15-15s-6.716-15-15-15h-15v-62c0-24.813-20.187-45-45-45h-91c-8.284 0-15 6.716-15 15v482c0 8.284 6.716 15 15 15h241c10.226 0 17.466-10.034 14.23-19.743l-21.226-63.676c-1.08-3.241 1.32-6.581 4.743-6.581h62.253c57.897 0 105-47.103 105-105 0-10.352 0-40.028 0-50.333 0-30.327-24.673-55-55-55zm0 30c13.785 0 25 11.215 25 25v5.333h-240v-30.333zm-336-136.667h91v167h-91zm76-75c8.271 0 15 6.729 15 15v30h-91v-45zm285 287c0 41.355-33.645 75-75 75h-62.252c-23.851 0-40.748 23.428-33.204 46.067l14.644 43.933h-205.188v-180h361z'/></g></svg>",wc_2:"<svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M467,212H165c-5.259,0-10.305,0.915-15,2.58V90h15c24.813,0,45-20.187,45-45S189.813,0,165,0H45C20.187,0,0,20.187,0,45 v30v182c0,11.792,1.111,22.884,3.299,32.978c0.001,0.004,0.001,0.008,0.002,0.012c0.003,0.017,0.007,0.033,0.011,0.05 c0.012,0.054,0.021,0.11,0.033,0.164c0.003,0.014,0.008,0.027,0.011,0.041c7.734,37.714,28.669,71.824,59.016,96.102 c16.255,12.908,22.822,32.772,16.732,50.606c-0.015,0.042-0.028,0.084-0.043,0.127l-18.3,55.2C57.549,501.973,64.774,512,75,512 h302c8.284,0,15-6.716,15-15v-93.098c41.392-21.053,71.926-58.444,84.064-102.819C496.548,296.877,512,278.709,512,257 C512,232.187,491.813,212,467,212z M30,45c0-8.271,6.729-15,15-15h120c8.271,0,15,6.729,15,15s-6.729,15-15,15 c-2.961,0-132.291,0-135,0V45z M30,90h90v182H30.767C29.71,262.118,30,270.986,30,90z M362,482H95.775l11.742-35.419 c10.352-30.413-0.939-63.438-26.447-83.694C61.101,346.911,46.104,325.726,37.699,302c47.719,0,94.958,0,118.526,0 c9.112,31.911,28.258,60.794,54.777,82.3C240.979,408.611,278.624,422,317,422c15.43,0,30.498-2.108,45-6.252V482z M317,392 c-58.77,0-110.452-36.9-129.314-90h256.69C425.648,355.43,374.39,392,317,392z M467,272h-3.033c-0.041,0-0.082,0-0.123,0 c-23.96,0-299.853,0-313.844,0v-15c0-8.271,6.729-15,15-15h302c8.271,0,15,6.729,15,15S475.271,272,467,272z'/> </g></svg>",wc_3:"<svg id='Capa_1' enable-background='new 0 0 512 512' height='512' viewBox='0 0 512 512' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m444.58 0h-377.16v173.571h56.32c-.001.307-.008.613-.008.92 0 17.939 2.032 35.476 6.032 52.326-19.632 8.926-33.324 28.71-33.324 51.644v43.816h25.198c1.529 43.578 28.151 80.883 65.833 97.867l-17.676 61.868h-41.596v29.988h255.602v-29.989h-41.596l-17.676-61.868c37.682-16.984 64.304-54.289 65.833-97.867h25.198v-43.816c0-22.934-13.692-42.718-33.324-51.644 4.001-16.85 6.032-34.387 6.032-52.326 0-.307-.007-.613-.008-.92h56.32zm-91.964 221.748h-36.702c4.64-14.824 7.125-30.999 7.125-47.259 0-58.105-31.326-109.074-67.039-109.074s-67.039 50.969-67.039 109.074c0 16.261 2.484 32.435 7.125 47.259h-36.702c-3.761-15.145-5.663-30.993-5.663-47.258 0-39.378 11.162-76.227 31.43-103.759 19.252-26.153 44.413-40.555 70.849-40.555s51.597 14.403 70.849 40.556c20.268 27.532 31.43 64.381 31.43 103.759 0 16.265-1.901 32.112-5.663 47.257zm-133.666-47.259c0-21.665 5.433-43.268 14.906-59.269 8.06-13.614 17.129-19.815 22.144-19.815s14.085 6.201 22.144 19.815c9.473 16.001 14.906 37.604 14.906 59.269 0 16.709-3.147 33.165-8.958 47.259h-56.185c-5.81-14.094-8.957-30.55-8.957-47.259zm-121.541-30.908v-113.592h84.323c-7.405 6.627-14.352 14.296-20.733 22.963-18.53 25.171-30.633 56.598-35.207 90.629zm213.607 338.43h-110.032l15.243-53.357c5.531.847 11.195 1.286 16.959 1.286h45.628c5.764 0 11.427-.439 16.959-1.286zm-32.202-82.06h-45.628c-43.688 0-79.47-34.491-81.543-77.675h208.713c-2.072 43.184-37.854 77.675-81.542 77.675zm106.757-107.664h-259.142v-13.827c0-14.735 11.988-26.723 26.723-26.723h56.133 93.431 56.133c14.735 0 26.723 11.988 26.723 26.723v13.827zm29.02-148.706h-28.383c-4.575-34.031-16.677-65.458-35.207-90.629-6.38-8.667-13.327-16.337-20.733-22.963h84.323z'/></g></svg>",voltage_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='485px' height='485px' viewBox='0 0 485 485' style='enable-background:new 0 0 485 485;' xml:space='preserve'> <g fill='%23fff'> <polygon points='353.125,180.403 292.601,180.403 381.354,0 252.754,0 120.551,268.709 189.479,268.709 103.646,485'/> </g></svg>",hand_2:"<svg id='Capa_1' enable-background='new 0 0 512 512' height='512' viewBox='0 0 512 512' width='512' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m393.714 103.285c-6.893 0-13.461 1.418-19.428 3.978v-23.406h-.001c0-27.255-22.173-49.429-49.428-49.429-7.329 0-14.294 1.604-20.556 4.479-4.835-22.217-24.655-38.907-48.301-38.907s-43.466 16.69-48.302 38.908c-6.262-2.875-13.227-4.479-20.556-4.479-27.255 0-49.429 22.174-49.429 49.429v92.264c-5.967-2.561-12.535-3.979-19.429-3.979h-49.427v187.144c0 26.209 10.206 50.849 28.738 69.379l20.167 20.168c12.865 12.866 19.951 29.972 19.951 48.167v15h236.571v-15c0-18.194 7.086-35.301 19.952-48.167l20.167-20.168c18.532-18.53 28.738-43.17 28.738-69.379v-206.572c.002-27.256-22.172-49.43-49.427-49.43zm19.429 256.001c0 18.195-7.085 35.301-19.951 48.166l-20.167 20.168c-14.948 14.948-24.479 33.867-27.607 54.38h-178.836c-3.128-20.513-12.658-39.433-27.606-54.38l-20.167-20.168c-12.866-12.865-19.951-29.971-19.951-48.166v-157.143h19.428c10.713 0 19.429 8.716 19.429 19.429v103.286h30v-241c0-10.713 8.716-19.429 19.429-19.429s19.429 8.716 19.429 19.429v137.714h30v-172.143c-.002-10.713 8.714-19.429 19.427-19.429s19.429 8.716 19.429 19.429v172.143h30v-137.715c0-10.713 8.716-19.429 19.429-19.429s19.428 8.716 19.428 19.429v172.143h30v-103.304c.011-10.705 8.721-19.41 19.428-19.41 10.713 0 19.429 8.716 19.429 19.43z'/></g></svg>",move_1:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 382.632 382.632' style='enable-background:new 0 0 382.632 382.632;' xml:space='preserve'> <g fill='%23fff'> <polygon points='118.632,109.948 141.264,87.316 70.632,16.684 0,87.316 22.632,109.948 54.632,77.948 54.632,304.684 22.632,272.684 0,295.316 70.632,365.948 141.264,295.316 118.632,272.684 86.632,304.684 86.632,77.948 '/> <rect x='174.632' y='15.316' width='208' height='32'/> <rect x='174.632' y='175.316' width='208' height='32'/> <rect x='174.632' y='95.316' width='144' height='32'/> <rect x='174.632' y='255.316' width='144' height='32'/> <rect x='174.632' y='335.316' width='208' height='32'/> </g></svg>",move_2:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 502.624 502.624' style='enable-background:new 0 0 502.624 502.624;' xml:space='preserve'> <g fill='%23fff'> <polygon points='235.312,61.248 235.312,118.624 267.312,118.624 267.312,61.248 288,81.936 310.624,59.312 251.312,0 192,59.312 214.624,81.936 '/> <polygon points='438.624,107.312 416,129.936 436.688,150.624 395.312,150.624 395.312,182.624 436.688,182.624 416,203.312 438.624,225.936 497.936,166.624 '/> <polygon points='86.624,129.936 64,107.312 4.688,166.624 64,225.936 86.624,203.312 65.936,182.624 107.312,182.624 107.312,150.624 65.936,150.624 '/> <path d='M299.312,198.624c0-26.51-21.49-48-48-48c-26.51,0-48,21.49-48,48v64c-35.346,0-64,28.654-64,64v85.328l48,64v26.672h32 v-37.328l-48-64v-74.672c0-17.673,14.327-32,32-32v80h32v-176c0-8.837,7.163-16,16-16c8.837,0,16,7.163,16,16v91.088l128,48 v65.136l-32,64v35.776h32V474.4l32-64v-94.864l-128-48V198.624z'/> <rect x='139.312' y='150.624' width='32' height='32'/> <rect x='331.312' y='150.624' width='32' height='32'/> </g></svg>",move_3:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'> <g fill='%23fff'> <path d='M359.385,137.846c-5.804,0-11.328,1.224-16.327,3.426c-6.982-12.323-20.218-20.657-35.365-20.657 c-5.804,0-11.328,1.224-16.327,3.427c-6.982-12.323-20.218-20.657-35.365-20.657s-28.383,8.334-35.365,20.657 c-4.999-2.203-10.524-3.427-16.327-3.427c-22.395,0-40.615,18.22-40.615,40.615v47.073c-3.522-0.999-7.239-1.535-11.077-1.535 c-22.395,0-40.615,18.22-40.615,40.615v94.769c0,36.647,29.814,66.461,66.462,66.461h155.077 c36.647,0,66.462-29.814,66.462-66.461V178.462C400,156.066,381.78,137.846,359.385,137.846z M370.462,342.154 c0,20.36-16.563,36.923-36.923,36.923H178.462c-20.36,0-36.923-16.563-36.923-36.923v-94.769c0-6.108,4.969-11.077,11.077-11.077 c6.108,0,11.077,4.969,11.077,11.077v77.538c0,8.157,6.613,14.769,14.769,14.769s14.769-6.613,14.769-14.769V161.231 c0-6.108,4.969-11.077,11.077-11.077c6.108,0,11.077,4.969,11.077,11.077V256c0,8.157,6.613,14.769,14.769,14.769 s14.769-6.613,14.769-14.769V144c0-6.108,4.969-11.077,11.077-11.077s11.077,4.969,11.077,11.077v112 c0,8.157,6.613,14.769,14.769,14.769s14.769-6.613,14.769-14.769v-94.769c0-6.108,4.969-11.077,11.077-11.077 c6.108,0,11.077,4.969,11.077,11.077V256c0,8.157,6.613,14.769,14.769,14.769s14.769-6.613,14.769-14.769v-77.538 c0-6.108,4.969-11.077,11.077-11.077c6.108,0,11.077,4.969,11.077,11.077V342.154z'/> <path d='M323.938,47.262L264.862,2.954c-5.252-3.938-12.471-3.938-17.723,0l-59.077,44.308 c-6.525,4.895-7.848,14.152-2.954,20.677c4.896,6.525,14.152,7.847,20.677,2.954L256,33.231l50.215,37.662 c2.656,1.993,5.766,2.955,8.85,2.955c4.491,0,8.926-2.04,11.827-5.909C331.787,61.413,330.464,52.156,323.938,47.262z'/> <path d='M326.892,444.062c-4.896-6.525-14.152-7.847-20.677-2.954L256,478.769l-50.215-37.662 c-6.524-4.895-15.783-3.571-20.677,2.954c-4.894,6.525-3.571,15.782,2.954,20.677l59.077,44.308 c2.626,1.969,5.743,2.954,8.862,2.954s6.236-0.985,8.862-2.954l59.077-44.308C330.464,459.844,331.787,450.587,326.892,444.062z' /> <path d='M33.231,256l37.662-50.215c4.894-6.525,3.571-15.782-2.954-20.677c-6.525-4.894-15.782-3.571-20.677,2.954L2.954,247.138 c-3.938,5.251-3.938,12.472,0,17.723l44.308,59.077c2.902,3.869,7.336,5.909,11.827,5.909c3.084,0,6.193-0.963,8.85-2.955 c6.525-4.895,7.848-14.152,2.954-20.677L33.231,256z'/> <path d='M509.046,247.138l-44.308-59.077c-4.895-6.525-14.152-7.847-20.677-2.954c-6.525,4.895-7.848,14.152-2.954,20.677 L478.769,256l-37.662,50.215c-4.895,6.525-3.571,15.782,2.954,20.677c2.656,1.993,5.766,2.955,8.85,2.955 c4.491,0,8.926-2.04,11.827-5.909l44.308-59.077C512.985,259.611,512.985,252.389,509.046,247.138z'/> </g></svg>",move_4:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 511.781 511.781' style='enable-background:new 0 0 511.781 511.781;' xml:space='preserve'> <g fill='%23fff'> <path d='M298.557,191.781h-85.333c-29.397,0-53.333,23.936-53.333,53.333v21.333c0,29.397,23.936,53.333,53.333,53.333h85.333 c29.397,0,53.333-23.915,53.333-53.333v-21.333C351.891,215.717,327.955,191.781,298.557,191.781z M330.557,266.448 c0,17.643-14.357,32-32,32h-85.333c-17.643,0-32-14.357-32-32v-21.333c0-17.643,14.357-32,32-32h85.333c17.643,0,32,14.357,32,32 V266.448z'/> <path d='M349.544,110.459L264.211,3.792c-4.053-5.056-12.608-5.056-16.661,0l-85.333,106.667c-2.56,3.2-3.051,7.595-1.28,11.285 c1.792,3.691,5.525,6.037,9.621,6.037h170.667c4.096,0,7.829-2.347,9.6-6.037S352.104,113.659,349.544,110.459z M192.765,106.448 l63.125-78.912l63.147,78.912H192.765z'/> <path d='M350.845,389.819c-1.792-3.691-5.525-6.037-9.621-6.037H170.557c-4.096,0-7.829,2.368-9.621,6.037 c-1.771,3.691-1.28,8.085,1.28,11.285l85.333,106.667c2.048,2.539,5.099,4.011,8.341,4.011c3.243,0,6.293-1.472,8.341-4.011 l85.333-106.667C352.125,397.904,352.616,393.509,350.845,389.819z M255.891,484.048l-63.125-78.933h126.251L255.891,484.048z'/> </g></svg>",move_5:"<svg height='512pt' viewBox='0 -75 512 512' width='512pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m192 42.667969h-170.667969c-11.773437 0-21.332031-9.558594-21.332031-21.335938 0-11.773437 9.558594-21.332031 21.332031-21.332031h170.667969c11.777344 0 21.332031 9.558594 21.332031 21.332031 0 11.777344-9.554687 21.335938-21.332031 21.335938zm0 0'/><path d='m192 298.667969h-170.667969c-11.773437 0-21.332031-9.558594-21.332031-21.335938 0-11.773437 9.558594-21.332031 21.332031-21.332031h170.667969c11.777344 0 21.332031 9.558594 21.332031 21.332031 0 11.777344-9.554687 21.335938-21.332031 21.335938zm0 0'/><path d='m192 170.667969h-170.667969c-11.773437 0-21.332031-9.558594-21.332031-21.335938 0-11.773437 9.558594-21.332031 21.332031-21.332031h170.667969c11.777344 0 21.332031 9.558594 21.332031 21.332031 0 11.777344-9.554687 21.335938-21.332031 21.335938zm0 0'/><path d='m362.667969 0h-85.335938c-11.773437 0-21.332031 9.558594-21.332031 21.332031 0 11.777344 9.558594 21.335938 21.332031 21.335938h85.335938c58.816406 0 106.664062 47.847656 106.664062 106.664062 0 58.816407-47.847656 106.667969-106.664062 106.667969v-48c0-6.355469-3.777344-12.117188-9.601563-14.675781-5.824218-2.519531-12.628906-1.386719-17.300781 2.941406l-74.667969 69.335937c-3.242187 3.027344-5.097656 7.273438-5.097656 11.730469 0 4.460938 1.855469 8.707031 5.097656 11.734375l74.667969 69.332032c3.027344 2.796874 6.933594 4.269531 10.902344 4.269531 2.175781 0 4.328125-.449219 6.398437-1.324219 5.824219-2.558594 9.601563-8.320312 9.601563-14.675781v-48c82.34375 0 149.332031-66.988281 149.332031-149.335938 0-82.34375-66.988281-149.332031-149.332031-149.332031zm0 0'/></g></svg>",move_6:"<svg height='512pt' viewBox='0 0 512 512.00081' width='512pt' xmlns='http://www.w3.org/2000/svg'><g fill='%23fff'><path d='m467 .00390625h-181c-24.8125 0-45 20.18749975-45 44.99999975v60c0 24.8125 20.1875 45 45 45h75v31h-75c-24.8125 0-45 20.183594-45 44.996094v60c0 24.816406 20.1875 45 45 45h75v31h-75c-24.8125 0-45 20.1875-45 45v60c0 24.8125 20.1875 45 45 45h181c24.8125 0 45-20.1875 45-45v-60c0-24.8125-20.1875-45-45-45h-76v-31h76c24.8125 0 45-20.183594 45-45v-60c0-24.8125-20.1875-44.996094-45-44.996094h-76v-31h76c24.8125 0 45-20.1875 45-45v-60c0-24.8125-20.1875-44.99999975-45-44.99999975zm15 406.99609375v60c0 8.273438-6.730469 15-15 15h-181c-8.273438 0-15-6.726562-15-15v-60c0-8.269531 6.726562-15 15-15h181c8.269531 0 15 6.730469 15 15zm0-181v60c0 8.273438-6.730469 15-15 15h-181c-8.273438 0-15-6.726562-15-15v-60c0-8.269531 6.726562-14.996094 15-14.996094h181c8.269531 0 15 6.726563 15 14.996094zm0-120.996094c0 8.269532-6.730469 15-15 15h-181c-8.273438 0-15-6.730468-15-15v-60c0-8.273437 6.726562-15 15-15h181c8.269531 0 15 6.726563 15 15zm0 0'/><path d='m76 452c8.285156 0 15-6.714844 15-15 0-8.28125-6.714844-15-15-15-24.933594 0-46-20.605469-46-45 0-8.28125-6.714844-15-15-15s-15 6.71875-15 15c0 41.457031 34.535156 75 76 75zm0 0'/><path d='m15 331c8.285156 0 15-6.714844 15-15v-60c0-8.28125-6.714844-15-15-15s-15 6.71875-15 15v60c0 8.285156 6.714844 15 15 15zm0 0'/><path d='m15 211.003906c8.285156 0 15-6.71875 15-15v-61c0-24.394531 21.066406-45 46-45h70.457031l-48.777343 32.515625c-6.894532 4.597657-8.757813 13.910157-4.160157 20.800781 4.617188 6.929688 13.941407 8.734376 20.800781 4.160157l90-59.996094c4.171876-2.785156 6.679688-7.46875 6.679688-12.484375s-2.507812-9.699219-6.679688-12.480469l-90-60c-6.894531-4.59375-16.207031-2.730469-20.800781 4.160157-4.597656 6.894531-2.734375 16.207031 4.160157 20.800781l48.777343 32.519531h-70.457031c-41.457031 0-76 33.535156-76 75v61c0 8.285156 6.714844 15.003906 15 15.003906zm0 0'/><path d='m136 422c-8.285156 0-15 6.71875-15 15 0 8.285156 6.714844 15 15 15h60c8.285156 0 15-6.714844 15-15 0-8.28125-6.714844-15-15-15zm0 0'/><path d='m437 60.003906h-121c-8.285156 0-15 6.714844-15 15 0 8.28125 6.714844 15 15 15h121c8.28125 0 15-6.71875 15-15 0-8.285156-6.71875-15-15-15zm0 0'/><path d='m301 256c0 8.285156 6.714844 15 15 15h121c8.28125 0 15-6.714844 15-15 0-8.28125-6.71875-15-15-15h-121c-8.285156 0-15 6.71875-15 15zm0 0'/><path d='m301 437c0 8.285156 6.714844 15 15 15h121c8.28125 0 15-6.714844 15-15 0-8.28125-6.71875-15-15-15h-121c-8.285156 0-15 6.714844-15 15zm0 0'/></g></svg>",move_7:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 421.285 421.285' style='enable-background:new 0 0 421.285 421.285;' xml:space='preserve'> <g fill='%23fff'> <path d='M418.742,203.942c-0.3-0.2-0.5-0.5-0.8-0.8l-50.6-44.8c-4.1-3.6-10.5-3.2-14.1,0.9c-3.6,4.1-3.2,10.4,0.8,14l30.9,27.4 h-164.3v-164.3l27.3,30.8c3.7,4.1,10,4.5,14.1,0.8s4.5-10,0.8-14.1l-44.8-50.5c-3.7-4.1-10-4.5-14.1-0.8c-0.3,0.3-0.6,0.5-0.8,0.8 l-44.8,50.5c-3.6,4.1-3.2,10.5,0.9,14.1c4.1,3.6,10.4,3.2,14-0.8l27.3-30.8v164.3h-164.2l30.8-27.3c4.1-3.7,4.5-10,0.8-14.1 c-3.7-4.1-10-4.5-14.1-0.8l-50.5,44.8c-4.1,3.7-4.5,10-0.8,14.1c0.3,0.3,0.5,0.6,0.8,0.8l50.5,44.8c4.1,3.6,10.5,3.2,14.1-0.9 c3.6-4.1,3.2-10.4-0.8-14l-30.8-27.4h164.3v164.3l-27.3-30.8c-3.7-4.1-10-4.5-14.1-0.8c-4.1,3.7-4.5,10-0.8,14.1l44.8,50.5 c3.7,4.1,10,4.5,14.1,0.8c0.3-0.3,0.6-0.5,0.8-0.8l44.8-50.5c3.6-4.1,3.2-10.5-0.9-14.1c-4.1-3.6-10.4-3.2-14,0.8l-27.4,30.8 v-164.3h164.3l-30.8,27.3c-4.1,3.7-4.5,10-0.8,14.1c3.7,4.1,10,4.5,14.1,0.8l50.5-44.8 C422.042,214.342,422.442,208.042,418.742,203.942z'/> </g></svg>",move_8:"<svg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512.025 512.025' style='enable-background:new 0 0 512.025 512.025;' xml:space='preserve'> <g fill='%23fff'> <path d='M155.293,4.653c-6.241-6.204-16.319-6.204-22.56,0l-112,112l22.56,22.72l84.64-84.8v457.44h32V54.573l84.64,84.64 l22.72-22.56L155.293,4.653z'/> <path d='M468.573,372.653l-84.64,84.8V0.013h-32v457.44l-84.64-84.64l-22.56,22.56l112,112c6.241,6.204,16.319,6.204,22.56,0 l112-112L468.573,372.653z'/> </g></svg>"},e=Object.keys(t);return{getIconSvg:function(e){return t[e]},getIconUrl:function(e){var e=t[e];return e=e&&'"data:image/svg+xml,'+e+'"'},getIconList:function(){return e}}}(),RED.history=function(){var t=[],o=[];function R(t){var e,o,i,n,a,r,s,d,l,c,p,u={};if(t){if("multi"==t.t)for(i={t:"multi",events:[]},e=t.events.length-1;0<=e;e--){var f=R(t.events[e]);i.events.push(f)}else if("replace"==t.t)t.complete?(i={t:"replace",config:RED.nodes.createCompleteNodeSet(),changed:{},rev:RED.nodes.version()},RED.nodes.clear(),RED.nodes.import(t.config).nodes.forEach(function(e){t.changed[e.id]&&(e.changed=!0,i.changed[e.id]=!0)}),RED.nodes.version(t.rev)):(n={},t.config.forEach(function(e){n[e.id]="replace"}),a=RED.nodes.import(t.config,{importMap:n}),i={t:"replace",config:a.removedNodes,dirty:RED.nodes.dirty()});else if("add"==t.t){if(i={t:"delete",dirty:RED.nodes.dirty()},t.nodes)for(i.nodes=[],e=0;e<t.nodes.length;e++)(d=RED.nodes.node(t.nodes[e])).z&&(u[d.z]=!0),i.nodes.push(d),RED.nodes.remove(t.nodes[e]),!d.g||-1!==(s=(r=RED.nodes.group(d.g)).nodes.indexOf(d))&&(r.nodes.splice(s,1),RED.group.markDirty(r));if(t.links)for(i.links=[],e=0;e<t.links.length;e++)i.links.push(t.links[e]),RED.nodes.removeLink(t.links[e]);if(t.groups)for(i.groups=[],e=t.groups.length-1;0<=e;e--)u[(r=t.groups[e]).z]=!0,i.groups.unshift(r),RED.nodes.removeGroup(r);if(t.workspaces)for(i.workspaces=[],e=0;e<t.workspaces.length;e++){var h=RED.nodes.getWorkspaceOrder();t.workspaces[e]._index=h.indexOf(t.workspaces[e].id),i.workspaces.push(t.workspaces[e]),RED.nodes.removeWorkspace(t.workspaces[e].id),RED.workspaces.remove(t.workspaces[e])}if(t.subflows)for(i.subflows=[],e=0;e<t.subflows.length;e++)i.subflows.push(t.subflows[e]),RED.nodes.removeSubflow(t.subflows[e]),RED.workspaces.remove(t.subflows[e]);if(t.subflow&&(i.subflow={},t.subflow.instances&&(i.subflow.instances=[],t.subflow.instances.forEach(function(e){i.subflow.instances.push(e);var t=RED.nodes.node(e.id);t&&(t.changed=e.changed,t.dirty=!0)})),t.subflow.hasOwnProperty("changed")&&(o=RED.nodes.subflow(t.subflow.id))&&(o.changed=t.subflow.changed)),t.removedLinks)for(i.createdLinks=[],e=0;e<t.removedLinks.length;e++)i.createdLinks.push(t.removedLinks[e]),RED.nodes.addLink(t.removedLinks[e])}else if("delete"==t.t){if(i={t:"add",dirty:RED.nodes.dirty()},t.workspaces)for(i.workspaces=[],e=0;e<t.workspaces.length;e++)i.workspaces.push(t.workspaces[e]),RED.nodes.addWorkspace(t.workspaces[e],t.workspaces[e]._index),RED.workspaces.add(t.workspaces[e],void 0,t.workspaces[e]._index),delete t.workspaces[e]._index;if(t.subflows)for(i.subflows=[],e=0;e<t.subflows.length;e++)i.subflows.push(t.subflows[e]),RED.nodes.addSubflow(t.subflows[e]);if(t.subflowInputs&&0<t.subflowInputs.length&&((o=RED.nodes.subflow(t.subflowInputs[0].z)).in.push(t.subflowInputs[0]),o.in[0].dirty=!0),t.subflowOutputs&&0<t.subflowOutputs.length)for(o=RED.nodes.subflow(t.subflowOutputs[0].z),t.subflowOutputs.sort(function(e,t){return e.i-t.i}),e=0;e<t.subflowOutputs.length;e++){var g=t.subflowOutputs[e];o.out.splice(g.i,0,g);for(var v=g.i+1;v<o.out.length;v++)o.out[v].i++,o.out[v].dirty=!0;RED.nodes.eachLink(function(e){e.source.type=="subflow:"+o.id&&e.sourcePort>=g.i&&e.sourcePort++})}if(t.subflow&&(i.subflow={},t.subflow.hasOwnProperty("instances")&&(i.subflow.instances=[],t.subflow.instances.forEach(function(e){i.subflow.instances.push(e);var t=RED.nodes.node(e.id);t&&(t.changed=e.changed,t.dirty=!0)})),t.subflow.hasOwnProperty("status")&&((o=RED.nodes.subflow(t.subflow.id)).status=t.subflow.status)),o&&RED.nodes.filterNodes({type:"subflow:"+o.id}).forEach(function(e){for(e.inputs=o.in.length;e.inputs>e.inputPorts.length;)e.inputPorts.push(e.inputPorts.length);for(e.outputs=o.out.length;e.outputs>e.outputPorts.length;)e.outputPorts.push(e.outputPorts.length);e.resize=!0,e.dirty=!0}),t.groups){i.groups=[];var m={};for(t.groups.forEach(function(e){m[e.id]=e}),e=t.groups.length-1;0<=e;e--)RED.nodes.addGroup(t.groups[e]),u[t.groups[e].z]=!0,i.groups.unshift(t.groups[e]),t.groups[e].g&&(-1===(r=m[t.groups[e].g]||RED.nodes.group(t.groups[e].g)).nodes.indexOf(t.groups[e])&&r.nodes.push(t.groups[e]),RED.group.markDirty(t.groups[e]))}if(t.nodes)for(i.nodes=[],e=0;e<t.nodes.length;e++)RED.nodes.add(t.nodes[e]),u[t.nodes[e].z]=!0,i.nodes.push(t.nodes[e].id),t.nodes[e].g&&(-1===(r=RED.nodes.group(t.nodes[e].g)).nodes.indexOf(t.nodes[e])&&r.nodes.push(t.nodes[e]),RED.group.markDirty(r));if(t.links)for(i.links=[],e=0;e<t.links.length;e++)RED.nodes.addLink(t.links[e]),i.links.push(t.links[e]);if(t.createdLinks)for(i.removedLinks=[],e=0;e<t.createdLinks.length;e++)i.removedLinks.push(t.createdLinks[e]),RED.nodes.removeLink(t.createdLinks[e]);if(t.changes)for(e in t.changes)if(t.changes.hasOwnProperty(e)){if(d=RED.nodes.node(e)){for(var b in t.changes[e])t.changes[e].hasOwnProperty(b)&&(d[b]=t.changes[e][b]);d.dirty=!0}RED.events.emit("nodes:change",d)}o&&RED.events.emit("subflows:change",o)}else if("move"==t.t){for(i={t:"move",nodes:[],dirty:RED.nodes.dirty()},e=0;e<t.nodes.length;e++){var y=t.nodes[e],w={n:y.n,ox:y.n.x,oy:y.n.y,dirty:!0,moved:y.n.moved};i.nodes.push(w),y.n.x=y.ox,y.n.y=y.oy,y.n.dirty=!0,y.n.moved=y.moved}if(t.links)for(i.removedLinks=[],e=0;e<t.links.length;e++)i.removedLinks.push(t.links[e]),RED.nodes.removeLink(t.links[e]);if(t.removedLinks)for(i.links=[],e=0;e<t.removedLinks.length;e++)i.links.push(t.removedLinks[e]),RED.nodes.addLink(t.removedLinks[e]);t.addToGroup?(RED.group.removeFromGroup(t.addToGroup,t.nodes.map(function(e){return e.n}),!1),i.removeFromGroup=t.addToGroup):t.removeFromGroup&&(RED.group.addToGroup(t.removeFromGroup,t.nodes.map(function(e){return e.n})),i.addToGroup=t.removeFromGroup)}else if("edit"==t.t){for(e in(i={t:"edit",changes:{},changed:t.node.changed,dirty:RED.nodes.dirty()}).node=t.node,t.changes)t.changes.hasOwnProperty(e)&&(i.changes[e]=t.node[e],t.node._def.defaults&&t.node._def.defaults[e]&&t.node._def.defaults[e].type&&(l=t.node[e],(l=!Array.isArray(l)?[l]:l).forEach(function(e){e=RED.nodes.node(e);e&&"config"===e._def.category&&(e.users.splice(e.users.indexOf(t.node),1),RED.events.emit("nodes:change",e))}),l=t.changes[e],(l=!Array.isArray(l)?[l]:l).forEach(function(e){e=RED.nodes.node(e);e&&"config"===e._def.category&&(e.users.push(t.node),RED.events.emit("nodes:change",e))})),t.node[e]=t.changes[e]);switch(t.node.type){case"tab":c="flows";break;case"group":c="groups";break;case"subflow":c="subflows";break;default:c="nodes"}if(RED.events.emit(c+=":change",t.node),"tab"===t.node.type&&t.changes.hasOwnProperty("disabled")&&($("#red-ui-tab-"+t.node.id.replace(".","-")).toggleClass("red-ui-workspace-disabled",!!t.node.disabled),$("#red-ui-workspace").toggleClass("red-ui-workspace-disabled",!!t.node.disabled)),t.subflow)i.subflow={},t.subflow.hasOwnProperty("inputCount")&&(i.subflow.inputCount=t.node.in.length,t.node.in.length>t.subflow.inputCount?(i.subflow.inputs=t.node.in.slice(t.subflow.inputCount),t.node.in.splice(t.subflow.inputCount)):0<t.subflow.inputs.length&&(t.node.in=t.node.in.concat(t.subflow.inputs))),t.subflow.hasOwnProperty("outputCount")&&(i.subflow.outputCount=t.node.out.length,t.node.out.length>t.subflow.outputCount?(i.subflow.outputs=t.node.out.slice(t.subflow.outputCount),t.node.out.splice(t.subflow.outputCount)):0<t.subflow.outputs.length&&(t.node.out=t.node.out.concat(t.subflow.outputs))),t.subflow.hasOwnProperty("instances")&&(i.subflow.instances=[],t.subflow.instances.forEach(function(e){i.subflow.instances.push(e);var t=RED.nodes.node(e.id);t&&(t.changed=e.changed,t.dirty=!0)})),t.subflow.hasOwnProperty("status")&&t.subflow.status&&delete t.node.status,RED.editor.validateNode(t.node),RED.nodes.filterNodes({type:"subflow:"+t.node.id}).forEach(function(e){e.inputs=t.node.in.length,e.outputs=t.node.out.length,RED.editor.updateNodeProperties(e),RED.editor.validateNode(e)});else{if(t.outputMap)for(var E in p={},i.outputMap={},t.outputMap)t.outputMap.hasOwnProperty(E)&&"-1"!==t.outputMap[E]&&(p[t.outputMap[E]]=E,i.outputMap[t.outputMap[E]]=E);t.node.__outputs=i.changes.outputs,RED.editor.updateNodeProperties(t.node,p),RED.editor.validateNode(t.node)}if(t.links)for(i.createdLinks=[],e=0;e<t.links.length;e++)RED.nodes.addLink(t.links[e]),i.createdLinks.push(t.links[e]);if(t.createdLinks)for(i.links=[],e=0;e<t.createdLinks.length;e++)RED.nodes.removeLink(t.createdLinks[e]),i.links.push(t.createdLinks[e]);t.node.dirty=!0,t.node.changed=t.changed}else if("createSubflow"==t.t){if(i={t:"deleteSubflow",activeWorkspace:t.activeWorkspace,dirty:RED.nodes.dirty()},t.nodes){i.movedNodes=[];var D=t.activeWorkspace;for(RED.nodes.filterNodes({z:t.subflow.subflow.id}).concat(RED.nodes.groups(t.subflow.subflow.id)).forEach(function(e){e.x+=t.subflow.offsetX,e.y+=t.subflow.offsetY,e.dirty=!0,i.movedNodes.push(e.id),RED.nodes.moveNodeToTab(e,D)}),i.subflows=[],e=0;e<t.nodes.length;e++)i.subflows.push(RED.nodes.node(t.nodes[e])),RED.nodes.remove(t.nodes[e])}if(t.links)for(i.links=[],e=0;e<t.links.length;e++)i.links.push(t.links[e]),RED.nodes.removeLink(t.links[e]);if(i.subflow=t.subflow,RED.nodes.removeSubflow(t.subflow.subflow),RED.workspaces.remove(t.subflow.subflow),t.removedLinks)for(i.createdLinks=[],e=0;e<t.removedLinks.length;e++)i.createdLinks.push(t.removedLinks[e]),RED.nodes.addLink(t.removedLinks[e])}else if("deleteSubflow"==t.t){if(i={t:"createSubflow",activeWorkspace:t.activeWorkspace,dirty:RED.nodes.dirty()},t.subflow&&(RED.nodes.addSubflow(t.subflow.subflow),i.subflow=t.subflow,t.subflow.subflow.g&&RED.group.addToGroup(RED.nodes.group(t.subflow.subflow.g),t.subflow.subflow)),t.subflows)for(i.nodes=[],e=0;e<t.subflows.length;e++)RED.nodes.add(t.subflows[e]),i.nodes.push(t.subflows[e].id);if(t.movedNodes&&t.movedNodes.forEach(function(e){nn=RED.nodes.node(e),nn=nn||RED.nodes.group(e),nn.x-=t.subflow.offsetX,nn.y-=t.subflow.offsetY,nn.dirty=!0,RED.nodes.moveNodeToTab(nn,t.subflow.subflow.id)}),t.links)for(i.links=[],e=0;e<t.links.length;e++)i.links.push(t.links[e]),RED.nodes.addLink(t.links[e]);if(t.createdLinks)for(i.removedLinks=[],e=0;e<t.createdLinks.length;e++)i.removedLinks.push(t.createdLinks[e]),RED.nodes.removeLink(t.createdLinks[e])}else if("reorder"==t.t)i={t:"reorder",dirty:RED.nodes.dirty()},t.workspaces&&(i.workspaces={from:t.workspaces.to,to:t.workspaces.from},RED.workspaces.order(t.workspaces.from)),t.nodes&&(i.nodes={z:t.nodes.z,from:t.nodes.to,to:t.nodes.from},RED.nodes.setNodeOrder(t.nodes.z,t.nodes.from));else if("createGroup"==t.t){if(i={t:"ungroup",dirty:RED.nodes.dirty(),groups:[]},t.groups)for(e=0;e<t.groups.length;e++)i.groups.push(t.groups[e]),RED.group.ungroup(t.groups[e])}else if("ungroup"==t.t){if(i={t:"createGroup",dirty:RED.nodes.dirty(),groups:[]},t.groups)for(e=0;e<t.groups.length;e++){i.groups.push(t.groups[e]);var x=t.groups[e].nodes.slice();t.groups[e].nodes=[],RED.nodes.addGroup(t.groups[e]),RED.group.addToGroup(t.groups[e],x)}}else"addToGroup"==t.t?(i={t:"removeFromGroup",dirty:RED.nodes.dirty(),group:t.group,nodes:t.nodes,reparent:t.reparent},t.nodes&&RED.group.removeFromGroup(t.group,t.nodes,!t.hasOwnProperty("reparent")||void 0===t.hasOwnProperty("reparent")||t.reparent)):"removeFromGroup"==t.t&&(i={t:"addToGroup",dirty:RED.nodes.dirty(),group:t.group,nodes:t.nodes,reparent:t.reparent},t.nodes&&RED.group.addToGroup(t.group,t.nodes));return t.callback&&"function"==typeof t.callback&&(i.callback=t.callback,t.callback(t)),Object.keys(u).forEach(function(e){e=RED.nodes.subflow(e);e&&RED.editor.validateNode(e)}),RED.nodes.dirty(t.dirty),RED.view.updateActive(),RED.view.select(null),RED.workspaces.refresh(),RED.sidebar.config.refresh(),RED.subflow.refresh(),i}}return{markAllDirty:function(){for(var e=0;e<t.length;e++)t[e].dirty=!0},list:function(){return t},listRedo:function(){return o},depth:function(){return t.length},push:function(e){t.push(e),o=[],RED.menu.setDisabled("menu-item-edit-undo",!1),RED.menu.setDisabled("menu-item-edit-redo",!0)},pop:function(){var e=R(t.pop());e&&o.push(e),RED.menu.setDisabled("menu-item-edit-undo",0===t.length),RED.menu.setDisabled("menu-item-edit-redo",0===o.length)},peek:function(){return t[t.length-1]},replace:function(e){0===t.length?RED.history.push(e):t[t.length-1]=e},clear:function(){t=[],o=[],RED.menu.setDisabled("menu-item-edit-undo",!0),RED.menu.setDisabled("menu-item-edit-redo",!0)},redo:function(){var e=o.pop();!e||(e=R(e))&&t.push(e),RED.menu.setDisabled("menu-item-edit-undo",0===t.length),RED.menu.setDisabled("menu-item-edit-redo",0===o.length)}}}(),RED.validators={number:function(t){return function(e){return t&&(""===e||void 0===e)||""!==e&&!isNaN(e)}},regex:function(t){return function(e){return t.test(e)}},typedInput:function(o,i){return function(e){var t=$("#node-"+(i?"config-":"")+"input-"+o).val()||this[o];if("json"===t)try{return JSON.parse(e),!0}catch(e){return!1}else{if("msg"===t||"flow"===t||"global"===t)return RED.utils.validatePropertyExpression(e);if("num"===t)return/^[+-]?[0-9]*\.?[0-9]*([eE][-+]?[0-9]+)?$/.test(e);if("int"===t)return/^[+-]?[0-9]*$/.test(e);if("float"===t)return/^[+-]?[0-9]*$/.test(e)}return!0}}},RED.utils=function(){window._marked=window.marked,window.marked=function(e){return console.warn("Use of 'marked()' is deprecated. Use RED.utils.renderMarkdown() instead"),t(e)};const e=new window._marked.Renderer;function t(e){e=_marked(e);return DOMPurify.sanitize(e,{SAFE_FOR_JQUERY:!0})}function L(e){return e.replace(/\r?\n/g,"&crarr;").replace(/\t/g,"&rarr;")}function z(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function S(e){var t;return Array.isArray(e)?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-meta"></span>').text("array["+e.length+"]"):null===e?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-null">null</span>'):"object"==typeof e?e.hasOwnProperty("type")&&"undefined"===e.type?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-null">undefined</span>'):e.hasOwnProperty("type")&&"Buffer"===e.type&&e.hasOwnProperty("data")?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-meta"></span>').text("buffer["+e.length+"]"):e.hasOwnProperty("type")&&"array"===e.type&&e.hasOwnProperty("data")?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-meta"></span>').text("array["+e.length+"]"):e.hasOwnProperty("type")&&"set"===e.type&&e.hasOwnProperty("data")?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-meta"></span>').text("set["+e.length+"]"):e.hasOwnProperty("type")&&"map"===e.type&&e.hasOwnProperty("data")?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-meta"></span>').text("map"):e.hasOwnProperty("type")&&"function"===e.type?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-meta"></span>').text("function"):!e.hasOwnProperty("type")||"number"!==e.type&&"bigint"!==e.type?e.hasOwnProperty("type")&&"regexp"===e.type?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-string"></span>').text(e.data):$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-meta">object</span>'):$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-number"></span>').text(e.data):"string"==typeof e?(t=30<e.length?z(e.substring(0,30))+"&hellip;":z(e),$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-string"></span>').html('"'+L(t)+'"')):("number"==typeof e?$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-number"></span>'):$('<span class="red-ui-debug-msg-object-value red-ui-debug-msg-type-other"></span>')).text(""+e)}function M(o,i,n,e){o.addClass("red-ui-debug-msg-expandable"),o.prop("toggle",function(){return function(e){var t=o.parent();if(t.hasClass("collapsed")){if(e)return i&&!t.hasClass("built")&&(i(),t.addClass("built")),t.removeClass("collapsed"),!0}else if(!e)return t.addClass("collapsed"),!0;return!1}}),o.on("click",function(e){var t=!$(this).parent().hasClass("collapsed");$(this).prop("toggle")(!t)&&n&&n(!t),e.preventDefault()}),e&&o.trigger("click")}e.list=function(e,t,o){return/dl.*?class.*?message-properties.*/.test(e)&&t?'<ol class="node-ports">'+e+"</ol>":t?"<ol>"+e+"</ol>":"<ul>"+e+"</ul>"},window._marked.setOptions({renderer:e,gfm:!0,tables:!0,breaks:!1,pedantic:!1,smartLists:!0,smartypants:!1}),window._marked.use({extensions:[{name:"descriptionList",level:"block",start(e){if(!e)return null;e=e.match(/:[^:\n]/g);return e&&e.index},tokenizer(e,t){if(!e)return null;const o=/^(?::[^:\n]+:[^:\n]*(?:\n|$))+/.exec(e);return o?{type:"descriptionList",raw:o[0],text:o[0].trim(),tokens:this.lexer.inlineTokens(o[0].trim())}:void 0},renderer(e){return`<dl class="message-properties">${this.parser.parseInline(e.tokens)}
</dl>`}},{name:"description",level:"inline",start(e){if(!e)return null;e=e.match(/:/g);return e&&e.index},tokenizer(e,t){if(!e)return null;const o=/^:([^:\n]+)\(([^:\n]+)\).*?:([^:\n]*)(?:\n|$)/.exec(e);return o?{type:"description",raw:o[0],dt:this.lexer.inlineTokens(o[1].trim()),types:this.lexer.inlineTokens(o[2].trim()),dd:this.lexer.inlineTokens(o[3].trim())}:void 0},renderer(e){return`
<dt>${this.parser.parseInline(e.dt)}<span class="property-type">${this.parser.parseInline(e.types)}</span></dt><dd>${this.parser.parseInline(e.dd)}</dd>`},childTokens:["dt","dd"],walkTokens(e){"strong"===e.type&&(e.text+=" walked")}}]});var O={},d={};function I(e,t,o,i){if(t&&0<t.length){if(""===e&&void 0===o)return!0;for(var n=0;n<t.length;n++){var a=t[n];if(0===a.indexOf(e)&&("."===a[e.length]||"["===a[e.length])){if(void 0===o||"["!==a[e.length])return!0;a=a.substring(e.length),a=/\[(\d+)\]/.exec(a);if(a){a=parseInt(a[1]);return o<=a&&a<=i}}}}return!1}function N(e,t,o,i,n,a){var r,s=d[o]&&d[o][i]&&d[o][i].number||a||"dec";n?(s="dec"===s?13===t.toString().length&&t<=2147483647e3?"dateMS":10===t.toString().length&&t<=2147483647?"dateS":"hex":"dateMS"===s||"dateS"==s?13===t.toString().length&&t<=2147483647e3?"dateML":10===t.toString().length&&t<=2147483647?"dateL":"hex":"dateML"===s||"dateL"==s?"hex":"dec",d[o]=d[o]||{},d[o][i]=d[o][i]||{},d[o][i].number=s):void 0!==a&&(d[o]=d[o]||{},d[o][i]=d[o][i]||{},d[o][i].number=s),"dec"===s?e.text(""+t):"dateMS"===s?e.text(new Date(t).toISOString()):"dateS"===s?e.text(new Date(1e3*t).toISOString()):"dateML"===s?(r=new Date(t),e.text(r.toLocaleString()+"  [UTC"+(r.getTimezoneOffset()/-60<=0?"":"+")+r.getTimezoneOffset()/-60+"]")):"dateL"===s?(r=new Date(1e3*t),e.text(r.toLocaleString()+"  [UTC"+(r.getTimezoneOffset()/-60<=0?"":"+")+r.getTimezoneOffset()/-60+"]")):"hex"===s&&e.text("0x"+t.toString(16))}function P(e,t,o,i,n){var a=d[o]&&d[o][i]&&d[o][i].buffer||"raw";n&&(a="raw"===a?"string":"raw",d[o]=d[o]||{},d[o][i]=d[o][i]||{},d[o][i].buffer=a),"raw"===a?(t.text("raw"),e.removeClass("red-ui-debug-msg-buffer-string").addClass("red-ui-debug-msg-buffer-raw")):"string"===a&&(t.text("string"),e.addClass("red-ui-debug-msg-buffer-string").removeClass("red-ui-debug-msg-buffer-raw"))}function g(e,t){t=new Error(t);return t.code=e,t}function A(e,t){var o=e.length;if(0===o)throw g("INVALID_EXPR","Invalid property expression: zero-length");for(var i,n,a=[],r=0,s=!1,d=!1,l=0;l<o;l++){var c=e[l];if(s){if(c===i){if(l-r==0)throw g("INVALID_EXPR","Invalid property expression: zero-length string at position "+r);if(a.push(e.substring(r,l)),d&&!/\]/.test(e[l+1]))throw g("INVALID_EXPR","Invalid property expression: unexpected array expression at position "+r);if(!d&&l+1!==o&&!/[\[\.]/.test(e[l+1]))throw g("INVALID_EXPR","Invalid property expression: unexpected "+e[l+1]+" expression at position "+(l+1));r=l+1,s=!1}}else if("'"===c||'"'===c){if(l!=r)throw g("INVALID_EXPR","Invalid property expression: unexpected "+c+" at position "+l);s=!0,i=c,r=l+1}else if("."===c){if(0===l)throw g("INVALID_EXPR","Invalid property expression: unexpected . at position 0");if(r!=l&&(n=e.substring(r,l),/^\d+$/.test(n)?a.push(parseInt(n)):a.push(n)),l===o-1)throw g("INVALID_EXPR","Invalid property expression: unterminated expression");if(!/[a-z0-9\$\_]/i.test(e[l+1]))throw g("INVALID_EXPR","Invalid property expression: unexpected "+e[l+1]+" at position "+(l+1));r=l+1}else if("["===c){if(0===l)throw g("INVALID_EXPR","Invalid property expression: unexpected "+c+" at position "+l);if(r!=l&&a.push(e.substring(r,l)),l===o-1)throw g("INVALID_EXPR","Invalid property expression: unterminated expression");if(/^msg[.\[]/.test(e.substring(l+1))){for(var p,u=1,f=!1,h=l+1;h<o;h++)if(/["']/.test(e[h])&&(f?e[h]===p&&(f=!1):(f=!0,p=e[h])),"["===e[h]?u++:"]"===e[h]&&u--,0===u)try{t?a.push(B(t,e.substring(l+1,h))):a.push(A(e.substring(l+1,h),t)),d=!1,r=(l=h)+1;break}catch(e){throw g("INVALID_EXPR","Invalid expression started at position "+(l+1))}if(0<u)throw g("INVALID_EXPR","Invalid property expression: unmatched '[' at position "+l)}else{if(!/["'\d]/.test(e[l+1]))throw g("INVALID_EXPR","Invalid property expression: unexpected "+e[l+1]+" at position "+(l+1));r=l+1,d=!0}}else if("]"===c){if(!d)throw g("INVALID_EXPR","Invalid property expression: unexpected "+c+" at position "+l);if(r!=l){if(n=e.substring(r,l),!/^\d+$/.test(n))throw g("INVALID_EXPR","Invalid property expression: unexpected array expression at position "+r);a.push(parseInt(n))}r=l+1,d=!1}else if(" "===c)throw g("INVALID_EXPR","Invalid property expression: unexpected ' ' at position "+l)}if(d||s)throw new g("INVALID_EXPR","Invalid property expression: unterminated expression");return r<o&&a.push(e.substring(r)),a}function B(e,t){var o=null,t="string"==typeof t?A(t=0===t.indexOf("msg.")?t.substring(4):t):t;return t.reduce(function(e,t){return o=void 0===(o=void 0!==e[t]?e[t]:void 0)&&e.hasOwnProperty("type")&&e.hasOwnProperty("data")&&e.hasOwnProperty("length")?void 0!==e.data[t]?e.data[t]:void 0:o},e),o}function r(e){var t,o={module:"",file:""};return e&&(0===e.indexOf(RED.settings.apiRootUrl+"icons/")&&(e=e.substring((RED.settings.apiRootUrl+"icons/").length)),(t=/^((?:@[^/]+\/)?[^/]+)\/(.*)$/.exec(e))?(o.module=t[1],o.file=t[2]):o.file=e),o}function i(t,e){if(t=t||{},e&&"subflow"===e.type)o="node-red/subflow.svg";else if("function"==typeof t.icon)try{o=t.icon.call(e)}catch(e){console.log("Definition error: "+t.type+".icon",e),o="arrow-in.svg"}else o=t.icon;var o=r(o);return o.module||(t.set?o.module=t.set.module:o.module="node-red"),o}function n(e){var t=RED.nodes.getIconSets()[e.module];return!(!t||-1===t.indexOf(e.file))}var s={};function l(e){if(/^#[a-f0-9]{6}$/i.test(e))t=parseInt(e.substring(1,3),16),o=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);else{if(!/^#[a-f0-9]{3}$/i.test(e))return e;t=parseInt(e.substring(1,2)+e.substring(1,2),16),o=parseInt(e.substring(2,3)+e.substring(2,3),16),i=parseInt(e.substring(3,4)+e.substring(3,4),16)}var t,o,i=(((t=Math.max(0,t-50))<<16)+((o=Math.max(0,o-50))<<8)+(i=Math.max(0,i-50))).toString(16);return"#"+"000000".slice(0,6-i.length)+i}function a(e,t,o){for(var i=0;i<o.length;i++){var n=o[i];if(n.module.test(e))return n}}return{createObjectElement:function s(t,e){var o,i,n,d,l=(e=e||{}).key,c=e.typeHint,a=e.hideKey,p=e.path,u=e.sourceId,f=e.rootPath,h=e.expandPaths,g=e.ontoggle,v=e.exposeApi,r=e.tools,m={};void 0!==p&&void 0!==f&&(d=p.substring(f.length+("."===p[f.length]?1:0)));var b=$('<span class="red-ui-debug-msg-element"></span>');if(b.collapse=function(){b.find(".red-ui-debug-msg-expandable").parent().addClass("collapsed")},i=$('<span class="red-ui-debug-msg-row"></span>').appendTo(b),u&&function(t,o,i,n,a,e){O.hasOwnProperty(o)||(O[o]={});var r,s=$('<span class="red-ui-debug-msg-tools"></span>').appendTo(t),d=$('<span class="red-ui-debug-msg-tools-copy button-group"></span>').appendTo(s);i&&(r=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-terminal"></i></button>').appendTo(d).on("click",function(e){e.preventDefault(),e.stopPropagation(),RED.clipboard.copyText(i,r,"clipboard.copyMessagePath")}),RED.popover.tooltip(r,RED._("node-red:debug.sidebar.copyPath")));var l,c=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-clipboard"></i></button>').appendTo(d).on("click",function(e){e.preventDefault(),e.stopPropagation(),RED.clipboard.copyText(n,c,"clipboard.copyMessageValue")});RED.popover.tooltip(c,RED._("node-red:debug.sidebar.copyPayload")),void 0!==a&&""!==a&&(l=O[o].hasOwnProperty(a),d=$('<button class="red-ui-button red-ui-button-small red-ui-debug-msg-tools-pin"><i class="fa fa-map-pin"></i></button>').appendTo(s).on("click",function(e){e.preventDefault(),e.stopPropagation(),O[o].hasOwnProperty(a)?(delete O[o][a],$(this).removeClass("selected"),t.removeClass("red-ui-debug-msg-row-pinned")):(e="$"+("["===a[0]?"":".")+a,O[o][a]=A(e),$(this).addClass("selected"),t.addClass("red-ui-debug-msg-row-pinned"))}).toggleClass("selected",l),t.toggleClass("red-ui-debug-msg-row-pinned",l),RED.popover.tooltip(d,RED._("node-red:debug.sidebar.pinPath"))),!e||(e="function"==typeof e?e(i,n):e)&&(e.addClass("red-ui-debug-msg-tools-other"),e.appendTo(s))}(i,u,p,t,d,r),l)a||($('<span class="red-ui-debug-msg-object-key"></span>').text(l).appendTo(i),$("<span>: </span>").appendTo(i));else if(b.addClass("red-ui-debug-msg-top-level"),u){var y=O[u],h=[];if(y){for(var w in y)if(y.hasOwnProperty(w))try{void 0!==B({$:t},y[w])&&h.push(w)}catch(e){}h.sort()}b.clearPinned=function(){b.find(".red-ui-debug-msg-row-pinned").removeClass("red-ui-debug-msg-row-pinned"),O[u]={}}}e=$('<span class="red-ui-debug-msg-object-value"></span>').appendTo(i),r=Array.isArray(t),a=!1;if(t&&"object"==typeof t&&t.hasOwnProperty("type")&&t.hasOwnProperty("data")&&(t.__enc__&&"set"===t.type||t.__enc__&&"array"===t.type||"Buffer"===t.type)&&(a=r=!0),null==t)$('<span class="red-ui-debug-msg-type-null">'+t+"</span>").appendTo(e);else if(t.__enc__&&"undefined"===t.type)$('<span class="red-ui-debug-msg-type-null">undefined</span>').appendTo(e);else if(!t.__enc__||"number"!==t.type&&"bigint"!==t.type)if("regexp"===c||t.__enc__&&"regexp"===t.type)o=$('<span class="red-ui-debug-msg-type-string red-ui-debug-msg-object-header"></span>').text("string"==typeof t?t:t.data).appendTo(e);else if("function"===c||t.__enc__&&"function"===t.type)o=$('<span class="red-ui-debug-msg-type-meta red-ui-debug-msg-object-header"></span>').text("function").appendTo(e);else if("internal"===c||t.__enc__&&"internal"===t.type)o=$('<span class="red-ui-debug-msg-type-meta red-ui-debug-msg-object-header"></span>').text("[internal]").appendTo(e);else if("string"==typeof t)/[\t\n\r]/.test(t)&&(b.addClass("collapsed"),$('<i class="fa fa-caret-right red-ui-debug-msg-object-handle"></i> ').prependTo(i),M(i,function(){$('<span class="red-ui-debug-msg-type-meta red-ui-debug-msg-object-type-header"></span>').text(c||"string").appendTo(i);var e=$('<div class="red-ui-debug-msg-object-entry collapsed"></div>').appendTo(b);$('<pre class="red-ui-debug-msg-type-string"></pre>').text(t).appendTo(e)},function(e){g&&g(p,e)},I(d,h))),o=$('<span class="red-ui-debug-msg-type-string red-ui-debug-msg-object-header"></span>').html('"'+L(z(t))+'"').appendTo(e),/^#[0-9a-f]{6}$/i.test(t)&&$('<span class="red-ui-debug-msg-type-string-swatch"></span>').css("backgroundColor",t).appendTo(o);else if("number"==typeof t)o=$('<span class="red-ui-debug-msg-type-number"></span>').appendTo(e),Number.isInteger(t)&&0<=t&&(o.addClass("red-ui-debug-msg-type-number-toggle"),o.on("click",function(e){e.preventDefault(),N($(this),t,u,p,!0)})),N(o,t,u,p,!1,"hex"===c?"hex":void 0);else if(r){b.addClass("collapsed");var E=t.length;!c||(r=/\[(\d+)\]/.exec(c))&&(E=parseInt(r[1]));var D=t,x="array";a?(D=t.data,void 0===E&&(E=D.length),D.__enc__&&(D=D.data),x=t.type.toLowerCase()):/buffer/.test(c)&&(x="buffer");var R,k=D.length;if(0<E&&($('<i class="fa fa-caret-right red-ui-debug-msg-object-handle"></i> ').prependTo(i),R=$('<div class="red-ui-debug-msg-array-rows"></div>').appendTo(b),b.addClass("red-ui-debug-msg-buffer-raw")),l)n=$('<span class="red-ui-debug-msg-type-meta"></span>').text(c||x+"["+E+"]").appendTo(e);else{n=$('<span class="red-ui-debug-msg-object-header"></span>').appendTo(e),$("<span>[ </span>").appendTo(n);for(var _=Math.min(E,10),T=0;T<_;T++)S(D[T]).appendTo(n),T<_-1&&$("<span>, </span>").appendTo(n);_<E&&$("<span> &hellip;</span>").appendTo(n),0===_&&$('<span class="red-ui-debug-msg-type-meta">empty</span>').appendTo(n),$("<span> ]</span>").appendTo(n)}0<E&&M(i,function(){if(l||(n=$('<span class="red-ui-debug-msg-type-meta red-ui-debug-msg-object-type-header"></span>').text(c||x+"["+E+"]").appendTo(i)),"buffer"===x){var e=$('<div class="red-ui-debug-msg-string-rows"></div>').appendTo(b),t=$('<div class="red-ui-debug-msg-object-entry collapsed"></div>').appendTo(e),e="";try{e=String.fromCharCode.apply(null,new Uint16Array(D))}catch(e){console.log(e)}$('<pre class="red-ui-debug-msg-type-string"></pre>').text(e).appendTo(t),t=$('<span class="red-ui-debug-msg-buffer-opts"></span>').appendTo(n),t=$('<a class="red-ui-button red-ui-button-small" href="#"></a>').text("raw").appendTo(t).on("click",function(e){e.preventDefault(),e.stopPropagation(),P(b,$(this),u,p,!0)}),P(b,t,u,p,!1)}if(k<=10)for(T=0;T<k;T++)r=$('<div class="red-ui-debug-msg-object-entry collapsed"></div>').appendTo(R),m[p+"["+T+"]"]=s(D[T],{key:""+T,typeHint:"buffer"===x&&"hex",hideKey:!1,path:p+"["+T+"]",sourceId:u,rootPath:f,expandPaths:h,ontoggle:g,exposeApi:v}).appendTo(r);else{for(T=0;T<k;T+=10){var a=T,r=$('<div class="red-ui-debug-msg-object-entry collapsed"></div>').appendTo(R);i=$("<span></span>").appendTo(r),$('<i class="fa fa-caret-right red-ui-debug-msg-object-handle"></i> ').appendTo(i),M(i,function(){var o=a,i=Math.min(k-1,a+9),n=r;return function(){for(var e=o;e<=i;e++){var t=$('<div class="red-ui-debug-msg-object-entry collapsed"></div>').appendTo(n);m[p+"["+e+"]"]=s(D[e],{key:""+e,typeHint:"buffer"===x&&"hex",hideKey:!1,path:p+"["+e+"]",sourceId:u,rootPath:f,expandPaths:h,ontoggle:g,exposeApi:v}).appendTo(t)}}}(),function(){var t=void 0+"["+T+"]";return function(e){g&&g(t,e)}}(),I(d,h,a,Math.min(k-1,a+9))),$('<span class="red-ui-debug-msg-object-key"></span>').html("["+a+" &hellip; "+Math.min(k-1,a+9)+"]").appendTo(i)}k<E&&$('<div class="red-ui-debug-msg-object-entry collapsed"><span class="red-ui-debug-msg-object-key">['+k+" &hellip; "+E+"]</span></div>").appendTo(R)}},function(e){g&&g(p,e)},I(d,h))}else if("object"==typeof t){b.addClass("collapsed"),x="object",(D=t).__enc__&&(D=D.data,x=t.type.toLowerCase());var C=Object.keys(D);if((l||0<C.length)&&($('<i class="fa fa-caret-right red-ui-debug-msg-object-handle"></i> ').prependTo(i),M(i,function(){for(l||$('<span class="red-ui-debug-msg-type-meta red-ui-debug-msg-object-type-header"></span>').text(x).appendTo(i),T=0;T<C.length;T++){var e=$('<div class="red-ui-debug-msg-object-entry collapsed"></div>').appendTo(b),t=p;void 0!==t&&(/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(C[T])?t+=(0<t.length?".":"")+C[T]:t+='["'+C[T].replace(/"/,'\\"')+'"]'),m[t]=s(D[C[T]],{key:C[T],typeHint:!1,hideKey:!1,path:t,sourceId:u,rootPath:f,expandPaths:h,ontoggle:g,exposeApi:v}).appendTo(e)}0===C.length&&$('<div class="red-ui-debug-msg-object-entry red-ui-debug-msg-type-meta collapsed"></div>').text("empty").appendTo(b)},function(e){g&&g(p,e)},I(d,h))),l)$('<span class="red-ui-debug-msg-type-meta"></span>').text(x).appendTo(e);else{n=$('<span class="red-ui-debug-msg-object-header"></span>').appendTo(e),$("<span>{ </span>").appendTo(n);var j=Math.min(C.length,5);for(T=0;T<j;T++)$('<span class="red-ui-debug-msg-object-key"></span>').text(C[T]).appendTo(n),$("<span>: </span>").appendTo(n),S(D[C[T]]).appendTo(n),T<j-1&&$("<span>, </span>").appendTo(n);C.length>j&&$("<span> &hellip;</span>").appendTo(n),0===j&&$('<span class="red-ui-debug-msg-type-meta">empty</span>').appendTo(n),$("<span> }</span>").appendTo(n)}}else $('<span class="red-ui-debug-msg-type-other"></span>').text(""+t).appendTo(e);else o=$('<span class="red-ui-debug-msg-type-number red-ui-debug-msg-object-header"></span>').text(t.data).appendTo(e);return v&&b.prop("expand",function(){return function(e,t){if(p===e)i.prop("toggle")&&i.prop("toggle")(t);else if(m[e]&&m[e].prop("expand"))m[e].prop("expand")(e,t);else for(var o in m)if(m.hasOwnProperty(o)&&0===e.indexOf(o)){m[o].prop("expand")&&m[o].prop("expand")(e,t);break}}}),b},getMessageProperty:B,setMessageProperty:function(e,t,o,i){void 0===i&&(i=void 0!==o);for(var n,a=A(t=0===t.indexOf("msg.")?t.substring(4):t),r=a.length,s=e,d=0;d<r-1;d++)if("string"==typeof(n=a[d])||"number"==typeof n&&!Array.isArray(s))if(s.hasOwnProperty(n))s=s[n];else{if(!i)return null;"string"==typeof a[d+1]?s[n]={}:s[n]=[],s=s[n]}else if("number"==typeof n)if(void 0===s[n]){if(!i)return null;"string"==typeof a[d+1]?s[n]={}:s[n]=[],s=s[n]}else s=s[n];n=a[r-1],void 0===o?"number"==typeof n&&Array.isArray(s)?s.splice(n,1):delete s[n]:s[n]=o},normalisePropertyExpression:A,validatePropertyExpression:function(e){try{A(e);return!0}catch(e){return!1}},separateIconPath:r,getDefaultNodeIcon:i,getNodeIcon:function(e,t){if(t&&"_selection_"===t.type)return"font-awesome/fa-object-ungroup";if(t&&"group"===t.type)return"font-awesome/fa-object-group";if("config"===(e=e||{}).category)return RED.settings.apiRootUrl+"icons/node-red/cog.svg";if(t&&"tab"===t.type)return"red-ui-icons/red-ui-icons-flow";if(t&&"unknown"===t.type)return RED.settings.apiRootUrl+"icons/node-red/alert.svg";if(t&&t.icon){if(n(o=r(t.icon)))return"font-awesome"===o.module?t.icon:RED.settings.apiRootUrl+"icons/"+t.icon;if("font-awesome"!==o.module&&/.png$/i.test(o.file)&&(o.file=o.file.replace(/.png$/,".svg"),n(o)))return RED.settings.apiRootUrl+"icons/"+t.icon.replace(/.png$/,".svg")}var o;if(n(o=i(e,t)))return"font-awesome"===o.module?o.module+"/"+o.file:RED.settings.apiRootUrl+"icons/"+o.module+"/"+o.file;if(/.png$/i.test(o.file)){t=o.file;if(o.file=o.file.replace(/.png$/,".svg"),n(o))return RED.settings.apiRootUrl+"icons/"+o.module+"/"+o.file;o.file=t}return o.module="node-red",n(o)||/.png$/i.test(o.file)&&(o.file=o.file.replace(/.png$/,".svg"),n(o))?RED.settings.apiRootUrl+"icons/"+o.module+"/"+o.file:"subflows"===e.category?RED.settings.apiRootUrl+"icons/node-red/subflow.svg":RED.settings.apiRootUrl+"icons/node-red/arrow-in.svg"},getNodeLabel:function(t,o){var i;if(o=o||"","tab"===t.type)i=t.label||o;else if("group"===t.type)i=t.name||o;else{i=t._def.label;try{i=("function"==typeof i?i.call(t):i)||o}catch(e){console.log("Definition error: "+t.type+".label",e),i=o}}return RED.text.bidi.enforceTextDirectionWithUCC(i)},getNodeColor:function(e,t){var o=(t=t||{}).color,i=RED.settings.theme("palette.theme")||[];if(0<i.length){if(!s.hasOwnProperty(e)){s[e]=t.color;for(var n=i.length,a=0;a<n;a++){var r=i[a];if((!r.hasOwnProperty("category")||(r.hasOwnProperty("_category")||(r._category=new RegExp(r.category)),r._category.test(t.category)))&&(!r.hasOwnProperty("type")||(r.hasOwnProperty("_type")||(r._type=new RegExp(r.type)),r._type.test(e)))){s[e]=r.color||t.color;break}}}o=s[e]}return o||"#ddd"},clearNodeColorCache:function(){s={}},addSpinnerOverlay:function(e,t){return e=$('<div class="red-ui-component-spinner "><img src="red/images/spin.svg"/></div>').appendTo(e),t&&e.addClass("red-ui-component-spinner-contain"),e},decodeObject:function(e,t){if("number"===t&&"NaN"===e)e=Number.NaN;else if("number"===t&&"Infinity"===e)e=1/0;else if("number"===t&&"-Infinity"===e)e=-1/0;else if("Object"!==t&&!/^(array|set|map)/.test(t)&&"boolean"!==t&&"number"!==t)if(/error/i.test(t))e=(e.name?e.name+": ":"")+e.message;else if("null"===t)e=null;else if("undefined"===t)e=void 0;else if(/^buffer/.test(t)){var o=e;e=[];for(var i=0;i<o.length;i+=2)e.push(parseInt(o.substr(i,2),16))}return e},parseContextKey:function(e,t){var o={},i=/^#:\((\S+?)\)::(.*)$/.exec(e);return i?(o.store=i[1],o.key=i[2]):(o.key=e,t?o.store=t:RED.settings.context&&(o.store=RED.settings.context.default)),o},createIconElement:function(e,t,o){0!==(a=t.find(".red-ui-palette-icon")).length&&a.remove(),0!==(n=t.find("i")).length&&n.remove();var i=r(e);if("font-awesome"===i.module){var n,a=RED.nodes.fontAwesome.getIconUnicode(i.file);if(a)return void(n=$("<i/>").appendTo(t)).addClass("red-ui-palette-icon-fa fa fa-fw "+(o?"fa-lg ":"")+i.file);e=RED.settings.apiRootUrl+"icons/node-red/arrow-in.svg"}else if("red-ui-icons"===i.module)return void $("<i/>").appendTo(t).addClass("red-ui-palette-icon red-ui-icons "+i.file);$("<div/>",{class:"red-ui-palette-icon"}).appendTo(t).css("backgroundImage","url("+e+")")},sanitize:z,renderMarkdown:t,createNodeIcon:function(e,t){var o,i,n=$('<span class="red-ui-node-icon-container">'),a=e._def,r=$("<div>",{class:"red-ui-node-icon"});return"_selection_"===e.type?r.addClass("red-ui-palette-icon-selection"):"group"===e.type?r.addClass("red-ui-palette-icon-group"):"tab"===e.type?r.addClass("red-ui-palette-icon-flow"):(o=RED.utils.getNodeColor(e.type,a),r.css("backgroundColor",o),(i=l(o))!==o&&r.css("border-color",i)),a=RED.utils.getNodeIcon(a,e),RED.utils.createIconElement(a,r,!0),r.appendTo(n),t&&(t=RED.utils.getNodeLabel(e,e.name||e.type+": "+e.id),e=$("<div>",{class:"red-ui-node-label"}).appendTo(n),t?e.text(t):e.html("&nbsp;")),n},getDarkerColor:l,parseModuleList:function(e){return(e=e||["*"]).map(function(e){var t=/^(.+?)(?:@(.*))?$/.exec(e),e=-1===(e=t[1].indexOf("*"))?1/0:e;return{module:new RegExp("^"+t[1].replace(/\*/g,".*")+"$"),version:t[2],wildcardPos:e}})},checkModuleAllowed:function(e,t,o,i){return!o&&!i||(0===o.length&&0===i.length||(o=a(e,0,o),i=a(e,0,i),!(!o||i)||!(!o&&i)&&(!o&&!i||(o.wildcardPos!==i.wildcardPos?o.wildcardPos>i.wildcardPos:o.module.toString().length>i.module.toString().length))))},getBrowserInfo:function(){var e={};try{var t=navigator.userAgent;e.ua=t,e.browser=/Edge\/\d+/.test(t)?"ed":/MSIE 9/.test(t)?"ie9":/MSIE 10/.test(t)?"ie10":/MSIE 11/.test(t)?"ie11":/MSIE\s\d/.test(t)?"ie?":/rv\:11/.test(t)?"ie11":/Firefox\W\d/.test(t)?"ff":/Chrom(e|ium)\W\d|CriOS\W\d/.test(t)?"gc":/\bSafari\W\d/.test(t)?"sa":/\bOpera\W\d/.test(t)||/\bOPR\W\d/i.test(t)?"op":"undefined"!=typeof MSPointerEvent?"ie?":"",e.os=/Windows NT 10/.test(t)?"win10":/Windows NT 6\.0/.test(t)?"winvista":/Windows NT 6\.1/.test(t)?"win7":/Windows NT 6\.\d/.test(t)?"win8":/Windows NT 5\.1/.test(t)?"winxp":/Windows NT [1-5]\./.test(t)?"winnt":/Mac/.test(t)?"mac":/Linux/.test(t)?"linux":/X11/.test(t)?"nix":"",e.touch="ontouchstart"in document.documentElement,e.mobile=/IEMobile|Windows Phone|Lumia/i.test(t)?"w":/iPhone|iP[oa]d/.test(t)?"i":/Android/.test(t)?"a":/BlackBerry|PlayBook|BB10/.test(t)?"b":/Mobile Safari/.test(t)?"s":/webOS|Mobile|Tablet|Opera Mini|\bCrMo\/|Opera Mobi/i.test(t)?1:0,e.tablet=/Tablet|iPad/i.test(t),e.ie=/MSIE \d|Trident.*rv:/.test(navigator.userAgent),e.android=/android/i.test(navigator.userAgent)}catch(e){}return e}}}(),function(s){s.widget("nodered.editableList",{_create:function(){var o=this;this.element.addClass("red-ui-editableList-list"),this.uiWidth=this.element.width(),this.uiContainer=this.element.wrap("<div>").parent(),this.options.header?(this.options.header.addClass("red-ui-editableList-header"),this.borderContainer=this.uiContainer.wrap("<div>").parent(),this.borderContainer.prepend(this.options.header),this.topContainer=this.borderContainer.wrap("<div>").parent()):this.topContainer=this.uiContainer.wrap("<div>").parent(),this.topContainer.addClass("red-ui-editableList"),this.options.class&&this.topContainer.addClass(this.options.class);var e,t,i=this.options.buttons||[];!1!==this.options.addButton&&("string"==typeof this.options.addButton?e=this.options.addButton:t=RED&&RED._?(e=RED._("editableList.add"),RED._("editableList.addTitle")):(e="add","add new item"),i.unshift({label:e,icon:"fa fa-plus",click:function(e){o.addItem({})},title:t})),i.forEach(function(t){var e=s('<button type="button" class="red-ui-button red-ui-button-small red-ui-editableList-addButton" style="margin-top: 4px; margin-right: 5px;"></button>').appendTo(o.topContainer).on("click",function(e){e.preventDefault(),void 0!==t.click&&t.click(e)});t.id&&e.attr("id",t.id),t.title&&e.attr("title",t.title),t.icon&&e.append(s("<i></i>").attr("class",t.icon)),t.label&&e.append(s("<span></span>").text(" "+t.label))}),"absolute"===this.element.css("position")&&(["top","left","bottom","right"].forEach(function(e){var t=o.element.css(e);"auto"!==t&&""!==t&&(o.topContainer.css(e,t),o.uiContainer.css(e,"0"),"top"===e&&o.options.header&&o.uiContainer.css(e,"20px"),o.element.css(e,"auto"))}),this.element.css("position","static"),this.topContainer.css("position","absolute"),this.uiContainer.css("position","absolute")),(this.options.header?this.borderContainer:this.uiContainer).addClass("red-ui-editableList-border"),this.uiContainer.addClass("red-ui-editableList-container"),this.uiHeight=this.element.height(),this.activeFilter=this.options.filter||null,this.activeSort=this.options.sort||null,this.scrollOnAdd=this.options.scrollOnAdd,void 0===this.scrollOnAdd&&(this.scrollOnAdd=!0);i=this.element.css("minHeight");"0px"!==i&&(this.uiContainer.css("minHeight",i),this.element.css("minHeight",0));i=this.element.css("maxHeight");"0px"!==i&&(this.uiContainer.css("maxHeight",i),this.element.css("maxHeight",null)),"auto"!==this.options.height&&(this.uiContainer.css("overflow-x","hidden"),this.uiContainer.css("overflow-y","scroll"),isNaN(this.options.height)||(this.uiHeight=this.options.height)),this.element.height("auto");var i=this.element.attr("style");null!==(i=/width\s*:\s*(\d+%)/i.exec(i))&&(this.element.width("100%"),this.uiContainer.width(i[1])),this.options.sortable&&(i={axis:"y",update:function(e,t){o.options.sortItems&&o.options.sortItems(o.items())},handle:"string"==typeof this.options.sortable?this.options.sortable:".red-ui-editableList-item-handle",cursor:"move",tolerance:"pointer",forcePlaceholderSize:!0,placeholder:"red-ui-editabelList-item-placeholder",start:function(e,t){t.placeholder.height(t.item.height()-4)}},this.options.connectWith&&(i.connectWith=this.options.connectWith),this.element.sortable(i)),this._resize()},_resize:function(){var t,e=this.topContainer.height(),o=this.uiContainer.height();0!==this.uiHeight&&this.uiContainer.height(this.uiHeight-(e-o)),this.options.resize&&this.options.resize(),this.options.resizeItem&&(t=this).element.children().each(function(e){t.options.resizeItem(s(this).children(".red-ui-editableList-item-content"),e)})},_destroy:function(){var e;this.topContainer&&(e=this.topContainer,delete this.topContainer,e.remove())},_refreshFilter:function(){var i=this,n=0;return this.activeFilter?(this.items().each(function(e,t){var o=t.data("data");try{i.activeFilter(o)?(t.parent().show(),n++):t.parent().hide()}catch(e){console.log(e),t.parent().show(),n++}}),n):this.element.children().show()},_refreshSort:function(){var e,o;this.activeSort&&(e=this.element.children(),o=this,e.sort(function(e,t){return o.activeSort(s(e).children(".red-ui-editableList-item-content").data("data"),s(t).children(".red-ui-editableList-item-content").data("data"))}),s.each(e,function(e,t){o.element.append(t)}))},width:function(e){this.uiWidth=e,this._resize()},height:function(e){this.uiHeight=e,this._resize()},getItemAt:function(e){var t=this.items();if(0<=e&&e<t.length)return s(t[e]).data("data")},indexOf:function(e){for(var t=this.items(),o=0;o<t.length;o++)if(s(t[o]).data("data")===e)return o;return-1},insertItemAt:function(i,e){var n=this;i=i||{};var t,a=s("<li>"),o=s("<div/>").addClass("red-ui-editableList-item-content").appendTo(a);o.data("data",i),!0===this.options.sortable&&(s('<i class="red-ui-editableList-item-handle fa fa-bars"></i>').appendTo(a),a.addClass("red-ui-editableList-item-sortable")),this.options.removable&&(t=s("<a/>",{href:"#",class:"red-ui-editableList-item-remove red-ui-button red-ui-button-small"}).appendTo(a),s("<i/>",{class:"fa fa-remove"}).appendTo(t),a.addClass("red-ui-editableList-item-removable"),t.on("click",function(e){e.preventDefault();var t=o.data("data");a.addClass("red-ui-editableList-item-deleting"),a.fadeOut(300,function(){s(this).remove(),n.options.removeItem&&n.options.removeItem(t)})}));var r=!1;if(this.activeSort&&this.items().each(function(e,t){var o;r||(o=t.data("data"),n.activeSort(i,o)<0&&(a.insertBefore(t.closest("li")),r=!0))}),r||(e<=0?a.prependTo(this.element):e>n.element.children().length-1?a.appendTo(this.element):a.insertBefore(this.element.children().eq(e))),this.options.addItem){e=n.element.children().length-1;if(n.options.addItem(o,e,i),n.activeFilter)try{n.activeFilter(i)||a.hide()}catch(e){}!n.activeSort&&n.scrollOnAdd&&setTimeout(function(){n.uiContainer.scrollTop(n.element.height())},0)}},addItem:function(e){this.insertItemAt(e,this.element.children().length)},addItems:function(e){for(var t=0;t<e.length;t++)this.addItem(e[t])},removeItem:function(t,e){var o=this.element.children().filter(function(e){return t===s(this).children(".red-ui-editableList-item-content").data("data")});e?o.detach():o.remove(),this.options.removeItem&&this.options.removeItem(t)},items:function(){return this.element.children().map(function(e){return s(this).children(".red-ui-editableList-item-content")})},empty:function(){this.element.empty(),this.uiContainer.scrollTop(0)},filter:function(e){return void 0!==e&&(this.activeFilter=e),this._refreshFilter()},sort:function(e){return void 0!==e&&(this.activeSort=e),this._refreshSort()},length:function(){return this.element.children().length},show:function(t){var e=this.element.children().filter(function(e){return t===s(this).children(".red-ui-editableList-item-content").data("data")});0<e.length&&this.uiContainer.scrollTop(this.uiContainer.scrollTop()+e.position().top)},getItem:function(e){e=e.children(".red-ui-editableList-item-content");return e.length?e.data("data"):null}})}(jQuery),function(p){p.widget("nodered.treeList",{_create:function(){var i=this,n=!0;!1===i.options.autoSelect&&(n=!1),this.element.addClass("red-ui-treeList"),this.element.attr("tabIndex",0);var e=p("<div>",{class:"red-ui-treeList-container"}).appendTo(this.element);this.element.on("keydown",function(e){var t,o=i._topList.find(".focus").parent().data("data");if(o||40!==e.keyCode&&38!==e.keyCode){switch(e.keyCode){case 32:case 13:if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;e.preventDefault(),e.stopPropagation(),o.checkbox?o.treeList.checkbox.trigger("click"):o.radio?o.treeList.radio.trigger("click"):o.children?o.treeList.container.hasClass("expanded")?o.treeList.collapse():o.treeList.expand():i._trigger("confirm",null,o);break;case 37:e.preventDefault(),e.stopPropagation(),o.children&&o.treeList.container.hasClass("expanded")?o.treeList.collapse():o.parent&&(t=o.parent);break;case 38:e.preventDefault(),e.stopPropagation(),!(t=(t=i._getPreviousSibling(o))&&i._getLastDescendant(t))&&o.parent&&(t=o.parent);break;case 39:e.preventDefault(),e.stopPropagation(),o.children&&(o.treeList.container.hasClass("expanded")||o.treeList.expand());break;case 40:if(e.preventDefault(),e.stopPropagation(),o.children&&Array.isArray(o.children)&&0<o.children.length&&o.treeList.container.hasClass("expanded"))t=o.children[0];else for(t=i._getNextSibling(o);!t&&o.parent;)o=o.parent,t=i._getNextSibling(o)}t&&(n?i.select(t):i._topList.find(".focus").removeClass("focus"),t.treeList.label.addClass("focus"))}else i._data[0]&&(n?i.select(i._data[0]):i._topList.find(".focus").removeClass("focus"),i._data[0].treeList.label.addClass("focus"))}),this._data=[],this._items={},this._selected=new Set,this._topList=p('<ol class="red-ui-treeList-list">').css({position:"absolute",top:0,left:0,right:0,bottom:0}).appendTo(e);e={addButton:!1,scrollOnAdd:!1,height:"100%",addItem:function(e,t,o){i._addSubtree(i._topList,e,o,0)}};this.options.header&&(e.header=this.options.header),!1!==this.options.rootSortable&&this.options.sortable&&(e.sortable=this.options.sortable,e.connectWith=".red-ui-treeList-sortable",this._topList.addClass("red-ui-treeList-sortable")),this._topList.editableList(e),this.options.data&&this.data(this.options.data)},_getLastDescendant:function(e){return e.children&&e.treeList.container.hasClass("expanded")&&0!==e.children.length?this._getLastDescendant(e.children[e.children.length-1]):e},_getPreviousSibling:function(e){var t=e.parent?e.parent.children:this._data,e=t.indexOf(e);return 0===e?null:t[e-1]},_getNextSibling:function(e){var t=e.parent?e.parent.children:this._data,e=t.indexOf(e);return e===t.length-1?null:t[e+1]},_addChildren:function(e,i,o,n,a){var r=this,s=p('<ol class="red-ui-treeList-list">').appendTo(e).editableList({connectWith:".red-ui-treeList-sortable",sortable:r.options.sortable,addButton:!1,scrollOnAdd:!1,height:"auto",addItem:function(e,t,o){r._addSubtree(s,e,o,n+1)},sortItems:function(e){var t=[],o=[];e.each(function(){var e=p(this).data("data");t.push(e);e=r._fixDepths(i,e);e&&o.push(e)}),Array.isArray(i.children)&&(i.children=t),o.forEach(function(e){r._trigger("changeparent",null,e)}),r._trigger("sort",null,i)},filter:i.treeList.childFilter});r.options.sortable&&s.addClass("red-ui-treeList-sortable");var d=30,l=0,c=function(){for(var e=l,t=0;t<d;t++){if((l=e+t)===o.length)return void setTimeout(function(){a&&a()},10);o[l].parent=i,s.editableList("addItem",o[l])}++l<o.length&&setTimeout(function(){c()},10)};return c(),s.hide(),s},_fixDepths:function(e,t){var o,i=this,n=null;return t.parent!==e&&(reparented=!0,o=t.parent,t.parent=e,n={item:t,old:o}),t.depth!==e.depth+1&&(t.depth=e.depth+1,e=(t.gutter&&!t.gutter.hasClass("red-ui-treeList-gutter-float")?t.gutter.width()+2:0)+20*t.depth,t.treeList.labelPadding.width(e+"px"),t.element&&p(t.element).css({width:"calc(100% - "+(e+20+(t.icon?20:0))+"px)"}),t.children&&Array.isArray(t.children)&&t.children.forEach(function(e){i._fixDepths(t,e)})),n},_initItem:function(r,s){var d;r.treeList||(((d=this)._items[r.id]=r).treeList={},r.depth=s,r.treeList.remove=function(e){var t;if(r.treeList.parentList&&r.treeList.parentList.editableList("removeItem",r,e),r.parent&&(e=r.parent.children.indexOf(r),r.parent.children.splice(e,1),d._trigger("sort",null,r.parent)),d._selected.delete(r),delete r.treeList,delete d._items[r.id],0===r.depth){for(var o in d._items)!d._items.hasOwnProperty(o)||(t=d._items[o]).parent&&t.parent.id===r.id&&(delete d._items[o].treeList,delete d._items[o]);d._data=d._data.filter(function(e){return e.id!==r.id})}},r.treeList.insertChildAt=function(e,t,o){(e.parent=r).children.splice(t,0,e);function i(t,o){d._initItem(o,t.depth+1),o.parent=t,o.children&&"function"!=typeof o.children&&o.children.forEach(function(e){i(o,e,t.depth)})}i(r,e),!r.deferBuild&&r.treeList.childList&&(r.treeList.childList.editableList("insertItemAt",e,t),o&&setTimeout(function(){d.select(e)},100),d._trigger("sort",null,r),d.activeFilter&&d.filter(d.activeFilter))},r.treeList.addChild=function(e,t){r.treeList.insertChildAt(e,r.children.length,t)},r.treeList.expand=function(t){if(r.children){if(!r.treeList.container)return r.expanded=!0,void(t&&t(!1));var o,i,n,e,a=r.treeList.container;a.hasClass("expanded")?t&&t(!1):(a.hasClass("built")||!r.deferBuild&&"function"!=typeof r.children?(d._loadingData||20<r.children.length?r.treeList.childList.show():r.treeList.childList.slideDown("fast"),r.expanded=!0,t&&t(!d._loadingData)):(a.addClass("built"),o=!1,n=0,Date.now(),e=function(e){o=!0,r.treeList.childList=d._addChildren(a,r,e,s,function(){t&&t(!0),d._trigger("childrenloaded",null,r)});e=Date.now()-n;e<400?setTimeout(function(){r.treeList.childList.slideDown("fast"),i&&i.remove()},400-e):(r.treeList.childList.slideDown("fast"),i&&i.remove()),r.expanded=!0},"function"==typeof r.children?r.children(e,r):(delete r.deferBuild,e(r.children)),o||(n=Date.now(),i=p('<div class="red-ui-treeList-spinner">').css({"background-position":35+20*s+"px 50%"}).appendTo(a))),a.addClass("expanded"))}else t&&t(!1)},r.treeList.collapse=function(){!1!==r.collapsible&&r.children&&(r.expanded=!1,r.treeList.container&&(r.children.length<20?r.treeList.childList.slideUp("fast"):r.treeList.childList.hide(),r.treeList.container.removeClass("expanded")))},r.treeList.sortChildren=function(e){r.children&&(r.children.sort(e),r.treeList.childList&&(r.treeList.childList.editableList("sort",e),r.treeList.childList.editableList("sort",null)))},r.treeList.replaceElement=function(e){var t;r.element&&(r.treeList.container&&(p(r.element).remove(),p(e).appendTo(r.treeList.label),t=(r.gutter?r.gutter[0].offsetWidth+2:0)+20*r.depth,p(e).css({width:"calc(100% - "+(t+20+(r.icon?20:0))+"px)"})),r.element=e)},r.children&&"function"!=typeof r.children&&r.children.forEach(function(e){d._initItem(e,s+1)}))},_addSubtree:function(e,o,i,t){var n=this;this._initItem(i,t),i.treeList.container=o,i.treeList.parentList=e;var a=p("<div>",{class:"red-ui-treeList-label"});a.appendTo(o),i.treeList.label=a,i.class&&a.addClass(i.class),i.gutter&&i.gutter.css({position:"absolute"}).appendTo(a);e=(i.gutter&&!i.gutter.hasClass("red-ui-treeList-gutter-float")?i.gutter.width()+2:0)+20*t;i.treeList.labelPadding=p("<span>").css({display:"inline-block","flex-shrink":0,width:e+"px"}).appendTo(a),a.on("mouseover",function(e){n._trigger("itemmouseover",e,i)}),a.on("mouseout",function(e){n._trigger("itemmouseout",e,i)}),a.on("mouseenter",function(e){n._trigger("itemmouseenter",e,i)}),a.on("mouseleave",function(e){n._trigger("itemmouseleave",e,i)}),i.treeList.makeLeaf=function(e){var t;d.children().length&&(e&&i.children&&(t=function(e){e.children&&e.children.forEach(function(e){e.element&&e.element.detach(),e.gutter&&e.gutter.detach(),t(e)})})(i),d.empty(),i.deferBuild||(i.treeList.childList.remove(),delete i.treeList.childList),a.off("click.red-ui-treeList-expand"),d.off("click.red-ui-treeList-expand"),delete i.children,o.removeClass("expanded"),delete i.expanded)},i.treeList.makeParent=function(e){d.children().length||(p('<i class="fa fa-angle-right" />').toggleClass("hide",!1===i.collapsible).appendTo(d),d.on("click.red-ui-treeList-expand",function(e){e.stopPropagation(),e.preventDefault(),o.hasClass("expanded")?i.treeList.collapse():i.treeList.expand()}),a.on("click.red-ui-treeList-expand",function(e){o.hasClass("expanded")?(i.hasOwnProperty("selected")||a.hasClass("selected"))&&i.treeList.collapse():i.treeList.expand()}),i.children||(i.children=e||[],i.treeList.childList=n._addChildren(o,i,i.children,t)))};var r,s,d=p('<span class="red-ui-treeList-icon"></span>').appendTo(a);i.children&&i.treeList.makeParent(),i.checkbox?(r=p('<span class="red-ui-treeList-icon"></span>'),(s=p('<input class="red-ui-treeList-checkbox" type="checkbox">').prop("checked",i.selected).appendTo(r)).on("click",function(e){e.stopPropagation()}),s.on("change",function(e){i.selected=this.checked,i.selected?n._selected.add(i):n._selected.delete(i),a.toggleClass("selected",this.checked),n._trigger("select",e,i)}),i.children||a.on("click",function(e){e.stopPropagation(),s.trigger("click"),n._topList.find(".focus").removeClass("focus"),a.addClass("focus")}),i.treeList.select=function(e){e!==i.selected&&s.trigger("click")},i.treeList.checkbox=s,r.appendTo(a)):i.radio?(r=p('<span class="red-ui-treeList-icon"></span>'),(s=p('<input class="red-ui-treeList-radio" type="radio">').prop("name",i.radio).prop("checked",i.selected).appendTo(r)).on("click",function(e){e.stopPropagation()}),s.on("change",function(e){i.selected=this.checked,n._selected.forEach(function(e){e.radio===i.radio&&(e.treeList.label.removeClass("selected"),e.selected=!1,n._selected.delete(e))}),i.selected?n._selected.add(i):n._selected.delete(i),a.toggleClass("selected",this.checked),n._trigger("select",e,i)}),i.children||a.on("click",function(e){e.stopPropagation(),s.trigger("click"),n._topList.find(".focus").removeClass("focus"),a.addClass("focus")}),i.treeList.select=function(e){e!==i.selected&&s.trigger("click")},r.appendTo(a),i.treeList.radio=s):(a.on("click",function(e){n.options.multi||n.clearSelection(),a.addClass("selected"),n._selected.add(i),n._topList.find(".focus").removeClass("focus"),a.addClass("focus"),n._trigger("select",e,i)}),a.on("dblclick",function(e){n._topList.find(".focus").removeClass("focus"),a.addClass("focus"),i.children||n._trigger("confirm",e,i)}),i.treeList.select=function(e){n.options.multi||n.clearSelection(),a.toggleClass("selected",e),e?(n._selected.add(i),n._trigger("select",null,i)):n._selected.delete(i),n.reveal(i)}),a.toggleClass("selected",!!i.selected),i.selected&&n._selected.add(i),i.icon&&("string"==typeof i.icon?p('<span class="red-ui-treeList-icon"><i class="'+i.icon+'" /></span>').appendTo(a):p('<span class="red-ui-treeList-icon">').appendTo(a).append(i.icon)),i.hasOwnProperty("label")||i.hasOwnProperty("sublabel")?(i.hasOwnProperty("label")&&p('<span class="red-ui-treeList-label-text"></span>').text(i.label).appendTo(a),i.hasOwnProperty("sublabel")&&p('<span class="red-ui-treeList-sublabel-text"></span>').text(i.sublabel).appendTo(a)):i.element&&(p(i.element).appendTo(a),p(i.element).css({width:"calc(100% - "+(e+20+(i.icon?20:0))+"px)"})),i.children&&(Array.isArray(i.children)&&!i.deferBuild&&(i.treeList.childList=n._addChildren(o,i,i.children,t)),i.expanded&&i.treeList.expand())},empty:function(){this._topList.editableList("empty")},data:function(e){var t=this;if(void 0===e)return this._data;this._data=e,this._items={},this._topList.editableList("empty"),this._loadingData=!0;for(var o=0;o<e.length;o++)this._topList.editableList("addItem",e[o]);setTimeout(function(){delete t._loadingData},200),this._trigger("select")},show:function(e,o){if(e="string"==typeof e?this._items[e]:e){for(var i=this,n=[],t=e;t;)n.unshift(t),t=t.parent;var a=!1,r=function(e){a=a||e;var t=n.shift();0===n.length?setTimeout(function(){i.reveal(t),o&&o()},a?200:0):t.treeList.expand(r)};r()}},reveal:function(e){var t,o,i;(e="string"==typeof e?this._items[e]:e)&&(i=this._topList.offset().top,t=e.treeList.label.offset().top,t-=i+(o=this._topList.parent().scrollTop()),i=this._topList.parent().height(),t<(e=e.treeList.label.outerHeight())/2?this._topList.parent().scrollTop(o+t-e/2-e):i<t+e&&this._topList.parent().scrollTop(o+(t+2.5*e-i)))},select:function(e,t,o){var i=this;this.options.multi||!1===o||this.clearSelection(),Array.isArray(e)?e.forEach(function(e){i.select(e,t,!1)}):(e="string"==typeof e?this._items[e]:e)&&(e.selected=!0,this._selected.add(e),e.treeList.label&&e.treeList.label.addClass("selected"),i._topList.find(".focus").removeClass("focus"),!1!==t&&this._trigger("select",null,e))},clearSelection:function(){this._selected.forEach(function(e){e.selected=!1,e.treeList.checkbox&&e.treeList.checkbox.prop("checked",!1),e.treeList.label&&e.treeList.label.removeClass("selected")}),this._selected.clear()},selected:function(){var t=[];return this._selected.forEach(function(e){t.push(e)}),this.options.multi?t:t.length?t[0]:void 0},filter:function(i){this.activeFilter=i;function n(e){var t=0;i&&i(e)&&(t++,a++);var o=0;return e.children&&"function"!=typeof e.children&&(e.treeList.childList?o=e.treeList.childList.editableList("filter",n):(e.treeList.childFilter=n,i&&e.children.forEach(function(e){n(e)&&o++})),t+=o,i&&0<o&&setTimeout(function(){e.treeList.expand()},10)),i?0<t:(a++,!0)}var a=0;return this._topList.editableList("filter",n),a},get:function(e){return this._items[e]||null}})}(jQuery),function(t){t.widget("nodered.checkboxSet",{_create:function(){var o=this;this.uiElement=this.element.wrap("<span>").parent(),this.uiElement.addClass("red-ui-checkboxSet"),this.options.parent&&(this.parent=this.options.parent,this.parent.checkboxSet("addChild",this.element)),this.children=[],this.partialFlag=!1,this.stateValue=0;var e=this.element.prop("checked");this.states=[t('<span class="red-ui-checkboxSet-option hide"><i class="fa fa-square-o"></i></span>').appendTo(this.uiElement),t('<span class="red-ui-checkboxSet-option hide"><i class="fa fa-check-square-o"></i></span>').appendTo(this.uiElement),t('<span class="red-ui-checkboxSet-option hide"><i class="fa fa-minus-square-o"></i></span>').appendTo(this.uiElement)],(e?this.states[1]:this.states[0]).show(),this.element.on("change",function(){this.checked?(o.states[0].hide(),o.states[1].show()):(o.states[1].hide(),o.states[0].show()),o.states[2].hide();var t=this.checked;o.children.forEach(function(e){e.checkboxSet("state",t,!1,!0)})}),this.uiElement.on("click",function(e){e.stopPropagation(),o.state(!1===o.state())}),this.parent&&this.parent.checkboxSet("updateChild",this)},_destroy:function(){this.parent&&this.parent.checkboxSet("removeChild",this.element)},addChild:function(e){this.children.push(e)},removeChild:function(e){e=this.children.indexOf(e);-1<e&&this.children.splice(e,1)},updateChild:function(e){var o=0;this.children.forEach(function(e,t){!0===e.checkboxSet("state")&&o++}),0===o?this.state(!1,!0):o===this.children.length?this.state(!0,!0):this.state(null,!0)},disable:function(){this.uiElement.addClass("disabled")},state:function(e,t,o){if(0===arguments.length)return this.partialFlag?null:this.element.is(":checked");this.partialFlag=null===e;var i=this.partialFlag||e;this.element.prop("checked",i),!0===e?(this.states[0].hide(),this.states[1].show(),this.states[2].hide()):!1===e?(this.states[2].hide(),this.states[1].hide(),this.states[0].show()):null===e&&(this.states[0].hide(),this.states[1].hide(),this.states[2].show()),t||this.element.trigger("change",null),!o&&this.parent&&this.parent.checkboxSet("updateChild",this)}})}(jQuery),RED.menu=function(){var s={};function d(t){var e;if(null!==t&&t.id&&!1===RED.settings.theme("menu."+t.id))return null;if(null===t)e=$('<li class="red-ui-menu-divider"></li>');else{e=$("<li></li>"),t.group&&e.addClass("red-ui-menu-group-"+t.group);var o="<a "+(t.id?'id="'+t.id+'" ':"")+'tabindex="-1" href="#">';t.toggle&&(o+='<i class="fa fa-square pull-left"></i>',o+='<i class="fa fa-check-square pull-left"></i>'),void 0!==t.icon&&(/\.(png|svg)/.test(t.icon)?o+='<img src="'+t.icon+'"/> ':o+='<i class="'+(t.icon||'" style="display: inline-block;"')+'"></i> '),t.sublabel?o+='<span class="red-ui-menu-label-container"><span class="red-ui-menu-label">'+t.label+'</span><span class="red-ui-menu-sublabel">'+t.sublabel+"</span></span>":o+='<span class="red-ui-menu-label"><span>'+t.label+"</span></span>",o+="</a>";var i,o=$(o).appendTo(e);if(t.link=o,"string"!=typeof t.onselect||(i=RED.keyboard.getShortcut(t.onselect))&&i.key&&(t.shortcutSpan=$('<span class="red-ui-popover-key">'+RED.keyboard.formatKey(i.key,!0)+"</span>").appendTo(o.find(".red-ui-menu-label"))),(s[t.id]=t).onselect?(o.on("click",function(e){e.preventDefault(),$(this).parent().hasClass("disabled")||(t.toggle?!0===t.toggle?p(t.id,!c(t.id)):p(t.id,!0):l(t.id))}),t.toggle&&(i=RED.settings.get("menu-"+t.id),t.setting&&(null!==i?(RED.settings.set(t.setting,i),RED.settings.remove("menu-"+t.id)):i=RED.settings.get(t.setting)),i?(o.addClass("active"),l(t.id,!0)):!1===i?(o.removeClass("active"),l(t.id,!1)):t.hasOwnProperty("selected")&&(t.selected?o.addClass("active"):o.removeClass("active"),l(t.id,t.selected)))):t.href?o.attr("target","_blank").attr("href",t.href):t.hrefLocal?o.attr("target","_self").attr("href",t.hrefLocal):t.options||(e.addClass("disabled"),o.on("click",function(e){e.preventDefault()})),t.options){e.addClass("red-ui-menu-dropdown-submenu pull-left");for(var n=$('<ul id="'+t.id+'-submenu" class="red-ui-menu-dropdown"></ul>').appendTo(e),a=0;a<t.options.length;a++){var r=d(t.options[a]);r&&r.appendTo(n)}}t.disabled&&e.addClass("disabled")}return e}function l(e,t){var o=s[e],i=o.onselect;(i="string"==typeof o.onselect?RED.actions.get(o.onselect):i)?i.call(o,t):console.log("No callback for",e,o.onselect)}function c(e){return $("#"+e).hasClass("active")}function p(e,t){var o=!1;c(e)==t&&(o=!0);var i=s[e];if(t?$("#"+e).addClass("active"):$("#"+e).removeClass("active"),i){if(i.toggle&&"string"==typeof i.toggle&&t)for(var n in s)!s.hasOwnProperty(n)||(n=s[n]).id!=i.id&&i.toggle==n.toggle&&p(n.id,!1);!o&&i.onselect&&l(i.id,t),i.local||o||RED.settings.set(i.setting||"menu-"+i.id,t)}}return{init:function(e){var t,o=$("<ul/>",{class:"red-ui-menu red-ui-menu-dropdown pull-right"});e.id&&(o.attr({id:e.id+"-submenu"}),1===(t=$("#"+e.id)).length&&(o.insertAfter(t),t.on("click",function(e){e.stopPropagation(),e.preventDefault(),o.is(":visible")?($(document).off("click.red-ui-menu"),t.parent().removeClass("open"),o.hide()):($(document).on("click.red-ui-menu",function(e){$(document).off("click.red-ui-menu"),activeMenu=null,t.parent().removeClass("open"),o.hide()}),$(".red-ui-menu").hide(),t.parent().addClass("open"),o.show())})));for(var i=!1,n=0;n<e.options.length;n++){var a,r=e.options[n];null===r&&i||(a=d(r))&&(a.appendTo(o),i=null===r)}return o},setSelected:p,isSelected:c,toggleSelected:function(e){p(e,!c(e))},setDisabled:function(e,t){t?$("#"+e).parent().addClass("disabled"):$("#"+e).parent().removeClass("disabled")},addItem:function(e,t){var o=d(t);if(null!==t&&t.group){var i=$("#"+e+"-submenu").children(".red-ui-menu-group-"+t.group);if(0===i.length)o.appendTo("#"+e+"-submenu");else{for(var n=0;n<i.length;n++){var a=i[n],r=$(a).find(".red-ui-menu-label").html();if(t.label<r){$(a).before(o);break}}n===i.length&&o.appendTo("#"+e+"-submenu")}}else o.appendTo("#"+e+"-submenu")},removeItem:function(e){$("#"+e).parent().remove()},setAction:function(e,t){(e=s[e])&&(e.onselect=t)},refreshShortcuts:function(){for(var e in s){var t;!s.hasOwnProperty(e)||"string"==typeof(t=s[e]).onselect&&t.shortcutSpan&&(t.shortcutSpan.remove(),delete t.shortcutSpan,(e=RED.keyboard.getShortcut(t.onselect))&&e.key&&(t.shortcutSpan=$('<span class="red-ui-popover-key">'+RED.keyboard.formatKey(e.key,!0)+"</span>").appendTo(t.link.find(".red-ui-menu-label"))))}}}}(),RED.panels={create:function(a){var r=a.container||$("#"+a.id),s=r.children();if(2!==s.length)throw console.log(a.id),new Error("Container must have exactly two children");var d=!a.dir||"vertical"===a.dir;r.addClass("red-ui-panels"),d||r.addClass("red-ui-panels-horizontal"),$(s[0]).addClass("red-ui-panel"),$(s[1]).addClass("red-ui-panel");var l,t=$('<div class="red-ui-panels-separator"></div>').insertAfter(s[0]),c=[],i=!1,p=.5;t.draggable({axis:d?"y":"x",containment:r,scroll:!1,start:function(e,t){l=d?t.position.top:t.position.left,c=[d?$(s[0]).height():$(s[0]).width(),d?$(s[1]).height():$(s[1]).width()]},drag:function(e,t){var o=d?r.height():r.width(),i=(d?t.position.top:t.position.left)-l,n=[c[0]+i,c[1]-i];d?($(s[0]).height(n[0]),t.position.top-=i):($(s[0]).width(n[0]),t.position.left-=i),a.resize&&a.resize(n[0],n[1]),p=n[0]/(o-8)},stop:function(e,t){i=!0}});var o={ratio:function(e){if(void 0===e)return p;i=!0,0===(p=e)||1===e?t.hide():t.show(),d?o.resize(r.height()):o.resize(r.width())},resize:function(e){var t,o;d?(o=[$(s[0]).outerHeight(),$(s[1]).outerHeight()],r.height(e)):(o=[$(s[0]).outerWidth(),$(s[1]).outerWidth()],r.width(e)),i&&(o=[t=p*(e-8),e-t-8],d?$(s[0]).outerHeight(o[0]):$(s[0]).outerWidth(o[0])),a.resize&&(o=d?[$(s[0]).height(),$(s[1]).height()]:[$(s[0]).width(),$(s[1]).width()],a.resize(o[0],o[1]))}};return o}},RED.popover=function(){var _={default:{x:12,y:12},small:{x:8,y:8}},T=null;return{create:function(i){var c=i.target,p=i.direction||"right",n=i.trigger,a=i.content,r=i.delay||{show:750,hide:50},t=i.autoClose,s=i.width||"auto",d=i.maxWidth,u=i.size||"default",f=i.offsetX||0,h=i.offsetY||0,l=i.intervalCallback||null,g=i.dialog1||null,v=i.dialog2||null,m=i.offset||0;if(!_[u])throw new Error("Invalid RED.popover size value:",u);function o(e){if(w){var t=c.data("red-ui-popover");if(i.tooltip&&t)w=!1;else{if(E=$('<div class="red-ui-popover"></div>'),i.class&&E.addClass(i.class),D=$('<div class="red-ui-popover-content">').appendTo(E),"default"!==u&&E.addClass("red-ui-popover-size-"+u),"function"==typeof a){var o=a.call(k);if(null===o)return;"string"==typeof o?D.text(o):D.append(o)}else D.html(a);E.appendTo("body"),b({target:c,direction:p,width:s,maxWidth:d}),t&&t.close(!0),"manual"!==i.trigger&&c.data("red-ui-popover",k),i.tooltip&&E.on("mousedown",function(e){y(!0)}),"hover"===n&&i.interactive&&(E.on("mouseenter",function(e){clearTimeout(R),w=!0}),E.on("mouseleave",function(e){R&&clearTimeout(R),w&&(R=setTimeout(function(){w=!1,y()},r.hide))})),e?E.show():E.fadeIn("fast"),"hover"===n&&(E.on("mouseenter",function(e){R&&clearTimeout(R),0}),E.on("mouseleave",function(e){R&&clearTimeout(R),R=setTimeout(function(){w=!1,y()},r.hide)})),g&&$(".popover-dialog1").on("click",function(e){g(),y(w=!1)}),v&&$(".popover-dialog2").on("click",function(e){v(),y(w=!1)}),l&&(T=setInterval(l,1e3))}}}function b(e){c=e.target||c,p=e.direction||p||"right",m=e.offset||m;var t=e.transition,o=e.width||"auto";E.width(o),e.maxWidth?E.css("max-width",e.maxWidth):E.css("max-width","auto");var i=c[0].getBoundingClientRect();i.top+=h,i.left+=f;var n=i.height,a=i.width,r=E.outerHeight(),s=E.outerWidth(),d=$(window).scrollTop(),l=$(window).scrollLeft(),o=d+$(window).height(),e=l+$(window).width(),d=0,l=0;"right"===p?(d=i.top+n/2-r/2,l=i.left+a+_[u].x+m):"left"===p?(d=i.top+n/2-r/2,l=i.left-_[u].x-s-m):"bottom"===p?(d=i.top+n+_[u].y+m,(l=i.left+a/2-s/2)<0?(p="right",d=i.top+n/2-r/2,l=i.left+a+_[u].x+m):e<l+s+10?(p="left",d=i.top+n/2-r/2,l=i.left-_[u].x-s-m,o<d+r+n/2+5&&(d-=d+r+n/2-o+5)):o<d+r&&(p="top",d=i.top-_[u].y-r-m,l=i.left+a/2-s/2)):"top"===p?(d=i.top-_[u].y-r-m,l=i.left+a/2-s/2,d<0&&(p="bottom",d=i.top+n+_[u].y+m,l=i.left+a/2-s/2)):/inset/.test(p)&&(d=i.top+n/2-r/2,l=i.left+a/2-s/2,/bottom/.test(p)&&(d=i.top+n-r-m),/top/.test(p)&&(d=i.top+m),/left/.test(p)&&(l=i.left+m),/right/.test(p)&&(l=i.left+a-s-m)),x&&E.removeClass(x),t&&E.css({transition:"0.6s ease","transition-property":"top,left,right,bottom"}),x="red-ui-popover-"+p,E.addClass(x).css({top:d,left:l}),t&&setTimeout(function(){E.css({transition:"none"})},600)}function y(e){$(document).off("mousedown.red-ui-popover"),w||(T&&clearInterval(T),E&&(e?E.remove():E.fadeOut("fast",function(){$(this).remove()}),E=null,c.removeData("red-ui-popover",k)))}var w,E,D,x,R=null;"hover"===n?(c.on("mouseenter",function(e){R&&clearTimeout(R),w||(R=setTimeout(function(){w=!0,o()},r.show))}),c.on("mouseleave disabled",function(e){R&&clearTimeout(R),w&&(R=setTimeout(function(){w=!1,y()},r.hide))})):"click"===n?(c.on("click",function(e){e.preventDefault(),e.stopPropagation(),((w=!w)?o:y)()}),t&&c.on("mouseleave disabled",function(e){R&&clearTimeout(R),w&&setTimeout(function(){w=!1,y()},t)})):"modal"===n?$(document).on("mousedown.red-ui-popover",function(e){for(var t=e.target;"BODY"!==t.nodeName&&t!==E[0];)t=t.parentElement;"BODY"===t.nodeName&&(w=!1,y())}):t&&setTimeout(function(){w=!1,y()},t);var k={get element(){return E},setContent:function(e){return a=e,k},open:function(e){return w=!0,o(e),k},close:function(e){return w=!1,y(e),k},move:function(e){b(e)}};return k},tooltip:function(e,o,i){e=RED.popover.create({tooltip:!0,target:e,trigger:"hover",size:"small",direction:"bottom",content:function(){var e,t=o;return!i||(e=RED.keyboard.getShortcut(i))&&e.key&&(t=$("<span>"+o+' <span class="red-ui-popover-key">'+RED.keyboard.formatKey(e.key,!0)+"</span></span>")),t},delay:{show:750,hide:50}});return e.setContent=function(e){o=e},e.setAction=function(e){i=e},e},menu:function(o){var i=$('<ul class="red-ui-menu"></ul>');"compact"===o.style&&i.addClass("red-ui-menu-compact");var n=o.options||[],t=RED.popover.panel(i);o.width&&t.container.width(o.width),o.class&&t.container.addClass(o.class),o.maxHeight&&t.container.css({"max-height":o.maxHeight,"overflow-y":"auto"});var a={options:function(e){if(void 0===e)return n;n=e||[],i.empty(),n.forEach(function(t){var e=$("<li>").appendTo(i),e=$('<a href="#"></a>').appendTo(e);"string"==typeof t.label?e.text(t.label):t.label&&t.label.appendTo(e),e.on("click",function(e){e.preventDefault(),t.onselect?t.onselect():o.onselect&&o.onselect(t),a.hide()}),0})},show:function(e){$(document).on("keydown.red-ui-menu",function(e){var t=i.find(":focus").parent();40===e.keyCode?(e.preventDefault(),(!(0<t.length)||t.index()===n.length-1?i.children().first():t.next()).children().first().focus()):38===e.keyCode?(e.preventDefault(),(!(0<t.length)||0===t.index()?i.children().last():t.prev()).children().first().focus()):27===e.keyCode?(e.preventDefault(),a.hide(!0)):9===e.keyCode&&o.tabSelect&&(e.preventDefault(),t.find("a").trigger("click")),e.stopPropagation()}),e.onclose=function(){$(document).off("keydown.red-ui-menu"),o.onclose&&o.onclose(!0)},t.show(e)},hide:function(e){$(document).off("keydown.red-ui-menu"),t.hide(o.disposeOnClose),o.onclose&&o.onclose(e)}};return a.options(n),a},panel:function(e){var l=$('<div class="red-ui-editor-dialog red-ui-popover-panel"></div>');function c(e){$(document).off("mousedown.red-ui-popover-panel-close"),$(document).off("keydown.red-ui-popover-panel-close"),l.hide(),l.css({height:"auto"}),!1!==e&&l.remove()}return l.css({display:"none"}),l.appendTo(document.body),e.appendTo(l),{container:l,show:function(t){var o=t.onclose,i=t.closeButton,e=t.target,n=t.align||"right",a=t.offset||[0,0],r=e.offset(),s=(e.width(),e.outerHeight()),d=l.height(),e=l.width();(s=s+r.top+a[1])+d-$(document).scrollTop()>$(window).height()&&(s-=s+d-$(window).height()+5),s<0&&(l.height(d+s),s=0),"right"===n?l.css({top:s+"px",left:r.left+a[0]+"px"}):"left"===n&&l.css({top:s+"px",left:r.left-e+a[0]+"px"}),l.slideDown(100),$(document).on("keydown.red-ui-popover-panel-close",function(e){27===e.keyCode&&(o&&o(),c(t.dispose))}),$(document).on("mousedown.red-ui-popover-panel-close",function(e){i&&$(e.target).closest(i).length||$(e.target).closest(l).length||$(e.target).closest(".red-ui-editor-dialog").length||(o&&o(),c(t.dispose))})},hide:c}}}}(),function(n){n.widget("nodered.searchBox",{_create:function(){var t,o,i=this;this.currentTimeout=null,this.lastSent="",this.element.val(""),this.element.addClass("red-ui-searchBox-input"),this.uiContainer=this.element.wrap("<div>").parent(),this.uiContainer.addClass("red-ui-searchBox-container"),"compact"===this.options.style&&this.uiContainer.addClass("red-ui-searchBox-compact"),0===this.element.parents("form").length&&this.element.wrap("<form>").parent().addClass("red-ui-searchBox-form"),n('<i class="fa fa-search"></i>').prependTo(this.uiContainer),this.clearButton=n('<a class="red-ui-searchBox-clear" href="#"><i class="fa fa-times"></i></a>').appendTo(this.uiContainer),this.clearButton.on("click",function(e){e.preventDefault(),i.element.val(""),i._change("",!0),i.element.trigger("focus")}),this.options.options&&(this.uiContainer.addClass("red-ui-searchBox-has-options"),this.optsButton=n('<a class="red-ui-searchBox-opts" href="#"><i class="fa fa-caret-down"></i></a>').appendTo(this.uiContainer),t=!1,this.optsMenu=RED.popover.menu({style:this.options.style,options:this.options.options.map(function(e){return{label:e.label,onselect:function(){i.element.val(e.value+" "),i._change(e.value,!0)}}}),onclose:function(e){t=!1,i.element.trigger("focus")},disposeOnClose:!1}),o=function(){t=!0,i.optsMenu.show({target:i.optsButton,align:"left",offset:[i.optsButton.width()-2,-1],dispose:!1})},this.optsButton.on("click",function(e){e.preventDefault(),t?i.optsMenu.hide(!0):o()}),this.optsButton.on("keydown",function(e){t||40!==e.keyCode||o()}),this.element.on("keydown",function(e){t||40!==e.keyCode||o()})),this.resultCount=n("<span>",{class:"red-ui-searchBox-resultCount hide"}).appendTo(this.uiContainer),this.element.val(""),this.element.on("keydown",function(e){27===e.keyCode&&i.element.val(""),13===e.keyCode&&e.preventDefault()}),this.element.on("keyup",function(e){i._change(n(this).val())}),this.element.on("focus",function(){n(document).one("mousedown",function(){i.element.blur()})})},_change:function(e,t){var o,i=!1,i=""===e?(this.clearButton.hide(),!0):(this.clearButton.show(),e.length>=(this.options.minimumLength||0)),e=this.element.val();(i=i&&e!==this.lastSent)&&(!t&&0<this.options.delay?(clearTimeout(this.currentTimeout),(o=this).currentTimeout=setTimeout(function(){o.lastSent=o.element.val(),o._trigger("change")},this.options.delay)):(this.lastSent=this.element.val(),this._trigger("change")))},value:function(e){if(void 0===e)return this.element.val();this.element.val(e),this._change(e)},count:function(e){null==e||""===e?this.resultCount.text("").hide():this.resultCount.text(e).show()},change:function(){this._trigger("change")}})}(jQuery),RED.tabs=function(){var S,M="fa fa-lemon-o",O=!1,I=!1;return{create:function(f){var d,h,g,e,t,o,i,n,a,r,v,s,m={},b=0,l=0,y=f.order,w=f.element||$("#"+f.id),c=w.wrap("<div>").parent(),E=w.wrap("<div>").parent();function p(e,t){var o,i;e.preventDefault(),$(this).hasClass("disabled")||(o=E.scrollLeft(),E.animate({scrollLeft:t},100),i=setInterval(function(){var e=E.scrollLeft();e!==o?(o=e,E.animate({scrollLeft:t},100)):clearInterval(i)},100),$(this).one("mouseup",function(){clearInterval(i)}))}function u(){var e=w.find("li.red-ui-tab.selected"),t=[];return e.each(function(){t.push(m[$(this).find("a").attr("href").slice(1)])}),t}function D(){f.onselect(u())}function x(e){if(!O)if(e.currentTarget===g){if(g=null,S&&Date.now()-S<400)return I=!(S=0),function(e){if(e.preventDefault(),!e.metaKey&&!e.shiftKey)return f.ondblclick&&f.ondblclick(m[$(this).attr("href").slice(1)]),!1}.call(this,e);S=Date.now();var t,o,i=w.find("li.red-ui-tab.active"),n=$(this).parent(),a=!1;if(f.onselect)if(e.metaKey||e.ctrlKey){if(n.hasClass("selected")){if(n.removeClass("selected"),n[0]!==i[0])return void D();if(0===(o=w.find("li.red-ui-tab.selected")).length)return void D();n=o.first()}else i.hasClass("selected")||(m[i.find("a").attr("href").slice(1)],i.addClass("selected")),n.addClass("selected");a=!0}else e.shiftKey?(i[0]!==n[0]&&(i=i.index()<n.index()?(t=i,n):(t=n,i),w.find("li.red-ui-tab").removeClass("selected"),t.addClass("selected"),i.addClass("selected"),t.nextUntil(i).addClass("selected")),a=!0):0<(o=w.find("li.red-ui-tab.selected")).length&&(o.removeClass("selected"),a=!0);n=n.find("a");f.onclick&&f.onclick(m[n.attr("href").slice(1)]),k(n),a&&D()}else g=null}function R(){var e,t,o;0!==w.children().length&&(e=E.scrollLeft(),t=E.width(),o=w.width(),0===e?a.hide():a.show(),e===o-t?r.hide():r.show())}function k(e){var t;0!==(e="string"==typeof e?w.find("a[href='#"+e+"']"):e).length&&(e.parent().hasClass("hide-tab")&&(e.parent().removeClass("hide-tab").removeClass("hide"),f.onshow&&f.onshow(m[e.attr("href").slice(1)])),e.parent().hasClass("active")||(w.children().removeClass("active"),w.children().css({transition:"width 100ms"}),e.parent().addClass("active"),t=e.parent().attr("id"),c.find(".red-ui-tab-link-button").removeClass("active selected"),$("#"+t+"-link-button").addClass("active selected"),f.scrollable&&((t=e.parent().position().left)-21<0?E.animate({scrollLeft:"+="+(t-50)},300):t+120>E.width()&&E.animate({scrollLeft:"+="+(t+140-E.width())},300)),f.onchange&&f.onchange(m[e.attr("href").slice(1)]),_(),setTimeout(function(){w.children().css({transition:""})},100)))}function _(){if(!f.vertical){var e,t=w.find("li.red-ui-tab"),o=t.filter(":not(.hide-tab)"),i=t.filter(".hide-tab"),n=c.width(),a=o.length;if(f.collapsible){var t=v.children().length,r=v.children(":visible").length;if((e=n-v.width()-10)<=120||e<198&&5<r){var s=v.find("a:last").prev();for(v.children().length;s.is(":not(:visible)");)s=s.prev(),0;(e<=120||6<r)&&s.hide(),e=Math.max(120,n-v.width()-10)}else 40<n-(e=r!==t?r<6?120:198:e)-v.width()&&v.find("a:not(:visible):first").show(),e=n-v.width()-10;o.css({width:e})}else l=(d=100*(e=(n-12-6*a)/a)/n+"%")+"%",f.scrollable?(e=Math.max(e,140),d=e+"px",l=0,r=Math.max(c.width(),12+(e+6)*a),w.width(r),R()):f.hasOwnProperty("minimumActiveTabWidth")&&(l=e<f.minimumActiveTabWidth?(e=(n-12-f.minimumActiveTabWidth-6*--a)/a,d=100*e/n+"%",f.minimumActiveTabWidth+"px"):0),o.css({width:d}),i.css({width:"0px"}),e<50?(w.find(".red-ui-tab-icon").hide(),w.find(".red-ui-tab-label").css({paddingLeft:Math.min(12,Math.max(0,e-38))+"px"})):(w.find(".red-ui-tab-icon").show(),w.find(".red-ui-tab-label").css({paddingLeft:""})),0!==l&&(w.find("li.red-ui-tab.active").css({width:f.minimumActiveTabWidth}),w.find("li.red-ui-tab.active .red-ui-tab-icon").show(),w.find("li.red-ui-tab.active .red-ui-tab-label").css({paddingLeft:""}))}}function T(t){!f.onselect||0<(e=w.find("li.red-ui-tab.selected")).length&&(e.removeClass("selected"),D());var e,o=w.find("a[href='#"+t+"']").parent();o.hasClass("active")&&(0<(e=0===(e=C(o)).length?j(o):e).length?k(e.find("a")):f.onchange&&f.onchange(null)),o.one("transitionend",function(e){o.remove(),m[t].pinned&&b--,f.onremove&&f.onremove(m[t]),delete m[t],_(),h&&(h.remove(),h=null)}),o.addClass("hide-tab"),o.width(0)}function C(e){for(var t=(e=e||w.find("li.active")).prev();0<t.length&&t.hasClass("hide-tab");)t=t.prev();return t}function j(e){for(var t=(e=e||w.find("li.active")).next();0<t.length&&t.hasClass("hide-tab");)t=t.next();return t}function L(t){var o,e;m[t]&&((o=w.find("a[href='#"+t+"']").parent()).hasClass("hide-tab")||(o.hasClass("active")&&(0<(e=0===(e=C(o)).length?j(o):e).length?k(e.find("a")):f.onchange&&f.onchange(null)),o.removeClass("active"),o.one("transitionend",function(e){o.addClass("hide"),_(),f.onhide&&f.onhide(m[t]),setTimeout(function(){R()},200)}),o.addClass("hide-tab"),o.css({width:0})))}c.addClass("red-ui-tabs"),f.vertical&&c.addClass("red-ui-tabs-vertical"),f.addButton&&(c.addClass("red-ui-tabs-add"),(e=$('<div class="red-ui-tab-button red-ui-tabs-add"><a href="#"><i class="fa fa-plus"></i></a></div>').appendTo(c)).find("a").on("click",function(e){e.preventDefault(),"function"==typeof f.addButton?f.addButton():"string"==typeof f.addButton&&RED.actions.invoke(f.addButton)}),"string"==typeof f.addButton&&(o=f.addButton,f.addButtonCaption&&(o=f.addButtonCaption),RED.popover.tooltip(e,o,f.addButton)),w.on("dblclick",function(e){var t=w.children(),o=e.clientX,i=0;t.each(function(e){return!($(this).offset().left>o)&&void(i=e+1)}),"function"==typeof f.addButton?f.addButton({index:i}):"string"==typeof f.addButton&&RED.actions.invoke(f.addButton,{index:i})})),f.searchButton&&(c.addClass("red-ui-tabs-search"),(e=$('<div class="red-ui-tab-button red-ui-tabs-search"><a href="#"><i class="fa fa-list-ul"></i></a></div>').appendTo(c)).find("a").on("click",function(e){e.preventDefault(),"function"==typeof f.searchButton?f.searchButton():"string"==typeof f.searchButton&&RED.actions.invoke(f.searchButton)}),"string"==typeof f.searchButton&&(o=f.searchButton,f.searchButtonCaption&&(o=f.searchButtonCaption),RED.popover.tooltip(e,o,f.searchButton))),f.menu&&(c.addClass("red-ui-tabs-menu"),o=(t=$('<div class="red-ui-tab-button red-ui-tabs-menu"><a href="#"><i class="fa fa-caret-down"></i></a></div>').appendTo(c)).find("a"),i=!1,o.on("click",function(e){if(e.stopPropagation(),e.preventDefault(),i)return n.remove(),void(i=!1);i=!0;e=[];"function"==typeof f.searchButton?e=f.menu():Array.isArray(f.menu)?e=f.menu:"function"==typeof f.menu&&(e=f.menu()),(n=RED.menu.init({options:e})).attr("id",f.id+"-menu"),n.css({position:"absolute"}),n.appendTo("body");e=t.offset();n.css({top:e.top+t.height()-2+"px",left:e.left-n.width()+t.width()+"px"}),$(".red-ui-menu.red-ui-menu-dropdown").hide(),$(document).on("click.red-ui-tabmenu",function(e){$(document).off("click.red-ui-tabmenu"),i=!1,n.remove()}),n.show()})),f.scrollable&&(c.addClass("red-ui-tabs-scrollable"),E.addClass("red-ui-tabs-scroll-container"),E.on("scroll",function(e){R()}),E.on("wheel",function(e){var t;0===e.originalEvent.deltaX&&(e.preventDefault(),t=E.scrollLeft(),t-=e.originalEvent.deltaY,E.scrollLeft(t))}),(a=$('<div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-left"><a href="#" style="display:none;"><i class="fa fa-caret-left"></i></a></div>').appendTo(c).find("a")).on("mousedown",function(e){p(e,e.shiftKey?"-="+E.scrollLeft():"-=150")}).on("click",function(e){e.preventDefault()}),(r=$('<div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-right"><a href="#" style="display:none;"><i class="fa fa-caret-right"></i></a></div>').appendTo(c).find("a")).on("mousedown",function(e){p(e,e.shiftKey?"+="+(E[0].scrollWidth-E.width()-E.scrollLeft()):"+=150")}).on("click",function(e){e.preventDefault()})),f.collapsible&&(c.addClass("red-ui-tabs-collapsible"),v=$('<div class="red-ui-tab-link-buttons"></div>').appendTo(c),!1!==f.menu&&((s=$('<a href="#"><i class="fa fa-caret-down"></i></a>').appendTo(v)).addClass("red-ui-tab-link-button-menu"),s.on("click",function(e){var i;e.stopPropagation(),e.preventDefault(),h||(i=[],w.children().each(function(e,t){var o=$(t).data("tabId"),t={id:"red-ui-tabs-menu-option-"+o,icon:m[o].iconClass||M,label:m[o].name,onselect:function(){k(o)}};i.push(t)}),i=[].concat(i),(h=RED.menu.init({options:i})).css({position:"absolute"}),h.appendTo("body"));e=s.offset();h.css({top:e.top+s.height()-2+"px",left:e.left-h.width()+s.width()+"px"}),h.is(":visible")?$(document).off("click.red-ui-tabmenu"):($(".red-ui-menu.red-ui-menu-dropdown").hide(),$(document).on("click.red-ui-tabmenu",function(e){$(document).off("click.red-ui-tabmenu"),h.hide()})),h.toggle()}))),w.children().first().addClass("active"),w.children().addClass("red-ui-tab"),w.find("li.red-ui-tab a").on("mousedown",function(e){g=e.currentTarget}).on("mouseup",x).on("click",function(e){e.preventDefault()}).on("dblclick",function(e){e.stopPropagation(),e.preventDefault()}),setTimeout(function(){_()},0);var z={addTab:function(t,e){var o;!f.onselect||0<(o=w.find("li.red-ui-tab.selected")).length&&(o.removeClass("selected"),D()),m[t.id]=t;var i=$("<li/>",{class:"red-ui-tab"});0===(e=0===w.children().length?void 0:e)?i.prependTo(w):0<e?i.insertAfter(w.find("li:nth-child("+e+")")):i.appendTo(w),i.attr("id","red-ui-tab-"+t.id.replace(".","-")),i.data("tabId",t.id),(f.maximumTabWidth||t.maximumTabWidth)&&i.css("maxWidth",(f.maximumTabWidth||t.maximumTabWidth)+"px");var n,a,r,s,e=$("<a/>",{href:"#"+t.id,class:"red-ui-tab-label"}).appendTo(i);t.icon?$('<img src="'+t.icon+'" class="red-ui-tab-icon"/>').appendTo(e):t.iconClass&&$("<i>",{class:"red-ui-tab-icon "+t.iconClass}).appendTo(e),$("<span/>",{class:"red-ui-text-bidi-aware"}).text(t.label).appendTo(e).attr("dir",RED.text.bidi.resolveBaseTextDir(t.label)),f.collapsible&&(i.addClass("red-ui-tab-pinned"),n=$('<a href="#'+t.id+'" class="red-ui-tab-link-button"></a>'),t.pinned?0===b?n.prependTo(v):n.insertAfter(v.find("a.red-ui-tab-link-button-pinned:last")):!1!==f.menu?n.insertBefore(v.find("a:last")):n.appendTo(v),n.attr("id",i.attr("id")+"-link-button"),(t.iconClass?$("<i>",{class:t.iconClass}):$("<i>",{class:M})).appendTo(n),n.on("click",function(e){e.preventDefault(),k(t.id)}),n.data("tabId",t.id),t.pinned&&(n.addClass("red-ui-tab-link-button-pinned"),b++),RED.popover.tooltip($(n),t.name,t.action),f.onreorder&&(r=[],n.draggable({distance:10,axis:"x",containment:".red-ui-tab-link-buttons",start:function(e,t){if(O=!0,$(".red-ui-tab-link-buttons").width($(".red-ui-tab-link-buttons").width()),I)return I=!1;v.children().each(function(e){r[e]={el:$(this),text:$(this).text(),left:$(this).position().left,width:$(this).width(),menu:$(this).hasClass("red-ui-tab-link-button-menu")},$(this).is(n)&&(s=a=e)}),v.children().each(function(e){e!==a&&$(this).css({position:"absolute",left:r[e].left+"px",width:r[e].width+2,transition:"left 0.3s"})}),n.hasClass("active")||n.css({zIndex:1})},drag:function(e,t){t.position.left+=r[a].left;for(var o=t.position.left+r[a].width/2,i=0;i<r.length;i++)if(i!==a&&!r[i].menu&&!r[i].el.is(":not(:visible)")&&o>r[i].left&&o<r[i].left+r[i].width){i<a?(r[i].left+=r[a].width+8,r[a].el.detach().insertBefore(r[i].el)):(r[i].left-=r[a].width+8,r[a].el.detach().insertAfter(r[i].el)),r[i].el.css({left:r[i].left+"px"}),r.splice(i,0,r.splice(a,1)[0]),a=i;break}},stop:function(e,t){var o;O=!1,v.children().css({position:"relative",left:"",transition:""}),$(".red-ui-tab-link-buttons").width("auto"),n.css({zIndex:""}),_(),s!==a&&(h&&(h.remove(),h=null),o=$.makeArray(v.children().map(function(){return $(this).data("tabId")})),z.order(o),f.onreorder(o))}}))),e.on("mousedown",function(e){g=e.currentTarget}),e.on("mouseup",x),e.on("click",function(e){e.preventDefault()}),e.on("dblclick",function(e){e.stopPropagation(),e.preventDefault()}),$('<span class="red-ui-tabs-fade"></span>').appendTo(i),t.closeable&&(i.addClass("red-ui-tabs-closeable"),(u=$("<a/>",{href:"#",class:"red-ui-tab-close"}).appendTo(i)).append('<i class="fa fa-times" />'),u.on("click",function(e){e.preventDefault(),T(t.id)}),RED.popover.tooltip(u,RED._("workspace.hideFlow"))),t.hideable&&(i.addClass("red-ui-tabs-closeable"),(u=$("<a/>",{href:"#",class:"red-ui-tab-close red-ui-tab-hide"}).appendTo(i)).append('<i class="fa fa-eye" />'),u.append('<i class="fa fa-eye-slash" />'),u.on("click",function(e){e.preventDefault(),L(t.id)}),RED.popover.tooltip(u,RED._("workspace.hideFlow")));var d,l,c,p,u=$('<span class="red-ui-tabs-badges"></span>').appendTo(i);f.onselect&&($('<i class="red-ui-tabs-badge-changed fa fa-circle"></i>').appendTo(u),$('<i class="red-ui-tabs-badge-selected fa fa-check-circle"></i>').appendTo(u)),RED.popover.tooltip(e,function(){return t.label}),f.onadd&&f.onadd(t),1==w.find("li.red-ui-tab").length&&k(e),f.onreorder&&!f.collapsible&&(c=[],i.draggable({axis:"x",distance:20,start:function(e,t){if(I)return I=!1;O=!0,d=[],c=[],w.children().each(function(e){c[e]={el:$(this),text:$(this).text(),left:$(this).position().left,width:$(this).width()},$(this).is(i)&&(p=l=e),d.push($(this).data("tabId"))}),w.children().each(function(e){e!==l&&$(this).css({position:"absolute",left:c[e].left+"px",width:c[e].width+2,transition:"left 0.3s"})}),i.hasClass("active")||i.css({zIndex:1})},drag:function(e,t){t.position.left+=c[l].left+E.scrollLeft();for(var o=t.position.left+c[l].width/2-E.scrollLeft(),i=0;i<c.length;i++)if(i!==l&&o>c[i].left&&o<c[i].left+c[i].width){i<l?(c[i].left+=c[l].width+8,c[l].el.detach().insertBefore(c[i].el)):(c[i].left-=c[l].width+8,c[l].el.detach().insertAfter(c[i].el)),c[i].el.css({left:c[i].left+"px"}),c.splice(i,0,c.splice(l,1)[0]),l=i;break}},stop:function(e,t){O=!1,w.children().css({position:"relative",left:"",transition:""}),i.hasClass("active")||i.css({zIndex:""}),_(),p!==l&&f.onreorder(d,$.makeArray(w.children().map(function(){return $(this).data("tabId")}))),k(c[l].el.data("tabId"))}})),setTimeout(function(){_()},10),h&&(h.remove(),h=null),y&&z.order(y)},removeTab:T,activateTab:k,nextTab:function(){var e=j();0<e.length&&k(e.find("a"))},previousTab:function(){var e=C();0<e.length&&k(e.find("a"))},resize:_,count:function(){return w.find("li.red-ui-tab:not(.hide)").length},activeIndex:function(){return w.find("li.active").index()},contains:function(e){return 0<w.find("a[href='#"+e+"']").length},showTab:function(e){var t;!m[e]||(t=w.find("a[href='#"+e+"']").parent()).hasClass("hide-tab")&&(t.removeClass("hide-tab").removeClass("hide"),1===w.find("li.red-ui-tab:not(.hide-tab)").length&&k(t.find("a")),_(),f.onshow&&f.onshow(m[e]))},hideTab:L,renameTab:function(e,t){m[e].label=t,w.find("a[href='#"+e+"']").find("span.red-ui-text-bidi-aware").text(t).attr("dir",RED.text.bidi.resolveBaseTextDir(t)),_()},listTabs:function(){return $.makeArray(w.children().map(function(){return $(this).data("tabId")}))},selection:u,clearSelection:function(){var e;!f.onselect||0<(e=w.find("li.red-ui-tab.selected")).length&&(e.removeClass("selected"),D())},order:function(e){y=e;for(var t=$.makeArray(w.children().map(function(){return $(this).data("tabId")})),o=!0,i=0;i<e.length;i++)if(e[i]!==t[i]){o=!1;break}if(!o){var n={},a=(w.children().detach().each(function(){n[$(this).data("tabId")]=$(this)}),{});for(f.collapsible&&v.children().detach().each(function(){var e=$(this).data("tabId");a[e=e||"__menu__"]=$(this)}),i=0;i<e.length;i++)n[e[i]]&&(n[e[i]].appendTo(w),f.collapsible&&a[e[i]].appendTo(v),delete n[e[i]]);for(i in n)n.hasOwnProperty(i)&&(n[i].appendTo(w),f.collapsible&&a[i].appendTo(v));f.collapsible&&(a.__menu__.appendTo(v),_())}}};return z}}}(),RED.stack={create:function(i){var n=i.container;function a(){var t,e;0<s.length&&(t=0,s.forEach(function(e){t+=e.header.outerHeight()}),e=n.innerHeight(),r=e-t-(s.length-1),s.forEach(function(e){e.contentWrap.height(r)}))}n.addClass("red-ui-stack");var r=0,s=[],d=!0;return i.fill&&i.singleExpanded&&($(window).on("resize",a),$(window).on("focus",a)),{add:function(t){s.push(t),t.container=$('<div class="red-ui-palette-category">').appendTo(n),d||t.container.hide();var e,o=$('<div class="red-ui-palette-header"></div>').appendTo(t.container);return t.header=o,t.contentWrap=$("<div></div>",{style:"position:relative"}).appendTo(t.container),i.fill&&t.contentWrap.css("height",r),t.content=$("<div></div>").appendTo(t.contentWrap),!1!==t.collapsible?(o.on("click",function(){if(i.singleExpanded)if(t.isExpanded())2===s.length&&(s[0]===t?(s[0].collapse(),s[1].expand()):(s[1].collapse(),s[0].expand()));else{for(var e=0;e<s.length;e++)s[e].isExpanded()&&s[e].collapse();t.expand()}else t.toggle()}),e=$('<i class="fa fa-angle-down"></i>').appendTo(o),t.expanded?(t.container.addClass("expanded"),e.addClass("expanded")):t.contentWrap.hide()):($('<i style="opacity: 0.5;" class="fa fa-angle-down expanded"></i>').appendTo(o),o.css("cursor","default")),t.title=$("<span></span>").html(t.title).appendTo(o),t.toggle=function(){return t.isExpanded()?(t.collapse(),!1):(t.expand(),!0)},t.expand=function(){if(!t.isExpanded())return t.onexpand&&t.onexpand.call(t),i.singleExpanded&&s.forEach(function(e){e!==t&&e.collapse()}),e.addClass("expanded"),t.container.addClass("expanded"),t.contentWrap.slideDown(200),!0},t.collapse=function(){if(t.isExpanded())return e.removeClass("expanded"),t.container.removeClass("expanded"),t.contentWrap.slideUp(200),!0},t.isExpanded=function(){return t.container.hasClass("expanded")},i.fill&&i.singleExpanded&&a(),t},hide:function(){return d=!1,s.forEach(function(e){e.container.hide()}),this},show:function(){return d=!0,s.forEach(function(e){e.container.show()}),this},resize:function(){a()}}}},function(l){function e(e,t){return{option:(t=RED.utils.parseContextKey(e,t&&t.value)).store,value:t.key}}function t(e,t){return t&&(t="string"==typeof t?t:t.value)!==RED.settings.context.default?"#:("+t+")::"+e:e}function o(e,t){e.css("pointer-events","none"),e.css("flex-grow",0),e.css("position","relative"),e.css("overflow","visible"),l("<div></div>").text(t).css({position:"absolute",bottom:"-2px",right:"5px","font-size":"0.7em",opacity:.3}).appendTo(e),this.elementDiv.show()}function d(e){return e=/^red\/images\/typedInput\/.+\.png$/.test(e)?e.replace(/.png$/,".svg"):e}var i,r={msg:{value:"msg",label:"msg.",validate:RED.utils.validatePropertyExpression,autoComplete:(i=[{value:"payload"},{value:"req",source:["http in"]},{value:"req.body",source:["http in"]},{value:"req.headers",source:["http in"]},{value:"req.query",source:["http in"]},{value:"req.params",source:["http in"]},{value:"req.cookies",source:["http in"]},{value:"req.files",source:["http in"]},{value:"complete",source:["join"]},{value:"contentType",source:["mqtt"]},{value:"cookies",source:["http in","http request"]},{value:"correlationData",source:["mqtt"]},{value:"delay",source:["delay","trigger"]},{value:"encoding",source:["file"]},{value:"error",source:["catch"]},{value:"filename",source:["file","file in"]},{value:"flush",source:["delay"]},{value:"followRedirects",source:["http request"]},{value:"headers",source:["http in"," http request"]},{value:"kill",source:["exec"]},{value:"messageExpiryInterval",source:["mqtt"]},{value:"method",source:["http-request"]},{value:"options",source:["xml"]},{value:"parts",source:["split","join"]},{value:"pid",source:["exec"]},{value:"qos",source:["mqtt"]},{value:"rate",source:["delay"]},{value:"rejectUnauthorized",source:["http request"]},{value:"requestTimeout",source:["http request"]},{value:"reset",source:["delay","trigger","join","rbe"]},{value:"responseTopic",source:["mqtt"]},{value:"restartTimeout",source:["join"]},{value:"retain",source:["mqtt"]},{value:"select",source:["html"]},{value:"statusCode",source:["http in"]},{value:"template",source:["template"]},{value:"toFront",source:["delay"]},{value:"topic",source:["inject","mqtt","rbe"]},{value:"url",source:["http request"]},{value:"userProperties",source:["mqtt"]}],function(s){var d=[];return i.forEach(e=>{let t=e.value;var o,i,n,a,r=t.toLowerCase().indexOf(s.toLowerCase());-1<r&&(o=t.substring(0,r),i=t.substring(r,r+s.length),a=t.substring(r+s.length),n=l("<div/>",{style:"white-space:nowrap; overflow: hidden; flex-grow:1"}),l("<span/>").text(o).appendTo(n),l("<span/>",{style:"font-weight: bold"}).text(i).appendTo(n),l("<span/>").text(a).appendTo(n),a=l("<div>",{style:"display: flex"}),n.appendTo(a),e.source&&l("<div>").css({"font-size":"0.8em"}).text(e.source.join(",")).appendTo(a),d.push({value:t,label:a,i:r}))}),d.sort(function(e,t){return e.i-t.i}),d})},flow:{value:"flow",label:"flow.",hasValue:!0,options:[],validate:RED.utils.validatePropertyExpression,parse:e,export:t,valueLabel:o},global:{value:"global",label:"global.",hasValue:!0,options:[],validate:RED.utils.validatePropertyExpression,parse:e,export:t,valueLabel:o},str:{value:"str",label:"string",icon:"red/images/typedInput/az.svg"},num:{value:"num",label:"number",icon:"red/images/typedInput/09.svg",validate:/^[+-]?[0-9]*\.?[0-9]*([eE][-+]?[0-9]+)?$/},bool:{value:"bool",label:"bool",icon:"red/images/typedInput/bool.svg",options:["true","false"]},json:{value:"json",label:"JSON",icon:"red/images/typedInput/json.svg",validate:function(e){try{return JSON.parse(e),!0}catch(e){return!1}},expand:function(){var o=this,e=this.value();try{e=JSON.stringify(JSON.parse(e),null,4)}catch(e){}RED.editor.editJSON({value:e,complete:function(e){var t=e;try{t=JSON.stringify(JSON.parse(e))}catch(e){}o.value(t)}})}},re:{value:"re",label:"regular expression",icon:"red/images/typedInput/re.svg"},date:{value:"date",label:"timestamp",icon:"fa fa-clock-o",hasValue:!1},jsonata:{value:"jsonata",label:"expression",icon:"red/images/typedInput/expr.svg",validate:function(e){try{return jsonata(e),!0}catch(e){return!1}},expand:function(){var t=this;RED.editor.editExpression({value:this.value().replace(/\t/g,"\n"),complete:function(e){t.value(e.replace(/\n/g,"\t"))}})}},bin:{value:"bin",label:"buffer",icon:"red/images/typedInput/bin.svg",expand:function(){var t=this;RED.editor.editBuffer({value:this.value(),complete:function(e){t.value(e)}})}},env:{value:"env",label:"env variable",icon:"red/images/typedInput/env.svg"},node:{value:"node",label:"node",icon:"red/images/typedInput/target.svg",valueLabel:function(e,t){var o=RED.nodes.node(t),i=l("<div>",{class:"red-ui-search-result-node"}).css({"margin-top":"2px","margin-left":"3px"}).appendTo(e),n=l("<span>").css({"line-height":"32px","margin-left":"6px"}).appendTo(e);o?(t=RED.utils.getNodeColor(o.type,o._def),e=RED.utils.getNodeIcon(o._def,o),"tab"===o.type&&(t="#C0DEED"),i.css("backgroundColor",t),t=l("<div/>",{class:"red-ui-palette-icon-container"}).appendTo(i),RED.utils.createIconElement(e,t,!0),o=RED.utils.getNodeLabel(o,o.id),n.text(o)):i.css({backgroundColor:"#eee","border-style":"dashed"})},expand:function(){var t=this;RED.tray.hide(),RED.view.selectNodes({single:!0,selected:[t.value()],onselect:function(e){t.value(e.id),RED.tray.show()},oncancel:function(){RED.tray.show()}})}},string:{value:"string",label:"string",icon:"red/images/typedInput/az.svg"},int:{value:"int",label:"int",icon:"red/images/typedInput/09.svg",validate:/^[+-]?[0-9]*$/},float:{value:"float",label:"float",icon:"red/images/typedInput/09.svg",validate:/^[+-]?[0-9]*\.?[0-9]*([eE][-+]?[0-9]+)?$/},suntime:{value:"suntime",label:"sun",icon:"red/images/typedInput/bool.svg",options:["sunrise","sunriseEnd","goldenHourEnd","solarNoon","goldenHour","sunsetStart","sunset","dusk","nauticalDusk","night","nadir","nightEnd","nauticalDawn","dawn"]},time:{value:"time",defaultValue:"HH:MM[:SS]",label:"time",icon:"red/images/typedInput/time.svg",validate:/^([0-9]|0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]){1,2}$/},array:{value:"array",label:"array",icon:"red/images/typedInput/array.svg",validate:function(e){e=e.trim();try{return JSON.parse(e),e&&"["==e.charAt(0)}catch(e){return!1}},expand:function(){var o=this,e=this.value();try{e=JSON.stringify(JSON.parse(e),null,4)}catch(e){}RED.editor.editJSON({value:e,complete:function(e){var t=e;try{t=JSON.stringify(JSON.parse(e))}catch(e){}o.value(t)}})}},arraySimple:{value:"array",label:"array",icon:"red/images/typedInput/array.svg",validate:function(e){e=e.trim();try{return JSON.parse(e),e&&"["==e.charAt(0)}catch(e){return!1}}},struct:{value:"struct",label:"struct",icon:"red/images/typedInput/json.svg",validate:function(e){e=e.trim();try{return JSON.parse(e),e&&"{"==e.charAt(0)}catch(e){return!1}},expand:function(){var o=this,e=this.value();try{e=JSON.stringify(JSON.parse(e),null,4)}catch(e){}RED.editor.editJSON({value:e,complete:function(e){var t=e;try{t=JSON.stringify(JSON.parse(e))}catch(e){}o.value(t)}})}},structSimple:{value:"struct",label:"struct",icon:"red/images/typedInput/json.svg",validate:function(e){e=e.trim();try{return JSON.parse(e),e&&"{"==e.charAt(0)}catch(e){return!1}}},binSimple:{value:"bin",label:"buffer",icon:"red/images/typedInput/bin.svg"},cred:{value:"cred",label:"credential",icon:"fa fa-lock",inputType:"password",valueLabel:function(t,e){var o=this;t.css("pointer-events","none"),t.css("flex-grow",0),this.elementDiv.hide();var i,n,a,r=l("<div>").css({position:"absolute",right:"6px",top:"6px","pointer-events":"all"}).appendTo(t),s=l('<button type="button" class="red-ui-button red-ui-button-small"></button>').css({width:"20px"}).appendTo(r).on("click",function(e){e.preventDefault();var t=o.input[0].selectionStart;"text"===o.input.attr("type")?(o.input.attr("type","password"),d.removeClass("fa-eye-slash").addClass("fa-eye")):(o.input.attr("type","text"),d.removeClass("fa-eye").addClass("fa-eye-slash")),setTimeout(function(){o.input.focus(),o.input[0].setSelectionRange(t,t)},50)}).hide(),d=l('<i class="fa fa-eye"></i>').css("margin-left","-2px").appendTo(s);"__PWRD__"===e?(i=l('<div><i class="fa fa-asterisk"></i><i class="fa fa-asterisk"></i><i class="fa fa-asterisk"></i><i class="fa fa-asterisk"></i><i class="fa fa-asterisk"></i></div>').css({padding:"6px 6px",borderRadius:"4px"}).addClass("red-ui-typedInput-value-label-inactive").appendTo(t),n=l('<button type="button" class="red-ui-button red-ui-button-small"><i class="fa fa-pencil"></i></button>').appendTo(r).on("click",function(e){e.preventDefault(),i.hide(),t.css("background","none"),t.css("pointer-events","none"),o.input.val(""),o.element.val(""),o.elementDiv.show(),n.hide(),a.show(),s.show(),setTimeout(function(){o.input.focus()},50)}),a=l('<button type="button" class="red-ui-button red-ui-button-small"><i class="fa fa-times"></i></button>').css("margin-left","3px").appendTo(r).on("click",function(e){e.preventDefault(),i.show(),t.css("background",""),o.input.val("__PWRD__"),o.element.val("__PWRD__"),o.elementDiv.hide(),n.show(),a.hide(),s.hide(),o.input.attr("type","password"),d.removeClass("fa-eye-slash").addClass("fa-eye")}).hide()):(t.css("background","none"),t.css("pointer-events","none"),this.elementDiv.show(),s.show())}}};function c(e,t){if(e.multiple){var o={},i=[];t.split(",").forEach(function(e){e&&(o[e]=!0)});for(a=0;a<e.options.length;a++){op=e.options[a];var n="string"==typeof op?op:op.value;o.hasOwnProperty(n)&&(delete o[n],i.push("string"==typeof op?{value:op}:op.value))}return l.isEmptyObject(o)?i:null}for(var a=0;a<e.options.length;a++){if(op=e.options[a],"string"==typeof op&&op===t)return{value:t};if(op.value===t)return op}}var s=!1;l.widget("nodered.typedInput",{_create:function(){try{if(!s&&RED&&RED._){for(var e in r)r.hasOwnProperty(e)&&(r[e].label=RED._("typedInput.type."+e,{defaultValue:r[e].label}));var t=RED.settings.context.stores.map(function(e){return{value:e,label:e,icon:'<i class="red-ui-typedInput-icon fa fa-database"></i>'}}).sort(function(e,t){return e.value===RED.settings.context.default?-1:t.value===RED.settings.context.default?1:e.value.localeCompare(t.value)});t.length<2?(r.flow.options=[],r.global.options=[]):(r.flow.options=t,r.global.options=t)}s=!0;var o=this;this.identifier=this.element.attr("id")||"TypedInput-"+Math.floor(100*Math.random()),this.options.debug&&console.log(this.identifier,"Create",{defaultType:this.options.default,value:this.element.val()}),this.disarmClick=!1,this.input=l('<input class="red-ui-typedInput-input" type="text"></input>'),this.input.insertAfter(this.element),this.input.val(this.element.val()),this.element.addClass("red-ui-typedInput"),this.uiWidth=this.element.outerWidth(),this.elementDiv=this.input.wrap("<div>").parent().addClass("red-ui-typedInput-input-wrap"),this.uiSelect=this.elementDiv.wrap("<div>").parent();var i,n,a=this.element.attr("style");null!==(i=/width\s*:\s*(calc\s*\(.*\)|\d+(%|px))/i.exec(a))?(this.input.css("width","100%"),this.uiSelect.width(i[1]),this.uiWidth=null):0!==this.uiWidth&&this.uiSelect.width(this.uiWidth),["Right","Left"].forEach(function(e){var t=o.element.css("margin"+e);o.uiSelect.css("margin"+e,t),o.input.css("margin"+e,0)}),["type","placeholder","autocomplete","data-i18n"].forEach(function(e){var t=o.element.attr(e);o.input.attr(e,t)}),this.defaultInputType=this.input.attr("type"),this.oldValues={},this.uiSelect.addClass("red-ui-typedInput-container"),this.element.attr("type","hidden"),!this.options.types&&this.options.type?this.options.types=[this.options.type]:this.options.types=this.options.types||Object.keys(r),this.selectTrigger=l('<button class="red-ui-typedInput-type-select" tabindex="0"></button>').prependTo(this.uiSelect),l('<i class="red-ui-typedInput-icon fa fa-caret-down"></i>').toggle(1<this.options.types.length).appendTo(this.selectTrigger),this.selectLabel=l('<span class="red-ui-typedInput-type-label"></span>').appendTo(this.selectTrigger),this.valueLabelContainer=l('<div class="red-ui-typedInput-value-label">').appendTo(this.uiSelect),this.types(this.options.types),this.options.typeField?(this.typeField=l(this.options.typeField).hide(),(n=this.typeField.val())&&this.typeMap[n]&&(this.options.default=n)):this.typeField=l("<input>",{type:"hidden"}).appendTo(this.uiSelect),this.input.on("focus",function(){o.uiSelect.addClass("red-ui-typedInput-focus")}),this.input.on("blur",function(){o.uiSelect.removeClass("red-ui-typedInput-focus")}),this.input.on("change",function(){o.validate(),o.element.val(o.value()),o.element.trigger("change",[o.propertyType,o.value()])}),this.input.on("keyup",function(e){o.validate(),o.element.val(o.value()),o.element.trigger("keyup",e)}),this.input.on("paste",function(e){o.validate(),o.element.val(o.value()),o.element.trigger("paste",e)}),this.input.on("keydown",function(e){o.typeMap[o.propertyType].autoComplete||37<=e.keyCode&&e.keyCode<=40&&e.stopPropagation()}),this.selectTrigger.on("click",function(e){e.preventDefault(),e.stopPropagation(),o._showTypeMenu()}),this.selectTrigger.on("keydown",function(e){40===e.keyCode&&o._showTypeMenu(),e.stopPropagation()}).on("focus",function(){o.uiSelect.addClass("red-ui-typedInput-focus")}).on("blur",function(){!1===o.typeMap[o.propertyType].hasValue&&o.uiSelect.removeClass("red-ui-typedInput-focus")}),this.optionSelectTrigger=l('<button tabindex="0" class="red-ui-typedInput-option-trigger" style="display:inline-block"><span class="red-ui-typedInput-option-caret"><i class="red-ui-typedInput-icon fa fa-caret-down"></i></span></button>').appendTo(this.uiSelect),this.optionSelectLabel=l('<span class="red-ui-typedInput-option-label"></span>').prependTo(this.optionSelectTrigger),this.optionSelectTrigger.on("click",function(e){e.preventDefault(),e.stopPropagation(),o._showOptionSelectMenu()}).on("keydown",function(e){40===e.keyCode&&o._showOptionSelectMenu(),e.stopPropagation()}).on("blur",function(){o.uiSelect.removeClass("red-ui-typedInput-focus")}).on("focus",function(){o.uiSelect.addClass("red-ui-typedInput-focus")}),this.optionExpandButton=l('<button tabindex="0" class="red-ui-typedInput-option-expand" style="display:inline-block"></button>').appendTo(this.uiSelect),this.optionExpandButtonIcon=l('<i class="red-ui-typedInput-icon fa fa-ellipsis-h"></i>').appendTo(this.optionExpandButton),this.type(this.typeField.val()||this.options.default||this.typeList[0].value),this.typeChanged=!!this.options.default}catch(e){console.log(e.stack)}},_showTypeMenu:function(){var e;1<this.typeList.length?(this._showMenu(this.menu,this.selectTrigger),e=this.menu.find("[value='"+this.propertyType+"']"),setTimeout(function(){e.trigger("focus")},120)):this.input.trigger("focus")},_showOptionSelectMenu:function(){var e;this.optionMenu&&(this.optionMenu.css({minWidth:this.optionSelectLabel.width()}),this._showMenu(this.optionMenu,this.optionSelectTrigger),e=this.optionValue,null!==this.optionValue&&void 0!==this.optionValue||(e=this.value()),(e=0===(e=this.optionMenu.find("[value='"+e+"']")).length?this.optionMenu.children(":first"):e).trigger("focus"))},_hideMenu:function(e){var t;l(document).off("mousedown.red-ui-typedInput-close-property-select"),e.hide(),e.css({height:"auto"}),e.opts.multiple&&(t=[],e.find('input[type="checkbox"]').each(function(){l(this).prop("checked")&&t.push(l(this).data("value"))}),e.callback(t)),(this.elementDiv.is(":visible")?this.input:this.optionSelectTrigger.is(":visible")?this.optionSelectTrigger:this.selectTrigger).trigger("focus")},_createMenu:function(e,i,n){var a=this,r=l("<div>").addClass("red-ui-typedInput-options red-ui-editor-dialog");return r.opts=i,r.callback=n,e.forEach(function(t){"string"==typeof t&&(t={value:t,label:t});var o,e=l('<a href="#"></a>').attr("value",t.value).appendTo(r);t.label&&e.text(t.label),t.title&&e.prop("title",t.title),t.icon?(0===t.icon.indexOf("<")?l(t.icon):-1!==t.icon.indexOf("/")?l("<img>",{src:d(t.icon),style:"margin-right: 4px; height: 18px;"}):l("<i>",{class:"red-ui-typedInput-icon "+t.icon})).prependTo(e):e.css({paddingLeft:"18px"}),t.icon||t.label||e.text(t.value),i.multiple&&(o=l('<input type="checkbox">').css("pointer-events","none").data("value",t.value).prependTo(e).on("mousedown",function(e){e.preventDefault()})),e.on("click",function(e){e.preventDefault(),e.stopPropagation(),i.multiple?o.prop("checked",!o.prop("checked")):(n(t.value),a._hideMenu(r))})}),r.css({display:"none"}),r.appendTo(document.body),r.on("keydown",function(e){40===e.keyCode?(e.preventDefault(),l(this).children(":focus").next().trigger("focus")):38===e.keyCode?(e.preventDefault(),l(this).children(":focus").prev().trigger("focus")):27===e.keyCode&&(e.preventDefault(),a._hideMenu(r)),e.stopPropagation()}),r},_showMenu:function(t,o){var i,n,e,a,r;this.disarmClick?this.disarmClick=!1:(t.opts.multiple&&(i={},this.value().split(",").forEach(function(e){i[e]=!0}),t.find('input[type="checkbox"]').each(function(){l(this).prop("checked",i[l(this).data("value")])})),n=this,e=o.offset(),r=o.height(),a=t.height(),(r=r+e.top)+a-l(document).scrollTop()>l(window).height()&&(r-=r+a-l(window).height()+5),r<0&&(t.height(a+r),r=0),t.css({top:r+"px",left:e.left+"px"}),t.slideDown(100),this._delay(function(){n.uiSelect.addClass("red-ui-typedInput-focus"),l(document).on("mousedown.red-ui-typedInput-close-property-select",function(e){l(e.target).closest(t).length||n._hideMenu(t),l(e.target).closest(o).length&&(n.disarmClick=!0,e.preventDefault())})}))},_getLabelWidth:function(e,t){var o,i,n,a=e.outerWidth();0===a?(o=l('<div class="red-ui-editor"></div>').css({position:"absolute","white-space":"nowrap",top:-2e3}).appendTo(document.body),i=l('<div class="red-ui-typedInput-container"></div>').appendTo(o),n=e.clone().appendTo(i),setTimeout(function(){a=n.outerWidth(),o.remove(),t(a)},50)):t(a)},_updateOptionSelectLabel:function(e){var t=this.typeMap[this.propertyType];this.optionSelectLabel.empty(),t.hasValue?(this.valueLabelContainer.empty(),this.valueLabelContainer.show()):this.valueLabelContainer.hide(),this.typeMap[this.propertyType].valueLabel&&(t.multiple?this.typeMap[this.propertyType].valueLabel.call(this,t.hasValue?this.valueLabelContainer:this.optionSelectLabel,e):this.typeMap[this.propertyType].valueLabel.call(this,t.hasValue?this.valueLabelContainer:this.optionSelectLabel,e.value)),this.typeMap[this.propertyType].valueLabel&&!t.hasValue||(t.multiple?this.optionSelectLabel.text(e.length+" selected"):(e.icon?(0===e.icon.indexOf("<")?l(e.icon):-1!==e.icon.indexOf("/")?l("<img>",{src:d(e.icon),style:"height: 18px;"}):l("<i>",{class:"red-ui-typedInput-icon "+e.icon})).prependTo(this.optionSelectLabel):e.label?this.optionSelectLabel.text(e.label):this.optionSelectLabel.text(e.value),t.hasValue&&(this.optionValue=e.value,this.input.trigger("change",[this.propertyType,this.value()]))))},_destroy:function(){this.optionMenu&&this.optionMenu.remove(),this.menu.remove(),this.uiSelect.remove()},types:function(e){var t=this,o=this.type();this.typeMap={};var i=void 0===this.typeList;this.typeList=e.map(function(e){e="string"==typeof e?r[e]:e;return t.typeMap[e.value]=e}),this.typeList.length<2?(this.selectTrigger.attr("tabindex",-1),this.selectTrigger.on("mousedown.red-ui-typedInput-focus-block",function(e){e.preventDefault()})):(this.selectTrigger.attr("tabindex",0),this.selectTrigger.off("mousedown.red-ui-typedInput-focus-block")),this.selectTrigger.toggleClass("disabled",1===this.typeList.length),this.selectTrigger.find(".fa-caret-down").toggle(1<this.typeList.length),this.menu&&this.menu.remove(),this.menu=this._createMenu(this.typeList,{},function(e){t.type(e)}),o&&!this.typeMap.hasOwnProperty(o)?i||this.type(this.typeList[0].value):(this.propertyType=null,i||this.type(o)),1!==this.typeList.length||this.typeList[0].icon||this.typeList[0].label&&!1!==this.typeList[0].showLabel?this.selectTrigger.show():this.selectTrigger.hide()},width:function(e){this.uiWidth=e,null!==this.uiWidth&&this.uiSelect.width(this.uiWidth)},value:function(e){var i=this,n=this.typeMap[this.propertyType]||{};if(!arguments.length){var t=this.input.val();return t=n.export?n.export(t,this.optionValue):t}this.options.debug&&console.log(this.identifier,"----- SET VALUE ------",e);var o,a=[],t=e;n.options?(n.hasValue&&n.parse&&(o=n.parse(e),this.options.debug&&console.log(this.identifier,"new parse",o),e=o.value,t=o.option||o.value),o=[t],n.multiple&&(a=[],o=t.split(",")),o.forEach(function(e){for(var t=0;t<n.options.length;t++){var o=n.options[t];if("string"==typeof o){if(o===e||o===""+e){a.push(i.activeOptions[o]);break}}else if(o.value===e){a.push(o);break}}}),this.options.debug&&console.log(this.identifier,"set value to",e),this.input.val(e),n.multiple?this._updateOptionSelectLabel(a):(0===a.length&&(a=[{value:""}]),this._updateOptionSelectLabel(a[0]))):(this.input.val(e),n.valueLabel&&(this.valueLabelContainer.empty(),n.valueLabel.call(this,this.valueLabelContainer,e))),this.input.trigger("change",[this.type(),e])},type:function(e){if(!arguments.length)return this.propertyType;var o=this;this.options.debug&&console.log(this.identifier,"----- SET TYPE -----",e);var t,i,n,a,r=null,s=this.typeMap[e];s&&this.propertyType!==e&&(t=this.typeMap[this.propertyType],r=this.input.val(),t&&this.typeChanged&&(this.options.debug&&console.log(this.identifier,"typeChanged",{previousType:t,previousValue:r}),t.options&&!0!==s.hasValue||!1===t.hasValue?this.oldValues[t.value]=r:this.oldValues._=r,s.options&&!0!==s.hasValue||!1===s.hasValue?this.oldValues.hasOwnProperty(s.value)?(this.options.debug&&console.log(this.identifier,"restored previous (1)",this.oldValues[s.value]),this.input.val(this.oldValues[s.value])):s.options?(i=c(s,r),this.options.debug&&console.log(this.identifier,{previousValue:r,opt:s,validOptions:i}),(r||""===r)&&i?(this.options.debug&&console.log(this.identifier,"restored previous (2)"),this.input.val(r)):"string"==typeof s.default?(this.options.debug&&console.log(this.identifier,"restored previous (3)",s.default),this.input.val(s.default)):Array.isArray(s.default)?(this.options.debug&&console.log(this.identifier,"restored previous (4)",s.default.join(",")),this.input.val(s.default.join(","))):(this.options.debug&&console.log(this.identifier,"restored previous (5)"),this.input.val(""))):(this.options.debug&&console.log(this.identifier,"restored default/blank",s.default||""),this.input.val(s.default||"")):(this.options.debug&&console.log(this.identifier,"restored old/default/blank"),this.input.val(this.oldValues.hasOwnProperty("_")?this.oldValues._:s.default||"")),t.autoComplete&&this.input.autoComplete("destroy")),this.propertyType=e,this.typeChanged=!0,this.typeField&&this.typeField.val(e),this.selectLabel.empty(),s.icon&&!1!==s.showLabel&&(0===s.icon.indexOf("<")?l(s.icon).prependTo(this.selectLabel):-1!==s.icon.indexOf("/")?((n=new Image).name=s.icon,n.src=d(s.icon),l("<img>",{src:d(s.icon),style:"margin-right: 4px;height: 18px;"}).prependTo(this.selectLabel)):l("<i>",{class:"red-ui-typedInput-icon "+s.icon,style:"min-width: 13px; margin-right: 4px;"}).prependTo(this.selectLabel)),!1!==s.hasValue&&(!1===s.showLabel||s.icon)||this.selectLabel.text(s.label),s.label?this.selectTrigger.attr("title",s.label):this.selectTrigger.attr("title",""),!1===s.hasValue?this.selectTrigger.addClass("red-ui-typedInput-full-width"):this.selectTrigger.removeClass("red-ui-typedInput-full-width"),this.optionMenu&&(this.optionMenu.remove(),this.optionMenu=null),s.options?(this.optionExpandButton&&(this.optionExpandButton.hide(),this.optionExpandButton.shown=!1),this.optionSelectTrigger&&(this.optionSelectTrigger.css({display:"inline-flex"}),s.hasValue?(this.optionSelectTrigger.css({"flex-grow":0}),this.elementDiv.show()):(this.optionSelectTrigger.css({"flex-grow":1}),this.elementDiv.hide()),this.valueLabelContainer.hide(),this.activeOptions={},s.options.forEach(function(e){"string"==typeof e?o.activeOptions[e]={label:e,value:e}:o.activeOptions[e.value]=e}),o.activeOptions.hasOwnProperty(o.optionValue)||(o.optionValue=null),s.hasValue?(a=this.optionValue||s.options[0],s.parse&&(n="string"==typeof a?{value:a}:a,(n=s.parse(this.input.val(),n)).option&&(a=n.option,this.activeOptions.hasOwnProperty(a)||(n.option=Object.keys(this.activeOptions)[0],a=n.option)),this.input.val(n.value),s.export&&this.element.val(s.export(n.value,n.option||a))),"string"==typeof a?(this.optionValue=a,(a=!this.activeOptions.hasOwnProperty(a)?Object.keys(this.activeOptions)[0]:a)?this._updateOptionSelectLabel(this.activeOptions[a]):this.optionSelectTrigger.hide()):a?(this.options.debug&&console.log(this.identifier,"HERE",{optionValue:a.value}),this.optionValue=a.value,this._updateOptionSelectLabel(a)):this.optionSelectTrigger.hide()):(a=c(s,this.input.val()),s.multiple?(a||(a=(s.default||[]).map(function(e){return"string"==typeof e?e:e.value}),this.value(a.join(","))),o._updateOptionSelectLabel(a)):a?o._updateOptionSelectLabel(a):"string"==typeof(a=s.options[0])?(this.value(a),o._updateOptionSelectLabel({value:a})):(this.value(a.value),o._updateOptionSelectLabel(a))),this.optionMenu=this._createMenu(s.options,s,function(e){s.multiple?(o._updateOptionSelectLabel(e),s.hasValue||o.value(e.join(","))):(o._updateOptionSelectLabel(o.activeOptions[e]),s.hasValue||o.value(o.activeOptions[e].value))}))):(this.optionSelectTrigger&&this.optionSelectTrigger.hide(),s.inputType?this.input.attr("type",s.inputType):this.input.attr("type",this.defaultInputType),!1===s.hasValue?(this.elementDiv.hide(),this.valueLabelContainer.hide()):s.valueLabel?(this.valueLabelContainer.css("pointer-events",""),this.valueLabelContainer.css("flex-grow",1),this.valueLabelContainer.css("overflow","hidden"),this.valueLabelContainer.show(),this.valueLabelContainer.empty(),this.elementDiv.hide(),s.valueLabel.call(this,this.valueLabelContainer,this.input.val())):(this.valueLabelContainer.hide(),this.elementDiv.show(),s.autoComplete&&this.input.autoComplete({search:s.autoComplete})),this.optionExpandButton&&(s.expand?(s.expand.icon?this.optionExpandButtonIcon.removeClass().addClass("red-ui-typedInput-icon fa "+s.expand.icon):this.optionExpandButtonIcon.removeClass().addClass("red-ui-typedInput-icon fa fa-ellipsis-h"),this.optionExpandButton.shown=!0,this.optionExpandButton.show(),this.optionExpandButton.off("click"),this.optionExpandButton.on("click",function(e){var t;e.preventDefault(),"function"==typeof s.expand?s.expand.call(o):(t=l("<div>"),e=s.expand.content.call(o,t),(t=RED.popover.panel(t)).container.css({width:o.valueLabelContainer.width()}),s.expand.minWidth&&t.container.css({minWidth:s.expand.minWidth+"px"}),t.show({target:o.optionExpandButton,onclose:e.onclose,align:"left"}))})):(this.optionExpandButton.shown=!1,this.optionExpandButton.hide()))),this._trigger("typechange",null,this.propertyType),this.input.trigger("change",[this.propertyType,this.value()]))},validate:function(){var e=this.value(),t=this.type();return(e=!this.typeMap[t]||!this.typeMap[t].validate||("function"==typeof(t=this.typeMap[t].validate)?t(e):t.test(e)))?this.uiSelect.removeClass("input-error"):this.uiSelect.addClass("input-error"),e},show:function(){this.uiSelect.show()},hide:function(){this.uiSelect.hide()},disable:function(e){void 0===e||e?this.uiSelect.attr("disabled","disabled"):this.uiSelect.attr("disabled",null)},enable:function(){this.uiSelect.attr("disabled",null)},disabled:function(){return"disabled"===this.uiSelect.attr("disabled")},focus:function(){this.input.focus()}})}(jQuery),function(s){s.widget("nodered.toggleButton",{_create:function(){var t=this,o=!1;this.options.hasOwnProperty("invertState")&&(o=this.options.invertState);var e=this.options.baseClass||"red-ui-button",i=this.options.hasOwnProperty("enabledIcon")?this.options.enabledIcon:"fa-check-square-o",n=this.options.hasOwnProperty("disabledIcon")?this.options.disabledIcon:"fa-square-o",a=this.options.hasOwnProperty("enabledLabel")?this.options.enabledLabel:RED._("editor:workspace.enabled"),r=this.options.hasOwnProperty("disabledLabel")?this.options.disabledLabel:RED._("editor:workspace.disabled");this.element.css("display","none"),this.element.on("focus",function(){t.button.focus()}),this.button=s('<button type="button" class="red-ui-toggleButton '+e+' toggle single"></button>'),(a||r)&&(this.buttonLabel=s("<span>").appendTo(this.button).css("margin-left","5px")),this.options.class&&this.button.addClass(this.options.class),this.element.after(this.button),i&&n&&(this.buttonIcon=s('<i class="fa"></i>').prependTo(this.button)),this.button.addClass("selected"),this.buttonIcon&&this.buttonIcon.addClass(i),this.buttonLabel&&this.buttonLabel.text(a);e=this.button.width();this.button.removeClass("selected"),this.buttonIcon&&(this.buttonIcon.removeClass(i),t.buttonIcon.addClass(n)),this.buttonLabel&&t.buttonLabel.text(r),e=Math.max(e,this.button.width()),this.buttonIcon&&this.buttonIcon.removeClass(n),0<e&&this.button.width(Math.ceil(e)),this.button.on("click",function(e){e.stopPropagation(),t.state?t.element.prop("checked",o):t.element.prop("checked",!o),t.element.trigger("change")}),this.element.on("change",function(e){s(this).prop("checked")!==o?(t.button.addClass("selected"),t.state=!0,t.buttonIcon&&(t.buttonIcon.addClass(i),t.buttonIcon.removeClass(n)),t.buttonLabel&&t.buttonLabel.text(a)):(t.button.removeClass("selected"),t.state=!1,t.buttonIcon&&(t.buttonIcon.addClass(n),t.buttonIcon.removeClass(i)),t.buttonLabel&&t.buttonLabel.text(r))}),this.element.trigger("change")}})}(jQuery),jQuery.widget("nodered.autoComplete",{_create:function(){var o=this;this.completionMenuShown=!1,this.options.search=this.options.search||function(){return[]},this.element.addClass("red-ui-autoComplete"),this.element.on("keydown.red-ui-autoComplete",function(e){var t;13!==e.keyCode&&9!==e.keyCode||!o.completionMenuShown||(t=o.menu.options(),o.element.val(t[0].value),o.menu.hide(),e.preventDefault())}),this.element.on("keyup.red-ui-autoComplete",function(e){13!==e.keyCode&&9!==e.keyCode&&27!==e.keyCode&&(8!==e.keyCode&&46!==e.keyCode||o.completionMenuShown)&&o._updateCompletions(this.value)})},_showCompletionMenu:function(e){this.completionMenuShown||(this.menu=RED.popover.menu({tabSelect:!0,width:300,maxHeight:200,class:"red-ui-autoComplete-container",options:e,onselect:e=>{this.element.val(e.value),this.element.focus(),this.element.trigger("change")},onclose:()=>{this.completionMenuShown=!1,delete this.menu,this.element.focus()}}),this.menu.show({target:this.element}),this.completionMenuShown=!0)},_updateCompletions:function(e){var t,o=this;function i(e,t){t&&t!==o.pendingRequest||(e&&0!==e.length?o.completionMenuShown?o.menu.options(e):o._showCompletionMenu(e):o.completionMenuShown&&o.menu.hide())}""!==e.trim()?2===this.options.search.length?(t=1+Math.floor(1e4*Math.random()),this.pendingRequest=t,this.options.search(e,function(e){i(e,t)})):i(this.options.search(e)):this.completionMenuShown&&this.menu.hide()},_destroy:function(){this.element.removeClass("red-ui-autoComplete"),this.element.off("keydown.red-ui-autoComplete"),this.element.off("keyup.red-ui-autoComplete"),this.completionMenuShown&&this.menu.hide()}}),RED.actions=function(){var o={};return{add:function(e,t){if("function"!=typeof t)throw new Error("Action handler not a function");if(o[e])throw new Error("Cannot override existing action");o[e]=t},remove:function(e){delete o[e]},get:function(e){return o[e]},invoke:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();o.hasOwnProperty(t)&&o[t].apply(null,e)},list:function(){var i=[];return Object.keys(o).forEach(function(e){var t=RED.keyboard.getShortcut(e),o=!1,o=t?t.user:!!RED.keyboard.getUserShortcut(e);i.push({id:e,scope:t?t.scope:void 0,key:t?t.key:void 0,user:o})}),i}}}(),RED.deploy=function(){var f={unknown:!1,unusedConfig:!1,invalid:!1},h="full",g=!1,l=null;function v(e){var t="";e.z&&(t=(o=RED.nodes.workspace(e.z))?o.label:(o=RED.nodes.subflow(e.z)).name);var o=RED.utils.getNodeLabel(e,e.id);return{tab:t,type:e.type,label:o}}function m(e,t){return e.tab<t.tab?-1:e.tab>t.tab?1:e.type<t.type?-1:e.type>t.type?1:e.name<t.name?-1:e.name>t.name?1:0}function b(e,t){var o=$("<div>");$('<p data-i18n="deploy.confirm.conflict"></p>').appendTo(o);var i=$('<div class="red-ui-deploy-dialog-confirm-conflict-row"><img src="red/images/spin.svg"/><div data-i18n="deploy.confirm.conflictChecking"></div></div>').appendTo(o),n=$('<div class="red-ui-deploy-dialog-confirm-conflict-row"><i class="fa fa-check"></i><div data-i18n="deploy.confirm.conflictAutoMerge"></div></div>').hide().appendTo(o),a=$('<div class="red-ui-deploy-dialog-confirm-conflict-row"><i class="fa fa-exclamation"></i><div data-i18n="deploy.confirm.conflictManualMerge"></div></div>').hide().appendTo(o);o.i18n(),l=null;var r=[{text:RED._("common.label.cancel"),click:function(){s.close()}},{id:"red-ui-deploy-dialog-confirm-deploy-review",text:RED._("deploy.confirm.button.review"),class:"primary disabled",click:function(){$("#red-ui-deploy-dialog-confirm-deploy-review").hasClass("disabled")||(RED.diff.showRemoteDiff(),s.close())}},{id:"red-ui-deploy-dialog-confirm-deploy-merge",text:RED._("deploy.confirm.button.merge"),class:"primary disabled",click:function(){$("#red-ui-deploy-dialog-confirm-deploy-merge").hasClass("disabled")||(RED.diff.mergeDiff(l),s.close())}}];t&&r.push({id:"red-ui-deploy-dialog-confirm-deploy-overwrite",text:RED._("deploy.confirm.button.overwrite"),class:"primary",click:function(){E(!0,t),s.close()}});var s=RED.notify(o,{modal:!0,fixed:!0,width:600,buttons:r}),d=Date.now();RED.diff.getRemoteDiff(function(e){var t=Math.max(1e3-(Date.now()-d),0);l=e,setTimeout(function(){i.hide(),0===Object.keys(e.conflicts).length?(n.show(),$("#red-ui-deploy-dialog-confirm-deploy-merge").removeClass("disabled")):a.show(),$("#red-ui-deploy-dialog-confirm-deploy-review").removeClass("disabled")},t)})}function y(e){var t;return 5<e.length&&(t=e.length-5,(e=e.slice(0,5)).push(RED._("deploy.confirm.plusNMore",{count:t}))),e}function w(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(){var t=Date.now();$(".red-ui-deploy-button-content").css("opacity",0),$(".red-ui-deploy-button-spinner").show();var i=!$("#red-ui-header-button-deploy").hasClass("disabled");$("#red-ui-header-button-deploy").addClass("disabled"),g=!0,$("#red-ui-header-shade").show(),$("#red-ui-editor-shade").show(),$("#red-ui-palette-shade").show(),$("#red-ui-sidebar-shade").show(),$.ajax({url:"flows",type:"POST",headers:{"Node-RED-Deployment-Type":"reload"}}).done(function(e,t,o){i&&$("#red-ui-header-button-deploy").removeClass("disabled"),RED.notify("<p>"+RED._("deploy.successfulRestart")+"</p>","success")}).fail(function(e,t,o){i&&$("#red-ui-header-button-deploy").removeClass("disabled"),401===e.status?RED.notify(RED._("deploy.deployFailed",{message:RED._("user.notAuthorized")}),"error"):409===e.status?b(nns,!0):e.responseText?RED.notify(RED._("deploy.deployFailed",{message:e.responseText}),"error"):RED.notify(RED._("deploy.deployFailed",{message:RED._("deploy.errors.noResponse")}),"error")}).always(function(){g=!1;var e=Math.max(0,300-(Date.now()-t));setTimeout(function(){$(".red-ui-deploy-button-content").css("opacity",1),$(".red-ui-deploy-button-spinner").hide(),$("#red-ui-header-shade").hide(),$("#red-ui-editor-shade").hide(),$("#red-ui-palette-shade").hide(),$("#red-ui-sidebar-shade").hide()},e)})}function E(e,t){if(!$("#red-ui-header-button-deploy").hasClass("disabled"))if(RED.user.hasPermission("flows.write")){if(!e){var i=!1,o=[],n=[];RED.nodes.eachConfig(function(e){e.valid||e.d||n.push(v(e)),"unknown"===e.type&&-1==o.indexOf(e.name)&&o.push(e.name)}),RED.nodes.eachNode(function(e){e.valid||e.d||n.push(v(e)),"unknown"===e.type&&-1==o.indexOf(e.name)&&o.push(e.name)});var a=0<o.length,r=0<n.length,s=[];RED.nodes.eachConfig(function(e){!1!==e._def.hasUsers&&0===e.users.length&&(s.push(v(e)),i=!0)});var d,l,e=!1,c=[];if(a&&!f.unknown?(e=!0,d="<p>"+RED._("deploy.confirm.unknown")+'</p><ul class="red-ui-deploy-dialog-confirm-list"><li>'+y(o).map(w).join("</li><li>")+"</li></ul><p>"+RED._("deploy.confirm.confirm")+"</p>",c=[{id:"red-ui-deploy-dialog-confirm-deploy-deploy",text:RED._("deploy.confirm.button.confirm"),class:"primary",click:function(){E(!0),l.close()}}]):r&&!f.invalid&&(e=!0,n.sort(m),d="<p>"+RED._("deploy.confirm.improperlyConfigured")+'</p><ul class="red-ui-deploy-dialog-confirm-list"><li>'+y(n.map(function(e){return w((e.tab?"["+e.tab+"] ":"")+e.label+" ("+e.type+")")})).join("</li><li>")+"</li></ul><p>"+RED._("deploy.confirm.confirm")+"</p>",c=[{id:"red-ui-deploy-dialog-confirm-deploy-deploy",text:RED._("deploy.confirm.button.confirm"),class:"primary",click:function(){E(!0),l.close()}}]),e)return c.unshift({text:RED._("common.label.cancel"),click:function(){l.close()}}),void(l=RED.notify(d,{modal:!0,fixed:!0,buttons:c}))}var p=RED.nodes.createCompleteNodeSet(),u=Date.now();$(".red-ui-deploy-button-content").css("opacity",0),$(".red-ui-deploy-button-spinner").show(),$("#red-ui-header-button-deploy").addClass("disabled");c={flows:p};t||(c.rev=RED.nodes.version()),g=!0,$("#red-ui-header-shade").show(),$("#red-ui-editor-shade").show(),$("#red-ui-palette-shade").show(),$("#red-ui-sidebar-shade").show(),$.ajax({url:"flows",type:"POST",data:JSON.stringify(c),contentType:"application/json; charset=utf-8",headers:{"Node-RED-Deployment-Type":h}}).done(function(e,t,o){RED.nodes.dirty(!1),RED.nodes.version(e.rev),RED.nodes.originalFlow(p),i?RED.notify("<p>"+RED._("deploy.successfulDeploy")+"</p><p>"+RED._("deploy.unusedConfigNodes")+' <a href="#" onclick="RED.sidebar.config.show(true); return false;">'+RED._("deploy.unusedConfigNodesLink")+"</a></p>","success",!1,6e3):RED.notify("<p>"+RED._("deploy.successfulDeploy")+"</p>","success"),RED.nodes.eachNode(function(e){e.changed&&(e.dirty=!0,e.changed=!1),e.moved&&(e.dirty=!0,e.moved=!1),e.credentials&&delete e.credentials}),RED.nodes.eachConfig(function(e){e.changed=!1,e.credentials&&delete e.credentials}),RED.nodes.eachSubflow(function(e){e.changed=!1}),RED.nodes.eachWorkspace(function(e){e.changed=!1}),RED.history.markAllDirty(),RED.view.redraw(),RED.events.emit("deploy")}).fail(function(e,t,o){RED.nodes.dirty(!0),$("#red-ui-header-button-deploy").removeClass("disabled"),401===e.status?RED.notify(RED._("deploy.deployFailed",{message:RED._("user.notAuthorized")}),"error"):409===e.status?b(0,!0):e.responseText?RED.notify(RED._("deploy.deployFailed",{message:e.responseText}),"error"):RED.notify(RED._("deploy.deployFailed",{message:RED._("deploy.errors.noResponse")}),"error")}).always(function(){g=!1;var e=Math.max(0,300-(Date.now()-u));setTimeout(function(){$(".red-ui-deploy-button-content").css("opacity",1),$(".red-ui-deploy-button-spinner").hide(),$("#red-ui-header-shade").hide(),$("#red-ui-editor-shade").hide(),$("#red-ui-palette-shade").hide(),$("#red-ui-sidebar-shade").hide()},e)})}else RED.notify(RED._("user.errors.deploy"),"error")}return{init:function(e){var t,o,i,n=(e=e||{}).type||"default";"default"==n?$('<li><span class="red-ui-deploy-button-group button-group"><a id="red-ui-header-button-deploy" class="red-ui-deploy-button disabled" href="#"><span class="red-ui-deploy-button-content"><img id="red-ui-header-button-deploy-icon" src="red/images/deploy-full-o.svg"> <span>'+RED._("deploy.deploy")+'</span></span><span class="red-ui-deploy-button-spinner hide"><img src="red/images/spin.svg"/></span></a>').prependTo(".red-ui-header-toolbar"):"simple"==n&&(t=e.label||RED._("deploy.deploy"),o="red/images/deploy-full-o.svg",e.hasOwnProperty("icon")&&(o=e.icon),$('<li><span class="red-ui-deploy-button-group button-group"><a id="red-ui-header-button-deploy" class="red-ui-deploy-button disabled" href="#"><span class="red-ui-deploy-button-content">'+(o?'<img id="red-ui-header-button-deploy-icon" src="'+o+'"> ':"")+"<span>"+t+'</span></span><span class="red-ui-deploy-button-spinner hide"><img src="red/images/spin.svg"/></span></a></span></li>').prependTo(".red-ui-header-toolbar")),$("#red-ui-header-button-deploy").on("click",function(e){e.preventDefault(),E()}),RED.actions.add("core:deploy-flows",E),"default"===n&&(RED.actions.add("core:restart-flows",a),RED.actions.add("core:set-deploy-type-to-full",function(){RED.menu.setSelected("deploymenu-item-full",!0)}),RED.actions.add("core:set-deploy-type-to-modified-flows",function(){RED.menu.setSelected("deploymenu-item-flow",!0)}),RED.actions.add("core:set-deploy-type-to-modified-nodes",function(){RED.menu.setSelected("deploymenu-item-node",!0)})),RED.events.on("workspace:dirty",function(e){e.dirty?(window.onbeforeunload=function(){return RED._("deploy.confirm.undeployedChanges")},$("#red-ui-header-button-deploy").removeClass("disabled")):(window.onbeforeunload=null,$("#red-ui-header-button-deploy").addClass("disabled"))}),RED.comms.subscribe("notification/runtime-deploy",function(e,t){var o;i||(null===(o=RED.nodes.version())||g||o===t.revision||(t=$("<p>").text(RED._("deploy.confirm.backgroundUpdate")),i=RED.notify(t,{modal:!0,fixed:!0,buttons:[{text:RED._("deploy.confirm.button.ignore"),click:function(){i.close(),i=null}},{text:RED._("deploy.confirm.button.review"),class:"primary",click:function(){i.close(),b(RED.nodes.createCompleteNodeSet(),!1),i=null}}]})))})},setDeployInflight:function(e){g=e}}}(),RED.diff=function(){var r=!1;function u(e,t,o){var i=$('<div class="red-ui-diff-panel"></div>').appendTo(e),n=$('<div class="red-ui-diff-panel-headers"></div>').appendTo(i);"merge"===o.mode&&i.addClass("red-ui-diff-panel-merge");var D,a=(e=i,D=t,(e=$('<ol class="red-ui-diff-list"></ol>').appendTo(e)).editableList({addButton:!1,height:"auto",scrollOnAdd:!1,addItem:function(e,t,o){var i=o.diff,n=o.remoteDiff,a=o.tab.n,r=o.def,s=D.conflicts,d=$("<div>",{class:"red-ui-diff-list-flow"}).appendTo(e);d.addClass("collapsed");var l,c=$("<div>",{class:"red-ui-diff-list-flow-title"}).appendTo(d),p=$("<div>").appendTo(d),u=$("<div>",{class:"red-ui-diff-list-node-cell"}).appendTo(c),f=$("<div>",{class:"red-ui-diff-list-node-cell red-ui-diff-list-node-local"}).appendTo(c);n&&(l=$("<div>",{class:"red-ui-diff-list-node-cell red-ui-diff-list-node-remote"}).appendTo(c)),$('<span class="red-ui-diff-list-chevron"><i class="fa fa-angle-down"></i></span>').appendTo(u),x(a,r).appendTo(u);var h=(o.newTab||o.tab).n,g=$("<span>",{class:"red-ui-diff-list-flow-title-meta"}).appendTo(u);"tab"===h.type?g.text(h.label||h.id):"subflow"===a.type?g.text(h.name||h.id):g.text(RED._("diff.globalNodes"));var v,m,b={local:{addedCount:0,deletedCount:0,changedCount:0,unchangedCount:0},remote:{addedCount:0,deletedCount:0,changedCount:0,unchangedCount:0},conflicts:0};(o.newTab||o.remoteTab)&&(u={node:i.newConfig.all[a.id],all:i.newConfig.all,diff:i},n&&(v={node:n.newConfig.all[a.id]||null,all:n.newConfig.all,diff:n}),void 0!==a.type&&(h=$("<div>",{class:"red-ui-diff-list-node red-ui-diff-list-node-props collapsed"}).appendTo(p),m=$("<div>",{class:"red-ui-diff-list-node-header"}).appendTo(h),g=$("<div>",{class:"red-ui-diff-list-node-cell"}).appendTo(m),y=$("<div>",{class:"red-ui-diff-list-node-cell red-ui-diff-list-node-local"}).appendTo(m),i.newConfig.all[a.id]?i.added[a.id]?(y.addClass("red-ui-diff-status-added"),$('<span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> <span data-i18n="diff.type.added"></span></span>').appendTo(y)):i.changed[a.id]?(y.addClass("red-ui-diff-status-changed"),$('<span class="red-ui-diff-status"><i class="fa fa-square"></i> <span data-i18n="diff.type.changed"></span></span>').appendTo(y)):(y.addClass("red-ui-diff-status-unchanged"),$('<span class="red-ui-diff-status"><i class="fa fa-square-o"></i> <span data-i18n="diff.type.unchanged"></span></span>').appendTo(y)):y.addClass("red-ui-diff-empty"),n&&(w=$("<div>",{class:"red-ui-diff-list-node-cell red-ui-diff-list-node-remote"}).appendTo(m),n.newConfig.all[a.id]?n.added[a.id]?(w.addClass("red-ui-diff-status-added"),$('<span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> <span data-i18n="diff.type.added"></span></span>').appendTo(w)):n.changed[a.id]?(w.addClass("red-ui-diff-status-changed"),$('<span class="red-ui-diff-status"><i class="fa fa-square"></i> <span data-i18n="diff.type.changed"></span></span>').appendTo(w)):(w.addClass("red-ui-diff-status-unchanged"),$('<span class="red-ui-diff-status"><i class="fa fa-square-o"></i> <span data-i18n="diff.type.unchanged"></span></span>').appendTo(w)):(w.addClass("red-ui-diff-empty"),n.deleted[a.id])),$('<span class="red-ui-diff-list-chevron"><i class="fa fa-angle-down"></i></span>').appendTo(g),$("<span>").text(RED._("diff.flowProperties")).appendTo(g),m.on("click",function(e){e.preventDefault(),$(this).parent().toggleClass("collapsed")}),k(r,a,u,v).appendTo(h),m="",s[a.id]?(b.conflicts++,y.hasClass("red-ui-diff-empty")||$('<span class="red-ui-diff-status-conflict"><span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span></span>').prependTo(y),w.hasClass("red-ui-diff-empty")||$('<span class="red-ui-diff-status-conflict"><span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span></span>').prependTo(w),h.addClass("red-ui-diff-list-node-conflict")):m=D.resolutions[a.id],_(a,h,y,w,!0,!s[a.id],m,D)));var y=0,w=0,E={};o.tab.nodes.forEach(function(e){E[e.id]=!0,R(e,b,D).appendTo(p)}),o.newTab&&(y=o.newTab.nodes.length,o.newTab.nodes.forEach(function(e){E[e.id]||(E[e.id]=!0,R(e,b,D).appendTo(p))})),o.remoteTab&&(w=o.remoteTab.nodes.length,o.remoteTab.nodes.forEach(function(e){E[e.id]||R(e,b,D).appendTo(p)})),c.on("click",function(e){c.parent().toggleClass("collapsed"),$(this).parent().hasClass("collapsed")&&($(this).parent().find(".red-ui-diff-list-node").addClass("collapsed"),$(this).parent().find(".red-ui-debug-msg-element").addClass("collapsed"))}),i.deleted[a.id]?$('<span class="red-ui-diff-status-deleted"><span class="red-ui-diff-status"><i class="fa fa-minus-square"></i> <span data-i18n="diff.type.flowDeleted"></span></span></span>').appendTo(f):o.newTab?i.added[a.id]?$('<span class="red-ui-diff-status-added"><span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> <span data-i18n="diff.type.flowAdded"></span></span></span>').appendTo(f):(a.id&&(i.changed[a.id]?b.local.changedCount++:b.local.unchangedCount++),s=$("<span>",{class:"red-ui-diff-list-flow-stats"}).appendTo(f),$('<span class="red-ui-diff-status"></span>').text(RED._("diff.nodeCount",{count:y})).appendTo(s),0<b.conflicts+b.local.addedCount+b.local.changedCount+b.local.deletedCount&&($('<span class="red-ui-diff-status"> [ </span>').appendTo(s),0<b.conflicts&&$('<span class="red-ui-diff-status-conflict"><span class="red-ui-diff-status"><i class="fa fa-exclamation"></i> '+b.conflicts+"</span></span>").appendTo(s),0<b.local.addedCount&&$('<span class="red-ui-diff-status-added"><span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> '+b.local.addedCount+"</span></span>").appendTo(s),0<b.local.changedCount&&$('<span class="red-ui-diff-status-changed"><span class="red-ui-diff-status"><i class="fa fa-square"></i> '+b.local.changedCount+"</span></span>").appendTo(s),0<b.local.deletedCount&&$('<span class="red-ui-diff-status-deleted"><span class="red-ui-diff-status"><i class="fa fa-minus-square"></i> '+b.local.deletedCount+"</span></span>").appendTo(s),$('<span class="red-ui-diff-status"> ] </span>').appendTo(s))):f.addClass("red-ui-diff-empty"),n&&(n.deleted[a.id]?$('<span class="red-ui-diff-status-deleted"><span class="red-ui-diff-status"><i class="fa fa-minus-square"></i> <span data-i18n="diff.type.flowDeleted"></span></span></span>').appendTo(l):o.remoteTab?n.added[a.id]?$('<span class="red-ui-diff-status-added"><span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> <span data-i18n="diff.type.flowAdded"></span></span></span>').appendTo(l):(a.id&&(n.changed[a.id]?b.remote.changedCount++:b.remote.unchangedCount++),o=$("<span>",{class:"red-ui-diff-list-flow-stats"}).appendTo(l),$('<span class="red-ui-diff-status"></span>').text(RED._("diff.nodeCount",{count:w})).appendTo(o),0<b.conflicts+b.remote.addedCount+b.remote.changedCount+b.remote.deletedCount&&($('<span class="red-ui-diff-status"> [ </span>').appendTo(o),0<b.conflicts&&$('<span class="red-ui-diff-status-conflict"><span class="red-ui-diff-status"><i class="fa fa-exclamation"></i> '+b.conflicts+"</span></span>").appendTo(o),0<b.remote.addedCount&&$('<span class="red-ui-diff-status-added"><span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> '+b.remote.addedCount+"</span></span>").appendTo(o),0<b.remote.changedCount&&$('<span class="red-ui-diff-status-changed"><span class="red-ui-diff-status"><i class="fa fa-square"></i> '+b.remote.changedCount+"</span></span>").appendTo(o),0<b.remote.deletedCount&&$('<span class="red-ui-diff-status-deleted"><span class="red-ui-diff-status"><i class="fa fa-minus-square"></i> '+b.remote.deletedCount+"</span></span>").appendTo(o),$('<span class="red-ui-diff-status"> ] </span>').appendTo(o))):l.addClass("red-ui-diff-empty"),m="",0<b.conflicts?c.addClass("red-ui-diff-list-node-conflict"):m=D.resolutions[a.id],a.id&&(n=!(0<b.conflicts&&(i.deleted[a.id]||n.deleted[a.id])),_(a,c,f,l,!1,n,m,D))),0===d.find(".red-ui-diff-list-node").length&&d.addClass("red-ui-diff-list-flow-empty"),e.i18n()}}),e),r=t.localDiff,s=t.remoteDiff,d=(t.conflicts,r.currentConfig),l=r.newConfig;return void 0!==s?(i.addClass("red-ui-diff-three-way"),t=o.oldRevTitle||RED._("diff.local"),o=o.newRevTitle||RED._("diff.remote"),$("<div></div>").text(t).appendTo(n),$("<div></div>").text(o).appendTo(n)):i.removeClass("red-ui-diff-three-way"),{list:a,finish:function(){var e={diff:r,def:{category:"config",color:"#f0f0f0"},tab:{n:{},nodes:d.globals},newTab:{n:{},nodes:l.globals}};void 0!==s&&(e.remoteTab={n:{},nodes:s.newConfig.globals},e.remoteDiff=s),a.editableList("addItem",e);var t,o={};for(t in d.tabOrder.forEach(function(e){var t=d.tabs[e],t={diff:r,def:RED.nodes.getType("tab"),tab:t};l.tabs.hasOwnProperty(e)&&(t.newTab=l.tabs[e]),void 0!==s&&(t.remoteTab=s.newConfig.tabs[e],t.remoteDiff=s),o[e]=!0,a.editableList("addItem",t)}),l.tabOrder.forEach(function(e){o[e]||(o[e]=!0,e=l.tabs[e],e={diff:r,def:RED.nodes.getType("tab"),tab:e,newTab:e},void 0!==s&&(e.remoteDiff=s),a.editableList("addItem",e))}),void 0!==s&&s.newConfig.tabOrder.forEach(function(e){o[e]||(e=s.newConfig.tabs[e],e={diff:r,remoteDiff:s,def:RED.nodes.getType("tab"),tab:e,remoteTab:e},a.editableList("addItem",e))}),d.subflows)d.subflows.hasOwnProperty(t)&&(o[t]=!0,e={diff:r,def:{defaults:{},icon:"subflow.svg",category:"subflows",color:"#DDAA99"},tab:d.subflows[t]},l.subflows.hasOwnProperty(t)&&(e.newTab=l.subflows[t]),void 0!==s&&(e.remoteTab=s.newConfig.subflows[t],e.remoteDiff=s),a.editableList("addItem",e));for(t in l.subflows)l.subflows.hasOwnProperty(t)&&!o[t]&&(o[t]=!0,e={diff:r,def:{defaults:{},icon:"subflow.svg",category:"subflows",color:"#DDAA99"},tab:l.subflows[t],newTab:l.subflows[t]},void 0!==s&&(e.remoteDiff=s),a.editableList("addItem",e));if(void 0!==s)for(t in s.newConfig.subflows)s.newConfig.subflows.hasOwnProperty(t)&&!o[t]&&(e={diff:r,remoteDiff:s,def:{defaults:{},icon:"subflow.svg",category:"subflows",color:"#DDAA99"},tab:s.newConfig.subflows[t],remoteTab:s.newConfig.subflows[t]},a.editableList("addItem",e))}}}function D(e,n){var t=$("<div>",{class:"red-ui-diff-list-wires"}),a=$("<ol></ol>"),r=0;return e.forEach(function(e,t){var i,o=$("<li>").appendTo(a);e&&0<e.length?($("<span>").text(t+1).appendTo(o),i=$("<ul>").appendTo(o),e.forEach(function(e){r++;var t=$("<li>").appendTo(i),o=n[e];o?m(o,RED.nodes.getType(o.type)||{}).appendTo(t):t.text(e)})):o.text("none")}),0===r?t.text("none"):a.appendTo(t),t}function x(e,t){var o=$("<div>",{class:"red-ui-diff-list-node-icon"}),i=RED.utils.getNodeColor(e.type,t),t=RED.utils.getNodeIcon(t,e);"tab"===e.type&&(i="#C0DEED"),o.css("backgroundColor",i);i=$("<div/>",{class:"red-ui-palette-icon-container"}).appendTo(o);return RED.utils.createIconElement(t,i,!1),o}function m(e,t){var o=$("<div>",{class:"red-ui-diff-list-node-title"});x(e,t).appendTo(o);e=e.label||e.name||e.id;return $("<div>",{class:"red-ui-diff-list-node-description"}).text(e).appendTo(o),o}function R(t,e,o){var i=o.localDiff,n=o.remoteDiff,a=o.conflicts[t.id],r=!0;i.added[t.id]&&(e.local.addedCount++,r=!1),n&&n.added[t.id]&&(e.remote.addedCount++,r=!1),i.deleted[t.id]&&(e.local.deletedCount++,r=!1),n&&n.deleted[t.id]&&(e.remote.deletedCount++,r=!1),i.changed[t.id]&&(e.local.changedCount++,r=!!0),n&&n.changed[t.id]&&(e.remote.changedCount++,r=!!0);var s=RED.nodes.getType(t.type);void 0===s&&(s=/^subflow:/.test(t.type)?{icon:"subflow.svg",category:"subflows",color:"#DDAA99",defaults:{name:{value:""}}}:"group"===t.type?RED.group.def:{});var d,l,c,p=$("<div>",{class:"red-ui-diff-list-node collapsed"}),u=$("<div>",{class:"red-ui-diff-list-node-header"}).appendTo(p),f=$("<div>",{class:"red-ui-diff-list-node-cell"}).appendTo(u),h=$("<div>",{class:"red-ui-diff-list-node-cell red-ui-diff-list-node-local"}).appendTo(u);n&&(d=$("<div>",{class:"red-ui-diff-list-node-cell red-ui-diff-list-node-remote"}).appendTo(u)),$('<span class="red-ui-diff-list-chevron"><i class="fa fa-angle-down"></i></span>').appendTo(f),r?(e.local.unchangedCount++,m(t,s).appendTo(f),h.addClass("red-ui-diff-status-unchanged"),$('<span class="red-ui-diff-status"><i class="fa fa-square-o"></i> <span data-i18n="diff.type.unchanged"></span></span>').appendTo(h),n&&(e.remote.unchangedCount++,d.addClass("red-ui-diff-status-unchanged"),$('<span class="red-ui-diff-status"><i class="fa fa-square-o"></i> <span data-i18n="diff.type.unchanged"></span></span>').appendTo(d)),p.addClass("red-ui-diff-status-unchanged")):i.added[t.id]?(h.addClass("red-ui-diff-status-added"),d&&d.addClass("red-ui-diff-empty"),$('<span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> <span data-i18n="diff.type.added"></span></span>').appendTo(h),m(t,s).appendTo(f)):n&&n.added[t.id]?(h.addClass("red-ui-diff-empty"),d.addClass("red-ui-diff-status-added"),$('<span class="red-ui-diff-status"><i class="fa fa-plus-square"></i> <span data-i18n="diff.type.added"></span></span>').appendTo(d),m(t,s).appendTo(f)):(m(t,s).appendTo(f),i.moved[t.id]?(l=i.newConfig.all[t.id],i.deleted[t.z]||t.z===l.z||""===t.z||i.newConfig.all[t.z]?(h.addClass("red-ui-diff-status-moved"),c="",c=t.z===l.z?RED._("diff.type.movedFrom",{id:i.currentConfig.all[t.id].z||"global"}):RED._("diff.type.movedTo",{id:l.z||"global"}),$('<span class="red-ui-diff-status"><i class="fa fa-caret-square-o-right"></i> '+c+"</span>").appendTo(h)):h.addClass("red-ui-diff-empty")):i.deleted[t.z]?h.addClass("red-ui-diff-empty"):i.deleted[t.id]?(h.addClass("red-ui-diff-status-deleted"),$('<span class="red-ui-diff-status"><i class="fa fa-minus-square"></i> <span data-i18n="diff.type.deleted"></span></span>').appendTo(h)):i.changed[t.id]?i.newConfig.all[t.id].z!==t.z?h.addClass("red-ui-diff-empty"):(h.addClass("red-ui-diff-status-changed"),$('<span class="red-ui-diff-status"><i class="fa fa-square"></i> <span data-i18n="diff.type.changed"></span></span>').appendTo(h)):i.newConfig.all[t.id].z!==t.z?h.addClass("red-ui-diff-empty"):(e.local.unchangedCount++,h.addClass("red-ui-diff-status-unchanged"),$('<span class="red-ui-diff-status"><i class="fa fa-square-o"></i> <span data-i18n="diff.type.unchanged"></span></span>').appendTo(h)),n&&(n.moved[t.id]?(l=n.newConfig.all[t.id],n.deleted[t.z]||t.z===l.z||""===t.z||n.newConfig.all[t.z]?(d.addClass("red-ui-diff-status-moved"),c="",c=t.z===l.z?RED._("diff.type.movedFrom",{id:n.currentConfig.all[t.id].z||"global"}):RED._("diff.type.movedTo",{id:l.z||"global"}),$('<span class="red-ui-diff-status"><i class="fa fa-caret-square-o-right"></i> '+c+"</span>").appendTo(d)):d.addClass("red-ui-diff-empty")):n.deleted[t.z]?d.addClass("red-ui-diff-empty"):n.deleted[t.id]?(d.addClass("red-ui-diff-status-deleted"),$('<span class="red-ui-diff-status"><i class="fa fa-minus-square"></i> <span data-i18n="diff.type.deleted"></span></span>').appendTo(d)):n.changed[t.id]?n.newConfig.all[t.id].z!==t.z?d.addClass("red-ui-diff-empty"):(d.addClass("red-ui-diff-status-changed"),$('<span class="red-ui-diff-status"><i class="fa fa-square"></i> <span data-i18n="diff.type.changed"></span></span>').appendTo(d)):n.newConfig.all[t.id].z!==t.z?d.addClass("red-ui-diff-empty"):(e.remote.unchangedCount++,d.addClass("red-ui-diff-status-unchanged"),$('<span class="red-ui-diff-status"><i class="fa fa-square-o"></i> <span data-i18n="diff.type.unchanged"></span></span>').appendTo(d))));var g,v={node:i.newConfig.all[t.id],all:i.newConfig.all,diff:i};n&&(g={node:n.newConfig.all[t.id]||null,all:n.newConfig.all,diff:n});n="";return a?(e.conflicts++,h.hasClass("red-ui-diff-empty")||$('<span class="red-ui-diff-status-conflict"><span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span></span>').prependTo(h),d.hasClass("red-ui-diff-empty")||$('<span class="red-ui-diff-status-conflict"><span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span></span>').prependTo(d),p.addClass("red-ui-diff-list-node-conflict")):n=o.resolutions[t.id],_(t,p,h,d,!1,!a,n,o),u.on("click",function(e){$(this).parent().toggleClass("collapsed"),0===$(this).siblings(".red-ui-diff-list-node-properties").length&&k(s,t,v,g).appendTo(p)}),p}function k(t,i,n,a){var r,s={},d=n.node;a&&(r=a.node);var e=$("<div>",{class:"red-ui-diff-list-node-properties"}),o=$("<table>").appendTo(e),l=$("<colgroup><col/><col/></colgroup>").appendTo(o);void 0!==r&&$("<col/>").appendTo(l);var c,p,u,f,h,g,v=$("<tbody>").appendTo(o),m=!1,b=!1,y=!1,w=$("<tr>").appendTo(v);$("<td>",{class:"red-ui-diff-list-cell-label"}).text("id").appendTo(w),c=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-local"}).appendTo(w),d?(c.addClass("red-ui-diff-status-unchanged"),$('<span class="red-ui-diff-status"></span>').appendTo(c),h=$('<span class="red-ui-diff-list-element"></span>').appendTo(c),s["local.id"]=RED.utils.createObjectElement(d.id).appendTo(h)):c.addClass("red-ui-diff-empty"),void 0!==r&&((g=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-remote"}).appendTo(w)).addClass("red-ui-diff-status-unchanged"),r?($('<span class="red-ui-diff-status"></span>').appendTo(g),h=$('<span class="red-ui-diff-list-element"></span>').appendTo(g),s["remote.id"]=RED.utils.createObjectElement(r.id).appendTo(h)):g.addClass("red-ui-diff-empty")),i.hasOwnProperty("x")&&(d&&(d.x===i.x&&d.y===i.y&&d.w===i.w&&d.h===i.h||(m=!0)),r&&(r.x===i.x&&r.y===i.y&&r.w===i.w&&r.h===i.h||(b=!0)),(b&&m&&(d.x!==r.x||d.y!==r.y)||!m&&b&&n.diff.deleted[i.id]||m&&!b&&a.diff.deleted[i.id])&&(y=!0),w=$("<tr>").appendTo(v),$("<td>",{class:"red-ui-diff-list-cell-label"}).text("position").appendTo(w),c=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-local"}).appendTo(w),d?(c.addClass("red-ui-diff-status-"+(m?"changed":"unchanged")),$('<span class="red-ui-diff-status">'+(m?'<i class="fa fa-square"></i>':"")+"</span>").appendTo(c),h=$('<span class="red-ui-diff-list-element"></span>').appendTo(c),o={x:d.x,y:d.y},d.hasOwnProperty("w")&&(o.w=d.w,o.h=d.h),s["local.position"]=RED.utils.createObjectElement(o,{path:"position",exposeApi:!0,ontoggle:function(e,t){s["remote."+e]&&s["remote."+e].prop("expand")(e,t)}}).appendTo(h)):c.addClass("red-ui-diff-empty"),void 0!==r&&((g=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-remote"}).appendTo(w)).addClass("red-ui-diff-status-"+(b?"changed":"unchanged")),r?($('<span class="red-ui-diff-status">'+(b?'<i class="fa fa-square"></i>':"")+"</span>").appendTo(g),h=$('<span class="red-ui-diff-list-element"></span>').appendTo(g),E={x:r.x,y:r.y},r.hasOwnProperty("w")&&(E.w=r.w,E.h=r.h),s["remote.position"]=RED.utils.createObjectElement(E,{path:"position",exposeApi:!0,ontoggle:function(e,t){s["local."+e]&&s["local."+e].prop("expand")(e,t)}}).appendTo(h)):g.addClass("red-ui-diff-empty"))),m=b=y=!1,i.hasOwnProperty("wires")&&(p=JSON.stringify(i.wires),d&&(u=JSON.stringify(d.wires),p!==u&&(m=!0)),r&&(f=JSON.stringify(r.wires),p!==f&&(b=!0)),(b&&m&&u!==f||!m&&b&&n.diff.deleted[i.id]||m&&!b&&a.diff.deleted[i.id])&&(y=!0),w=$("<tr>").appendTo(v),$("<td>",{class:"red-ui-diff-list-cell-label"}).text("wires").appendTo(w),c=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-local"}).appendTo(w),d?(y?(c.addClass("red-ui-diff-status-conflict"),$('<span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span>').appendTo(c)):(c.addClass("red-ui-diff-status-"+(m?"changed":"unchanged")),$('<span class="red-ui-diff-status">'+(m?'<i class="fa fa-square"></i>':"")+"</span>").appendTo(c)),D(d.wires,n.all).appendTo(c)):c.addClass("red-ui-diff-empty"),void 0!==r&&(g=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-remote"}).appendTo(w),r?(y?(g.addClass("red-ui-diff-status-conflict"),$('<span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span>').appendTo(g)):(g.addClass("red-ui-diff-status-"+(b?"changed":"unchanged")),$('<span class="red-ui-diff-status">'+(b?'<i class="fa fa-square"></i>':"")+"</span>").appendTo(g)),D(r.wires,a.all).appendTo(g)):g.addClass("red-ui-diff-empty")));var E=Object.keys(i).filter(function(e){return!("inputLabels"==e||"outputLabels"==e||"z"==e||"wires"==e||"x"===e||"y"===e||"w"===e||"h"===e||"id"===e||"type"===e||t.defaults&&t.defaults.hasOwnProperty(e))});return t.defaults&&(E=E.concat(Object.keys(t.defaults))),"tab"!==i.type&&"group"!==i.type&&(E=E.concat(["inputLabels","outputLabels"])),(d&&d.hasOwnProperty("icon")||r&&r.hasOwnProperty("icon"))&&-1===E.indexOf("icon")&&E.unshift("icon"),E.forEach(function(o){y=b=m=!1,p=JSON.stringify(i[o]),d&&(u=JSON.stringify(d[o]),p!==u&&(m=!0,0)),r&&(f=JSON.stringify(r[o]),p!==f&&(b=!0,0)),(b&&m&&u!==f||!m&&b&&n.diff.deleted[i.id]||m&&!b&&a.diff.deleted[i.id])&&(y=!0),w=$("<tr>").appendTo(v);var e=$("<td>",{class:"red-ui-diff-list-cell-label"}).text(o).appendTo(w);c=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-local"}).appendTo(w),d?(y?(c.addClass("red-ui-diff-status-conflict"),$('<span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span>').appendTo(c)):(c.addClass("red-ui-diff-status-"+(m?"changed":"unchanged")),$('<span class="red-ui-diff-status">'+(m?'<i class="fa fa-square"></i>':"")+"</span>").appendTo(c)),h=$('<span class="red-ui-diff-list-element"></span>').appendTo(c),s["local."+o]=RED.utils.createObjectElement(d[o],{path:o,exposeApi:!0,ontoggle:function(e,t){s["remote."+o]&&s["remote."+o].prop("expand")(e,t)}}).appendTo(h)):c.addClass("red-ui-diff-empty"),void 0!==r&&(g=$("<td>",{class:"red-ui-diff-list-cell red-ui-diff-list-node-remote"}).appendTo(w),r?(y?(g.addClass("red-ui-diff-status-conflict"),$('<span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span>').appendTo(g)):(g.addClass("red-ui-diff-status-"+(b?"changed":"unchanged")),$('<span class="red-ui-diff-status">'+(b?'<i class="fa fa-square"></i>':"")+"</span>").appendTo(g)),h=$('<span class="red-ui-diff-list-element"></span>').appendTo(g),s["remote."+o]=RED.utils.createObjectElement(r[o],{path:o,exposeApi:!0,ontoggle:function(e,t){s["local."+o]&&s["local."+o].prop("expand")(e,t)}}).appendTo(h)):g.addClass("red-ui-diff-empty")),d&&r&&"string"==typeof d[o]&&(/\n/.test(d[o])||/\n/.test(r[o]))&&$('<button class="red-ui-button red-ui-button-small red-ui-diff-text-diff-button"><i class="fa fa-file-o"> <i class="fa fa-caret-left"></i> <i class="fa fa-caret-right"></i> <i class="fa fa-file-o"></i></button>').on("click",function(){C(d[o],r[o])}).appendTo(e)}),e}function _(o,i,e,t,n,a,r,s){var d="red-ui-diff-selectbox-"+o.id.replace(/\./g,"-")+(n?"-props":""),l="";(o.z||n)&&(l="red-ui-diff-selectbox-tab-"+(n?o.id:o.z).replace(/\./g,"-"));function c(e){var t;void 0===o.type||(p?(t="red-ui-diff-selectbox-tab-"+o.id.replace(/\./g,"-"),$("."+t+"-"+this.value).prop("checked",!0),"local"===this.value?($("."+t+"-"+this.value).closest(".red-ui-diff-list-node").addClass("red-ui-diff-select-local"),$("."+t+"-"+this.value).closest(".red-ui-diff-list-node").removeClass("red-ui-diff-select-remote")):($("."+t+"-"+this.value).closest(".red-ui-diff-list-node").removeClass("red-ui-diff-select-local"),$("."+t+"-"+this.value).closest(".red-ui-diff-list-node").addClass("red-ui-diff-select-remote"))):(t="red-ui-diff-selectbox-"+(n?o.id:o.z).replace(/\./g,"-"),$("#"+t+"-local").prop("checked",!1),$("#"+t+"-remote").prop("checked",!1),(t=$("#"+t+"-local").closest(".red-ui-diff-list-flow").find(".red-ui-diff-list-flow-title")).removeClass("red-ui-diff-select-local"),t.removeClass("red-ui-diff-select-remote"))),"local"===this.value?(i.removeClass("red-ui-diff-select-remote"),i.addClass("red-ui-diff-select-local")):"remote"===this.value&&(i.addClass("red-ui-diff-select-remote"),i.removeClass("red-ui-diff-select-local")),w(s)}var p=!n&&("tab"===o.type||"subflow"===o.type),u=$("<label>",{class:"red-ui-diff-selectbox",for:d+"-local"}).on("click",function(e){e.stopPropagation()}).appendTo(e),f=$("<input>",{class:"red-ui-diff-selectbox-input "+l+"-local",id:d+"-local",type:"radio",value:"local",name:d}).data("node-id",o.id).on("change",c).appendTo(u),h=$("<label>",{class:"red-ui-diff-selectbox",for:d+"-remote"}).on("click",function(e){e.stopPropagation()}).appendTo(t),d=$("<input>",{class:"red-ui-diff-selectbox-input "+l+"-remote",id:d+"-remote",type:"radio",value:"remote",name:d}).data("node-id",o.id).on("change",c).appendTo(h);"local"===r?f.prop("checked",!0):"remote"===r&&d.prop("checked",!0),(a||e.hasClass("red-ui-diff-empty")||t.hasClass("red-ui-diff-empty"))&&(u.hide(),h.hide())}function w(e){var t=0;$(".red-ui-diff-selectbox>input:checked").each(function(){e.conflicts[$(this).data("node-id")]&&t++,e.resolutions[$(this).data("node-id")]=$(this).val()});var o=Object.keys(e.conflicts).length;o-t==0?$("#red-ui-diff-dialog-toolbar-resolved-conflicts").html('<span class="red-ui-diff-status-added"><span class="red-ui-diff-status"><i class="fa fa-check"></i></span></span> '+RED._("diff.unresolvedCount",{count:o-t})):$("#red-ui-diff-dialog-toolbar-resolved-conflicts").html('<span class="red-ui-diff-status-conflict"><span class="red-ui-diff-status"><i class="fa fa-exclamation"></i></span></span> '+RED._("diff.unresolvedCount",{count:o-t})),o===t&&($("#red-ui-diff-view-diff-merge").removeClass("disabled"),$("#red-ui-diff-view-resolve-diff").removeClass("disabled"))}function t(n){$.ajax({headers:{Accept:"application/json"},cache:!1,url:"flows",success:function(e){var t=RED.nodes.createCompleteNodeSet(),o=RED.nodes.originalFlow(),i=e.flows,t=E(o,t),i=E(o,i);i.rev=e.rev,n(T(t,i))}})}function s(e){var o,i,n,a;void 0===e?t(s):(o=e,i={mode:"merge"},r||(i=i||{},o.localDiff,n=o.remoteDiff,a=o.conflicts,e={title:i.title||RED._("diff.reviewChanges"),width:1/0,overlay:!0,buttons:[{text:RED._("merge"===i.mode?"common.label.cancel":"common.label.close"),click:function(){RED.tray.close()}}],resize:function(e){},open:function(e){var e=e.find(".red-ui-tray-body"),t=($('<div class="red-ui-diff-dialog-toolbar"><span><span id="red-ui-diff-dialog-toolbar-resolved-conflicts"></span></span> </div>').prependTo(e),u($('<div class="red-ui-diff-container"></div>').appendTo(e),o,i));t.list.hide(),n?($("#red-ui-diff-view-diff-merge").show(),0===Object.keys(a).length?$("#red-ui-diff-view-diff-merge").removeClass("disabled"):$("#red-ui-diff-view-diff-merge").addClass("disabled")):$("#red-ui-diff-view-diff-merge").hide(),w(o),setTimeout(function(){t.finish(),t.list.show()},300),$("#red-ui-sidebar-shade").show()},close:function(){r=!1,$("#red-ui-sidebar-shade").hide()},show:function(){}},"merge"===i.mode&&e.buttons.push({id:"red-ui-diff-view-diff-merge",text:RED._("deploy.confirm.button.merge"),class:"primary disabled",click:function(){$("#red-ui-diff-view-diff-merge").hasClass("disabled")||(w(o),c(o),RED.tray.close())}}),RED.tray.show(e)))}function d(e){var t=[],o={},i={},n=[],a={};return e.forEach(function(e){"tab"===(a[e.id]=e).type?(t.push(e.id),o[e.id]={n:e,nodes:[]}):"subflow"===e.type&&(i[e.id]={n:e,nodes:[]})}),e.forEach(function(e){"tab"!==e.type&&"subflow"!==e.type&&(o[e.z]?o[e.z].nodes:i[e.z]?i[e.z].nodes:n).push(e)}),{all:a,tabOrder:t,tabs:o,subflows:i,globals:n}}function E(e,t){var o=d(e),i=d(t),n={},a={},r={},s={};return Object.keys(o.all).forEach(function(e){RED.nodes.workspace(e)||RED.nodes.subflow(e)||RED.nodes.node(e);i.all.hasOwnProperty(e)?JSON.stringify(o.all[e])!==JSON.stringify(i.all[e])&&(r[e]=!0,o.all[e].z!==i.all[e].z&&(s[e]=!0)):a[e]=!0}),Object.keys(i.all).forEach(function(e){o.all.hasOwnProperty(e)||(n[e]=!0)}),{currentConfig:o,newConfig:i,added:n,deleted:a,changed:r,moved:s}}function T(e,t){var o,i,n,a,r={},s={},d={localDiff:e,remoteDiff:t,conflicts:r,resolutions:s},l={};for(o in e.currentConfig.all)e.currentConfig.all.hasOwnProperty(o)&&(l[o]=!0,n=e.newConfig.all[o],e.changed[o]&&t.deleted[o]||e.deleted[o]&&t.changed[o]?r[o]=!0:e.changed[o]&&t.changed[o]&&(a=t.newConfig.all[o],JSON.stringify(n)!==JSON.stringify(a)&&(r[o]=!0)),r[o]||(t.added[o]||t.changed[o]||t.deleted[o]?s[o]="remote":s[o]="local"));for(o in e.added)e.added.hasOwnProperty(o)&&(i=e.newConfig.all[o],t.deleted[i.z]?r[o]=!0:s[o]="local");for(o in t.added)t.added.hasOwnProperty(o)&&(i=t.newConfig.all[o],e.deleted[i.z]?r[o]=!0:s[o]="remote");return d}function l(e){e.localDiff.currentConfig;var t,o=e.localDiff,i=e.remoteDiff,n=e.conflicts,a=e.resolutions;for(t in n)if(n.hasOwnProperty(t)&&!a.hasOwnProperty(t))throw console.log(e),new Error("No resolution for conflict on node",t);var r,s=[],d={},l={};for(t in o.newConfig.all)o.newConfig.all.hasOwnProperty(t)&&(r=RED.nodes.node(t),"local"===a[t]?(r&&(d[t]=r.changed),s.push(o.newConfig.all[t])):"remote"===a[t]?!i.deleted[t]&&i.newConfig.all.hasOwnProperty(t)&&(r&&(d[t]=r.changed),l[t]=1,s.push(i.newConfig.all[t])):console.log("Unresolved",t));for(t in i.added)i.added.hasOwnProperty(t)&&((r=RED.nodes.node(t))&&(d[t]=r.changed),o.added.hasOwnProperty(t)||(l[t]=2,s.push(i.newConfig.all[t])));return{config:s,nodeChangedStates:d,localChangedStates:l}}function c(e){var t=RED.workspaces.active(),o=l(e),i=o.config,n=o.nodeChangedStates,a=o.localChangedStates,r=RED.nodes.dirty(),o={t:"replace",config:RED.nodes.createCompleteNodeSet(),changed:n,dirty:r,rev:RED.nodes.version()};RED.history.push(o);var s,d=RED.nodes.originalFlow();for(s in e.remoteDiff.added)e.remoteDiff.added.hasOwnProperty(s)&&e.remoteDiff.newConfig.all.hasOwnProperty(s)&&d.push(JSON.parse(JSON.stringify(e.remoteDiff.newConfig.all[s])));RED.nodes.clear();i=RED.nodes.import(i);RED.nodes.originalFlow(d),i.nodes.forEach(function(e){(n[e.id]||a[e.id])&&(e.changed=!0)}),RED.nodes.version(e.remoteDiff.rev),r&&RED.nodes.dirty(!0),RED.view.redraw(!0),RED.palette.refresh(),RED.workspaces.refresh(),RED.workspaces.show(t,!0),RED.sidebar.config.refresh()}function C(v,m){var e={title:RED._("diff.compareChanges"),width:1/0,overlay:!0,buttons:[{text:RED._("common.label.close"),click:function(){RED.tray.close()}}],resize:function(e){},open:function(e){e=e.find(".red-ui-tray-body"),e=$('<div class="red-ui-diff-text"></div>').appendTo(e),e=$("<table>",{class:"red-ui-diff-text-content"}).appendTo(e);$('<colgroup><col width="50"><col width="50%"><col width="50"><col width="50%"></colgroup>').appendTo(e);for(var t,o=$("<tbody>").appendTo(e),i=function(e,t,o){var i,n,a=e.split(/\r?\n/),r=t.split(/\r?\n/),s=a.length,d=r.length,l={a:[],b:[]},c=[];for(i=0;i<s+1;i++)for(c[i]=[],n=0;n<d+1;n++)c[i][n]=0;for(i=s-1;0<=i;i--)for(n=d-1;0<=n;n--)1!==y(a[i],r[n],o)?c[i][n]=c[i+1][n+1]+1:c[i][n]=Math.max(c[i+1][n],c[i][n+1]);n=i=0;for(;i<s&&n<d;){var p,u=y(a[i],r[n],o);1!==u?((p=0)===u?p=0:2==u&&(p=3),l.a.push({i:i+1,j:n+1,line:a[i],type:p}),l.b.push({i:n+1,j:i+1,line:r[n],type:p}),i++,n++):c[i+1][n]>=c[i][n+1]?(l.a.push({i:i+1,line:a[i],type:1}),i++):(l.b.push({i:n+1,line:r[n],type:4}),n++)}for(;i<s||n<d;)i==s?(l.b.push({i:n+1,line:r[n],type:4}),n++):n==d&&(l.a.push({i:i+1,line:a[i],type:1}),i++);return l}(v||"",m||""),n=0,a=0,r=Math.max(i.a.length,i.b.length),s=[],d=[],l=0,c=0,p=0;p<r;p++){i[p];var u=n<i.a.length?i.a[n]:{type:2,line:""},f=a<i.b.length?i.b[a]:{type:2,line:""};0===u.type&&0!==f.type?(u={type:2,line:""},a++):0===f.type&&0!==u.type?(f={type:2,line:""},n++):(n++,a++),s.push({a:u,b:f}),void 0===t?(t={start:p,end:p},c=(l=0)===u.type&&0===f.type?0:1):0===u.type&&0===f.type?0===c?(t.end=p,l++):1===c?(t.end=p,c=2,l=0):2===c&&(t.end=p,8===++l&&(t.end-=5,d.push(t),t={start:p-5,end:p-5},l=c=0)):(t.end=p,l++,0===c?(3<t.end&&(t.end-=3,t.empty=!0,d.push(t),t={start:p-3,end:p-3}),c=1):2===c&&(c=1))}0===c&&(t.empty=!0),t.end=r,d.push(t),console.table(d);for(var h=0;h<d.length;h++)if((t=d[h]).empty)(function(i,n,a){diffRow=$('<tr class="red-ui-diff-text-header red-ui-diff-text-expand">');var e=$('<td colspan="4"> <i class="fa fa-arrows-v"></i> </td>').appendTo(diffRow),r=$("<span></span>").appendTo(e);n<a.length-1&&r.text("@@ -"+(a[n-1].a.i+1)+" +"+(a[n-1].b.i+1));return diffRow.on("click",function(e){if(20<n-i){var t=$(this).offset();if(0<i){for(var o=i;o<i+10;o++)b(a[o]).addClass("unchanged").insertBefore($(this));i+=10}if(n<a.length-1){for(o=n-1;n-11<o;o--)b(a[o]).addClass("unchanged").insertAfter($(this));n-=10}n<a.length-1&&r.text("@@ -"+(a[n-1].a.i+1)+" +"+(a[n-1].b.i+1));t=$(this).offset().top-t.top;$(".red-ui-diff-text").scrollTop($(".red-ui-diff-text").scrollTop()+t)}else{for(o=i;o<n;o++)b(a[o]).addClass("unchanged").insertBefore($(this));$(this).remove()}}),diffRow})(t.start,t.end,s).appendTo(o);else for(p=t.start;p<t.end;p++){var g=b(s[p]).appendTo(o);p===t.start?g.addClass("start-block"):p===t.end-1&&g.addClass("end-block")}},close:function(){r=!1},show:function(){}};RED.tray.show(e)}function b(e){var t=$("<tr>"),o=e.a,i=e.b,n=$('<td class="lineno">').text(2===o.type?"":o.i).appendTo(t),e=$('<td class="linetext">').text(o.line).appendTo(t);return 2===o.type?(n.addClass("blank"),e.addClass("blank")):4===o.type?(n.addClass("added"),e.addClass("added")):1===o.type&&(n.addClass("removed"),e.addClass("removed")),n=$('<td class="lineno">').text(2===i.type?"":i.i).appendTo(t),e=$('<td class="linetext">').text(i.line).appendTo(t),2===i.type?(n.addClass("blank"),e.addClass("blank")):4===i.type?(n.addClass("added"),e.addClass("added")):1===i.type&&(n.addClass("removed"),e.addClass("removed")),t}function y(e,t,o){return o?e===t?0:e.trim()===t.trime()?2:1:e===t?0:1}function a(e,y){var p=$("<div></div>");return e.forEach(function(f){var e=f.hunks,t=f.binary,o=$("<table>",{class:"red-ui-diff-text-content"}).appendTo(p);$('<colgroup><col width="50"><col width="50"><col width="100%"></colgroup>').appendTo(o);var h=$("<tbody>").appendTo(o),i=$('<tr class="red-ui-diff-text-file-header">').appendTo(h),n=$('<td colspan="3"></td>').appendTo(i);$('<i class="red-ui-diff-list-chevron fa fa-angle-down"></i>').appendTo(n);i.on("click",function(e){i.toggleClass("collapsed");var t=i.hasClass("collapsed");i.nextUntil(".red-ui-diff-text-file-header").toggle(!t)});$('<span class="filename"></span>').text(f.file).appendTo(n);var g,s,d,l,a,r,c,v=0,m=0,b={};y.project.files&&y.project.files.flow===f.file?(y.unmerged&&$('<span style="float: right;"><span id="red-ui-diff-dialog-toolbar-resolved-conflicts"></span></span>').appendTo(n),a=$('<tr class="red-ui-diff-text-header">').appendTo(h),s=$('<td class="red-ui-diff-flow-diff" colspan="3"></td>').appendTo(a),o=y.project.name,d=y.project.files.flow,c="projects/"+o+"/files/"+y.commonRev+"/"+d,l="projects/"+o+"/files/"+y.oldRev+"/"+d,a="projects/"+o+"/files/"+y.newRev+"/"+d,r=[$.Deferred(),$.Deferred(),$.Deferred()],y.commonRev?(c="projects/"+o+"/files/"+y.commonRev+"/"+d,$.ajax({dataType:"json",url:c}).then(function(e){r[0].resolve(e)}).fail(function(){r[0].resolve(null)})):r[0].resolve(null),$.ajax({dataType:"json",url:l}).then(function(e){r[1].resolve(e)}).fail(function(){r[1].resolve({content:"[]"})}),$.ajax({dataType:"json",url:a}).then(function(e){r[2].resolve(e)}).fail(function(){r[2].resolve({content:"[]"})}),$.when.apply($,r).always(function(e,t,o){var i;if(e)try{i=JSON.parse(e.content||"[]")}catch(e){return console.log(RED._("diff.commonVersionError"),c),void console.log(e)}try{n=JSON.parse(t.content||"[]")}catch(e){return console.log(RED._("diff.oldVersionError"),l),void console.log(e)}i=i||n;try{a=JSON.parse(o.content||"[]")}catch(e){return console.log(RED._("diff.newVersionError"),a),void console.log(e)}var n=E(i,n),a=E(i,a);y.currentDiff=T(n,a);var r=u(s,y.currentDiff,{title:d,mode:y.commonRev?"merge":"view",oldRevTitle:y.oldRevTitle,newRevTitle:y.newRevTitle});r.list.hide(),w(y.currentDiff),setTimeout(function(){r.finish(),r.list.show()},300)})):t?(t=$('<tr class="red-ui-diff-text-header">').appendTo(h),t=$('<td colspan="3"></td>').appendTo(t),$("<span></span>").text(RED._("diff.noBinaryFileShowed")).appendTo(t)):(y.unmerged&&(g=$('<span style="float: right;">'+RED._("diff.conflictHeader",{resolved:m,unresolved:v})+"</span>").appendTo(n)),e.forEach(function(l){var e=$('<tr class="red-ui-diff-text-header">').appendTo(h),e=$('<td colspan="3"></td>').appendTo(e),c=($("<span></span>").text(l.header).appendTo(e),l.conflict),p=l.localStartLine,u=l.remoteStartLine;c&&v++,l.lines.forEach(function(e,t){var o,i=l.diffStart+t,n=c&&/^\+\+(<<<<<<<|=======$|>>>>>>>)/.test(e),a=$("<tr>").appendTo(h),r=$('<td class="lineno">').appendTo(a);n?r.attr("colspan",2):o=$('<td class="lineno">').appendTo(a);var s,d=$('<td class="linetext">').appendTo(a),t=c?2:1;n?(a.addClass("mergeHeader"),/^\+\+=======$/.test(e)?(l.changeSeparator=i,a.addClass("mergeHeader-separator")):((s=/^..<<<<<<</.test(e))?($("<span>").text("<<<<<<< Local Changes").appendTo(d),l.localChangeStart=i):(l.remoteChangeEnd=i,$("<span>").text(">>>>>>> Remote Changes").appendTo(d)),a.addClass("mergeHeader-"+(s?"ours":"theirs")),$('<button class="red-ui-button red-ui-button-small" style="float: right; margin-right: 20px;"><i class="fa fa-angle-double-'+(s?"down":"up")+'"></i> use '+(s?"local":"remote")+" changes</button>").appendTo(d).on("click",function(e){var t,o;e.preventDefault(),m++,s?((o=(t=a.nextUntil(".mergeHeader-separator")).last().next()).nextUntil(".mergeHeader").remove(),o.next().remove()):((o=(t=a.prevUntil(".mergeHeader-separator")).last().prev()).prevUntil(".mergeHeader").remove(),o.prev().remove()),o.remove(),a.remove(),t.find(".linetext").addClass("added"),g.empty(),$("<span>"+RED._("diff.conflictHeader",{resolved:m,unresolved:v})+"</span>").appendTo(g),b[f.file]=b[f.file]||{},b[f.file][l.localChangeStart]={changeStart:l.localChangeStart,separator:l.changeSeparator,changeEnd:l.remoteChangeEnd,selection:s?"A":"B"},y.resolveConflict&&y.resolveConflict({conflicts:v,resolved:m,resolutions:b})}))):(i=e[0],c&&!y.unmerged&&" "===i&&(i=e[1]),$('<span class="prefix">').text(i).appendTo(d),i=!1,c&&y.unmerged?($('<span class="prefix">').text(e[1]).appendTo(d),"+"===e[0]&&(r.text(p++),i=!0),"+"===e[1]&&(o.text(u++),i=!0)):"+"===e[0]||c&&"+"===e[1]?(r.addClass("added"),o.addClass("added"),d.addClass("added"),o.text(u++),i=!0):("-"===e[0]||c&&"-"===e[1])&&(r.addClass("removed"),o.addClass("removed"),d.addClass("removed"),r.text(p++),i=!0),i||(d.addClass("unchanged"),0<p&&"\\"!==e[0]&&""!==e&&r.text(p++),0<u&&"\\"!==e[0]&&""!==e&&o.text(u++)),$("<span>").text(e.substring(t)).appendTo(d))})}))}),p}function p(e){for(var t,o,i=Array.isArray(e)?e:e.split("\n"),n=/^diff (?:(?:--git a\/(.*) b\/(.*))|(?:--cc (.*)))$/,a=/^\+\+\+ b\/(.*)\t?/,r=/^Binary files /,s=/^@@ -((\d+)(,(\d+))?) \+((\d+)(,(\d+))?) @@ ?(.*)$/,d=/^@+ -((\d+)(,(\d+))?) -((\d+)(,(\d+))?) \+((\d+)(,(\d+))?) @+/,l=[],c=0;c<i.length;c++){var p=i[c],u=n.exec(p);u?(o&&(t.hunks.push(o),l.push(t)),o=null,t={file:u[1]||u[3],hunks:[]}):r.test(p)?t&&(t.binary=!0):(u=a.exec(p))?t.file=u[1]:(u=s.exec(p))?(o&&t.hunks.push(o),o={header:p,localStartLine:u[2],localLength:u[4]||1,remoteStartLine:u[6],remoteLength:u[8]||1,lines:[],conflict:!1}):(u=d.exec(p))?(o&&t.hunks.push(o),o={header:p,localStartLine:u[2],localLength:u[4]||1,remoteStartLine:u[6],remoteLength:u[8]||1,diffStart:parseInt(u[10]),lines:[],conflict:!0}):o&&o.lines.push(p)}return o&&t.hunks.push(o),l.push(t),l}return{init:function(){RED.actions.add("core:show-remote-diff",s)},getRemoteDiff:t,showRemoteDiff:s,showUnifiedDiff:function(t){var o,e=t.diff,i=t.title,n=p(e);t.unmerged&&(t.resolveConflict=function(e){(o=e).conflicts===e.resolved&&$("#red-ui-diff-view-resolve-diff").removeClass("disabled")}),i={title:i||RED._("diff.compareChanges"),width:1/0,overlay:!0,buttons:[{text:RED._(t.unmerged?"common.label.cancel":"common.label.close"),click:function(){t.oncancel&&t.oncancel(),RED.tray.close()}}],resize:function(e){},open:function(e){e=e.find(".red-ui-tray-body"),e=$('<div class="red-ui-diff-text"></div>').appendTo(e);a(n,t).appendTo(e)},close:function(){r=!1},show:function(){}},t.unmerged&&i.buttons.push({id:"red-ui-diff-view-resolve-diff",text:RED._("diff.saveConflict"),class:"primary disabled",click:function(){var e;$("#red-ui-diff-view-resolve-diff").hasClass("disabled")||(t.currentDiff&&(e=l(t.currentDiff),(o={resolutions:{}}).resolutions[t.project.files.flow]=JSON.stringify(e.config,"",4)),t.onresolve&&t.onresolve(o),RED.tray.close())}}),RED.tray.show(i)},showCommitDiff:function(o){var i=function(e){for(var t={},o=e.split("\n"),i=[],n=0;n<o.length;n++)if(/^commit /.test(o[n]))t.sha=o[n].substring(7);else if(/^Author: /.test(o[n])){t.author=o[n].substring(8);var a=/^(.*) <(.*)>$/.exec(t.author);a&&(t.authorName=a[1],t.authorEmail=a[2])}else if(/^Date: /.test(o[n]))t.date=o[n].substring(8);else if(/^    /.test(o[n]))t.title?(4!==o[n].length||0<i.length)&&i.push(o[n].substring(4)):t.title=o[n].substring(4);else if(/^diff /.test(o[n])){t.files=p(o.slice(n));break}return t.comment=i.join("\n"),t}(o.commit),e={title:RED._("diff.viewCommitDiff"),width:1/0,overlay:!0,buttons:[{text:RED._("common.label.close"),click:function(){RED.tray.close()}}],resize:function(e){},open:function(e){var t=e.find(".red-ui-tray-body"),e=$('<div class="red-ui-diff-text"></div>').appendTo(t),t=$("<table>",{class:"red-ui-diff-text-content"}).appendTo(e);$('<colgroup><col width="50"><col width="50"><col width="100%"></colgroup>').appendTo(t);t=$("<tbody>").appendTo(t),t=$('<tr class="red-ui-diff-text-commit-header">').appendTo(t),t=$('<td colspan="3"></td>').appendTo(t);$("<h3>").text(i.title).appendTo(t),$('<div class="commit-body"></div>').text(i.comment).appendTo(t);t=$('<div class="commit-summary"></div>').appendTo(t);$('<div style="float: right">').text("Commit "+i.sha).appendTo(t),$("<div>").text((i.authorName||i.author)+" - "+o.date).appendTo(t),i.files&&a(i.files,o).appendTo(e)},close:function(){r=!1},show:function(){}};RED.tray.show(e)},mergeDiff:c}}(),RED.keyboard=function(){var d,l,n=/Mac/i.test(window.navigator.platform),t=!0,p={},a={left:37,up:38,right:39,down:40,escape:27,enter:13,backspace:8,delete:46,space:32,";":186,"=":187,"+":187,",":188,"-":189,".":190,"/":191,"\\":220,"'":222,"?":191,"[":219,"]":221,"{":219,"}":221},o={16:!0,17:!0,18:!0,91:!0,93:!0},u={},f={},c={59:186,61:187,173:189};function h(e){return RED.settings.get("editor.keymap",{})[e]}function g(e){for(var t,o=e.toLowerCase().split("-"),i={},n=0;n<o.length;n++)switch(o[n]){case"ctrl":case"cmd":i.ctrl=!0,i.meta=!0;break;case"alt":i.alt=!0;break;case"shift":i.shift=!0;break;case"":t=a["-"];break;default:if(a.hasOwnProperty(o[n]))t=a[o[n]];else{if(1<o[n].length)return null;t=o[n].toUpperCase().charCodeAt(0)}}return[t,i]}function v(e){var t=l||p;(t=(t=(e.ctrlKey||e.metaKey)&&e.ctrlKey!==e.metaKey?t.ctrl:t)&&e.shiftKey?t.shift:t)&&e.altKey&&(t=t.alt);var o=c[e.keyCode]||e.keyCode;if(t&&t[o]){var i=t[o];if(!i.handlers)return l?(l=null,v(e)):(0<Object.keys(i).length&&(l=i,e.preventDefault()),null);for(var n,a=1/0,r=0,s=i.handlers.length,r=0;r<s;r++){var d=function(e,t){for(var o=e.target,i=0;"BODY"!==o.nodeName&&o.id!==t.scope;)o=o.parentElement,i++;return i="BODY"===o.nodeName&&"*"!==t.scope?-1:i}(e,i.handlers[r]);-1<d&&d<a&&(a=d,n=i.handlers[r])}return l=null,i=n}if(l)return l=null,v(e)}function s(e,t,o,i){var n=o,a=i;"function"!=typeof o&&"string"!=typeof o||(n={},a=o);var r=[],s=0;if("string"==typeof t){if("string"==typeof a){if(i||f.hasOwnProperty(a)||(f[a]={scope:e,key:t,user:!1}),!i)if(h(a))return;u[a]={scope:e,key:t},"boolean"==typeof i&&(u[a].user=i)}for(var d=t.split(" "),s=0;s<d.length;s++){var l=g(d[s]);if(!l)return;r.push(l)}}else r.push([t,n]);var c=p;for(s=0;s<r.length;s++)t=r[s][0],(n=r[s][1]).ctrl&&(c.ctrl=c.ctrl||{},c=c.ctrl),n.shift&&(c.shift=c.shift||{},c=c.shift),n.alt&&(c.alt=c.alt||{},c=c.alt),c[t]=c[t]||{},c=c[t];c.handlers=c.handlers||[],c.handlers.push({scope:e,ondown:a}),c.scope=e,c.ondown=a}function r(e,t){var o=t||{},i=[],n=0;if("string"==typeof e)for(var a=e.split(" "),n=0;n<a.length;n++){var r=g(a[n]);if(!r)return void console.log("Unrecognised key specifier:",e);i.push(r)}else i.push([e,o]);var s=p;for(n=0;n<i.length;n++){if(e=i[n][0],!(s=(s=(s=(o=i[n][1]).ctrl?s.ctrl:s)&&o.shift?s.shift:s)&&o.alt?s.alt:s)[e])return;s=s[e]}"string"==typeof s.ondown&&("boolean"==typeof t&&t?u[s.ondown]={user:t}:delete u[s.ondown]),delete s.scope,delete s.ondown,delete s.handlers}d3.select(window).on("keydown",function(){var e;t&&(o[d3.event.keyCode]||(e=v(d3.event))&&e.ondown&&("string"==typeof e.ondown?RED.actions.invoke(e.ondown):e.ondown(),d3.event.preventDefault()))});function m(e){e.preventDefault();var t,o,i,n,a=$(this),r=a.data("data");a.hasClass("keyboard-shortcut-entry-expanded")||(b(),t=a.find(".keyboard-shortcut-entry-key"),e=a.find(".keyboard-shortcut-entry-scope"),a.addClass("keyboard-shortcut-entry-expanded"),(o=$('<input type="text">').attr("placeholder",RED._("keyboard.unassigned")).val(r.key||"").appendTo(t)).on("change paste keyup",function(e){if(13===e.keyCode&&!$(this).hasClass("input-error"))return b();if(27===e.keyCode)return b(!0);var t=$(this).val(),e=""===(t=t.trim())||RED.keyboard.validateKey(t);e&&""!==t&&(e=!d.has(i.val()+":"+t.toLowerCase())),$(this).toggleClass("input-error",!e),n.attr("disabled",!e)}),(i=$('<select><option value="*" data-i18n="keyboard.global"></option><option value="red-ui-workspace" data-i18n="keyboard.workspace"></option></select>').appendTo(e)).i18n(),"workspace"===r.scope&&(r.scope="red-ui-workspace"),i.val(r.scope||"*"),i.on("change",function(){o.trigger("change")}),e=$('<div class="keyboard-shortcut-edit button-group-vertical"></div>').appendTo(e),n=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-check"></i></button>').appendTo(e),e=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-reply"></i></button>').appendTo(e),n.on("click",function(e){e.stopPropagation(),b()}),e.on("click",function(e){e.stopPropagation(),a.empty(),a.removeClass("keyboard-shortcut-entry-expanded");e=RED.settings.get("editor.keymap",{});e[r.id]=null,RED.settings.set("editor.keymap",e),RED.keyboard.revertToDefault(r.id);e=RED.keyboard.getShortcut(r.id),e={id:r.id,scope:e?e.scope:void 0,key:e?e.key:void 0,user:e?e.user:void 0};y(a,e)}),o.trigger("focus"))}function b(e){var t,o,i,n,a,r,s=$(".keyboard-shortcut-entry-expanded");1===s.length&&(t=s.data("data"),o=s.find(".keyboard-shortcut-entry-key input"),i=s.find(".keyboard-shortcut-entry-scope select"),e||(a=o.val().trim(),r=i.val(),!(""===a||RED.keyboard.validateKey(a))||(!(n=RED.keyboard.getShortcut(t.id))&&a||n&&(n.scope!==r||n.key!==a))&&(e=s.find(".keyboard-shortcut-entry-key"),n=s.find(".keyboard-shortcut-entry-scope"),e.empty(),n.empty(),t.key&&(d.delete(t.scope+":"+t.key),RED.keyboard.remove(t.key,!0)),s.find(".keyboard-shortcut-entry-text i").css("opacity",1),""===a?(e.parent().addClass("keyboard-shortcut-entry-unassigned"),e.append($("<span>").text(RED._("keyboard.unassigned"))),delete t.key,delete t.scope):(e.parent().removeClass("keyboard-shortcut-entry-unassigned"),e.append(RED.keyboard.formatKey(a)),$("<span>").text(r).appendTo(n),t.key=a,t.scope=r,d.add(t.scope+":"+t.key),RED.keyboard.add(t.scope,t.key,t.id,!0)),a=RED.settings.get("editor.keymap",{}),r=RED.keyboard.getShortcut(t.id),a[t.id]={scope:r.scope,key:r.key},RED.settings.set("editor.keymap",a))),o.remove(),i.remove(),$(".keyboard-shortcut-edit").remove(),s.removeClass("keyboard-shortcut-entry-expanded"))}function y(e,t){var o=$('<div class="keyboard-shortcut-entry">').appendTo(e);e.data("data",t);var i=t.id.replace(/(^.+:([a-z]))|(-([a-z]))/g,function(){return 0===arguments[5]?arguments[2].toUpperCase():" "+arguments[4].toUpperCase()}),i=$("<div>").addClass("keyboard-shortcut-entry-text").text(i).appendTo(o),i=$('<i class="fa fa-user"></i>').prependTo(i);t.user||i.css("opacity",0);i=$('<div class="keyboard-shortcut-entry-key">').appendTo(o);t.key?i.append(RED.keyboard.formatKey(t.key)):(o.addClass("keyboard-shortcut-entry-unassigned"),i.append($("<span>").text(RED._("keyboard.unassigned"))));o=$('<div class="keyboard-shortcut-entry-scope">').appendTo(o);$("<span>").text("*"===t.scope?"global":t.scope||"").appendTo(o),e.on("click",m)}function w(){var e=$('<div id="red-ui-settings-tab-keyboard"></div>');$('<div class="keyboard-shortcut-entry keyboard-shortcut-list-header"><div class="keyboard-shortcut-entry-key keyboard-shortcut-entry-text"><input autocomplete="off" name="keyboard-filter" id="red-ui-settings-tab-keyboard-filter" type="text" data-i18n="[placeholder]keyboard.filterActions"></div><div class="keyboard-shortcut-entry-key" data-i18n="keyboard.shortcut"></div><div class="keyboard-shortcut-entry-scope" data-i18n="keyboard.scope"></div></div>').appendTo(e),e.find("#red-ui-settings-tab-keyboard-filter").searchBox({delay:100,change:function(){var t=$(this).val().trim();""===t?o.editableList("filter",null):(t=t.replace(/\s/g,""),o.editableList("filter",function(e){return-1<e.id.toLowerCase().replace(/^.*:/,"").replace("-","").indexOf(t)}))}});var o=$('<ol class="keyboard-shortcut-list"></ol>').css({position:"absolute",top:"32px",bottom:"0",left:"0",right:"0"}).appendTo(e).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,o){y(e,o)}}),t=RED.actions.list();return t.sort(function(e,t){e=e.id.replace(/^.*:/,"").replace(/[ -]/g,"").toLowerCase(),t=t.id.replace(/^.*:/,"").replace(/[ -]/g,"").toLowerCase();return e.localeCompare(t)}),d=new Set,t.forEach(function(e){e.key&&d.add(e.scope+":"+e.key),o.editableList("addItem",e)}),e}return{init:function(a){var e;"localStorage"in window&&null!==window.localStorage&&(null!==(e=localStorage.getItem("keymap"))&&(localStorage.removeItem("keymap"),RED.settings.set("editor.keymap",JSON.parse(e))));var r=RED.settings.get("editor.keymap",{});$.getJSON("red/keymap.json",function(e){var t,o,i,n=function(e,t){var o,i,n={};for(o in e)if(e.hasOwnProperty(o)){var a,r=e[o];for(a in r)r.hasOwnProperty(a)&&(n[r[a]]?n[r[a]].push({scope:o,key:a,user:!1}):n[r[a]]=[{scope:o,key:a,user:!1}])}for(i in t)t.hasOwnProperty(i)&&(t[i].key?(n[i]=[{scope:t[i].scope||"*",key:t[i].key,user:!1}],"workspace"===n[i][0].scope&&(n[i][0].scope="red-ui-workspace")):delete n[i]);return n}(e,RED.settings.theme("keymap",{}));for(t in n)n.hasOwnProperty(t)&&(r.hasOwnProperty(t)||n[t].forEach(function(e){s(e.scope,e.key,t,!1)}),f[t]=n[t][0]);for(t in r)r.hasOwnProperty(t)&&r[t]&&((o=r[t]).hasOwnProperty("key")&&s(i="workspace"===(i=o.scope)?"red-ui-workspace":i,o.key,t,!0));a()}),RED.userSettings.add({id:"keyboard",title:RED._("keyboard.keyboard"),get:w,focus:function(){setTimeout(function(){$("#red-ui-settings-tab-keyboard-filter").trigger("focus")},200)},close:function(){RED.menu.refreshShortcuts()}})},add:s,remove:r,getShortcut:function(e){return u[e]},getUserShortcut:h,revertToDefault:function(e){var t=u[e];t&&r(t.key),f.hasOwnProperty(e)&&s((t=f[e]).scope,t.key,e,!1)},formatKey:function(e,t){var o=n?e.replace(/ctrl-?/,"&#8984;"):e;return o=(o=(o=(o=(o=(o=n?o.replace(/alt-?/,"&#8997;"):e).replace(/shift-?/,"&#8679;")).replace(/left/,"&#x2190;")).replace(/up/,"&#x2191;")).replace(/right/,"&#x2192;")).replace(/down/,"&#x2193;"),t?o:'<span class="help-key-block"><span class="help-key">'+o.split(" ").join('</span> <span class="help-key">')+"</span></span>"},validateKey:function(e){var t=(e=e.trim()).split(" ");for(i=0;i<t.length;i++)if(!g(t[i]))return!1;return!0},disable:function(){t=!1},enable:function(){t=!0}}}(),RED.workspaces=function(){var n,a=0,r=0,t=[],i=[],o=0;function s(e){o!==t.length&&t.splice(o),t.push(e),o=t.length}function d(o){i=i.filter(function(e){if(e===o)return!1;if(Array.isArray(e)){var t=e.indexOf(o);return-1<t&&e.splice(t,1),0===e.length?!1:!0}return!0})}function l(e,t,o){if(e)e.closeable||(e.hideable=!0),n.addTab(e,o),JSON.parse(RED.settings.getLocal("hiddenTabs")||"{}")[e.id]&&n.hideTab(e.id),n.resize();else{for(var i=RED.nodes.id();r+=1,0!==$("#red-ui-workspace-tabs li[flowname='"+RED._("workspace.defaultName",{number:r})+"']").size(););e={type:"tab",id:i,disabled:!1,info:"",label:RED._("workspace.defaultName",{number:r}),env:[],hideable:!0},RED.nodes.addWorkspace(e,o),n.addTab(e,o),n.activateTab(i),t||(RED.history.push({t:"add",workspaces:[e],dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0))}return $("#red-ui-tab-"+e.id.replace(".","-")).attr("flowname",e.label),RED.view.focus(),e}function c(e){var t;1!==u&&(t=RED.nodes.getWorkspaceOrder(),e._index=t.indexOf(e.id),b(e),(t=RED.nodes.removeWorkspace(e.id)).t="delete",t.dirty=RED.nodes.dirty(),t.workspaces=[e],RED.history.push(t),RED.nodes.dirty(!0),RED.sidebar.config.refresh())}function p(e){var t=RED.nodes.workspace(e);t?RED.editor.editFlow(t):(e=RED.nodes.subflow(e))&&RED.editor.editSubflow(e)}var u=0;function e(){n=RED.tabs.create({id:"red-ui-workspace-tabs",onchange:function(e){var t={old:a};e?(RED.comms.homegear().invoke("setNodeVariable",null,e.id,"enableEvents",!0),$("#red-ui-workspace-chart").show(),a=e.id,window.location.hash="flow/"+e.id,$("#red-ui-workspace").toggleClass("red-ui-workspace-disabled",!!e.disabled)):($("#red-ui-workspace-chart").hide(),a=0,window.location.hash=""),t.workspace=a,RED.events.emit("workspace:change",t),RED.sidebar.config.refresh(),RED.view.focus()},onclick:function(e){e.id!==a&&s(a),RED.view.focus()},ondblclick:function(e){"subflow"!=e.type?p(e.id):RED.editor.editSubflow(RED.nodes.subflow(e.id))},onadd:function(e){"tab"===e.type&&u++,$('<span class="red-ui-workspace-disabled-icon"><i class="fa fa-ban"></i> </span>').prependTo("#red-ui-tab-"+e.id.replace(".","-")+" .red-ui-tab-label"),e.disabled&&$("#red-ui-tab-"+e.id.replace(".","-")).addClass("red-ui-workspace-disabled"),RED.menu.setDisabled("menu-item-workspace-delete",0===a||u<=1),1===u&&($("#red-ui-workspace .red-ui-tabs").show(),$("#red-ui-workspace-chart").show(),$("#red-ui-workspace-footer").children().show())},onremove:function(e){"tab"===e.type?u--:i.push(e.id),RED.menu.setDisabled("menu-item-workspace-delete",0===a||u<=1),0===u&&f()},onreorder:function(e,t){RED.history.push({t:"reorder",workspaces:{from:e,to:t},dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),y(t)},onselect:function(e){RED.view.select(!1),0===e.length?($("#red-ui-workspace-chart svg").css({"pointer-events":"auto",filter:"none"}),$("#red-ui-workspace-toolbar").css({"pointer-events":"auto",filter:"none"}),$("#red-ui-palette-container").css({"pointer-events":"auto",filter:"none"}),$(".red-ui-sidebar-shade").hide()):(RED.view.select(!1),$("#red-ui-workspace-chart svg").css({"pointer-events":"none",filter:"opacity(60%)"}),$("#red-ui-workspace-toolbar").css({"pointer-events":"none",filter:"opacity(60%)"}),$("#red-ui-palette-container").css({"pointer-events":"none",filter:"opacity(60%)"}),$(".red-ui-sidebar-shade").show())},onhide:function(e){i.push(e.id);var t=JSON.parse(RED.settings.getLocal("hiddenTabs")||"{}");t[e.id]=!0,RED.settings.setLocal("hiddenTabs",JSON.stringify(t)),RED.events.emit("workspace:hide",{workspace:e.id})},onshow:function(e){d(e.id);var t=JSON.parse(RED.settings.getLocal("hiddenTabs")||"{}");delete t[e.id],RED.settings.setLocal("hiddenTabs",JSON.stringify(t)),RED.events.emit("workspace:show",{workspace:e.id})},minimumActiveTabWidth:150,scrollable:!0,addButton:"core:add-flow",addButtonCaption:RED._("workspace.addFlow"),menu:function(){var e=[{id:"red-ui-tabs-menu-option-search-flows",label:RED._("workspace.listFlows"),onselect:"core:list-flows"},{id:"red-ui-tabs-menu-option-search-subflows",label:RED._("workspace.listSubflows"),onselect:"core:list-subflows"},null,{id:"red-ui-tabs-menu-option-add-flow",label:RED._("workspace.addFlow"),onselect:"core:add-flow"},{id:"red-ui-tabs-menu-option-add-flow-right",label:RED._("workspace.addFlowToRight"),onselect:"core:add-flow-to-right"},null,{id:"red-ui-tabs-menu-option-add-hide-flows",label:RED._("workspace.hideFlow"),onselect:"core:hide-flow"},{id:"red-ui-tabs-menu-option-add-hide-other-flows",label:RED._("workspace.hideOtherFlows"),onselect:"core:hide-other-flows"},{id:"red-ui-tabs-menu-option-add-show-all-flows",label:RED._("workspace.showAllFlows"),onselect:"core:show-all-flows"},{id:"red-ui-tabs-menu-option-add-hide-all-flows",label:RED._("workspace.hideAllFlows"),onselect:"core:hide-all-flows"},{id:"red-ui-tabs-menu-option-add-show-last-flow",label:RED._("workspace.showLastHiddenFlow"),onselect:"core:show-last-hidden-flow"}];return 0<i.length&&e.unshift({label:RED._("workspace.hiddenFlows",{count:i.length}),onselect:"core:list-hidden-flows"}),e}}),u=0}function f(){$("#red-ui-workspace .red-ui-tabs").hide(),$("#red-ui-workspace-chart").hide(),$("#red-ui-workspace-footer").children().hide()}function h(e){p(e||a)}function g(e){m(e,!1)}function v(e){m(e,!0)}function m(e,t){var o,i=RED.nodes.workspace(e||a);i&&i.disabled!==t&&(o={disabled:i.disabled},i.disabled=t,$("#red-ui-tab-"+i.id.replace(".","-")).toggleClass("red-ui-workspace-disabled",!!i.disabled),e&&e!==a||$("#red-ui-workspace").toggleClass("red-ui-workspace-disabled",!!i.disabled),e={t:"edit",changes:o,node:i,dirty:RED.nodes.dirty()},i.changed=!0,RED.history.push(e),RED.events.emit("flows:change",i),RED.nodes.dirty(!0),RED.sidebar.config.refresh(),(e=RED.view.selection()).nodes||e.links||i.id!==a||RED.sidebar.info.refresh(i),o.hasOwnProperty("disabled")&&(RED.nodes.eachNode(function(e){e.z===i.id&&(e.dirty=!0)}),RED.view.redraw()))}function b(e){e?(n.contains(e.id)&&n.removeTab(e.id),e.id===a&&(a=0)):c(RED.nodes.workspace(a))}function y(e){var t=e.filter(function(e){return void 0!==RED.nodes.workspace(e)}),o=RED.nodes.getWorkspaceOrder();JSON.stringify(t)!==JSON.stringify(o)&&(RED.nodes.setWorkspaceOrder(t),RED.events.emit("flows:reorder",t)),n.order(e)}return{init:function(){$('<ul id="red-ui-workspace-tabs"></ul>').appendTo("#red-ui-workspace"),$('<div id="red-ui-workspace-tabs-shade" class="hide"></div>').appendTo("#red-ui-workspace"),$('<div id="red-ui-workspace-chart" tabindex="1"></div>').appendTo("#red-ui-workspace"),$('<div id="red-ui-workspace-toolbar"></div>').appendTo("#red-ui-workspace"),$('<div id="red-ui-workspace-footer" class="red-ui-component-footer"></div>').appendTo("#red-ui-workspace"),$('<div id="red-ui-editor-shade" class="hide"></div>').appendTo("#red-ui-workspace"),e(),RED.events.on("sidebar:resize",n.resize),RED.actions.add("core:show-next-tab",function(){var e=a;n.nextTab(),e!==a&&s(e)}),RED.actions.add("core:show-previous-tab",function(){var e=a;n.previousTab(),e!==a&&s(e)}),RED.menu.setAction("menu-item-workspace-delete",function(){c(RED.nodes.workspace(a))}),$(window).on("resize",function(){n.resize()}),RED.actions.add("core:add-flow",function(e){l(void 0,void 0,e?e.index:void 0)}),RED.actions.add("core:add-flow-to-right",function(e){l(void 0,void 0,n.activeIndex()+1)}),RED.actions.add("core:edit-flow",h),RED.actions.add("core:remove-flow",b),RED.actions.add("core:enable-flow",g),RED.actions.add("core:disable-flow",v),RED.actions.add("core:hide-flow",function(){var e=n.selection();0===e.length&&(e=[{id:a}]);var t=[];e.forEach(function(e){RED.workspaces.hide(e.id),i.pop(),t.push(e.id)}),0<t.length&&i.push(t),n.clearSelection()}),RED.actions.add("core:hide-other-flows",function(){var e=n.selection();0===e.length&&(e=[{id:a}]);var t=new Set(e.map(function(e){return e.id})),e=n.listTabs(),o=[];e.forEach(function(e){t.has(e)||(RED.workspaces.hide(e),i.pop(),o.push(e))}),0<o.length&&i.push(o)}),RED.actions.add("core:hide-all-flows",function(){var e=n.listTabs();e.forEach(function(e){RED.workspaces.hide(e),i.pop()}),0<e.length&&i.push(e),n.clearSelection()}),RED.actions.add("core:show-all-flows",function(){n.listTabs().forEach(function(e){RED.workspaces.show(e,null,!0)})}),RED.actions.add("core:show-last-hidden-flow",function(){var e,t=i.pop();t&&("string"==typeof t?RED.workspaces.show(t):(e=t.pop(),t.forEach(function(e){RED.workspaces.show(e,null,!0)}),setTimeout(function(){RED.workspaces.show(e)},150)))}),RED.actions.add("core:list-hidden-flows",function(){RED.actions.invoke("core:search","is:hidden ")}),RED.actions.add("core:list-flows",function(){RED.actions.invoke("core:search","type:tab ")}),RED.actions.add("core:list-subflows",function(){RED.actions.invoke("core:search","type:subflow ")}),RED.actions.add("core:go-to-previous-location",function(){0<o&&(o===t.length&&t.push(a),RED.workspaces.show(t[--o],!0))}),RED.actions.add("core:go-to-next-location",function(){o<t.length-1&&RED.workspaces.show(t[++o],!0)}),f()},add:l,remove:b,delete:c,order:y,edit:h,contains:function(e){return n.contains(e)},count:function(){return u},active:function(){return a},selection:function(){return n.selection()},hide:function(e){e=e||a,n.contains(e)&&n.hideTab(e)},isHidden:function(e){return i.includes(e)},show:function(e,t,o){if(!n.contains(e)){var i=RED.nodes.subflow(e);if(!i)return;l({type:"subflow",id:e,icon:"red/images/subflow_tab.svg",label:i.name,closeable:!0},null,n.activeIndex()+1),d(e)}o?n.showTab(e):(t||a===e||s(a),n.activateTab(e))},refresh:function(){RED.nodes.eachWorkspace(function(e){n.renameTab(e.id,e.label),$("#red-ui-tab-"+e.id.replace(".","-")).attr("flowname",e.label)}),RED.nodes.eachSubflow(function(e){n.contains(e.id)&&n.renameTab(e.id,e.name)}),RED.sidebar.config.refresh()},resize:function(){n.resize()},enable:g,disable:v}}(),RED.statusBar=function(){var o,i,n={};return{init:function(){o=$('<span class="red-ui-statusbar-bucket red-ui-statusbar-bucket-left">').appendTo("#red-ui-workspace-footer"),i=$('<span class="red-ui-statusbar-bucket red-ui-statusbar-bucket-right">').appendTo("#red-ui-workspace-footer")},add:function(e){n[e.id]=e;var t=$('<span class="red-ui-statusbar-widget"></span>');e.element.appendTo(t),"left"===e.align?o.append(t):"right"===e.align&&i.prepend(t)}}}(),RED.view=function(){var D,x,R,u,k,_,b,o,r,n,s,d,l,T,a,c,p,t,C=5e3,j=5e3,h=.75,L=1,S=100,M=30,f=650,g=1e3,v=0,m=[],y=0,w={},z=10,O=!1,I=!1,N=null,E=[],P=[],A=[],B={},V=null,H=null,G=[],F={},U=null,J=null,q=null,W=null,K=0,X=null,Y=[0,0],Q=null,Z=0,ee=null,te=null,oe=null,ie=null,ne=!1,ae=null,re=null,se=0,de=0,le=[],ce=null,pe=-1,ue=!1,fe=[],he="",ge={red:"#c00",green:"#5a8",yellow:"#F9DF31",blue:"#53A3F3",grey:"#d3d3d3",gray:"#d3d3d3"},ve=1,me=0,be=(a=new Set,c=[],p={add:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)p.add(e[t]);else if(!a.has(e.id)){c.push({n:e}),a.add(e.id);for(var o=RED.nodes.getNodeLinks(e.id,ve).concat(RED.nodes.getNodeLinks(e.id,me)),t=0,i=o.length;t<i;t++){var n=o[t];(n.source===e&&a.has(n.target.id)||n.target===e&&a.has(n.source.id))&&ye.add(n)}}},remove:function(e,t){if(a.has(e.id)){if(a.delete(e.id),void 0!==t&&c[t].n===e)c.splice(t,1);else for(var o=0;o<c.length;o++)if(c[o].n===e){c.splice(o,1);break}for(var i=RED.nodes.getNodeLinks(e.id,ve).concat(RED.nodes.getNodeLinks(e.id,me)),o=0,n=i.length;o<n;o++)ye.remove(i[o])}},clear:function(){a.clear(),c=[]},length:function(){return c.length},get:function(e){return c[e]},forEach:function(e){c.forEach(e)},nodes:function(){return c.map(function(e){return e.n})}}),ye=(t=new Set,{add:function(e){t.add(e),e.selected=!0},remove:function(e){t.delete(e),e.selected=!1},clear:function(){t.forEach(function(e){e.selected=!1}),t.clear()},length:function(){return t.size},forEach:function(e){t.forEach(e)},has:function(e){return t.has(e)},toArray:function(){return Array.from(t)}});function we(){for(var e=[],t=0;t<C;t+=+z)e.push(t);o.selectAll("line.red-ui-workspace-chart-grid-h").remove(),o.selectAll("line.red-ui-workspace-chart-grid-h").data(e).enter().append("line").attr({class:"red-ui-workspace-chart-grid-h",x1:0,x2:C,y1:function(e){return e},y2:function(e){return e}}),o.selectAll("line.red-ui-workspace-chart-grid-v").remove(),o.selectAll("line.red-ui-workspace-chart-grid-v").data(e).enter().append("line").attr({class:"red-ui-workspace-chart-grid-v",y1:0,y2:C,x1:function(e){return e},x2:function(e){return e}})}function Ee(e){pe=-1;for(var t=0;t<e.length;t++){var o=e[t];o.el=n.append("svg:path").attr("class","red-ui-flow-drag-line"),("link out"===o.node.type&&o.portType===me||"link in"===o.node.type&&o.portType===ve)&&(o.el.attr("class","red-ui-flow-link-link red-ui-flow-drag-line"),o.virtualLink=!0,pe=o.portType===me?ve:me),T.push(o)}-1!==pe&&E.forEach(function(e){"link in"!==e.type&&"link out"!==e.type||(e.dirty=!0)})}function De(){for(-1!==pe&&E.forEach(function(e){"link in"!==e.type&&"link out"!==e.type||(e.dirty=!0)}),pe=-1;T.length;){var e=T.pop();e.el&&e.el.remove()}}function xe(){var e=RED.workspaces.active();0!==e?((E=RED.nodes.filterNodes({z:e})).forEach(function(e,t){e._index=t}),P=RED.nodes.filterLinks({source:{z:e},target:{z:e}}),(G=RED.nodes.groups(e)||[]).forEach(function(e,t){e._index=t,e.g?(e._root=e.g,e._depth=1):(e._root=e.id,e._depth=0)})):(E=[],P=[],G=[]);for(var i=!1;i=!1,G.forEach(function(e){var t,o;!e.g||(t=RED.nodes.group(e.g))&&(o=t._depth,e._depth!==o+1&&(e._depth=o+1,i=!0),e._root!==t._root&&(e._root=t._root,i=!0))}),i;);G.sort(function(e,t){return e._root===t._root?e._depth-t._depth:e._index-t._index}),l.selectAll(".red-ui-flow-group").data(G,function(e){return e.id}).sort(function(e,t){return e._root===t._root?e._depth-t._depth:e._index-t._index})}function Re(e,t,o,i,n){var a=i-t,r=o-e,s=Math.sqrt(a*a+r*r),d=h;if(0<r*n?s<S&&(d=.75-(S-s)/S*.75):d=.4-.2*Math.max(0,(S-Math.min(Math.abs(r),Math.abs(a)))/S),0<r*n)return"M "+e+" "+t+" C "+(e+n*(S*d))+" "+(t+0*M)+" "+(o-n*d*S)+" "+(i-0*M)+" "+o+" "+i;var l=Math.floor(o-r/2),c=Math.floor(i-a/2),p=M/2,u=(i+(c=0==a?i+M:c))/2,f=e+n*S*d,s=0<a?Math.min(u-a/2,t+p):Math.max(u-a/2,t-p),r=o-n*S*d,n=0<a?Math.max(u,i-p):Math.min(u,i+p),d=(e+f)/2,u=0<a?1:-1,d=[[d,t],[f,0<a?Math.max(t,s-p):Math.min(t,s+p)],[d,0<a?Math.min(c,s+p):Math.max(c,s-p)],[r,0<a?Math.max(c,n-p):Math.min(c,n+p)],[(o+r)/2,i]];return d[2][1]===s+u*p&&(Math.abs(a)<10*p&&(d[1][1]=s-u*p/2,d[3][1]=n-u*p/2),d[2][0]=f),"M "+e+" "+t+" C "+d[0][0]+" "+d[0][1]+" "+d[1][0]+" "+d[1][1]+" "+f+" "+s+" S "+d[2][0]+" "+d[2][1]+" "+l+" "+c+" S "+d[3][0]+" "+d[3][1]+" "+r+" "+n+" S "+d[4][0]+" "+d[4][1]+" "+o+" "+i}function ke(e){var t=/^subflow:(.+)$/.exec(e);if(N&&t){if(t[1]===N.id)return void RED.notify(RED._("notification.error",{message:RED._("notification.errors.cannotAddSubflowToItself")}),"error");if(RED.nodes.subflowContains(t[1],N.id))return void RED.notify(RED._("notification.error",{message:RED._("notification.errors.cannotAddCircularReference")}),"error")}var o={id:RED.nodes.id(),z:RED.workspaces.active()};if(o.type=e,o._def=RED.nodes.getType(o.type),t){var i=RED.nodes.subflow(t[1]);o.name="",o.inputs=i.in.length,o.outputs=i.out.length}else{for(var n in o.inputs=o._def.inputs||0,o.outputs=o._def.outputs,o._def.defaults)o._def.defaults.hasOwnProperty(n)&&void 0!==o._def.defaults[n].value&&(o[n]=JSON.parse(JSON.stringify(o._def.defaults[n].value)));if(o._def.onadd)try{o._def.onadd.call(o)}catch(e){console.log("Definition error: "+o.type+".onadd:",e)}}o.changed=!0,o.moved=!0,o.w=S,o.h=Math.max(Math.max(M,20*(o.outputs||0)),20*(o.inputs||0)),o.resize=!0;t={t:"add",nodes:[o.id],dirty:RED.nodes.dirty()};return!N||(i=RED.subflow.refresh(!0))&&(t.subflow={id:N.id,changed:N.changed,instances:i.instances}),{node:o,historyEvent:t}}function e(){var e,t;if(RED.view.DEBUG&&console.warn("canvasMouseDown",Z),Z!==RED.state.SELECTING_NODE){if(1===d3.event.button)return Z=RED.state.PANNING,Q=[d3.event.pageX,d3.event.pageY],void(le=[k.scrollLeft(),k.scrollTop()]);J||U||q||(ye.clear(),Ne()),0===Z&&ee&&(ee.remove(),ee=null),0!==Z&&Z!==RED.state.QUICK_JOINING||!d3.event.touches&&0!==d3.event.button||!d3.event.metaKey&&!d3.event.ctrlKey?0!==Z||!d3.event.touches&&0!==d3.event.button||d3.event.metaKey||d3.event.ctrlKey?0===Z&&2===d3.event.button&&(d3.event.metaKey||d3.event.ctrlKey)&&(Oe(),Z=RED.state.SLICING,e=d3.mouse(this),te=b.append("path").attr("class","nr-ui-view-slice").attr("d",`M${e[0]} `+e[1]),oe=e,RED.view.redraw()):y||(e=d3.mouse(this),ee=b.append("rect").attr("ox",e[0]).attr("oy",e[1]).attr("rx",1).attr("ry",1).attr("x",e[0]).attr("y",e[1]).attr("width",0).attr("height",0).attr("class","nr-ui-view-lasso"),d3.event.preventDefault()):(d3.event.stopPropagation(),Oe(),t=kt((e=d3.mouse(this))[0],e[1]),_e({position:e,group:t=0<T.length?t||RED.nodes.group(T[0].node.g):t}))}else d3.event.stopPropagation()}function _e(e){var p=(e=e||{}).position||fe,u=e.splice,f=e.group,h=e.touchTrigger;f&&!f.active&&(Et(f,!1),Dt(f),RED.view.redraw());var t=p[0],o=p[1];RED.settings.get("editor").view["view-snap-grid"]&&(p[0]=Math.round(p[0]/z)*z,p[1]=Math.round(p[1]/z)*z);var i,e=$("#red-ui-main-container").position();Z!==RED.state.QUICK_JOINING&&(Z=RED.state.QUICK_JOINING,$(window).on("keyup",qe)),ie&&ie.remove(),(ie=b.append("g").attr("transform","translate("+(p[0]-S/2)+","+(p[1]-M/2)+")")).append("rect").attr("class","red-ui-flow-node-placeholder").attr("rx",5).attr("ry",5).attr("width",S).attr("height",M).attr("fill","none"),0<T.length&&(i=T[0].virtualLink?{type:"link in"===T[0].node.type?"link out":"link in"}:T[0].portType===me?{input:!0}:{output:!0},ce={node:T[0].node,port:T[0].port,portType:T[0].portType},T[0].virtualLink&&(ce.virtualLink=!0),De()),u&&(i={input:!0,output:!0});function g(){var e,t,o;ce&&(ce.el||(ce.el=n.append("svg:path").attr("class","red-ui-flow-drag-line")),e=ce.portType===me?ce.node.outputs||1:ce.node.inputs||1,t=ce.port,o=ce.portType===me?1:-1,ce.el.attr("d",Re(ce.node.x+o*ce.node.w/2,ce.node.y+(-(e-1)/2*18+18*t),p[0]-o*S/2,p[1],o)))}var v,m;ce&&g(),RED.typeSearch.show({x:d3.event.clientX-e.left-S/2-(t-p[0]),y:d3.event.clientY-e.top+M/2+5-(o-p[1]),disableFocus:h,filter:i,move:function(e,t){var o;ie&&(o=d3.transform(ie.attr("transform")).translate,ie.attr("transform","translate("+(o[0]+e)+","+(o[1]+t)+")"),p[0]+=e,p[1]+=t,g())},cancel:function(){ce&&(ce.el&&ce.el.remove(),ce=null),ie&&ie.remove(),Je(),Ne(),De(),Lt()},add:function(e,t){h&&(t=!1,Je());var o,i,n,a,r,s,d,l,c=ke(e);c&&(t&&(Z=RED.state.QUICK_JOINING),o=c.node,l=c.historyEvent,o.x=p[0],o.y=p[1],void 0===(e=RED.utils.getMessageProperty(RED.settings.get("editor"),"view.view-node-show-label"))||o._def.hasOwnProperty("showLabel")&&!o._def.showLabel||o._def.defaults.hasOwnProperty("l")||(o.l=e),ce?((d=ce).portType===me&&(0<o.inputs||d.virtualLink)?(i=d.node,a=d.port,n=o,r=0):d.portType===ve&&(0<o.outputs||d.virtualLink)&&(i=o,n=d.node,a=0,r=d.port),null!==i?(d.virtualLink?(l={t:"multi",events:[l]},c=$.extend(!0,{},{v:i.links}).v,e=$.extend(!0,{},{v:n.links}).v,i.links.push(n.id),n.links.push(i.id),i.dirty=!0,n.dirty=!0,l.events.push({t:"edit",node:i,dirty:RED.nodes.dirty(),changed:i.changed,changes:{links:c}}),l.events.push({t:"edit",node:n,dirty:RED.nodes.dirty(),changed:n.changed,changes:{links:e}}),i.changed=!0,n.changed=!0):(RED.nodes.addLink(s={source:i,sourcePort:a,target:n,targetPort:r}),l.links=[s]),t?(ce.node=o,ce.port=0):(ce.el.remove(),ce=null,Z===RED.state.QUICK_JOINING&&(d.portType===me&&0<o.outputs?Ee([{node:o,port:0,portType:me}]):!ce&&d.portType===ve&&0<o.inputs?Ee([{node:o,port:0,portType:ve}]):Je()))):(De(),Je())):t?0<o.outputs?ce={node:o,port:0,portType:me}:0<o.inputs?ce={node:o,port:0,portType:ve}:Je():Z===RED.state.QUICK_JOINING&&(0<o.outputs?Ee([{node:o,port:0,portType:me}]):0<o.inputs?Ee([{node:o,port:0,portType:ve}]):Je()),RED.nodes.add(o),RED.editor.validateNode(o),f&&(RED.group.addToGroup(f,o),(l="multi"!==l.t?{t:"multi",events:[l]}:l).events.push({t:"addToGroup",group:f,nodes:o})),u&&(Je(),RED.nodes.removeLink(u),s={source:u.source,sourcePort:u.sourcePort,target:o,targetPort:0},d={source:o,sourcePort:0,target:u.target,targetPort:u.targetPort},RED.nodes.addLink(s),RED.nodes.addLink(d),l.links=(l.links||[]).concat([s,d]),l.removedLinks=[u]),RED.history.push(l),RED.nodes.dirty(!0),Oe(),o.selected=!0,f&&(Et(f,!1),Dt(f)),be.add(o),xe(),Ne(),Lt(),void 0!==v&&(l=v+m/2,(l=o.x-o.w/2-l)!=2*z&&(o.x=o.x+2*z-l,o.dirty=!0,o.x=Math.ceil(o.x/z)*z,Lt())),t?(void 0===v&&setTimeout(function(){RED.typeSearch.refresh({filter:{input:!0}})},100),v=o.x,m=o.w,p[0]=o.x+o.w/2+S/2+2*z,ie.attr("transform","translate("+(p[0]-S/2)+","+(p[1]-M/2)+")"),g()):ie.remove())}}),xe(),Ne(),Lt()}function $e(){var c;if(Z===RED.state.PANNING){var e=[d3.event.pageX,d3.event.pageY];d3.event.touches&&(e=[(o=d3.event.touches.item(0)).pageX,o.pageY]);var t=[Q[0]-e[0],Q[1]-e[1]];return k.scrollLeft(le[0]+t[0]),void k.scrollTop(le[1]+t[1])}if(Q=d3.touches(this)[0]||d3.mouse(this),ee){var o=parseInt(ee.attr("ox")),i=parseInt(ee.attr("oy")),e=parseInt(ee.attr("x")),t=parseInt(ee.attr("y")),o=Q[0]<o?o-(e=Q[0]):Q[0]-e,i=Q[1]<i?i-(t=Q[1]):Q[1]-t;ee.attr("x",e).attr("y",t).attr("width",o).attr("height",i)}else if(Z!==RED.state.SLICING)if(Z!==RED.state.SELECTING_NODE){if(Z==RED.state.QUICK_JOINING||Z==RED.state.IMPORT_DRAGGING||Z==RED.state.DETACHED_DRAGGING||J||q||0!==ye.length()){if(Z==RED.state.JOINING||Z===RED.state.QUICK_JOINING){if(0===T.length&&null!==W){if(d3.event.shiftKey){var n=[],a=[];for(0<ye.length()?ye.forEach(function(e){(W===me&&e.source===J&&e.sourcePort===K||W===ve&&e.target===J&&e.targetPort===K)&&a.push(e)}):(i=W===me?{source:J,sourcePort:K}:{target:J,targetPort:K},a=RED.nodes.filterLinks(i)),E=0;E<a.length;E++){var r=a[E];RED.nodes.removeLink(r),n.push({link:r,node:W===me?r.target:r.source,port:W===me?r.targetPort:r.sourcePort,portType:W===me?ve:me})}0===n.length?(Je(),Lt()):(Ee(n),Z=0,xe(),Lt(),Z=RED.state.JOINING)}else J&&!ce&&Ee([{node:J,port:K,portType:W}]);ye.clear()}for(f=Q,E=0;E<T.length;E++){var s=T[E],d=s.portType===me?s.node.outputs||1:s.node.inputs||1,l=s.port;"subflow"==s.node.type&&(d=1,l=0);var p=s.portType===me?1:-1;s.el.attr("d",Re(s.node.x+p*s.node.w/2,s.node.y+(-(d-1)/2*18+18*l),f[0],f[1],p))}d3.event.preventDefault()}else if(Z==RED.state.MOVING){f=d3.mouse(document.body),isNaN(f[0])&&(f=d3.touches(document.body)[0]);var u=(Y[0]-f[0])*(Y[0]-f[0])+(Y[1]-f[1])*(Y[1]-f[1]);(3<u&&!re||re&&10<u)&&(Z=RED.state.MOVING_ACTIVE,de=0,I=!1,1===be.length()&&(c=be.get(0),I=c.n.hasOwnProperty("_def")&&(c.n.hasOwnProperty("inputs")&&0<c.n.inputs||!c.n.hasOwnProperty("inputs")&&0<c.n._def.inputs)&&(c.n.hasOwnProperty("outputs")&&0<c.n.outputs||!c.n.hasOwnProperty("outputs")&&0<c.n._def.outputs)&&0===RED.nodes.filterLinks({source:c.n}).length&&0===RED.nodes.filterLinks({target:c.n}).length))}else if(Z==RED.state.MOVING_ACTIVE||Z==RED.state.IMPORT_DRAGGING||Z==RED.state.DETACHED_DRAGGING){for(var f=Q,h=0,g=0,v=C,m=j,b=0;b<be.length();b++)c=be.get(b),d3.event.shiftKey&&(c.n.ox=c.n.x,c.n.oy=c.n.y),c.n.x=f[0]+c.dx,c.n.y=f[1]+c.dy,c.n.dirty=!0,m="group"===c.n.type?(!1!==c.n.groupMoved&&(c.n.groupMoved=!0),RED.group.markDirty(c.n),h=Math.min(c.n.x-5,h),g=Math.min(c.n.y-5,g),v=Math.max(c.n.x+c.n.w+5,v),Math.max(c.n.y+c.n.h+5,m)):(h=Math.min(c.n.x-c.n.w/2-5,h),g=Math.min(c.n.y-c.n.h/2-5,g),v=Math.max(c.n.x+c.n.w/2+5,v),Math.max(c.n.y+c.n.h/2+5,m));if(0!==h||0!==g)for(E=0;E<be.length();E++)(c=be.get(E)).n.x-=h,c.n.y-=g;if(v!==C||m!==j)for(E=0;E<be.length();E++)(c=be.get(E)).n.x-=v-C,c.n.y-=m-j;var y=[0,0];if(O!=d3.event.shiftKey&&0<be.length()){for(var w,E=0;c=be.get(E++),E<be.length()&&"group"===c.n.type;);if("group"===c.n.type?(y[0]=c.n.x-z*Math.floor(c.n.x/z)-z/2,y[1]=c.n.y-z*Math.floor(c.n.y/z)-z/2):(u=c.n.x-(z*Math.round((c.n.x-c.n.w/2)/z)+c.n.w/2),w=c.n.x-(z*Math.round((c.n.x+c.n.w/2)/z)-c.n.w/2),Math.abs(u)<Math.abs(w)?y[0]=u:y[0]=w,y[1]=c.n.y-z*Math.round(c.n.y/z)),0!==y[0]||0!==y[1])for(E=0;E<be.length();E++)(c=be.get(E)).n.x-=y[0],c.n.y-=y[1],c.n.x==c.n.ox&&c.n.y==c.n.oy&&(c.dirty=!1)}1===be.length()&&"group"!==be.get(0).n.type&&(c=be.get(0),I&&(x=x||setTimeout(function(){for(var e,t=[],o=1/0,i=null,n=c.n.x,a=c.n.y,t=_[0][0].getIntersectionList?((e=_[0][0].createSVGRect()).x=n*L,e.y=a*L,e.width=1,e.height=1,_[0][0].getIntersectionList(e,_[0][0])):RED.view.getLinksAtPoint(n*L,a*L),r=0;r<t.length;r++)if(d3.select(t[r]).classed("red-ui-flow-link-background"))for(var s=t[r].getTotalLength(),d=0;d<s;d+=10){var l=t[r].getPointAtLength(d),l=(l.x-n)*(l.x-n)+(l.y-a)*(l.y-a);l<200&&l<o&&(o=l,i=t[r])}D&&D!==i&&d3.select(D.parentNode).classed("red-ui-flow-link-splice",!1),i?d3.select(i.parentNode).classed("red-ui-flow-link-splice",!0):d3.select(".red-ui-flow-link-splice").classed("red-ui-flow-link-splice",!1),D=i,x=null},100)),"subflow"!==c.n.type&&!c.n.g&&G&&(R=R||setTimeout(function(){H=kt(c.n.x,c.n.y);for(var e=0;e<G.length;e++){var t=G[e];t===H?(t.hovered=!0,t.dirty=!0):t.hovered&&(t.hovered=!1,t.dirty=!0)}R=null},50)))}0!==Z&&Lt()}}else d3.event.stopPropagation();else te&&20<Math.max(1,Math.abs(oe[0]-Q[0]))*Math.max(1,Math.abs(oe[1]-Q[1]))&&(w=te.attr("d"),w+=" L"+Q[0]+" "+Q[1],te.attr("d",w),oe=Q)}function Te(){var o,i,n,a;if(fe=[d3.event.offsetX/L,d3.event.offsetY/L],RED.view.DEBUG&&console.warn("canvasMouseUp",Z),Z!==RED.state.PANNING)if(Z!==RED.state.SELECTING_NODE){if(Z!==RED.state.QUICK_JOINING){if(J&&Z==RED.state.JOINING){for(var e=[],t=0;t<T.length;t++)T[t].link&&e.push(T[t].link);0<e.length&&(f={t:"delete",links:e,dirty:RED.nodes.dirty()},RED.history.push(f),RED.nodes.dirty(!0)),De()}if(ee?(o=parseInt(ee.attr("x")),i=parseInt(ee.attr("y")),n=o+parseInt(ee.attr("width")),a=i+parseInt(ee.attr("height")),p=V,d3.event.shiftKey||(Oe(),p&&o<p.x+p.w&&n>p.x&&i<p.y+p.h&&a>p.y&&(Dt(p),V.selected=!0)),G.forEach(function(e){if(!e.selected&&e.x>o&&e.x+e.w<n&&e.y>i&&e.y+e.h<a&&(!V||RED.group.contains(V,e))){for(;e.g&&(!V||e.g!==V.id);)e=RED.nodes.group(e.g);e.selected||Et(e,!0)}}),E.forEach(function(e){if(!e.selected&&e.x>o&&e.x<n&&e.y>i&&e.y<a&&(!V||RED.group.contains(V,e)))if(!e.g||V&&e.g===V.id)e.selected=!0,e.dirty=!0,be.add(e);else{for(var t=RED.nodes.group(e.g);t.g&&(!V||t.g!==V.id);)t=RED.nodes.group(t.g);t.selected||Et(t,!0)}}),N&&(N.in.forEach(function(e){e.selected=e.x>o&&e.x<n&&e.y>i&&e.y<a,e.selected&&(e.dirty=!0,be.add(e))}),N.out.forEach(function(e){e.selected=e.x>o&&e.x<n&&e.y>i&&e.y<a,e.selected&&(e.dirty=!0,be.add(e))}),N.status&&(N.status.selected=N.status.x>o&&N.status.x<n&&N.status.y>i&&N.status.y<a,N.status.selected&&(N.status.dirty=!0,be.add(N.status)))),Ne(),ee.remove(),ee=null):Z!=RED.state.DEFAULT||null!=U||d3.event.ctrlKey||d3.event.metaKey?te&&(Ae(),te.remove(),te=null,RED.view.redraw(!0)):(Oe(),Ne()),Z==RED.state.MOVING_ACTIVE&&0<be.length()){var r=null;if(H){for(var s=0;s<be.length();s++){var d=be.get(s);RED.group.addToGroup(H,d.n)}(r=H).hovered=!1,Dt(H),V.selected=!0,H=null}for(var l,c,p,u=[],s=0;s<be.length();s++)(d=be.get(s)).ox===d.n.x&&d.oy===d.n.y||(u.push({n:d.n,ox:d.ox,oy:d.oy,moved:d.n.moved}),d.n.dirty=!0,d.n.moved=!0);0<u.length&&Z==RED.state.MOVING_ACTIVE&&(f={t:"move",nodes:u,dirty:RED.nodes.dirty()},D&&(l=d3.select(D).data()[0],RED.nodes.removeLink(l),c={source:l.source,sourcePort:l.sourcePort,target:be.get(0).n,targetPort:0},p={source:be.get(0).n,sourcePort:0,target:l.target,targetPort:l.targetPort},RED.nodes.addLink(c),RED.nodes.addLink(p),f.links=[c,p],f.removedLinks=[l],xe()),r&&(f.addToGroup=r),RED.nodes.dirty(!0),RED.history.push(f))}if(Z==RED.state.MOVING||Z==RED.state.MOVING_ACTIVE||Z==RED.state.DETACHED_DRAGGING){if(Z===RED.state.DETACHED_DRAGGING){for(u=[],s=0;s<be.length();s++)(d=be.get(s)).ox===d.n.x&&d.oy===d.n.y||(u.push({n:d.n,ox:d.ox,oy:d.oy,moved:d.n.moved}),d.n.dirty=!0,d.n.moved=!0);var r=RED.history.peek(),f={t:"move",nodes:u,dirty:RED.nodes.dirty()};("multi"===r.t?r.events:RED.history).push(f)}for(t=0;t<be.length();t++){var h=be.get(t);delete h.ox,delete h.oy}}Z==RED.state.IMPORT_DRAGGING&&(xe(),RED.nodes.dirty(!0)),Je(),Lt()}}else d3.event.stopPropagation();else Je()}function Ce(){L<2&&ze(L+.1)}function je(){.3<L&&ze(L-.1)}function Le(){ze(1)}function ze(e){var t=[k.width(),k.height()],o=[k.scrollLeft(),k.scrollTop()],i=[(o[0]+t[0]/2)/L,(o[1]+t[1]/2)/L];L=e;t=[(o[0]+t[0]/2)/L,(o[1]+t[1]/2)/L],i=[(t[0]-i[0])*L,(t[1]-i[1])*L];k.scrollLeft(o[0]-i[0]),k.scrollTop(o[1]-i[1]),RED.view.navigator.resize(),Lt()}function Se(){if(Z!==RED.state.MOVING&&Z!==RED.state.MOVING_ACTIVE){if(Z===RED.state.DETACHED_DRAGGING){for(var e=0;e<be.length();e++){var t=be.get(e);t.n.x=t.ox,t.n.y=t.oy}Oe(),RED.history.pop(),Z=0}else Z===RED.state.IMPORT_DRAGGING?(Oe(),RED.history.pop(),Z=0):Z===RED.state.SLICING?(te&&(te.remove(),te=null,Je()),Oe()):ee?(ee.remove(),ee=null):(V?xt:Oe)();Lt()}}function Me(){var e;Z===RED.state.SELECTING_NODE&&u.single||(ye.clear(),V?(e=V,Oe(),Dt(e),RED.group.getNodes(e,!1).forEach(function(e){"group"===e.type?Et(e,!0,!0):(be.add(e),e.selected=!0,e.dirty=!0)}),V.selected=!0):(Oe(),xt(),G.forEach(function(e){e.g?(e.selected=!1,e.dirty=!0):(Et(e,!0),e.selected||(e.selected=!0,e.dirty=!0))}),E.forEach(function(e){Z===RED.state.SELECTING_NODE&&u.filter&&!u.filter(e)||e.g||e.selected||(e.selected=!0,e.dirty=!0,be.add(e))}),Z!==RED.state.SELECTING_NODE&&N&&(N.in.forEach(function(e){e.selected||(e.selected=!0,e.dirty=!0,be.add(e))}),N.out.forEach(function(e){e.selected||(e.selected=!0,e.dirty=!0,be.add(e))}),N.status&&(N.status.selected||(N.status.selected=!0,N.status.dirty=!0,be.add(N.status))))),Z!==RED.state.SELECTING_NODE&&Ne(),Lt())}function Oe(){RED.view.DEBUG&&console.warn("clearSelection",Z,"movingSet.length():",be.length());for(var e=0;e<be.length();e++){var t=be.get(e);t.n.dirty=!0,t.n.selected=!1}be.clear(),ye.clear(),V&&(V.active=!1,V.dirty=!0,V=null),G.forEach(function(e){e.selected=!1,e.dirty=!0})}var Ie=null;function Ne(){var e={},t=RED.workspaces.active(),o=RED.workspaces.selection();if(0!==t)if(0===o.length){e=It(),P=RED.nodes.filterLinks({source:{z:t},target:{z:t}});RED.nodes.getWorkspaceOrder();var i={};A=[],Object.keys(B).forEach(function(e){B[e].dirty=!0}),B={};for(var n=0;n<be.length();n++){var a,r,s=be.get(n);("link out"===s.n.type&&"return"!==s.n.mode||"link in"===s.n.type)&&s.n.z===t&&(a=s.n,B[a.id]=a,r={},a.links.forEach(function(e){e=RED.nodes.node(e);e&&("link out"===a.type?e.z===a.z?i[a.id+":"+e.id]||(P.push({source:a,sourcePort:0,target:e,targetPort:0,link:!0}),i[a.id+":"+e.id]=!0,(B[e.id]=e).dirty=!0):(r[e.z]=r[e.z]||[],r[e.z].push(e)):e.z===a.z?i[e.id+":"+a.id]||(P.push({source:e,sourcePort:0,target:a,targetPort:0,link:!0}),i[e.id+":"+a.id]=!0,(B[e.id]=e).dirty=!0):(r[e.z]=r[e.z]||[],r[e.z].push(e)))}),0<Object.keys(r).length&&A.push({refresh:Math.floor(1e4*Math.random()),node:a,links:r}))}0===A.length&&0<ye.length()&&ye.forEach(function(e){e.link&&(P.push(e),B[e.source.id]=e.source,e.source.dirty=!0,B[e.target.id]=e.target,e.target.dirty=!0)})}else e.flows=o;o=t+":"+JSON.stringify(e,function(e,t){return"nodes"===e||"flows"===e?t.map(function(e){return e.id}):"link"===e?t.source.id+":"+t.sourcePort+":"+t.target.id+":"+t.targetPort:"links"===e?t.map(function(e){return e.source.id+":"+e.sourcePort+":"+e.target.id+":"+e.targetPort}):t});o!==Ie&&(Ie=o,RED.events.emit("view:selection-changed",e))}function Pe(){var e;0<be.length()&&("subflow"===(e=be.get(0).n).type?RED.editor.editSubflow(N):"group"===e.type?RED.editor.editGroup(e):RED.editor.edit(e))}function Ae(e){if(Z!==RED.state.SELECTING_NODE){Qe&&(Qe.remove(),Qe=null);var t=RED.workspaces.selection();if(0<t.length){var o=0;if(t.forEach(function(e){"tab"===e.type&&o++}),o!==RED.workspaces.count()){for(var i={t:"delete",dirty:RED.nodes.dirty(),nodes:[],links:[],groups:[],workspaces:[],subflows:[]},n=RED.nodes.getWorkspaceOrder().slice(0),a=0;a<t.length;a++){var r,s=t[a];s._index=n.indexOf(s.id),RED.workspaces.remove(s),"tab"===s.type?(i.workspaces.push(s),r=RED.nodes.removeWorkspace(s.id)):(r=RED.subflow.removeSubflow(s.id),i.subflows=i.subflows.concat(r.subflows)),i.nodes=i.nodes.concat(r.nodes),i.links=i.links.concat(r.links),i.groups=i.groups.concat(r.groups)}RED.history.push(i),RED.nodes.dirty(!0),xe(),Ne(),Lt()}}else if(0<be.length()||0<ye.length()){var d,l=[],c=[],p=[],u=[],f=[],h=[],g=[];e&&(0<(e=(v=RED.nodes.detachNodes(be.nodes())).newLinks).length&&g.push({t:"add",links:e}),c=c.concat(v.removedLinks));var v=RED.nodes.dirty(),m=[];if(0<be.length()){for(a=0;a<be.length();a++)"group"===(w=be.get(a).n).type&&m.push(w);for(a=0;a<m.length;a++)m[a].nodes.forEach(function(e){"group"===e.type&&-1===m.indexOf(e)&&m.push(e)});for(var b,y,w,a=0;a<be.length();a++)(w=be.get(a).n).selected=!1,"group"!==w.type&&"subflow"!==w.type?(w.x<0&&(w.x=25),y=RED.nodes.remove(w.id),l.push(w),l=l.concat(y.nodes),c=c.concat(y.links),w.g&&(b=RED.nodes.group(w.g),-1===m.indexOf(b)&&(y=b.nodes.indexOf(w),b.nodes.splice(y,1),RED.group.markDirty(b)))):("out"===w.direction?u.push(w):"in"===w.direction?f.push(w):"status"===w.direction&&(d=w),w.dirty=!0);for(a=m.length-1;0<=a;a--){var E=m[a];p.push(E),RED.nodes.removeGroup(E)}0<u.length&&(D=RED.subflow.removeOutput(u))&&(c=c.concat(D.links)),1==f.length&&(D=RED.subflow.removeInput())&&(c=c.concat(D.links)),d&&(D=RED.subflow.removeStatus())&&(c=c.concat(D.links));var D=RED.subflow.refresh(!0);D&&(h=D.instances),be.clear(),(0<l.length||0<u.length||0<f.length||d||0<p.length)&&RED.nodes.dirty(!0)}0<ye.length()&&ye.forEach(function(e){var t,o;e.link?(t=e.source.id,o=e.target.id,t=e.target.links.indexOf(t),o=e.source.links.indexOf(o),g.push({t:"edit",node:e.source,changed:e.source.changed,changes:{links:$.extend(!0,{},{v:e.source.links}).v}}),g.push({t:"edit",node:e.target,changed:e.target.changed,changes:{links:$.extend(!0,{},{v:e.target.links}).v}}),e.source.changed=!0,e.target.changed=!0,e.target.links.splice(t,1),e.source.links.splice(o,1),e.source.dirty=!0,e.target.dirty=!0):(RED.nodes.removeLink(e),c.push(e))}),RED.nodes.dirty(!0);i={t:"delete",nodes:l,links:c,groups:p,subflowOutputs:u,subflowInputs:f,subflow:{id:N?N.id:void 0,instances:h},dirty:v};d&&(i.subflow.status=d),0<g.length?(g.unshift(i),RED.history.push({t:"multi",events:g})):RED.history.push(i),ye.clear(),xe(),Ne(),Lt()}}}function Be(){if(Z!==RED.state.SELECTING_NODE){var t=[],e=RED.workspaces.selection();if(0<e.length?(t=[],e.forEach(function(e){"tab"===e.type&&(t.push(e),t=(t=t.concat(RED.nodes.groups(e.id))).concat(RED.nodes.filterNodes({z:e.id})))})):(e=RED.view.selection()).nodes&&e.nodes.forEach(function(e){t.push(e),"group"===e.type&&(t=t.concat(RED.group.getNodes(e,!0)))}),0<t.length){for(var o=[],i=0,n=0,a={},r=0;r<t.length;r++){var s=t[r];if(!a[s.id]&&(a[s.id]=!0,"subflow"!=s.type)){for(var d in"group"===s.type?n++:i++,s._def.defaults)s._def.defaults.hasOwnProperty(d)&&(!s._def.defaults[d].type||(d=RED.nodes.node(s[d]))&&d._def.exclusive&&o.push(RED.nodes.convertNode(d)));o.push(RED.nodes.convertNode(s))}}he=JSON.stringify(o),RED.menu.setDisabled("menu-item-edit-paste",!1),0<i?RED.notify(RED._("clipboard.nodeCopied",{count:i}),{id:"clipboard"}):0<n&&RED.notify(RED._("clipboard.groupCopied",{count:n}),{id:"clipboard"})}}}function Ve(e,t){for(var o=Ue(e),i=0,n=0;n<o.length;n++){var a=Fe(o[n],t)[0];i<a&&(i=a)}return{lines:o,width:i}}var He={},Ge={};function Fe(e,t){var o="!"+e;if(He[t]){if(Ge[t][o])return Ge[t][o]}else He[t]=document.createElement("span"),He[t].className=t,He[t].style.position="absolute",He[t].style.top="-1000px",document.getElementById("red-ui-editor").appendChild(He[t]),Ge[t]={};He[t].textContent=e||"";var i=He[t].offsetWidth,e=He[t].offsetHeight;return Ge[t][o]=[i,e],Ge[t][o]}function Ue(e){var t=[],o=e.split(/\\n /);if(1<o.length){for(var i=0,i=0;i<o.length-1;i++)/\\$/.test(o[i])?(t.push(o[i]+"\\n "+o[i+1]),i++):t.push(o[i]);i===o.length-1&&t.push(o[o.length-1])}else t=o;return t=t.map(function(e){return e.replace(/\\\\n /g,"\\n ").trim()})}function Je(){Z=0,D=W=U=X=q=J=null,I=!1,H&&(H.hovered=!1,H=null),d3.selectAll(".red-ui-flow-link-splice").classed("red-ui-flow-link-splice",!1),x&&(clearTimeout(x),x=null),R&&(clearTimeout(R),R=null)}function qe(e){17!==e.keyCode&&"Meta"!==e.key&&91!==e.keyCode||(Je(),De(),Lt(),$(window).off("keyup",qe))}function We(e,t,o,i){RED.view.DEBUG&&console.warn("portMouseDown",Z,e,t,o),1!==(i=i||d3.event)&&(Z!==RED.state.SELECTING_NODE?(J=e,W=t,K=o||0,Z!==RED.state.QUICK_JOINING&&(Z=RED.state.JOINING,document.body.style.cursor="crosshair",(i.ctrlKey||i.metaKey)&&(Z=RED.state.QUICK_JOINING,Ee([{node:J,port:K,portType:W}]),$(window).on("keyup",qe))),i.stopPropagation(),i.preventDefault()):i.stopPropagation())}function Ke(e,i,n,t){if(RED.view.DEBUG&&console.warn("portMouseUp",Z,e,i,n),t=t||d3.event,Z!==RED.state.SELECTING_NODE){if(Z===RED.state.QUICK_JOINING&&0<T.length){if(T[0].node===e)return;if(T[0].virtualLink&&("link in"===T[0].node.type&&"link out"!==e.type||"link out"===T[0].node.type&&"link in"!==e.type))return}if(document.body.style.cursor="",Z==RED.state.JOINING||Z==RED.state.QUICK_JOINING){if("undefined"!=typeof TouchEvent&&t instanceof TouchEvent){var a=!1;if(RED.nodes.eachNode(function(e){var t,o;e.z==RED.workspaces.active()&&(t=e.w/2,o=e.h/2,e.x-t<Q[0]&&e.x+t>Q[0]&&e.y-o<Q[1]&&e.y+o>Q[1]&&(a=!0,i=0<(X=e).inputs?ve:me,n=0))}),!a&&N){var o=[];N.status&&o.push(N.status),N.in&&(o=o.concat(N.in)),N.out&&(o=o.concat(N.out));for(var r=0;r<o.length;r++){var s=o[r],d=s.w/2,l=s.h/2;if(s.x-d<Q[0]&&s.x+d>Q[0]&&s.y-l<Q[1]&&s.y+l>Q[1]){a=!0,i="in"===(X=s).direction?me:ve,n=0;break}}}}else X=e;var c=[],p=[],u=[],f=null;for(r=0;r<T.length;r++)T[r].link&&p.push(T[r].link);var h,g,v,m,b,y,w,E,D,x,R=[];for(r=0;r<T.length;r++)i!=T[r].portType&&X!==T[r].node&&((h=T[r]).portType===me?(g=h.node,m=h.port,v=X,b=n):h.portType===ve&&(g=X,m=n,v=h.node,b=h.port),y={source:g,sourcePort:m,target:v,targetPort:b},h.virtualLink?/^link (in|out)$/.test(g.type)&&/^link (in|out)$/.test(v.type)&&g.type!==v.type&&-1===g.links.indexOf(v.id)&&-1===v.links.indexOf(g.id)&&(w=$.extend(!0,{},{v:g.links}).v,E=$.extend(!0,{},{v:v.links}).v,g.links.push(v.id),v.links.push(g.id),g.dirty=!0,v.dirty=!0,u.push(g),u.push(v),y.link=!0,P.push(y),B[g.id]=g,B[v.id]=v,f=y,R.push({t:"edit",node:g,dirty:RED.nodes.dirty(),changed:g.changed,changes:{links:w}}),R.push({t:"edit",node:v,dirty:RED.nodes.dirty(),changed:v.changed,changes:{links:E}}),g.changed=!0,v.changed=!0):"link out"===e.type&&i===me||"link in"===e.type&&i===ve||i===me&&"subflow"!==X.type&&0===X.outputs||i===ve&&"subflow"!==X.type&&0===X.inputs||h.portType===ve&&"subflow"===X.type&&("status"===X.direction||"out"===X.direction)||h.portType===me&&"subflow"===X.type&&"in"===X.direction||0!==RED.nodes.filterLinks({source:g,target:v,sourcePort:m,targetPort:b}).length||(RED.nodes.addLink(y),c.push(y)));if((0<c.length||0<p.length||0<u.length)&&(x=0<u.length?{t:"multi",events:R,dirty:RED.nodes.dirty()}:{t:"add",links:c,removedLinks:p,dirty:RED.nodes.dirty()},!N||(D=RED.subflow.refresh(!0))&&(x.subflow={id:N.id,changed:N.changed,instances:D.instances}),RED.history.push(x),xe(),RED.nodes.dirty(!0)),Z===RED.state.QUICK_JOINING)return(0<c.length||0<u.length)&&(De(),i===ve&&0<e.outputs?Ee([{node:e,port:0,portType:me}]):i===me&&0<e.inputs?Ee([{node:e,port:0,portType:ve}]):Je(),(U=f)?(ye.clear(),ye.add(f),Ne()):ye.clear()),void Lt();Je(),De(),f&&(ye.clear(),ye.add(f)),(U=f)&&Ne(),Lt()}}else t.stopPropagation()}var Xe,Ye=null,Qe=null;function Ze(e){var t=d3.select(e);if("red-ui-workspace-chart-event-layer"===t.attr("class"))return[0,0];var o,i=[0,0];"g"===e.nodeName.toLowerCase()?(o=t.attr("transform"))&&(i=d3.transform(o).translate):i=[t.attr("x")||0,t.attr("y")||0];e=Ze(e.parentNode);return[i[0]+e[0],i[1]+e[1]]}function et(t,o,e){if("link in"==t.type||"link out"==t.type)return null;var i,n=o===ve?t.inputLabels:t.outputLabels;if(n&&n[e])return n[e];n=o===ve?t._def.inputLabels:t._def.outputLabels;if("string"==typeof n)i=n;else if("function"==typeof n)try{i=n.call(t,e)}catch(e){console.log("Definition error: "+t.type+"."+(o===ve?"inputLabels":"outputLabels"),e),i=null}else if($.isArray(n))i=n[e];else{n=o===ve?t._def.inputInfo:t._def.outputInfo;if("function"==typeof n)try{(i=n.call(t,e)).hasOwnProperty("label")&&(i=i.label)}catch(e){console.log("Definition error: "+t.type+"."+(o===ve?"inputInfo":"outputInfo"),e),i=null}else $.isArray(n)&&e<n.length&&n[e].hasOwnProperty("label")?i=n[e].label:1<t.outputs&&(i=e)}return i}function tt(e,t,o,i){var n=b.append("g").attr("transform","translate("+e+","+t+")").attr("class","red-ui-flow-port-tooltip"),a=o.indexOf("\\n "),e=(o=-1<a&&"\\"!==o[a-1]?o.substring(0,a)+"...":o).split("\n"),r=6,s=12,d=[],l=0;e.forEach(function(e,t){e=Fe(e||"&nbsp;","red-ui-flow-port-tooltip-label");r=Math.max(r,e[0]+14),d.push(e[1]),0===t&&(l=e[1]),s+=e[1]});var c,p,u,t=r/2-5-2,a=s/2-5-2,o=s-4,f=-s/2;return"left"===i?(c="M0 0 l -5 -5 v -"+a+" q 0 -2 -2 -2 h -"+r+" q -2 0 -2 2 v "+o+" q 0 2 2 2 h "+r+" q 2 0 2 -2 v -"+a+" l 5 -5",p=-14,u="end"):"right"===i?(c="M0 0 l 5 -5 v -"+a+" q 0 -2 2 -2 h "+r+" q 2 0 2 2 v "+o+" q 0 2 -2 2 h -"+r+" q -2 0 -2 -2 v -"+a+" l -5 -5",p=14,u="start"):"top"===i&&(c="M0 0 l 5 -5 h "+t+" q 2 0 2 -2 v -"+s+" q 0 -2 -2 -2 h -"+(r-4)+" q -2 0 -2 2 v "+s+" q 0 2 2 2 h "+t+" l 5 5",p=-r/2+6,f=-s-l+12,u="start"),n.append("path").attr("d",c),e.forEach(function(e,t){f+=d[t],n.append("svg:text").attr("class","red-ui-flow-port-tooltip-label").attr("x",p).attr("y",f).attr("text-anchor",u).text(e||" ")}),n}function ot(e,t,o){Z!==RED.state.SELECTING_NODE?(t=Z!=RED.state.JOINING&&Z!=RED.state.QUICK_JOINING||0<T.length&&T[0].portType!==o&&(!T[0].virtualLink||"link in"===T[0].node.type&&"link out"===t.type||"link out"===T[0].node.type&&"link in"===t.type),e.classed("red-ui-flow-port-hovered",t)):d3.event.stopPropagation()}function it(e){Z!==RED.state.SELECTING_NODE?e.classed("red-ui-flow-port-hovered",!1):d3.event.stopPropagation()}function nt(e){for(Z=RED.state.MOVING,i=0;i<be.length();i++){var t=be.get(i);t.ox=t.n.x,t.oy=t.n.y,t.dx=t.n.x-e[0],t.dy=t.n.y-e[1]}try{Y=d3.mouse(document.body),isNaN(Y[0])&&(Y=d3.touches(document.body)[0])}catch(e){Y=[0,0]}}function at(e){if(RED.view.DEBUG&&console.warn("nodeMouseUp",Z,e),Z!==RED.state.SELECTING_NODE){if(re&&J==e&&0<de&&de<f)return Z=RED.state.DEFAULT,"subflow"!=e.type?/^subflow:/.test(e.type)&&(d3.event.ctrlKey||d3.event.metaKey)?RED.workspaces.show(e.type.substring(8)):RED.editor.edit(e):RED.editor.editSubflow(N),de=0,void d3.event.stopPropagation();if(Z===RED.state.MOVING&&!ue&&!e.selected&&e.g&&RED.nodes.group(e.g).selected){Oe(),Et(RED.nodes.group(e.g),!1),Dt(RED.nodes.group(e.g)),J.selected=!0,be.add(J);var t=d3.touches(this)[0]||d3.mouse(this);return t[0]+=e.x-e.w/2,t[1]+=e.y-e.h/2,nt(t),void Ne()}ue=!1;e._def?e.inputs:e.direction;t=!1;Z!==RED.state.JOINING&&Z!==RED.state.QUICK_JOINING||(t=!0,0<T.length&&(T[0].virtualLink?"link in"===e.type?0:"link out"===e.type&&0:T[0].portType)),t&&d3.selectAll(".red-ui-flow-port-hovered").classed("red-ui-flow-port-hovered",!1)}else d3.event.stopPropagation()}function rt(e){if(RED.view.DEBUG&&console.warn("nodeMouseDown",Z,e),St(),1!==d3.event.button){if(Z==RED.state.IMPORT_DRAGGING||Z==RED.state.DETACHED_DRAGGING){var t,o,i,n=RED.history.peek();if(D&&(t=d3.select(D).data()[0],RED.nodes.removeLink(t),o={source:t.source,sourcePort:t.sourcePort,target:be.get(0).n,targetPort:0},i={source:be.get(0).n,sourcePort:0,target:t.target,targetPort:t.targetPort},RED.nodes.addLink(o),RED.nodes.addLink(i),n.links=[o,i],n.removedLinks=[t],xe()),H){for(var a=0;a<be.length();a++){var r=be.get(a);RED.group.addToGroup(H,r.n)}(n.addedToGroup=H).hovered=!1,Dt(H),V.selected=!0,H=null}if(Z==RED.state.DETACHED_DRAGGING){for(var s=[],a=0;a<be.length();a++)(r=be.get(a)).ox===r.n.x&&r.oy===r.n.y||(s.push({n:r.n,ox:r.ox,oy:r.oy,moved:r.n.moved}),r.n.dirty=!0,r.n.moved=!0);RED.history.replace({t:"multi",events:[n,{t:"move",nodes:s}],dirty:n.dirty})}return Ne(),RED.nodes.dirty(!0),Lt(),Je(),void d3.event.stopPropagation()}if(Z!=RED.state.QUICK_JOINING){if(Z===RED.state.SELECTING_NODE)return d3.event.stopPropagation(),u.single?void u.done(e):(e.selected?(e.selected=!1,be.remove(e)):u.filter&&!u.filter(e)||(e.selected=!0,be.add(e)),e.dirty=!0,void Lt());J=e;n=Date.now();if(de=n-se,se=n,re=ae==J&&(d3.event.touches||0===d3.event.button)&&!d3.event.shiftKey&&!d3.event.altKey&&de<f,ae=J,!e.selected&&e.g){var d,l=RED.nodes.group(e.g);if(l!==V&&(d3.event.ctrlKey||d3.event.metaKey))ue=(V&&l.g===V.id||xt(),!0),l.selected?Rt(l):Et(l,!0);else if(l===V)if(d3.event.shiftKey){d3.event.ctrlKey||d3.event.metaKey||(p=V,Oe(),Dt(p),V.selected=!0),console.log(d3.event);for(var c=RED.nodes.getAllFlowNodes(J),r=0;r<c.length;r++)c[r].selected||(c[r].selected=!0,c[r].dirty=!0,be.add(c[r]))}else d3.event.ctrlKey||d3.event.metaKey||(p=V,Oe(),Rt(l),Et(l,!1,!1),p&&(Dt(p),V.selected=!0)),J.selected=!0,be.add(J);else{ue=!l.selected;var p=V;l.selected||Oe(),p?p!==l&&p.id!==l.g?(p.active=!1,p.dirty=!0):(V=p).active=!0:re=!1,Et(l,!(V&&V===l),!!ue),V&&V===l&&(J.selected=!0,be.add(J))}2!=d3.event.button&&((d=d3.touches(this)[0]||d3.mouse(this))[0]+=e.x-e.w/2,d[1]+=e.y-e.h/2,nt(d))}else if(e.selected&&(d3.event.ctrlKey||d3.event.metaKey))J.selected=!1,be.remove(J);else{if(d3.event.shiftKey){d3.event.ctrlKey||d3.event.metaKey||Oe();l=d3.event.offsetX/L-J.x;c=J.w/2-Math.abs(l)<(30<J.w?25:8)?[J].concat(l<0?RED.nodes.getAllUpstreamNodes(J):RED.nodes.getAllDownstreamNodes(J)):RED.nodes.getAllFlowNodes(J);for(r=0;r<c.length;r++)c[r].selected=!0,c[r].dirty=!0,be.add(c[r])}else e.selected||((d3.event.ctrlKey||d3.event.metaKey?xt:Oe)(),J.selected=!0,be.add(J));2!=d3.event.button&&(Z=RED.state.MOVING,(d=d3.touches(this)[0]||d3.mouse(this))[0]+=e.x-e.w/2,d[1]+=e.y-e.h/2,nt(d))}e.dirty=!0,Ne(),Lt(),d3.event.stopPropagation()}else d3.event.stopPropagation()}}function st(e){RED.view.DEBUG&&console.warn("nodeTouchStart",Z,e);var t=d3.select(this),o=d3.event.touches.item(0),i=[o.pageX,o.pageY];m=[o.pageX,o.pageY],v=0,y=setTimeout(function(){Tt(t,i)},g),rt.call(this,e),d3.event.preventDefault()}function dt(e){RED.view.DEBUG&&console.warn("nodeTouchEnd",Z,e),d3.event.preventDefault(),clearTimeout(y),y=null,RED.touch.radialMenu.active()?d3.event.stopPropagation():at.call(this,e)}function lt(o){var i,e,t;RED.view.DEBUG&&console.warn("nodeMouseOver",Z,o),0===Z||Z===RED.state.SELECTING_NODE?(Z===RED.state.SELECTING_NODE&&u&&u.filter&&!u.filter(o)||this.parentNode.classList.add("red-ui-flow-node-hovered"),clearTimeout(Ye),(o.hasOwnProperty("l")?o.l:"link in"!==o.type&&"link out"!==o.type)||(i=this.parentNode,Ye=setTimeout(function(){var t,e;if(o._def.label){t=o._def.label;try{t=("function"==typeof t?t.call(o):t)||""}catch(e){console.log("Definition error: "+o.type+".label",e),t=o.type}}""!==t&&(e=Ze(i),Ye=null,Qe=tt(e[0]+o.w/2,e[1]-1,t,"top"))},500))):Z!==RED.state.JOINING&&Z!==RED.state.QUICK_JOINING||0<T.length&&(t=T[0].virtualLink&&T[0].portType===ve||T[0].portType===me?(e=".red-ui-flow-port-input .red-ui-flow-port",ve):(e=".red-ui-flow-port-output .red-ui-flow-port",me),ot(d3.select(this.parentNode).selectAll(e),o,t))}function ct(e){var t;RED.view.DEBUG&&console.warn("nodeMouseOut",Z,e),this.parentNode.classList.remove("red-ui-flow-node-hovered"),clearTimeout(Ye),Qe&&(Qe.remove(),Qe=null),Z!==RED.state.JOINING&&Z!==RED.state.QUICK_JOINING||0<T.length&&(T[0].virtualLink&&T[0].portType===ve||T[0].portType===me?t=".red-ui-flow-port-input .red-ui-flow-port":t=".red-ui-flow-port-output .red-ui-flow-port",it(d3.select(this.parentNode).selectAll(t)))}function pt(e){We(this.__data__,this.__portType__,this.__portIndex__,e)}function ut(e){We(this.__data__,this.__portType__,this.__portIndex__,e),e.preventDefault()}function ft(e){Ke(this.__data__,this.__portType__,this.__portIndex__,e)}function ht(e){Ke(this.__data__,this.__portType__,this.__portIndex__,e),e.preventDefault()}function gt(e){ot(d3.select(this),this.__data__,this.__portType__,this.__portIndex__)}function vt(e){it(d3.select(this),this.__data__,this.__portType__,this.__portIndex__)}function mt(e){var t;Z!==RED.state.SELECTING_NODE?2!==d3.event.button&&(U=e,d3.event.metaKey||d3.event.ctrlKey||Oe(),(d3.event.metaKey||d3.event.ctrlKey)&&ye.has(U)?1!==ye.length()&&ye.remove(U):ye.add(U),Ne(),Lt(),St(),d3.event.stopPropagation(),U.link||0!==be.length()||!d3.event.touches&&0!==d3.event.button||1!==ye.length()||!ye.has(U)||!d3.event.metaKey&&!d3.event.ctrlKey||(d3.select(this).classed("red-ui-flow-link-splice",!0),e=kt((t=d3.mouse(this))[0],t[1]),_e({position:t,splice:U,group:e}))):d3.event.stopPropagation()}function bt(e){var t,o;Z!==RED.state.SELECTING_NODE?(U=e,Oe(),ye.clear(),ye.add(U),Ne(),Lt(),St(),d3.event.stopPropagation(),t=d3.select(document.body),e=d3.event.touches.item(0),o=[e.pageX,e.pageY],y=setTimeout(function(){y=null,Tt(t,o)},g),d3.event.preventDefault()):d3.event.stopPropagation()}function yt(e){re&&q==e&&0<de&&de<f&&(Z=RED.state.DEFAULT,RED.editor.editGroup(e),d3.event.stopPropagation())}function wt(e){var t,o=d3.touches(this.parentNode)[0]||d3.mouse(this.parentNode);St(),1!==d3.event.button&&(Z!=RED.state.QUICK_JOINING&&Z!==RED.state.SELECTING_NODE&&(q=e,t=Date.now(),de=t-se,se=t,re=ae==e&&(d3.event.touches||0===d3.event.button)&&!d3.event.shiftKey&&!d3.event.metaKey&&!d3.event.altKey&&!d3.event.ctrlKey&&de<f,(ae=e).selected&&(d3.event.ctrlKey||d3.event.metaKey)?(e===V&&xt(),Rt(e),d3.event.stopPropagation()):(e.selected?V&&e.g!==V.id&&xt():(d3.event.ctrlKey||d3.event.metaKey||(t=V,Oe(),t&&e.g===t.id&&(Dt(t),V.selected=!0)),V&&(RED.group.contains(V,e)||xt()),Et(e,!0)),2!=d3.event.button&&(e.nodes[0],nt(o),q.dx=q.x-o[0],q.dy=q.y-o[1])),Ne(),Lt()),d3.event.stopPropagation())}function Et(e,t,o){var i;e.selected||(e.selected=!0,e.dirty=!0),!1!==o&&be.add(e),t&&(i=new Set(be.nodes()),RED.group.getNodes(e,!0).forEach(function(e){i.has(e)||be.add(e),e.dirty=!0}))}function Dt(e){V&&xt(),e.active=!0,e.dirty=!0,V=e,be.remove(e)}function xt(){V&&(V.active=!1,V.dirty=!0,Rt(V),Et(V,!0),V=null)}function Rt(e){e.selected&&(e.selected=!1,e.dirty=!0);var t=new Set(e.nodes);t.add(e);for(var o=be.length()-1;0<=o;--o){var i=be.get(o);!t.has(i.n)&&i.n!==e||(i.n.selected=!1,i.n.dirty=!0,be.remove(i.n,o))}}function kt(e,t){for(var o={},i=0;i<G.length;i++){var n=G[i];e>=n.x&&e<=n.x+n.w&&t>=n.y&&t<=n.y+n.h&&(o[n.id]=n)}var a=Object.keys(o);return 1<a.length&&(a.forEach(function(e){o[e]&&o[e].g&&delete o[o[e].g]}),a=Object.keys(o)),0===a.length?null:o[a[a.length-1]]}function _t(e){var t=!0,o=RED.nodes.workspace(RED.workspaces.active());return!o||o.disabled||e.d?t=!1:e._def.button.hasOwnProperty("enabled")&&(t="function"==typeof e._def.button.enabled?e._def.button.enabled.call(e):e._def.button.enabled),t}function $t(t){if(Z!==RED.state.SELECTING_NODE){var e=RED.workspaces.active(),e=RED.nodes.workspace(e);if(!e||e.disabled||t.d)N?RED.notify(RED._("notification.warning",{message:RED._("notification.warnings.nodeActionDisabledSubflow")}),"warning"):RED.notify(RED._("notification.warning",{message:RED._("notification.warnings.nodeActionDisabled")}),"warning");else{if(t._def.button.toggle&&(t[t._def.button.toggle]=!t[t._def.button.toggle],t.dirty=!0),t._def.button.onclick)try{t._def.button.onclick.call(t)}catch(e){console.log("Definition error: "+t.type+".onclick",e)}t.dirty&&Lt()}d3.event&&d3.event.preventDefault()}else d3.event&&d3.event.stopPropagation()}function Tt(e,t){var o=J,i=[];i.push({name:"delete",disabled:0===be.length()&&0===ye.length(),onselect:function(){Ae()}}),i.push({name:"cut",disabled:0===be.length(),onselect:function(){Be(),Ae()}}),i.push({name:"copy",disabled:0===be.length(),onselect:function(){Be()}}),i.push({name:"paste",disabled:0===he.length,onselect:function(){Mt(he,{generateIds:!0,touchImport:!0})}}),i.push({name:"edit",disabled:1!=be.length(),onselect:function(){RED.editor.edit(o)}}),i.push({name:"select",onselect:function(){Me()}}),i.push({name:"undo",disabled:0===RED.history.depth(),onselect:function(){RED.history.pop()}}),i.push({name:"add",onselect:function(){chartPos=k.offset(),_e({position:[t[0]-chartPos.left+k.scrollLeft(),t[1]-chartPos.top+k.scrollTop()],touchTrigger:!0})}}),RED.touch.radialMenu.show(e,t,i),Je()}function Ct(o,e,t){var i,n,a,r=null;0===o.indexOf("font-awesome/")&&(i=o.substr(13),(r=RED.nodes.fontAwesome.getIconUnicode(i))||(t=RED.utils.getDefaultNodeIcon(t._def,t),o=RED.settings.apiRootUrl+"icons/"+t.module+"/"+t.file)),r?e.append("text").attr("xlink:href",o).attr("class","fa-lg").attr("x",15).text(r):(n=e.append("image").style("display","none").attr("xlink:href",o).attr("class","red-ui-flow-node-icon").attr("x",0).attr("width","30").attr("height","30"),(a=new Image).src=o,a.onload=function(){var e,t;o.match(/\.svg$/)||(e=Math.max(a.width,a.height),t=1,e=a.width*(t=30<e?30/e:t),t=a.height*t,n.attr("width",e),n.attr("height",t),n.attr("x",15-e/2)),n.attr("xlink:href",o),n.style("display",null)})}function jt(e,t){var o;e.z===RED.workspaces.active()&&(t=t||document.getElementById(e.id))&&(ne&&e.status&&!0!==e.d?(t.__statusGroup__.style.display="inline",o=ge[e.status.fill],null==e.status.shape&&null==o?(t.__statusShape__.style.display="none",t.__statusGroup__.setAttribute("transform","translate(-14,"+(e.h+3)+")")):(t.__statusGroup__.setAttribute("transform","translate(3,"+(e.h+3)+")"),o="red-ui-flow-node-status-"+(e.status.shape||"dot")+"-"+e.status.fill,t.__statusShape__.style.display="inline",t.__statusShape__.setAttribute("class","red-ui-flow-node-status "+o)),e.status.hasOwnProperty("text")?t.__statusLabel__.textContent=e.status.text:t.__statusLabel__.textContent=""):t.__statusGroup__.style.display="none",ne&&e.statusTop?(t.__statusTop__.style.display="inline",e.statusTop.hasOwnProperty("text")?t.__statusTop__.textContent=e.statusTop.text:t.__statusTop__.textContent=""):t.__statusTop__.style.display="none",delete e.dirtyStatus)}function Lt(){RED.view.DEBUG_SYNC_REDRAW?zt():(Xe&&cancelAnimationFrame(Xe),Xe=requestAnimationFrame(zt))}function zt(){var D,e,t,x,o,n,a;b.attr("transform","scale("+L+")"),_.attr("width",C*L).attr("height",j*L),-1!==pe||Z!=RED.state.JOINING?(D={},N?((e=d.selectAll(".red-ui-flow-subflow-port-output").data(N.out,function(e,t){return e.id})).exit().remove(),(o=e.enter().insert("svg:g").attr("class","red-ui-flow-node red-ui-flow-subflow-port-output").attr("transform",function(e){return"translate("+(e.x-20)+","+(e.y-20)+")"})).each(function(e,t){e.w=40,e.h=40}),o.append("rect").attr("class","red-ui-flow-subflow-port").attr("rx",8).attr("ry",8).attr("width",40).attr("height",40).on("mouseup",at).on("mousedown",rt).on("touchstart",st).on("touchend",dt),o.append("g").attr("transform","translate(-5,15)").append("rect").attr("class","red-ui-flow-port").attr("rx",3).attr("ry",3).attr("width",10).attr("height",10).on("mousedown",function(e,t){We(e,ve,t)}).on("touchstart",function(e,t){We(e,ve,t),d3.event.preventDefault()}).on("mouseup",function(e,t){Ke(e,ve,t)}).on("touchend",function(e,t){Ke(e,ve,t),d3.event.preventDefault()}).on("mouseover",function(e){ot(d3.select(this),e,ve,i)}).on("mouseout",function(e){it(d3.select(this),i)}),o.append("svg:text").attr("class","red-ui-flow-port-label").attr("x",20).attr("y",12).style("font-size","10px").text("output"),o.append("svg:text").attr("class","red-ui-flow-port-label red-ui-flow-port-index").attr("x",20).attr("y",28).text(function(e,t){return t+1}),(n=d.selectAll(".red-ui-flow-subflow-port-input").data(N.in,function(e,t){return e.id})).exit().remove(),(t=n.enter().insert("svg:g").attr("class","red-ui-flow-node red-ui-flow-subflow-port-input").attr("transform",function(e){return"translate("+(e.x-20)+","+(e.y-20)+")"})).each(function(e,t){e.w=40,e.h=40}),t.append("rect").attr("class","red-ui-flow-subflow-port").attr("rx",8).attr("ry",8).attr("width",40).attr("height",40).on("mouseup",at).on("mousedown",rt).on("touchstart",st).on("touchend",dt),t.append("g").attr("transform","translate(35,15)").append("rect").attr("class","red-ui-flow-port").attr("rx",3).attr("ry",3).attr("width",10).attr("height",10).on("mousedown",function(e,t){We(e,me,t)}).on("touchstart",function(e,t){We(e,me,t),d3.event.preventDefault()}).on("mouseup",function(e,t){Ke(e,me,t)}).on("touchend",function(e,t){Ke(e,me,t),d3.event.preventDefault()}).on("mouseover",function(e){ot(d3.select(this),e,me,i)}).on("mouseout",function(e){it(d3.select(this),i)}),t.append("svg:text").attr("class","red-ui-flow-port-label").attr("x",20).attr("y",8).style("font-size","10px").text("input"),t.append("svg:text").attr("class","red-ui-flow-port-label red-ui-flow-port-index").attr("x",20).attr("y",24).text(function(e,t){return t+1}),(o=d.selectAll(".red-ui-flow-subflow-port-status").data(N.status?[N.status]:[],function(e,t){return e.id})).exit().remove(),(t=o.enter().insert("svg:g").attr("class","red-ui-flow-node red-ui-flow-subflow-port-status").attr("transform",function(e){return"translate("+(e.x-20)+","+(e.y-20)+")"})).each(function(e,t){e.w=40,e.h=40}),t.append("rect").attr("class","red-ui-flow-subflow-port").attr("rx",8).attr("ry",8).attr("width",40).attr("height",40).on("mouseup",at).on("mousedown",rt).on("touchstart",st).on("touchend",dt),t.append("g").attr("transform","translate(-5,15)").append("rect").attr("class","red-ui-flow-port").attr("rx",3).attr("ry",3).attr("width",10).attr("height",10).on("mousedown",function(e,t){We(e,ve,0)}).on("touchstart",function(e,t){We(e,ve,0),d3.event.preventDefault()}).on("mouseup",function(e,t){Ke(e,ve,0)}).on("touchend",function(e,t){Ke(e,ve,0),d3.event.preventDefault()}).on("mouseover",function(e){ot(d3.select(this),e,ve)}).on("mouseout",function(e){it(d3.select(this))}),t.append("svg:text").attr("class","red-ui-flow-port-label").attr("x",22).attr("y",20).style("font-size","10px").text("status"),e.each(function(e,t){var o;e.dirty&&((o=d3.select(this)).classed("red-ui-flow-node-selected",function(e){return e.selected}),o.classed("red-ui-flow-node-working",function(e){return e.working}),o.selectAll(".red-ui-flow-port-index").text(function(e){return e.i+1}),o.attr("transform",function(e){return"translate("+(e.x-e.w/2)+","+(e.y-e.h/2)+")"}),(D[e.id]=e).dirty=!1)}),n.each(function(e,t){var o;e.dirty&&((o=d3.select(this)).classed("red-ui-flow-node-selected",function(e){return e.selected}),o.classed("red-ui-flow-node-working",function(e){return e.working}),o.attr("transform",function(e){return"translate("+(e.x-e.w/2)+","+(e.y-e.h/2)+")"}),(D[e.id]=e).dirty=!1)}),o.each(function(e,t){var o;e.dirty&&((o=d3.select(this)).classed("red-ui-flow-node-selected",function(e){return e.selected}),o.classed("red-ui-flow-node-working",function(e){return e.working}),o.selectAll(".red-ui-flow-port-index").text(function(e){return e.i+1}),o.attr("transform",function(e){return"translate("+(e.x-e.w/2)+","+(e.y-e.h/2)+")"}),(D[e.id]=e).dirty=!1)})):(d.selectAll(".red-ui-flow-subflow-port-output").remove(),d.selectAll(".red-ui-flow-subflow-port-input").remove(),d.selectAll(".red-ui-flow-subflow-port-status").remove()),(n=d.selectAll(".red-ui-flow-node-group").data(E,function(e){return e.id})).exit().each(function(e,t){RED.hooks.trigger("viewRemoveNode",{node:e,el:this})}).remove(),n.enter().insert("svg:g").attr("class","red-ui-flow-node red-ui-flow-node-group").classed("red-ui-flow-subflow",null!=N).each(function(e,t){this.__outputs__=[],this.__inputs__=[];var o=d3.select(this),i=document.createDocumentFragment(),n="link in"===e.type||"link out"===e.type,n=e.hasOwnProperty("l")?!e.l:n;o.attr("id",e.id),e.h=M,e.resize=!0,e._def.button&&((a=document.createElementNS("http://www.w3.org/2000/svg","g")).__data__=e,a.setAttribute("transform","translate("+("right"==e._def.align?94:-25)+",2)"),a.setAttribute("class","red-ui-flow-node-button"),o[0][0].__buttonGroup__=a,(r=document.createElementNS("http://www.w3.org/2000/svg","rect")).__data__=e,r.setAttribute("class","red-ui-flow-node-button-background"),r.setAttribute("rx",5),r.setAttribute("ry",5),r.setAttribute("width",32),r.setAttribute("height",M-4),a.appendChild(r),o[0][0].__buttonGroupBackground__=r,(r=document.createElementNS("http://www.w3.org/2000/svg","rect")).__data__=e,r.setAttribute("class","red-ui-flow-node-button-button"),r.setAttribute("x","right"==e._def.align?11:5),r.setAttribute("y",4),r.setAttribute("rx",4),r.setAttribute("ry",4),r.setAttribute("width",16),r.setAttribute("height",M-12),r.setAttribute("fill",RED.utils.getNodeColor(e.type,e._def)),d3.select(r).on("mousedown",function(e){!ee&&_t(e)&&(St(),d3.select(this).attr("fill-opacity",.2),d3.event.preventDefault(),d3.event.stopPropagation())}).on("mouseup",function(e){!ee&&_t(e)&&(d3.select(this).attr("fill-opacity",.4),d3.event.preventDefault(),d3.event.stopPropagation())}).on("mouseover",function(e){!ee&&_t(e)&&d3.select(this).attr("fill-opacity",.4)}).on("mouseout",function(e){var t;!ee&&_t(e)&&(t=1,e._def.button.toggle&&(t=e[e._def.button.toggle]?1:.2),d3.select(this).attr("fill-opacity",t))}).on("click",$t).on("touchstart",function(e){$t.call(this,e),d3.event.preventDefault()}),a.appendChild(r),o[0][0].__buttonGroupButton__=r,i.appendChild(a));var a,r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.__data__=e,r.setAttribute("class","red-ui-flow-node "+("unknown"==e.type?"red-ui-flow-node-unknown":"")),r.setAttribute("rx",5),r.setAttribute("ry",5),r.setAttribute("fill",RED.utils.getNodeColor(e.type,e._def)),o[0][0].__mainRect__=r,d3.select(r).on("mouseup",at).on("mousedown",rt).on("touchstart",st).on("touchend",dt).on("mouseover",lt).on("mouseout",ct),i.appendChild(r),e._def.icon&&(a=RED.utils.getNodeIcon(e._def,e),(s=document.createElementNS("http://www.w3.org/2000/svg","g")).__data__=e,s.setAttribute("class","red-ui-flow-node-icon-group"+("right"==e._def.align?" red-ui-flow-node-icon-group-right":"")),s.setAttribute("x",0),s.setAttribute("y",0),s.style["pointer-events"]="none",o[0][0].__iconGroup__=s,(r=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("class","red-ui-flow-node-icon-shade"),r.setAttribute("width",30),r.setAttribute("height",Math.min(50,e.h-4)),s.appendChild(r),o[0][0].__iconShade__=r,Ct(a,d3.select(s),e),(a=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","right"!=e._def.align?"M 30 1 l 0 "+(e.h-2):"M 0 1 l 0 "+(e.h-2)),a.setAttribute("class","red-ui-flow-node-icon-shade-border"),s.appendChild(a),o[0][0].__iconShadeBorder__=a,i.appendChild(s));var s=document.createElementNS("http://www.w3.org/2000/svg","g");s.setAttribute("class","red-ui-flow-node-label"+(n?" hide":"")+(e._def.align?" red-ui-flow-node-label-"+e._def.align:"")),s.setAttribute("transform","translate(38,0)"),i.appendChild(s),o[0][0].__textGroup__=s;n=document.createElementNS("http://www.w3.org/2000/svg","g");n.setAttribute("class","red-ui-flow-node-status-group"),n.style.display="none",o[0][0].__statusGroup__=n;s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("class","red-ui-flow-node-status"),s.setAttribute("x",6),s.setAttribute("y",1),s.setAttribute("width",9),s.setAttribute("height",9),s.setAttribute("rx",2),s.setAttribute("ry",2),s.setAttribute("stroke-width","3"),n.appendChild(s),o[0][0].__statusShape__=s;s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("class","red-ui-flow-node-status-label"),s.setAttribute("x",20),s.setAttribute("y",9),n.appendChild(s),o[0][0].__statusLabel__=s,i.appendChild(n);n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("class","red-ui-flow-node-status-label-top"),n.setAttribute("x",7),n.setAttribute("y",-3),o[0][0].__statusTop__=n,i.appendChild(n),o[0][0].appendChild(i),RED.hooks.trigger("viewAddNode",{node:e,el:this})}),x=!1,n.each(function(s,e){if(s._reordered&&(x=!0,delete s._reordered),s.dirty){var o=d3.select(this),i="link in"===s.type||"link out"===s.type,n=s.hasOwnProperty("l")?!s.l:i;D[s.id]=s;var t,a=RED.utils.getNodeLabel(s,s.type);if(!s.resize&&this.__hideLabel__===n&&this.__label__===a&&this.__inputs__.length===s.inputs&&this.__outputs__.length===s.outputs||((p=Ve(a,"red-ui-flow-node-label")).lines.length===this.__labelLineCount__&&this.__label__===a||(s.resize=!0),this.__label__=a,this.__labelLineCount__=p.lines.length,s.h=n?Math.max(M,20*(s.outputs||0),20*(s.inputs||0)):Math.max(M,6+24*p.lines.length,20*(s.outputs||0),20*(s.inputs||0)),this.__hideLabel__=n),s.resize&&(t=s.w,s.w=n?M:Math.max(S,z*Math.ceil((p.width+50+(0<s._def.inputs?7:0))/z)),void 0!==t&&(s.x+=(s.w-t)/2),s.resize=!1),s._colorChanged&&(t=RED.utils.getNodeColor(s.type,s._def),this.__mainRect__.setAttribute("fill",t),this.__buttonGroupButton__&&this.__buttonGroupButton__.settAttribute("fill",t),delete s._colorChanged),this.setAttribute("transform","translate("+(s.x-s.w/2)+","+(s.y-s.h/2)+")"),this.classList.toggle("red-ui-flow-node-selected",!!s.selected),this.classList.toggle("red-ui-flow-node-working",!!s.working),Z!=RED.state.MOVING_ACTIVE){if(s.hasOwnProperty("fixedInputs")||(s.fixedInputs=0),this.classList.toggle("red-ui-flow-node-disabled",!0===s.d),this.__mainRect__.setAttribute("width",s.w),this.__mainRect__.setAttribute("height",s.h),this.__mainRect__.classList.toggle("red-ui-flow-node-highlighted",!!s.highlighted),p){for(var r=p.lines,d=p.lines.length,l=this.__textGroup__.childNodes;l.length>d;)l[l.length-1].remove();for(var c,e=0;e<d;e++)e===l.length&&((c=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("class","red-ui-flow-node-label-text"),c.setAttribute("x",0),c.setAttribute("y",24*e),this.__textGroup__.appendChild(c)),l[e].textContent=r[e]}var p="";if(s._def.labelStyle){p=s._def.labelStyle;try{p=("function"==typeof p?p.call(s):p)||""}catch(e){console.log("Definition error: "+s.type+".labelStyle",e),p=""}p=" "+p}p="red-ui-flow-node-label"+(s._def.align?" red-ui-flow-node-label-"+s._def.align:"")+p+(n?" hide":""),this.__textGroup__.setAttribute("class",p);var n=s.h/2-this.__labelLineCount__/2*24+13;!s._def.align&&0!==s.inputs&&0===s.outputs||"right"===s._def.align?(this.__iconGroup__&&(this.__iconGroup__.classList.add("red-ui-flow-node-icon-group-right"),this.__iconGroup__.setAttribute("transform","translate("+(s.w-30)+",0)")),this.__textGroup__.classList.add("red-ui-flow-node-label-right"),this.__textGroup__.setAttribute("transform","translate("+(s.w-38)+","+n+")")):(this.__iconGroup__&&(this.__iconGroup__.classList.remove("red-ui-flow-node-icon-group-right"),this.__iconGroup__.setAttribute("transform","")),this.__textGroup__.classList.remove("red-ui-flow-node-label-right"),this.__textGroup__.setAttribute("transform","translate(38,"+n+")"));for(var u=s.inputs,f=s.h/2-(u-1)/2*18;this.__inputs__.length>u;){var h=this.__inputs__.pop();RED.hooks.trigger("viewRemovePort",{node:s,el:this,port:h,portType:"input",portIndex:this.__inputs__.length}),h.remove()}for(let a=0;a<u;a++){let e,t;a===this.__inputs__.length?(e=document.createElementNS("http://www.w3.org/2000/svg","g"),e.setAttribute("class","red-ui-flow-port-input"),"link in"===s.type?(t=document.createElementNS("http://www.w3.org/2000/svg","circle"),t.setAttribute("cx",-1),t.setAttribute("cy",5),t.setAttribute("r",5),t.setAttribute("class","red-ui-flow-port red-ui-flow-link-port")):(t=document.createElementNS("http://www.w3.org/2000/svg","rect"),t.setAttribute("rx",3),t.setAttribute("ry",3),t.setAttribute("width",10),t.setAttribute("height",10),t.setAttribute("class","red-ui-flow-port")),e.appendChild(t),t.__data__=this.__data__,t.__portType__=ve,t.__portIndex__=a,t.addEventListener("mousedown",pt),t.addEventListener("touchstart",ut),t.addEventListener("mouseup",ft),t.addEventListener("touchend",ht),t.addEventListener("mouseover",gt),t.addEventListener("mouseout",vt),portLabel=document.createElementNS("http://www.w3.org/2000/svg","text"),portLabel.setAttribute("class","red-ui-flow-node-port-input-label"),portLabel.setAttribute("rx",0),portLabel.setAttribute("ry",0),portLabel.setAttribute("width",50),portLabel.setAttribute("height",10),portLabel.textContent=et(s,t.__portType__,a),e.appendChild(portLabel),this.appendChild(e),this.__inputs__.push(e),RED.hooks.trigger("viewAddPort",{node:s,el:this,port:e,portType:"input",portIndex:a})):(e=this.__inputs__[a],$(e).children("text").html(et(s,ve,a)));var g=-5,f=s.h/2-(u-1)/2*18;e.setAttribute("transform","translate("+g+","+(f+18*a-5)+")");let o="",i="",n="";if(s._def&&s._def.inputInfo&&a<s._def.inputInfo.length){let t=s._def.inputInfo[a];var v=RED._(s._def.set.id+":"+s.type+".input"+(a+1)+"Description");if(t&&t.hasOwnProperty("types")){o="",t.label&&"-"!=t.label&&(o="<p><b>"+t.label+"</b></p>");for(let e=0;e<t.types.length;e++)i&&(i+=", "),i+=t.types[e];i=i&&"<p><b>Types:</b> <i>"+i+"</i></p>",n=v}}var m=s.id,v=RED.popover.create({target:$(t),trigger:"hover",width:"250px",content:function(){if("function"==typeof s._def.inputInfo){let t=s._def.inputInfo.call(s,a);var e=t.description;if(t&&t.hasOwnProperty("types")){o="",i="",t.label&&"-"!=t.label&&(o="<p><b>"+t.label+"</b></p>");for(let e=0;e<t.types.length;e++)i&&(i+=", "),i+=t.types[e];i=i&&"<p><b>Types:</b> <i>"+i+"</i></p>",n=e}}e="inputValue"+a;return RED.comms.homegear().invoke("getNodeVariable",function(e){setTimeout(function(){$(".red-ui-popover .last_value").text(JSON.stringify(e.result))},100)},m,e),$('<div style="float: right"><a class="popover-dialog1" href="#">'+RED._("history.title")+'</a>&nbsp;&nbsp;<a class="popover-dialog2" href="#">'+RED._("fixedInputs.set")+"</a></div>"+o+i+"<p><b>"+RED._("history.lastValue")+'</b> <span class="last_value">-</span></p><div style="clear: both">'+n+"</div>")},direction:"left",offsetX:-10,offsetY:0,delay:{show:750,hide:300},dialog1:function(){var o="inputHistory"+a;$('<div id="popover-dialog" class="hide node-red-dialog"><div class="history-values"></div></div>').appendTo("body").dialog({modal:!0,autoOpen:!1,width:500,height:450,resizable:!1,buttons:[{id:"popover-dialog-close",class:"primary",text:RED._("common.label.close"),click:function(){$(this).dialog("close")}}],open:function(e){$(this).parent().find(".ui-dialog-titlebar-close").hide(),RED.comms.homegear().invoke("getNodeVariable",function(e){var i;e.result&&(i="",$.each(e.result,function(e,t){var o=new Date(t[0]);i+='<p><span class="value-history-date">'+o.toLocaleDateString(void 0,{year:"numeric",day:"2-digit",month:"2-digit"})+" "+o.toLocaleTimeString(void 0,{hour12:!1})+"."+("000"+t[0]%1e3).slice(-3)+": </span><span>"+t[1]+"</span></p>"}),$("#popover-dialog .history-values").html(i))},m,o);var t=setInterval(function(){RED.comms.homegear().invoke("getNodeVariable",function(e){var i;e.result&&(i="",$.each(e.result,function(e,t){var o=new Date(t[0]);i+='<p><span class="value-history-date">'+o.toLocaleDateString(void 0,{year:"numeric",day:"2-digit",month:"2-digit"})+" "+o.toLocaleTimeString(void 0,{hour12:!1})+"."+("000"+t[0]%1e3).slice(-3)+": </span><span>"+t[1]+"</span></p>"}),$("#popover-dialog .history-values").html(i))},m,o)},1e3);$(this).dialog("option","interval",t)},close:function(e){var t=$(this).dialog("option","interval");t&&clearInterval(t),$(this).remove()}}).dialog("option","title",RED._("history.title")).dialog("open")},dialog2:function(){var t="fixedInput"+a;$('<div id="popover-dialog" class="hide node-red-dialog"><div class="fixed-input"><p>'+RED._("fixedInputs.description")+'</p><form><input type="text" id="fixed-input-payload" style="width:100%"/><input type="hidden" id="fixed-input-payloadType"/></form></div></div>').appendTo("body").dialog({modal:!0,autoOpen:!1,width:400,resizable:!1,buttons:[{id:"popover-dialog-cancel",class:"primary",text:RED._("common.label.cancel"),click:function(){$(this).dialog("close")}},{id:"popover-dialog-clear",class:"primary",text:RED._("fixedInputs.clear"),click:function(){RED.comms.homegear().invoke("setNodeVariable",null,m,t,!1),0<s.fixedInputs&&--s.fixedInputs,s.dirty=!0,$(this).dialog("close"),Lt()}},{id:"popover-dialog-set",class:"primary",text:RED._("fixedInputs.set"),click:function(){var e=$("#fixed-input-payload");RED.comms.homegear().invoke("setNodeVariable",null,m,t,[e.typedInput("type"),e.typedInput("value")]),$("#fixed-input-payload").data("oldPayload")||(s.fixedInputs+=1),s.dirty=!0,$(this).dialog("close"),Lt()}}],open:function(e){$(this).parent().find(".ui-dialog-titlebar-close").hide(),RED.comms.homegear().invoke("getNodeVariable",function(e){var t=e.result?e.result[0]:"int",o=e.result?e.result[1]:"";oldPayload=!!e.result,$("#fixed-input-payloadType").val(t),$("#fixed-input-payload").typedInput({default:"int",typeField:$("#fixed-input-payloadType"),types:["bool","int","float","string","arraySimple","structSimple","binSimple"]}),$("#fixed-input-payload").typedInput("type",t),$("#fixed-input-payload").typedInput("value",o),$("#fixed-input-payload").data("oldPayload",oldPayload)},m,t)},close:function(e){$(this).remove()}}).dialog("option","title",RED._("fixedInputs.title")).dialog("open")},intervalCallback:function(){var e="inputValue"+a;RED.comms.homegear().invoke("getNodeVariable",function(e){$(".red-ui-popover .last_value").text(JSON.stringify(e.result))},m,e)}});$(t).data("popover",v)}let t=s.outputs;i&&"link out"===s.type&&(t="return"===s.mode||pe!==me&&!B[s.id]?0:1);for(var b,f=s.h/2-(t-1)/2*18;this.__outputs__.length>t;){h=this.__outputs__.pop();RED.hooks.trigger("viewRemovePort",{node:s,el:this,port:h,portType:"output",portIndex:this.__outputs__.length}),h.remove()}for(let r=0;r<t;r++){let e,a;r===this.__outputs__.length?(e=document.createElementNS("http://www.w3.org/2000/svg","g"),e.setAttribute("class","red-ui-flow-port-output"),"link out"===s.type?(a=document.createElementNS("http://www.w3.org/2000/svg","circle"),a.setAttribute("cx",11),a.setAttribute("cy",5),a.setAttribute("r",5),a.setAttribute("class","red-ui-flow-port red-ui-flow-link-port")):(a=document.createElementNS("http://www.w3.org/2000/svg","rect"),a.setAttribute("rx",3),a.setAttribute("ry",3),a.setAttribute("width",10),a.setAttribute("height",10),a.setAttribute("class","red-ui-flow-port")),e.appendChild(a),e.__port__=a,a.__data__=this.__data__,a.__portType__=me,a.__portIndex__=r,a.addEventListener("mousedown",pt),a.addEventListener("touchstart",ut),a.addEventListener("mouseup",ft),a.addEventListener("touchend",ht),a.addEventListener("mouseover",gt),a.addEventListener("mouseout",vt),portLabel=document.createElementNS("http://www.w3.org/2000/svg","text"),portLabel.setAttribute("class","red-ui-flow-node-port-output-label"),portLabel.setAttribute("rx",0),portLabel.setAttribute("ry",0),portLabel.setAttribute("width",50),portLabel.setAttribute("height",10),portLabel.setAttribute("transform","translate(10,0)"),portLabel.textContent=et(s,a.__portType__,r),e.appendChild(portLabel),this.appendChild(e),this.__outputs__.push(e),RED.hooks.trigger("viewAddPort",{node:s,el:this,port:e,portType:"output",portIndex:r})):(e=this.__outputs__[r],$(e).children("text").html(et(s,me,r)));var g=s.w-5,f=s.h/2-(t-1)/2*18;if(e.setAttribute("transform","translate("+g+","+(f+18*r-5)+")"),s._def&&s._def.outputInfo){let o="",i="",n="",t;var y;if(r<s._def.outputInfo.length&&(t=s._def.outputInfo[r],y=RED._(s._def.set.id+":"+s.type+".output"+(r+1)+"Description"),t&&t.hasOwnProperty("types"))){o="",t.label&&"-"!=t.label&&(o="<p><b>"+t.label+"</b></p>");for(let e=0;e<t.types.length;e++)i&&(i+=", "),i+=t.types[e];i=i&&"<p><b>Types:</b> <i>"+i+"</i></p>",n=y}var w=RED.popover.create({target:$(a),trigger:"hover",width:"250px",content:function(){if("function"==typeof s._def.inputInfo){let t=s._def.outputInfo.call(s,r);var e=t.description;if(t&&t.hasOwnProperty("types")){o="",i="",t.label&&"-"!=t.label&&(o="<p><b>"+t.label+"</b></p>");for(let e=0;e<t.types.length;e++)i&&(i+=", "),i+=t.types[e];i=i&&"<p><b>Types:</b> <i>"+i+"</i></p>",n=e}}return $("<div>"+o+i+n+"</div>")},offsetX:0,offsetY:0,delay:{show:750,hide:50}});$(a).data("popover",w)}}s._def.icon&&(p=o.select(".red-ui-flow-node-icon"),b=o.select(".fa-lg"),n=(p.empty()?b:p).attr("xlink:href"),(i=RED.utils.getNodeIcon(s._def,s))!==n&&((p.empty()?b:p).remove(),Ct(i,o.select(".red-ui-flow-node-icon-group"),s),p=o.select(".red-ui-flow-node-icon"),b=o.select(".fa-lg")),p.attr("y",function(){return(s.h-d3.select(this).attr("height"))/2}),this.__iconShade__.setAttribute("height",s.h),this.__iconShadeBorder__.setAttribute("d","M "+(!s._def.align&&0!==s.inputs&&0===s.outputs||"right"===s._def.align?0:30)+" 1 l 0 "+(s.h-2)),b.attr("y",(s.h+18)/2)),s._def.button&&(b=_t(s),this.__buttonGroup__.classList.toggle("red-ui-flow-node-button-disabled",!b),g="right"==s._def.align?s.w-6:-25,s._def.button.toggle&&!s[s._def.button.toggle]&&(g-="right"==s._def.align?8:-8),this.__buttonGroup__.setAttribute("transform","translate("+g+",2)"),s._def.button.toggle&&(this.__buttonGroupButton__.setAttribute("fill-opacity",s[s._def.button.toggle]?1:.2),this.__buttonGroupBackground__.setAttribute("fill-opacity",s[s._def.button.toggle]?1:.2)),"function"==typeof s._def.button.visible&&(!1===s._def.button.visible.call(s)?this.__buttonGroup__.style.display="none":this.__buttonGroup__.style.display="inherit"))}if(s.dirtyStatus&&jt(s,this),s.dirty=!1,s.g&&!F[s.g])for(var E=s.g;E&&!F[E];)F[E]=RED.nodes.group(E),E=F[E].g}RED.hooks.trigger("viewRedrawNode",{node:s,el:this})}),x&&n.sort(function(e,t){return e._index-t._index}),(o=r.selectAll(".red-ui-flow-link").data(P,function(e){return e.source.id+":"+e.sourcePort+":"+e.target.id+":"+e.targetPort+":"+e.target.i})).enter().insert("g",".red-ui-flow-node").attr("class","red-ui-flow-link").each(function(e,t){var o=d3.select(this),i=document.createDocumentFragment();e.added=!0;var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.__data__=e,n.setAttribute("class","red-ui-flow-link-background red-ui-flow-link-path"+(e.link?" red-ui-flow-link-link":"")),this.__pathBack__=n,i.appendChild(n),d3.select(n).on("mousedown",mt).on("touchstart",bt).on("mousemove",function(e){Z===RED.state.SLICING&&(ye.add(e),o.classed("red-ui-flow-link-splice",!0),Lt())});n=document.createElementNS("http://www.w3.org/2000/svg","path");n.__data__=e,n.setAttribute("class","red-ui-flow-link-outline red-ui-flow-link-path"),this.__pathOutline__=n,i.appendChild(n);n=document.createElementNS("http://www.w3.org/2000/svg","path");n.__data__=e,n.setAttribute("class","red-ui-flow-link-line red-ui-flow-link-path"+(e.link?" red-ui-flow-link-link":N?" red-ui-flow-subflow-link":"")),this.__pathLine__=n,i.appendChild(n),o[0][0].appendChild(i)}),o.exit().remove(),o.each(function(e){var t,o,i,n;d3.select(this);(e.added||e.selected||D[e.source.id]||D[e.target.id])&&(t=e.source.outputs||1,o=e.target.inputs||1,i=e.sourcePort||0,n=e.targetPort||0,"subflow"==e.source.type&&(t=1,i=0),"subflow"==e.target.type&&(o=1,n=0),i=-(t-1)/2*18+18*i,n=-(o-1)/2*18+18*n,e.x1=e.source.x+e.source.w/2,e.y1=e.source.y+i,e.x2=e.target.x-e.target.w/2,e.y2=e.target.y+n,n=Re(e.x1,e.y1,e.x2,e.y2,1),/NaN/.test(n)&&(n=""),this.__pathBack__.setAttribute("d",n),this.__pathOutline__.setAttribute("d",n),this.__pathLine__.setAttribute("d",n),this.__pathLine__.classList.toggle("red-ui-flow-node-disabled",!(!e.source.d&&!e.target.d)),this.__pathLine__.classList.toggle("red-ui-flow-subflow-link",!e.link&&N)),this.classList.toggle("red-ui-flow-link-selected",!!e.selected),this.classList.toggle("red-ui-flow-link-working",!!e.working);"unknown"!=e.target.type&&e.source.type;this.classList.toggle("red-ui-flow-link-unknown",!("unknown"!=e.target.type&&"unknown"!=e.source.type)),delete e.added}),(n=r.selectAll(".red-ui-flow-link-off-flow").data(A,function(e){return e.node.id+":"+e.refresh})).enter().insert("g",".red-ui-flow-node").attr("class","red-ui-flow-link-off-flow").each(function(o,e){var t=d3.select(this),i=1,n="start";"link in"===o.node.type&&(i=-1,n="end");var a=30*i,r=20*i,s=(t.append("svg:path").attr("class","red-ui-flow-link-link").attr("d","M 0 0 h "+a),o.links),s=Object.keys(s),d=RED.nodes.getWorkspaceOrder();s.sort(function(e,t){return d.indexOf(e)-d.indexOf(t)});var l=M,c=-(s.length-1)*l/2,s=t.selectAll(".red-ui-flow-link-group").data(s);s.enter().append("g").attr("class","red-ui-flow-link-group").on("mouseover",function(){0===Z&&d3.select(this).classed("red-ui-flow-link-group-active",!0)}).on("mouseout",function(){0===Z&&d3.select(this).classed("red-ui-flow-link-group-active",!1)}).on("mousedown",function(){d3.event.preventDefault(),d3.event.stopPropagation()}).on("mouseup",function(e){var t;0===Z&&(d3.event.stopPropagation(),t=o.links[e],RED.workspaces.show(e),t.forEach(function(e){e.selected=!0,e.dirty=!0,be.add(e),1===t.length&&RED.view.reveal(e.id)}),Ne(),Lt())}).each(function(e){var t=d3.select(this);t.append("svg:path").attr("class","red-ui-flow-link-link").attr("d","M "+a+" 0 C "+(a+1.7*r)+" 0 "+(a+.1*r)+" "+c+" "+(a+1.5*r)+" "+c+" "),t.append("svg:path").attr("class","red-ui-flow-link-port").attr("d","M "+(a+1.5*r+17*i)+" "+(c-12)+" h "+10*-i+" a 3 3 45 0 "+(1===i?"0":"1")+" "+-3*i+" 3 v 18 a 3 3 45 0 "+(1===i?"0":"1")+" "+3*i+" 3 h "+10*i),t.append("svg:path").attr("class","red-ui-flow-link-port").attr("d","M "+(a+1.5*r+20*i)+" "+(c-12)+" h "+30*i+" M "+(a+1.5*r+20*i)+" "+(c+12)+" h "+30*i).style("stroke-dasharray","12 3 8 4 3"),t.append("rect").attr("class","red-ui-flow-port red-ui-flow-link-port").attr("x",a+1.5*r-4+4*i).attr("y",c-4).attr("rx",2).attr("ry",2).attr("width",8).attr("height",8),t.append("rect").attr("x",a+1.5*r-(-1===i?S:0)).attr("y",c-12).attr("width",S).attr("height",24).style("stroke","none").style("fill","transparent");var o,e=RED.nodes.workspace(e);e&&(o=e.label||e.id),t.append("svg:text").attr("class","red-ui-flow-port-label").attr("x",a+1.5*r+15*i).attr("y",c+1).style("font-size","10px").style("text-anchor",n).text(o),c+=l}),s.exit().remove()}),n.exit().remove(),(n=r.selectAll(".red-ui-flow-link-off-flow")).each(function(e){var t=1;"link in"===e.node.type&&(t=-1),d3.select(this).attr("transform",function(e){return"translate("+(e.node.x+t*e.node.w/2)+","+e.node.y+")"})}),(o=l.selectAll(".red-ui-flow-group").data(G,function(e){return e.id})).exit().each(function(e,t){document.getElementById("group_select_"+e.id).remove()}).remove(),n=o.enter().insert("svg:g").attr("class","red-ui-flow-group"),a=!1,n.each(function(e,t){a=!0;var o=d3.select(this);o.attr("id",e.id);var i=s.append("g").attr("class","red-ui-flow-group").attr("id","group_select_"+e.id);i.append("rect").classed("red-ui-flow-group-outline-select",!0).classed("red-ui-flow-group-outline-select-background",!0).attr("rx",4).attr("ry",4).attr("x",-4).attr("y",-4),i.append("rect").classed("red-ui-flow-group-outline-select",!0).attr("rx",4).attr("ry",4).attr("x",-4).attr("y",-4),i.on("mousedown",function(){wt.call(o[0][0],e)}),i.on("mouseup",function(){yt.call(o[0][0],e)}),i.on("touchstart",function(){wt.call(o[0][0],e),d3.event.preventDefault()}),i.on("touchend",function(){yt.call(o[0][0],e),d3.event.preventDefault()}),o.append("rect").classed("red-ui-flow-group-outline",!0).attr("rx",.5).attr("ry",.5),o.append("rect").classed("red-ui-flow-group-body",!0).attr("rx",4).attr("ry",4).style({fill:e.fill||"none",stroke:e.stroke||"none"}),o.on("mousedown",wt).on("mouseup",yt),o.on("touchstart",function(){wt.call(o[0][0],e),d3.event.preventDefault()}),o.on("touchend",function(){yt.call(o[0][0],e),d3.event.preventDefault()}),o.append("svg:text").attr("class","red-ui-flow-group-label"),e.dirty=!0}),a&&o.sort(function(e,t){return e._root===t._root?e._depth-t._depth:e._index-t._index}),o[0].reverse(),o.each(function(e,t){var o,i,n,a,r,s,d,l,c,p,u;e.resize&&(e.minWidth=0,delete e.resize),(e.dirty||F[e.id])&&(o=d3.select(this),i=!1,0<e.nodes.length?e.groupMoved?delete e.groupMoved:(n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=r=0,e.nodes.forEach(function(e){s="group"!==e.type?(n=Math.min(n,e.x-e.w/2-26-(e._def.button&&"right"!==e._def.align?20:0)),a=Math.min(a,e.y-e.h/2-26),r=Math.max(r,e.x+e.w/2+26+(e._def.button&&"right"==e._def.align?20:0)),Math.max(s,e.y+e.h/2+26)):(n=Math.min(n,e.x-26),a=Math.min(a,e.y-26),r=Math.max(r,e.x+e.w+26),Math.max(s,e.y+e.h+26))}),e.x=n,e.y=a,e.w=r-n,e.h=s-a,!(i=!0)===e.groupMoved&&delete e.groupMoved):(e.w=40,e.h=40,i=!0),i&&(e.minWidth||(e.style.label&&e.name?(u=Ve(e.name||"","red-ui-flow-group-label"),e.minWidth=u.width+8,e.labels=u.lines):(e.minWidth=40,e.labels=[])),e.w=Math.max(e.minWidth,e.w),e.style.label&&0<e.labels.length&&(l=e.style["label-position"]||"nw",c=16*(e.labels.length-1),"s"===l[0]&&(c+=8),e.h+=c,"n"===l[0]&&0<e.nodes.length&&(e.y-=c))),o.attr("transform","translate("+e.x+","+e.y+")"),o.selectAll(".red-ui-flow-group-outline").attr("width",e.w).attr("height",e.h),(u=document.getElementById("group_select_"+e.id)).setAttribute("transform","translate("+e.x+","+e.y+")"),e.hovered?u.classList.add("red-ui-flow-group-hovered"):u.classList.remove("red-ui-flow-group-hovered"),(c=u.children[0]).setAttribute("width",e.w+8),c.setAttribute("height",e.h+8),c.style.strokeOpacity=e.active||e.selected||e.highlighted?.8:0,c.style.strokeDasharray=e.active?"10 4":"",(c=u.children[1]).setAttribute("width",e.w+8),c.setAttribute("height",e.h+8),c.style.strokeOpacity=e.active||e.selected||e.highlighted?.8:0,c.style.strokeDasharray=e.active?"10 4":"",e.highlighted?u.classList.add("red-ui-flow-node-highlighted"):u.classList.remove("red-ui-flow-node-highlighted"),o.selectAll(".red-ui-flow-group-body").attr("width",e.w).attr("height",e.h).style("stroke",e.style.stroke||"").style("stroke-opacity",e.style.hasOwnProperty("stroke-opacity")?e.style["stroke-opacity"]:"").style("fill",e.style.fill||"").style("fill-opacity",e.style.hasOwnProperty("fill-opacity")?e.style["fill-opacity"]:""),(d=o.selectAll(".red-ui-flow-group-label")).classed("hide",!e.style.label),e.style.label&&(u="n"===(l=e.style["label-position"]||"nw")[u=c=0]?20:e.h-5-16*(e.labels.length-1),labelAnchor="w"===l[1]?(c=5,"start"):"e"===l[1]?(c=e.w-5,"end"):(c=e.w/2,"middle"),e.style.hasOwnProperty("color")?d.style("fill",e.style.color):d.style("fill",null),d.attr("transform","translate("+c+","+u+")").attr("text-anchor",labelAnchor),e.labels?(p=0,o.selectAll(".red-ui-flow-group-label-text").remove(),e.labels.forEach(function(e){d.append("tspan").classed("red-ui-flow-group-label-text",!0).text(e).attr("x",0).attr("y",p),p+=16})):o.selectAll(".red-ui-flow-group-label-text").remove()),delete F[e.id],delete e.dirty)})):r.selectAll(".red-ui-flow-link-selected").data(P,function(e){return e.source.id+":"+e.sourcePort+":"+e.target.id+":"+e.targetPort+":"+e.target.i}).classed("red-ui-flow-link-selected",!1),RED.view.navigator.refresh(),d3.event&&d3.event.preventDefault()}function St(){try{var e=window.parent.window.scrollX,t=window.parent.window.scrollY;k.trigger("focus"),window.parent.window.scrollTo(e,t)}catch(e){k.trigger("focus")}}function Mt(e,t){var o,i,n=(t=t||{addFlow:!1,touchImport:!1,generateIds:!1}).addFlow,a=t.touchImport;if(Z!==RED.state.SELECTING_NODE){if("string"==typeof e){if(""===e)return;try{o=JSON.parse(e)}catch(e){var r=new Error(RED._("clipboard.invalidFlow",{message:e.message}));throw r.code="NODE_RED",r}}else o=e;$.isArray(o)||(o=[o]);try{N&&(i=N.changed);var s=RED.nodes.import(o,{generateIds:t.generateIds,addFlow:n,importMap:t.importMap});if(s){var d=s.nodes,l=s.links,c=s.groups,p=s.workspaces,u=s.subflows,f=s.removedNodes,h=s.missingWorkspace;n&&h&&RED.workspaces.show(h.id);var g=(g=d.filter(function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&e.z==RED.workspaces.active()})).concat(c.filter(function(e){return e.z===RED.workspaces.active()})),v=d.map(function(e){return e.changed=!0,e.id});if(Oe(),be.clear(),be.add(g),0<be.length()){var m,b=(Q=null==Q?[0,0]:Q)[0],y=Q[1];0<be.length()&&(b=(m=be.get(0).n).x,y=m.y);for(var w,E=0,D=0,x=be.length(),R=0;R<x;R++)(w=be.get(R)).n.selected=!0,w.n.changed=!0,w.n.moved=!0,w.n.x-=b-Q[0],w.n.y-=y-Q[1],w.n.w=S,w.n.h=M,w.n.resize=!0,w.dx=w.n.x-Q[0],w.dy=w.n.y-Q[1],D="group"===w.n.type?(w.n.groupMoved=!1,E=Math.min(w.n.x-5,E),Math.min(w.n.y-5,D)):(E=Math.min(w.n.x-S/2-5,E),Math.min(w.n.y-M/2-5,D));for(R=0;R<x;R++)if((w=be.get(R)).n.x-=E,w.n.y-=D,w.dx-=E,w.dy-=D,w.n._def.onadd)try{w.n._def.onadd.call(w.n)}catch(e){console.log("Definition error: "+w.n.type+".onadd:",e)}a||(Z=RED.state.IMPORT_DRAGGING,I=!1,1===be.length()&&(w=be.get(0),I=w.n.hasOwnProperty("_def")&&(w.n.hasOwnProperty("inputs")&&0<w.n.inputs||!w.n.hasOwnProperty("inputs")&&0<w.n._def.inputs)&&(w.n.hasOwnProperty("outputs")&&0<w.n.outputs||!w.n.hasOwnProperty("outputs")&&0<w.n._def.outputs)))}var k,_={t:"add",nodes:v,links:l,groups:c,workspaces:p,subflows:u,dirty:RED.nodes.dirty()};0===be.length()&&RED.nodes.dirty(!0),!N||(k=RED.subflow.refresh(!0))&&(_.subflow={id:N.id,changed:i,instances:k.instances}),f&&(_={t:"multi",events:[{t:"replace",config:f},_]}),RED.history.push(_),xe(),Lt();var T=[],C=0,j=0;d.forEach(function(e){e.hasOwnProperty("x")&&e.hasOwnProperty("y")?C++:j++});var L,z=c.length;0<p.length&&T.push(RED._("clipboard.flow",{count:p.length})),0<C&&T.push(RED._("clipboard.node",{count:C})),0<z&&T.push(RED._("clipboard.group",{count:z})),0<j&&T.push(RED._("clipboard.configNode",{count:j})),0<u.length&&T.push(RED._("clipboard.subflow",{count:u.length})),f&&0<f.length&&T.push(RED._("clipboard.replacedNodes",{count:f.length})),0<T.length&&(L="<ul><li>"+T.join("</li><li>")+"</li></ul>",RED.notify("<p>"+RED._("clipboard.nodesImported")+"</p>"+L,{id:"clipboard"}))}}catch(e){if("import_conflict"===e.code)throw e;"NODE_RED"!=e.code?(console.log(e.stack),RED.notify(RED._("notification.error",{message:e.toString()}),"error")):RED.notify(RED._("notification.error",{message:e.message}),"error")}}}function Ot(e){if(Z!==RED.state.SELECTING_NODE){var t=RED.workspaces.selection();if(!(0<t.length)&&0<be.length()){for(var o=[],i=0;i<be.length();i++){var n=be.get(i).n;"group"!==n.type&&"subflow"!==n.type&&e!=n.d&&(o.push({t:"edit",node:n,changed:n.changed,changes:{d:n.d}}),e?n.d=!0:delete n.d,n.dirty=!0,n.dirtyStatus=!0,n.changed=!0,RED.events.emit("nodes:change",n))}0<o.length&&(RED.history.push({t:"multi",events:o,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0))}RED.view.redraw()}}function It(){var e={},t=new Set;0<be.length()&&be.forEach(function(e){"group"!==e.n.type&&t.add(e.n)});var o=G.filter(function(e){return e.selected&&!e.active});return 0<o.length&&(1===o.length&&o[0].active||o.forEach(function(e){RED.group.getNodes(e,!0).forEach(function(e){t.delete(e)}),t.add(e)})),0<t.size&&(e.nodes=Array.from(t)),0<ye.length()&&(e.links=ye.toArray(),e.link=e.links[0]),e}return{init:function(){k=$("#red-ui-workspace-chart"),_=d3.select("#red-ui-workspace-chart").append("svg:svg").attr("width",C).attr("height",j).attr("pointer-events","all").style("cursor","crosshair").style("touch-action","none").on("mousedown",function(){St()}).on("contextmenu",function(){d3.event.preventDefault()}),(b=_.append("svg:g").on("dblclick.zoom",null).append("svg:g").attr("class","red-ui-workspace-chart-event-layer").on("mousemove",$e).on("mousedown",e).on("mouseup",Te).on("mouseenter",function(){ee?1!==d3.event.buttons&&(ee.remove(),ee=null):Z===RED.state.PANNING&&4!==d3.event.buttons?Je():te&&2!==d3.event.buttons&&(te.remove(),te=null,Je())}).on("touchend",function(){d3.event.preventDefault(),clearTimeout(y),y=null,RED.touch.radialMenu.active()||Te.call(this)}).on("touchcancel",function(){RED.view.DEBUG&&console.warn("eventLayer.touchcancel",Z),d3.event.preventDefault(),Te.call(this)}).on("touchstart",function(){var e,t,o,i,n,a,r,s;RED.view.DEBUG&&console.warn("eventLayer.touchstart",Z),1<d3.event.touches.length?(clearTimeout(y),y=null,d3.event.preventDefault(),e=d3.event.touches.item(0),t=d3.event.touches.item(1),o=e.pageY-t.pageY,i=e.pageX-t.pageX,n=k.offset(),a=[k.scrollLeft(),k.scrollTop()],m=[(t.pageX+i/2-n.left+a[0])/L,(t.pageY+o/2-n.top+a[1])/L],t.pageX,t.pageY,v=Math.sqrt(o*o+i*i)):(r=d3.select(document.body),s=[(e=d3.event.touches.item(0)).pageX,e.pageY],m=[e.pageX,e.pageY],v=0,d3.touches(this)[0],y=setTimeout(function(){y=null,Tt(r,s)},g)),d3.event.preventDefault()}).on("touchmove",function(){var e,t,o,i,n;RED.touch.radialMenu.active()||(RED.view.DEBUG&&console.warn("eventLayer.touchmove",Z,J),d3.event.touches.length<2?(y?(e=(o=d3.event.touches.item(0)).pageX-m[0],t=o.pageY-m[1],64<Math.abs(e*e+t*t)&&(clearTimeout(y),y=null,J||q||(Z=RED.state.PANNING,Q=[o.pageX,o.pageY],le=[k.scrollLeft(),k.scrollTop()]))):ee&&d3.event.preventDefault(),$e.call(this)):(o=d3.event.touches.item(0),i=d3.event.touches.item(1),n=o.pageY-i.pageY,e=o.pageX-i.pageX,k.offset(),t=[k.scrollLeft(),k.scrollTop()],o=Math.sqrt(n*n+e*e),i=[i.pageX+e/2,i.pageY+n/2],isNaN(o)||(oldScaleFactor=L,L=Math.min(2,Math.max(.3,L+Math.floor(100*o-100*v)/1e4)),n=[m[0]*(L-oldScaleFactor),m[1]*(L-oldScaleFactor)],v=o,k.scrollLeft(t[0]+n[0]),k.scrollTop(t[1]+n[1]),Lt()))),d3.event.preventDefault()})).append("svg:rect").attr("class","red-ui-workspace-chart-background").attr("width",C).attr("height",j),o=b.append("g").attr("class","red-ui-workspace-chart-grid"),we(),l=b.append("g"),s=b.append("g"),r=b.append("g"),n=b.append("g"),d=b.append("g"),T=[],RED.events.on("workspace:change",function(e){0!==e.old&&(w[e.old]={left:k.scrollLeft(),top:k.scrollTop()});var t=k.scrollLeft(),o=k.scrollTop();N=RED.nodes.subflow(e.workspace),RED.menu.setDisabled("menu-item-workspace-edit",N||0===e.workspace),RED.menu.setDisabled("menu-item-workspace-delete",0===e.workspace||1==RED.workspaces.count()||N),w[e.workspace]?(k.scrollLeft(w[e.workspace].left),k.scrollTop(w[e.workspace].top)):(k.scrollLeft(0),k.scrollTop(0));t=k.scrollLeft()-t,o=k.scrollTop()-o;null!=Q&&(Q[0]+=t,Q[1]+=o),0===RED.workspaces.selection().length&&Oe(),RED.nodes.eachNode(function(e){e.dirty=!0,e.dirtyStatus=!0}),Ne(),xe(),Lt()}),RED.statusBar.add({id:"view-zoom-controls",align:"right",element:$('<span class="button-group"><button class="red-ui-footer-button" id="red-ui-view-zoom-out"><i class="fa fa-minus"></i></button><button class="red-ui-footer-button" id="red-ui-view-zoom-zero"><i class="fa fa-circle-o"></i></button><button class="red-ui-footer-button" id="red-ui-view-zoom-in"><i class="fa fa-plus"></i></button></span>')}),$("#red-ui-view-zoom-out").on("click",je),RED.popover.tooltip($("#red-ui-view-zoom-out"),RED._("actions.zoom-out"),"core:zoom-out"),$("#red-ui-view-zoom-zero").on("click",Le),RED.popover.tooltip($("#red-ui-view-zoom-zero"),RED._("actions.zoom-reset"),"core:zoom-reset"),$("#red-ui-view-zoom-in").on("click",Ce),RED.popover.tooltip($("#red-ui-view-zoom-in"),RED._("actions.zoom-in"),"core:zoom-in"),k.on("DOMMouseScroll mousewheel",function(e){e.altKey&&(e.preventDefault(),e.stopPropagation(),((-e.originalEvent.detail||e.originalEvent.wheelDelta)<=0?je:Ce)())}),k.droppable({accept:".red-ui-palette-node",drop:function(e,t){d3.event=e;var o=ke($(t.draggable[0]).attr("data-palette-type"));if(o){var i=o.historyEvent,n=o.node;RED.nodes.add(n);var a=RED.utils.getMessageProperty(RED.settings.get("editor"),"view.view-node-show-label");void 0===a||n._def.hasOwnProperty("showLabel")&&!n._def.showLabel||n._def.defaults.hasOwnProperty("l")||(n.l=a);var r=d3.touches(t.helper.get(0))[0]||d3.mouse(t.helper.get(0)),e=t.helper.width(),o=t.helper.height(),a=d3.touches(this)[0]||d3.mouse(this);try{var s="link in"===n.type||"link out"===n.type,d=n.hasOwnProperty("l")?!n.l:s,l=Ve(RED.utils.getNodeLabel(n,n.type),"red-ui-flow-node-label");d?(n.w=M,n.h=Math.max(M,20*(n.outputs||0))):(n.w=Math.max(S,20*Math.ceil((l.width+50+(0<n._def.inputs?7:0))/20)),n.h=Math.max(6+24*l.lines.length,20*(n.outputs||0),30))}catch(e){}a[1]+=this.scrollTop+(o/2-r[1]),a[0]+=this.scrollLeft+(e/2-r[0]),a[1]/=L,a[0]/=L,n.x=a[0],n.y=a[1],O&&(p=[0,0],u=n.x-(z*Math.round((n.x-n.w/2)/z)+n.w/2),c=n.x-(z*Math.round((n.x+n.w/2)/z)-n.w/2),Math.abs(u)<Math.abs(c)?p[0]=u:p[0]=c,p[1]=n.y-z*Math.round(n.y/z),n.x-=p[0],n.y-=p[1]);var c,p,u=$(t.helper).data("splice");u&&(RED.nodes.removeLink(u),c={source:u.source,sourcePort:u.sourcePort,target:n,targetPort:0},p={source:n,sourcePort:0,target:u.target,targetPort:u.targetPort},RED.nodes.addLink(c),RED.nodes.addLink(p),i.links=[c,p],i.removedLinks=[u]);t=$(t.helper).data("group");t&&(RED.group.addToGroup(t,n),(i={t:"multi",events:[i]}).events.push({t:"addToGroup",group:t,nodes:n})),RED.history.push(i),RED.editor.validateNode(n),RED.nodes.dirty(!0),xt(),Oe(),n.selected=!0,be.add(n),t&&(Et(t,!1),Dt(t),V=t),xe(),Ne(),Lt(),n._def.autoedit&&RED.editor.edit(n)}}}),k.on("focus",function(){$("#red-ui-workspace-tabs").addClass("red-ui-workspace-focussed")}),k.on("blur",function(){$("#red-ui-workspace-tabs").removeClass("red-ui-workspace-focussed")}),RED.actions.add("core:copy-selection-to-internal-clipboard",Be),RED.actions.add("core:cut-selection-to-internal-clipboard",function(){Be(),Ae()}),RED.actions.add("core:paste-from-internal-clipboard",function(){Mt(he,{generateIds:!0})}),RED.actions.add("core:detach-selected-nodes",function(){!function(){var e=RED.view.selection();{var t,o;e.nodes&&({newLinks:t,removedLinks:o}=RED.nodes.detachNodes(e.nodes),(o.length||t.length)&&(RED.history.push({t:"multi",events:[{t:"delete",links:o},{t:"add",links:t}],dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0)),nt([e.nodes[0].x,e.nodes[0].y]),Z=RED.state.DETACHED_DRAGGING,RED.view.redraw(!0))}}()}),RED.events.on("view:selection-changed",function(e){var t=e.nodes&&0<e.nodes.length,e=t&&1<e.nodes.length;RED.menu.setDisabled("menu-item-edit-cut",!t),RED.menu.setDisabled("menu-item-edit-copy",!t),RED.menu.setDisabled("menu-item-edit-select-connected",!t),RED.menu.setDisabled("menu-item-view-tools-move-to-back",!t),RED.menu.setDisabled("menu-item-view-tools-move-to-front",!t),RED.menu.setDisabled("menu-item-view-tools-move-backwards",!t),RED.menu.setDisabled("menu-item-view-tools-move-forwards",!t),RED.menu.setDisabled("menu-item-view-tools-align-left",!e),RED.menu.setDisabled("menu-item-view-tools-align-center",!e),RED.menu.setDisabled("menu-item-view-tools-align-right",!e),RED.menu.setDisabled("menu-item-view-tools-align-top",!e),RED.menu.setDisabled("menu-item-view-tools-align-middle",!e),RED.menu.setDisabled("menu-item-view-tools-align-bottom",!e),RED.menu.setDisabled("menu-item-view-tools-distribute-horizontally",!e),RED.menu.setDisabled("menu-item-view-tools-distribute-veritcally",!e)}),RED.actions.add("core:delete-selection",Ae),RED.actions.add("core:delete-selection-and-reconnect",function(){Ae(!0)}),RED.actions.add("core:edit-selected-node",Pe),RED.actions.add("core:go-to-selection",function(){var e;0<be.length()&&(e=be.get(0).n,/^subflow:/.test(e.type)?RED.workspaces.show(e.type.substring(8)):"group"===e.type&&(Dt(e),Lt()))}),RED.actions.add("core:undo",RED.history.pop),RED.actions.add("core:redo",RED.history.redo),RED.actions.add("core:select-all-nodes",Me),RED.actions.add("core:select-none",Se),RED.actions.add("core:zoom-in",Ce),RED.actions.add("core:zoom-out",je),RED.actions.add("core:zoom-reset",Le),RED.actions.add("core:enable-selected-nodes",function(){Ot(!1)}),RED.actions.add("core:disable-selected-nodes",function(){Ot(!0)}),RED.actions.add("core:toggle-show-grid",function(e){void 0===e?RED.userSettings.toggle("view-show-grid"):e?o.style("visibility","visible"):o.style("visibility","hidden")}),RED.actions.add("core:toggle-snap-grid",function(e){void 0===e?RED.userSettings.toggle("view-snap-grid"):(O=e,Lt())}),RED.actions.add("core:toggle-status",function(e){void 0===e?RED.userSettings.toggle("view-node-status"):(ne=e,RED.nodes.eachNode(function(e){e.dirtyStatus=!0,e.dirty=!0}),Lt())}),RED.view.annotations.init(),RED.view.navigator.init(),RED.view.tools.init(),RED.view.annotations.register("red-ui-flow-node-changed",{type:"badge",class:"red-ui-flow-node-changed",element:function(){var e=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.setAttribute("cx",5),e.setAttribute("cy",5),e.setAttribute("r",5),e},show:function(e){return e.changed||e.moved}}),RED.view.annotations.register("red-ui-flow-node-error",{type:"badge",class:"red-ui-flow-node-error",element:function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","M 0,9 l 10,0 -5,-8 z"),t},tooltip:function(e){if(e.validationErrors&&0<e.validationErrors.length)return RED._("editor.errors.invalidProperties")+"\n  - "+e.validationErrors.join("\n    - ")},show:function(e){return!e.valid}}),RED.view.annotations.register("red-ui-flow-node-fixed-input",{type:"badge",class:"red-ui-flow-node-fixed-input",element:function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","M 0,9 l 10,0 -5,-8 z"),t},show:function(e){return e.fixedInputs}})},state:function(e){if(null==e)return Z;Z=e},updateActive:xe,redraw:function(e,t){e&&(xe(),Ne()),(t?zt:Lt)()},focus:St,importNodes:Mt,calculateTextWidth:function(e,t){for(var o=Ue(e),i=0,n=0;n<o.length;n++){var a=Fe(o[n],t)[0];i<a&&(i=a)}return i},select:function(e){var t;void 0!==e&&(Oe(),"string"==typeof e?(t=RED.nodes.node(e))&&(t.selected=!0,t.dirty=!0,be.clear(),be.add(t)):e&&e.nodes&&(xe(),be.clear(),e.nodes.forEach(function(e){"group"!==e.type?(e.selected=!0,e.dirty=!0,be.add(e)):Et(e,!0)}))),Ne(),Lt()},selection:It,scale:function(){return L},getLinksAtPoint:function(e,t){for(var o=[],i=_.selectAll(".red-ui-flow-link-background")[0],n=0;n<i.length;n++){var a=i[n].getBBox();e>=a.x&&t>=a.y&&e<=a.x+a.width&&t<=a.y+a.height&&o.push(i[n])}return o},getGroupAtPoint:kt,getActiveGroup:function(){return V},reveal:function(e,t){var o,i,n,a,r,s;RED.nodes.workspace(e)||RED.nodes.subflow(e)?RED.workspaces.show(e):(o=RED.nodes.node(e)||RED.nodes.group(e))&&(!o.z||"group"!==o.type&&"config"===o._def.category?"config"===o._def.category&&RED.sidebar.config.show(e):(o.dirty=!0,RED.workspaces.show(o.z),a=[k.width()/L,k.height()/L],i=[k.scrollLeft()/L,k.scrollTop()/L],n=o.x,e=o.y,"group"===o.type&&(n+=o.w/2,e+=o.h/2),(n<i[0]||e<i[1]||a[0]+i[0]<n||a[1]+i[1]<e)&&(n="-="+(i[0]-n+a[0]/2)*L,a="-="+(i[1]-e+a[1]/2)*L,k.animate({scrollLeft:n,scrollTop:a},200)),!1!==t&&(o.highlighted=!0,o._flashing||(o._flashing=!0,r=22,(s=function(){r--,o.dirty=!0,0<=r?(o.highlighted=!o.highlighted,setTimeout(s,100)):(o.highlighted=!1,delete o._flashing),RED.view.redraw()})()))))},gridSize:function(e){if(void 0===e)return z;z=Math.max(5,e),we()},getActiveNodes:function(){return E},getSubflowPorts:function(){var o=[];return N&&(d.selectAll(".red-ui-flow-subflow-port-output").data(N.out,function(e,t){return e.id}).each(function(e,t){o.push(e)}),d.selectAll(".red-ui-flow-subflow-port-input").data(N.in,function(e,t){return e.id}).each(function(e,t){o.push(e)}),d.selectAll(".red-ui-flow-subflow-port-status").data(N.status?[N.status]:[],function(e,t){return e.id}).each(function(e,t){o.push(e)})),o},selectNodes:function(e){$("#red-ui-workspace-tabs-shade").show(),$("#red-ui-palette-shade").show(),$("#red-ui-sidebar-shade").show(),$("#red-ui-header-shade").show(),$("#red-ui-workspace").addClass("red-ui-workspace-select-mode"),Z=RED.state.SELECTING_NODE,Oe(),e.selected&&e.selected.forEach(function(e){e=RED.nodes.node(e);e&&(e.selected=!0,e.dirty=!0,be.add(e))}),Lt();function t(){Oe(),$("#red-ui-workspace-tabs-shade").hide(),$("#red-ui-palette-shade").hide(),$("#red-ui-sidebar-shade").hide(),$("#red-ui-header-shade").hide(),$("#red-ui-workspace").removeClass("red-ui-workspace-select-mode"),Je(),o.close()}(u=e||{}).done=function(e){t(),u.onselect&&u.onselect(e)};e=[{text:RED._("common.label.cancel"),click:function(e){t(),u.oncancel&&u.oncancel()}}];u.single||e.push({text:RED._("common.label.done"),class:"primary",click:function(e){var t=be.nodes();u.done(t)}});var o=RED.notify(u.prompt||RED._("workspace.selectNodes"),{modal:!1,fixed:!0,type:"compact",buttons:e})},scroll:function(e,t){k.scrollLeft(k.scrollLeft()+e),k.scrollTop(k.scrollTop()+t)},clickNodeButton:function(e){e._def.button&&$t(e)},clipboard:function(){return he},redrawStatus:jt,showQuickAddDialog:_e,calculateNodeDimensions:function(t){var e=[S,M];try{var o="link in"===t.type||"link out"===t.type,i=t.hasOwnProperty("l")?!t.l:o,n=Ve(RED.utils.getNodeLabel(t,t.type),"red-ui-flow-node-label");e[1]=i?Math.max(M,20*(t.outputs||0)):Math.max(6+24*n.lines.length,20*(t.outputs||0),30),e[0]=i?M:Math.max(S,20*Math.ceil((n.width+50+(0<t._def.inputs?7:0))/20))}catch(e){console.log("Error",t)}return e},getElementPosition:Ze,showTooltip:tt}}(),RED.view.annotations=function(){var s,d,c={};function p(e,t){var o=c[e];t.el.__annotations__=t.el.__annotations__||[];var i=document.createElementNS("http://www.w3.org/2000/svg","g");i.setAttribute("class",o.class||""),t.el.__annotations__.push({id:e,element:i});var n,a,r,e=o.element(t.node);o.tooltip&&(e.addEventListener("mouseenter",(n=e,a=t.node,r=o.tooltip,function(){var o="function"==typeof r?r(a):r;o&&(clearTimeout(s),s=setTimeout(function(){var e=RED.view.getElementPosition(n),t=n.getBoundingClientRect();s=null,d=RED.view.showTooltip(e[0]+t.width/2,e[1],o,"top")},500))})),e.addEventListener("mouseleave",l)),i.appendChild(e),t.el.appendChild(i)}function l(){clearTimeout(s),d&&(d.remove(),d=null)}return{init:function(){RED.hooks.add("viewRedrawNode.annotations",function(e){try{e.node.__pendingAnnotation__&&(p(e.node.__pendingAnnotation__,e),delete e.node.__pendingAnnotation__);for(var t=0,o=0,i=0,n=e.el.__annotations__.length;i<n;i++){var a,r,s,d,l=e.el.__annotations__[i];c.hasOwnProperty(l.id)?(a=c[l.id],r=!0,s="badge"===a.type,void 0!==a.show&&(r="string"==typeof a.show?!!e.node[a.show]:"function"==typeof a.show?a.show(e.node):!!a.show,l.element.classList.toggle("hide",!r)),s?r&&(t+=(d=l.element.getBoundingClientRect()).width,l.element.setAttribute("transform","translate("+(e.node.w-3-t)+", -8)"),t+=4):r&&(d=l.element.getBoundingClientRect(),l.element.setAttribute("transform","translate("+(3+o)+", -12)"),o+=d.width+4)):(l.element.parentNode.removeChild(l.element),e.el.__annotations__.splice(i,1),i--,n--)}}catch(e){console.log(e)}})},register:function(t,o){if("badge"!==o.type)throw new Error("Unsupported annotation type: "+o.type);c[t]=o,RED.hooks.add("viewAddNode.annotation-"+t,function(e){o.filter&&!o.filter(e.node)||p(t,e)}),RED.view.getActiveNodes().forEach(function(e){e.__pendingAnnotation__=t}),RED.view.redraw()},unregister:function(e){delete c[e],RED.hooks.remove("*.annotation-"+e),RED.view.redraw()}}}(),RED.view.navigator=function(){var e,t,o,i,n,a,r,s,d,l=25,c=5e3/l,p=5e3/l,u=!1;function f(){var e;u&&((e=i.selectAll(".red-ui-navigator-node").data(RED.view.getActiveNodes(),function(e){return e.id})).exit().remove(),e.enter().insert("rect").attr("class","red-ui-navigator-node").attr("pointer-events","none"),e.each(function(e){d3.select(this).attr("x",function(e){return(e.x-e.w/2)/l}).attr("y",function(e){return(e.y-e.h/2)/l}).attr("width",function(e){return Math.max(9,e.w/l)}).attr("height",function(e){return Math.max(3,e.h/l)}).attr("fill",function(e){return RED.utils.getNodeColor(e.type,e._def)})}))}function h(){d||g()}function g(){o&&(a=RED.view.scale(),r=[$("#red-ui-workspace-chart").width(),$("#red-ui-workspace-chart").height()],n=[$("#red-ui-workspace-chart").scrollLeft(),$("#red-ui-workspace-chart").scrollTop()],o.attr("x",n[0]/l).attr("y",n[1]/l).attr("width",r[0]/l/a).attr("height",r[1]/l/a))}function v(){u?(u=!1,e.fadeOut(100),$("#red-ui-workspace-chart").off("scroll",h),$("#red-ui-view-navigate").removeClass("selected")):(u=!0,$("#red-ui-view-navigate").addClass("selected"),g(),f(),$("#red-ui-workspace-chart").on("scroll",h),e.fadeIn(200))}return{init:function(){$(window).on("resize",g),RED.events.on("sidebar:resize",g),RED.actions.add("core:toggle-navigator",v),e=$("<div>").css({position:"absolute",bottom:$("#red-ui-workspace-footer").height(),right:0,zIndex:1}).appendTo("#red-ui-workspace").hide(),(t=d3.select(e[0]).append("svg:svg").attr("width",c).attr("height",p).attr("pointer-events","all").attr("id","red-ui-navigator-canvas")).append("rect").attr("x",0).attr("y",0).attr("width",c).attr("height",p).style({fill:"none",stroke:"none",pointerEvents:"all"}).on("mousedown",function(){a=RED.view.scale(),r=[$("#red-ui-workspace-chart").width(),$("#red-ui-workspace-chart").height()],s=[r[0]/l/a,r[1]/l/a];var e=Math.max(0,Math.min(d3.event.offsetX+s[0]/2,c)-s[0]),t=Math.max(0,Math.min(d3.event.offsetY+s[1]/2,p)-s[1]);o.attr("x",e).attr("y",t),d=!0,$("#red-ui-workspace-chart").scrollLeft(e*l*a),$("#red-ui-workspace-chart").scrollTop(t*l*a)}).on("mousemove",function(){var e,t;d&&(0!==d3.event.buttons?(e=Math.max(0,Math.min(d3.event.offsetX+s[0]/2,c)-s[0]),t=Math.max(0,Math.min(d3.event.offsetY+s[1]/2,p)-s[1]),o.attr("x",e).attr("y",t),$("#red-ui-workspace-chart").scrollLeft(e*l*a),$("#red-ui-workspace-chart").scrollTop(t*l*a)):d=!1)}).on("mouseup",function(){d=!1}),o=t.append("rect").attr("class","red-ui-navigator-border"),i=t.append("svg:g"),RED.statusBar.add({id:"view-navigator",align:"right",element:$('<button class="red-ui-footer-button-toggle single" id="red-ui-view-navigate"><i class="fa fa-map-o"></i></button>')}),$("#red-ui-view-navigate").on("click",function(e){e.preventDefault(),v()}),RED.popover.tooltip($("#red-ui-view-navigate"),RED._("actions.toggle-navigator"),"core:toggle-navigator")},refresh:f,resize:g,toggle:v}}(),RED.view.tools=function(){function e(o){var e=RED.view.selection(),i=new Set;e.nodes&&0<e.nodes.length&&(e.nodes.forEach(function(e){var t;i.has(e)||("all"===o?t=RED.nodes.getAllFlowNodes(e):"up"===o?t=[e].concat(RED.nodes.getAllUpstreamNodes(e)):"down"===o&&(t=[e].concat(RED.nodes.getAllDownstreamNodes(e))),t.forEach(function(e){i.add(e)}))}),RED.view.select({nodes:Array.from(i)}))}function t(){var i,e=RED.view.selection();e.nodes&&(i=[],e.nodes.forEach(function(e){var t=e.w/2+Math.round((e.x-e.w/2)/RED.view.gridSize())*RED.view.gridSize(),o=Math.round(e.y/RED.view.gridSize())*RED.view.gridSize();e.x===t&&e.y===o||(i.push({n:e,ox:e.x,oy:e.y,moved:e.moved}),e.x=t,e.y=o,e.dirty=!0,e.moved=!0)}),0<i.length&&(RED.history.push({t:"move",nodes:i,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),RED.view.redraw(!0)))}var d=null,l=!1;function c(){if(l=!1,0<d.length){for(var e=[],t=0;t<d.length;t++)e.push({n:d[t].n,ox:d[t].ox,oy:d[t].oy,moved:d[t].moved}),d[t].n.moved=!0,d[t].n.dirty=!0,delete d[t].ox,delete d[t].oy;RED.view.redraw(),RED.history.push({t:"move",nodes:e,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),d=null}}function o(e,t){if(null===d){d=[];var o=RED.view.selection();if(o.nodes)for(;0<o.nodes.length;){var i=o.nodes.shift();d.push({n:i}),"group"===i.type&&(o.nodes=o.nodes.concat(i.nodes))}}if(d&&0<d.length){l||($(document).one("keyup",c),l=!0);for(var n,a=0,r=0,s=0;s<d.length;s++)null==(n=d[s]).ox&&null==n.oy&&(n.ox=n.n.x,n.oy=n.n.y,n.moved=n.n.moved),n.n.moved=!0,n.n.dirty=!0,n.n.x+=e,n.n.y+=t,n.n.dirty=!0,r="group"===n.n.type?(RED.group.markDirty(n.n),a=Math.min(n.n.x-5,a),Math.min(n.n.y-5,r)):(a=Math.min(n.n.x-n.n.w/2-5,a),Math.min(n.n.y-n.n.h/2-5,r));if(0!==a||0!==r)for(i=0;i<d.length;i++)(n=d[i]).n.x-=a,n.n.y-=r;RED.view.redraw()}else RED.view.scroll(10*e,10*t)}function i(n){var e=RED.view.selection(),a=[],t=[];e.nodes&&e.nodes.forEach(function(e){"subflow"!==e.type&&"group"!==e.type?t.push(e):"group"===e.type&&(t=t.concat(RED.group.getNodes(e,!0)))}),t.forEach(function(e){var t=!1,o=void 0===e.l||e.l,i=!e._def.hasOwnProperty("showLabel")||e._def.showLabel;n?!1!==e.l&&(i||e.hasOwnProperty("l"))||(t=e.l=!0):(!i||e.hasOwnProperty("l")&&!0!==e.l)&&(i||!0!==e.l)||(t=!(e.l=!1)),t&&(a.push({t:"edit",node:e,changed:e.changed,changes:{l:o}}),e.changed=!0,e.dirty=!0,e.resize=!0)}),0<a.length&&(RED.history.push({t:"multi",events:a,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0)),RED.view.redraw()}function n(){var i={x:0,y:0},e=RED.view.getActiveGroup();e?(candidates=RED.group.getNodes(e,!1),i=e):candidates=RED.view.getActiveNodes();var n=[];candidates.forEach(function(e){var t=e.x-i.x,o=e.y-i.x;n.push({node:e,delta:o*o+t*t})}),0<n.length&&(n.sort(function(e,t){return e.delta-t.delta}),(e=n[0].node)&&(RED.view.select({nodes:[e]}),RED.view.reveal(e.id,!1)))}function a(e){return RED.nodes.filterLinks({source:e}).map(function(e){return e.target})}function r(e){return RED.nodes.filterLinks({target:e}).map(function(e){return e.source})}function s(e){var t=new Set;return r(e).forEach(function(e){a(e).forEach(function(e){t.add(e)})}),a(e).forEach(function(e){r(e).forEach(function(e){t.add(e)})}),t.delete(e),Array.from(t)}function p(r){var s,e,d,t,o=RED.view.selection();o.nodes&&1===o.nodes.length?(s=o.nodes[0],e=(e=RED.nodes.filterNodes({z:s.z})).concat(RED.view.getSubflowPorts()),d=[],e.forEach(function(e){if(e!==s){var t,o=e.x-s.x,i=e.y-s.y,n=i*i+o*o,a=180/Math.PI*Math.atan2(i,o);switch(a<0&&(a+=360),360<a&&(a-=360),r){case"up":if(a<210||330<a)return;t=Math.max(Math.abs(270-a)/60,.2);break;case"down":if(a<30||150<a)return;t=Math.max(Math.abs(90-a)/60,.2);break;case"left":if(a<140||220<a)return;t=Math.max(Math.abs(180-a)/40,.1);break;case"right":if(40<a&&a<320)return;t=Math.max(Math.abs(a)/40,.1)}t=Math.max(t,.1),d.push({node:e,d:n,w:t,delta:n*t})}}),0<d.length&&(d.sort(function(e,t){return e.delta-t.delta}),(t=d[0].node)&&(RED.view.select({nodes:[t]}),RED.view.reveal(t.id,!1)))):0===RED.workspaces.selection().length&&(e=RED.view.getActiveNodes(),d=[],e.forEach(function(e){var t=e.x,o=e.y;d.push({node:e,delta:o*o+t*t})}),0<d.length&&(d.sort(function(e,t){return e.delta-t.delta}),(t=d[0].node)&&(RED.view.select({nodes:[t]}),RED.view.reveal(t.id,!1))))}function u(s){var d,l,e=RED.view.selection();e.nodes&&1<e.nodes.length&&(d=[],l={minX:Number.MAX_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER},e.nodes.forEach(function(e){"group"===e.type?(l.minX=Math.min(l.minX,e.x),l.minY=Math.min(l.minY,e.y),l.maxX=Math.max(l.maxX,e.x+e.w),l.maxY=Math.max(l.maxY,e.y+e.h)):(l.minX=Math.min(l.minX,e.x-e.w/2),l.minY=Math.min(l.minY,e.y-e.h/2),l.maxX=Math.max(l.maxX,e.x+e.w/2),l.maxY=Math.max(l.maxY,e.y+e.h/2))}),l.midX=l.minX+(l.maxX-l.minX)/2,l.midY=l.minY+(l.maxY-l.minY)/2,e.nodes.forEach(function(e){var t,o,i,n,a,r="group"===e.type;switch(s){case"top":t=e.x,o=l.minY+(r?0:e.h/2);break;case"bottom":t=e.x,o=l.maxY-(r?e.h:e.h/2);break;case"left":t=l.minX+(r?0:e.w/2),o=e.y;break;case"right":t=l.maxX-(r?e.w:e.w/2),o=e.y;break;case"middle":t=e.x,o=l.midY-(r?e.h/2:0);break;case"center":t=l.midX-(r?e.w/2:0),o=e.y}e.x===t&&e.y===o||(r?(i=RED.group.getNodes(e,!0),n=e.x-t,a=e.y-o,i.forEach(function(e){"group"!==e.type&&(d.push({n:e,ox:e.x,oy:e.y,moved:e.moved}),e.x=e.x-n,e.y=e.y-a,e.dirty=!0,e.moved=!0)})):(d.push({n:e,ox:e.x,oy:e.y,moved:e.moved}),e.x=t,e.y=o,e.dirty=!0,e.moved=!0))}),0<d.length&&(RED.history.push({t:"move",nodes:d,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),RED.view.redraw(!0)))}function f(i){var e=RED.view.selection();if(e.nodes&&2<e.nodes.length){var t=[],n={minX:Number.MAX_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER},a=[],r=[];e.nodes.forEach(function(e){var t,o="group"===e.type?(t=e.x+e.w/2,e.y+e.h/2):(t=e.x,e.y);"h"===i?(t<n.minX&&(a=[],n.minX=t),t===n.minX&&a.push(e),t>n.maxX&&(r=[],n.maxX=t),t===n.maxX&&r.push(e)):(o<n.minY&&(a=[],n.minY=o),o===n.minY&&a.push(e),o>n.maxY&&(r=[],n.maxY=o),o===n.maxY&&r.push(e))});var o=a[0],s=r[0],d=0,l=e.nodes.filter(function(e){return e.id!==o.id&&e.id!==s.id&&(d+="h"===i?e.w:e.h,!0)}).sort(function(e,t){return"h"===i?e.x-t.x:e.y-t.y}),c=o.x+o.w/2,p=o.y+o.h/2;"group"===o.type&&(c=o.x+o.w,p=o.y+o.h);var u=s.x,e=s.y;"group"!==s.type&&(u-=s.w/2,e-=s.h/2);for(var f=("h"===i?u-c-d:e-p-d)/(l.length+1),h=c,g=p;0<l.length;){"h"===i?h+=f:g+=f;var v,m,b,y=l.shift(),w="group"===y.type,E=y.x,D=y.y;w||(h+=y.w/2,g+=y.h/2),("h"===i&&E!==h||"v"===i&&D!==g)&&(w?(v=RED.group.getNodes(y,!0),m="h"===i?E-h:0,b="v"===i?D-g:0,v.forEach(function(e){"group"!==e.type&&(t.push({n:e,ox:e.x,oy:e.y,moved:e.moved}),e.x=e.x-m,e.y=e.y-b,e.dirty=!0,e.moved=!0)})):(t.push({n:y,ox:y.x,oy:y.y,moved:y.moved}),"h"===i?y.x=h:y.y=g,y.dirty=!0,y.moved=!0)),w?(h+=y.w,g+=y.h):(h+=y.w/2,g+=y.h/2)}0<t.length&&(RED.history.push({t:"move",nodes:t,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),RED.view.redraw(!0))}}function h(e){var t,o,i,n=RED.view.selection();n.nodes&&(t=[],n.nodes.forEach(function(e){"group"===e.type?t=t.concat(RED.group.getNodes(e,!0).filter(function(e){return"group"!==e.type})):"subflow"!==e.type&&t.push(e)}),0<t.length&&(o=t[0].z,n=RED.nodes.getNodeOrder(o),"forwards"===e?i=RED.nodes.moveNodesForwards(t):"backwards"===e?i=RED.nodes.moveNodesBackwards(t):"front"===e?i=RED.nodes.moveNodesToFront(t):"back"===e&&(i=RED.nodes.moveNodesToBack(t)),0<i.length&&(i=RED.nodes.getNodeOrder(o),RED.history.push({t:"reorder",nodes:{z:o,from:n,to:i},dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),RED.view.redraw(!0))))}return{init:function(){RED.actions.add("core:show-selected-node-labels",function(){i(!0)}),RED.actions.add("core:hide-selected-node-labels",function(){i(!1)}),RED.actions.add("core:scroll-view-up",function(){RED.view.scroll(0,-RED.view.gridSize())}),RED.actions.add("core:scroll-view-right",function(){RED.view.scroll(RED.view.gridSize(),0)}),RED.actions.add("core:scroll-view-down",function(){RED.view.scroll(0,RED.view.gridSize())}),RED.actions.add("core:scroll-view-left",function(){RED.view.scroll(-RED.view.gridSize(),0)}),RED.actions.add("core:step-view-up",function(){RED.view.scroll(0,-5*RED.view.gridSize())}),RED.actions.add("core:step-view-right",function(){RED.view.scroll(5*RED.view.gridSize(),0)}),RED.actions.add("core:step-view-down",function(){RED.view.scroll(0,5*RED.view.gridSize())}),RED.actions.add("core:step-view-left",function(){RED.view.scroll(-5*RED.view.gridSize(),0)}),RED.actions.add("core:move-selection-up",function(){o(0,-1)}),RED.actions.add("core:move-selection-right",function(){o(1,0)}),RED.actions.add("core:move-selection-down",function(){o(0,1)}),RED.actions.add("core:move-selection-left",function(){o(-1,0)}),RED.actions.add("core:move-selection-forwards",function(){h("forwards")}),RED.actions.add("core:move-selection-backwards",function(){h("backwards")}),RED.actions.add("core:move-selection-to-front",function(){h("front")}),RED.actions.add("core:move-selection-to-back",function(){h("back")}),RED.actions.add("core:step-selection-up",function(){o(0,-RED.view.gridSize())}),RED.actions.add("core:step-selection-right",function(){o(RED.view.gridSize(),0)}),RED.actions.add("core:step-selection-down",function(){o(0,RED.view.gridSize())}),RED.actions.add("core:step-selection-left",function(){o(-RED.view.gridSize(),0)}),RED.actions.add("core:select-connected-nodes",function(){e("all")}),RED.actions.add("core:select-downstream-nodes",function(){e("down")}),RED.actions.add("core:select-upstream-nodes",function(){e("up")}),RED.actions.add("core:go-to-next-node",function(){var o,e;(e=RED.view.selection()).nodes&&1===e.nodes.length?(o=e.nodes[0],0<(e=RED.nodes.filterLinks({source:o})).length&&(e.sort(function(e,t){return Math.abs(e.target.y-o.y)-Math.abs(t.target.y-o.y)}),(e=e[0].target)&&(RED.view.select({nodes:[e]}),RED.view.reveal(e.id,!1)))):0===RED.workspaces.selection().length&&n()}),RED.actions.add("core:go-to-previous-node",function(){var o,e;(e=RED.view.selection()).nodes&&1===e.nodes.length?(o=e.nodes[0],0<(e=RED.nodes.filterLinks({target:o})).length&&(e.sort(function(e,t){return Math.abs(e.source.y-o.y)-Math.abs(t.source.y-o.y)}),(e=e[0].source)&&(RED.view.select({nodes:[e]}),RED.view.reveal(e.id,!1)))):0===RED.workspaces.selection().length&&n()}),RED.actions.add("core:go-to-next-sibling",function(){var o,e;(e=RED.view.selection()).nodes&&1===e.nodes.length?0<(e=s(o=e.nodes[0])).length&&((e=e.filter(function(e){return e.y>o.y})).sort(function(e,t){return Math.abs(e.y-o.y)-Math.abs(t.y-o.y)}),(e=e[0])&&(RED.view.select({nodes:[e]}),RED.view.reveal(e.id,!1))):0===RED.workspaces.selection().length&&n()}),RED.actions.add("core:go-to-previous-sibling",function(){var o,e;(e=RED.view.selection()).nodes&&1===e.nodes.length?0<(e=s(o=e.nodes[0])).length&&((e=e.filter(function(e){return e.y<o.y})).sort(function(e,t){return Math.abs(e.y-o.y)-Math.abs(t.y-o.y)}),(e=e[0])&&(RED.view.select({nodes:[e]}),RED.view.reveal(e.id,!1))):0===RED.workspaces.selection().length&&n()}),RED.actions.add("core:go-to-nearest-node-on-left",function(){p("left")}),RED.actions.add("core:go-to-nearest-node-on-right",function(){p("right")}),RED.actions.add("core:go-to-nearest-node-above",function(){p("up")}),RED.actions.add("core:go-to-nearest-node-below",function(){p("down")}),RED.actions.add("core:align-selection-to-grid",t),RED.actions.add("core:align-selection-to-left",function(){u("left")}),RED.actions.add("core:align-selection-to-right",function(){u("right")}),RED.actions.add("core:align-selection-to-top",function(){u("top")}),RED.actions.add("core:align-selection-to-bottom",function(){u("bottom")}),RED.actions.add("core:align-selection-to-middle",function(){u("middle")}),RED.actions.add("core:align-selection-to-center",function(){u("center")}),RED.actions.add("core:distribute-selection-horizontally",function(){f("h")}),RED.actions.add("core:distribute-selection-vertically",function(){f("v")}),RED.actions.add("core:wire-series-of-nodes",function(){!function(){var e=RED.view.selection();if(e.nodes&&1<e.nodes.length){for(var t=0,o=[];t<e.nodes.length-1;){var i=e.nodes[t],n=e.nodes[t+1];0<i.outputs&&0<n.inputs&&0===RED.nodes.filterLinks({source:i,target:n,sourcePort:0}).length&&(RED.nodes.addLink(n={source:i,target:n,sourcePort:0}),o.push(n)),t++}0<o.length&&(RED.history.push({t:"add",links:o,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),RED.view.redraw(!0))}}()}),RED.actions.add("core:wire-node-to-multiple",function(){!function(){var e=RED.view.selection();if(e.nodes&&1<e.nodes.length){var t=e.nodes[0];if(0!==t.outputs){for(var o=1,i=[];o<e.nodes.length;){var n=e.nodes[o];0<n.inputs&&0===RED.nodes.filterLinks({source:t,target:n,sourcePort:Math.min(t.outputs-1,o-1)}).length&&(n={source:t,target:n,sourcePort:Math.min(t.outputs-1,o-1)},RED.nodes.addLink(n),i.push(n)),o++}0<i.length&&(RED.history.push({t:"add",links:i,dirty:RED.nodes.dirty()}),RED.nodes.dirty(!0),RED.view.redraw(!0))}}}()})},alignSelectionToGrid:t,moveSelection:o}}(),RED.sidebar=function(){var a,r={};var n={};function t(e){e?($("#red-ui-main-container").removeClass("red-ui-sidebar-closed"),a.resize()):$("#red-ui-main-container").addClass("red-ui-sidebar-closed"),RED.events.emit("sidebar:resize")}function s(e){(e=":first"===e?RED.settings.get("editor.sidebar.order",["info","help","version-control","debug"])[0]:e)&&(!o(e)&&r[e]&&a.addTab(r[e]),a.activateTab(e),RED.menu.isSelected("menu-item-sidebar")||RED.menu.setSelected("menu-item-sidebar",!0))}function o(e){return a.contains(e)}return n.dragging=!1,{init:function(){!function(){$("#red-ui-sidebar-separator").draggable({axis:"x",start:function(e,t){n.closing=!1,n.opening=!1;var o=$("#red-ui-editor").width();n.start=t.position.left,n.chartWidth=$("#red-ui-workspace").width(),n.chartRight=o-$("#red-ui-workspace").width()-$("#red-ui-workspace").offset().left-2,n.dragging=!0,RED.menu.isSelected("menu-item-sidebar")||(n.opening=!0,$("#red-ui-sidebar").addClass("closing"),$("#red-ui-workspace").css("right",7),$("#red-ui-editor-stack").css("right",8),$("#red-ui-sidebar").width(0),RED.menu.setSelected("menu-item-sidebar",!0),RED.events.emit("sidebar:resize")),n.width=$("#red-ui-sidebar").width()},drag:function(e,t){var o=t.position.left-n.start,i=n.width-o;n.opening&&(i-=3),150<i&&n.chartWidth+o<200&&(t.position.left=200+n.start-n.chartWidth,o=t.position.left-n.start,i=n.width-o),i<150?(n.closing||($("#red-ui-sidebar").addClass("closing"),n.closing=!0),n.opening||(t.position.left=n.width-((i=150)-n.start),o=t.position.left-n.start)):150<i&&(n.closing||n.opening)&&(n.closing=!1,$("#red-ui-sidebar").removeClass("closing"));o=n.chartRight-o;$("#red-ui-workspace").css("right",o),$("#red-ui-editor-stack").css("right",1+o),$("#red-ui-sidebar").width(i),a.resize(),RED.events.emit("sidebar:resize")},stop:function(e,t){n.dragging=!1,n.closing&&($("#red-ui-sidebar").removeClass("closing"),RED.menu.setSelected("menu-item-sidebar",!1),$("#red-ui-sidebar").width()<180&&($("#red-ui-sidebar").width(180),$("#red-ui-workspace").css("right",187),$("#red-ui-editor-stack").css("right",188))),$("#red-ui-sidebar-separator").css("left","auto"),$("#red-ui-sidebar-separator").css("right",$("#red-ui-sidebar").width()+2+"px"),RED.events.emit("sidebar:resize")}});var e=$('<div class="red-ui-sidebar-control-right"><i class="fa fa-chevron-right"</div>').appendTo($("#red-ui-sidebar-separator"));e.on("click",function(){e.hide(),RED.menu.toggleSelected("menu-item-sidebar")}),$("#red-ui-sidebar-separator").on("mouseenter",function(){n.dragging||(RED.menu.isSelected("menu-item-sidebar")?e.find("i").addClass("fa-chevron-right").removeClass("fa-chevron-left"):e.find("i").removeClass("fa-chevron-right").addClass("fa-chevron-left"),e.toggle("slide",{direction:"right"},200))}),$("#red-ui-sidebar-separator").on("mouseleave",function(){n.dragging||(e.stop(!1,!0),e.hide())})}(),a=RED.tabs.create({element:$('<ul id="red-ui-sidebar-tabs"></ul>').appendTo("#red-ui-sidebar"),onchange:function(e){$("#red-ui-sidebar-content").children().hide(),$("#red-ui-sidebar-footer").children().hide(),e.onchange&&e.onchange.call(e),$(e.wrapper).show(),e.toolbar&&$(e.toolbar).show()},onremove:function(e){$(e.wrapper).hide(),e.onremove&&e.onremove.call(e)},collapsible:!0,onreorder:function(e){RED.settings.set("editor.sidebar.order",e)},order:RED.settings.get("editor.sidebar.order",["info","help","version-control","debug"])}),$('<div id="red-ui-sidebar-content"></div>').appendTo("#red-ui-sidebar"),$('<div id="red-ui-sidebar-footer" class="red-ui-component-footer"></div>').appendTo("#red-ui-sidebar"),$('<div id="red-ui-sidebar-shade" class="hide"></div>').appendTo("#red-ui-sidebar"),RED.actions.add("core:toggle-sidebar",function(e){void 0===e?RED.menu.toggleSelected("menu-item-sidebar"):t(e)}),RED.popover.tooltip($("#red-ui-sidebar-separator").find(".red-ui-sidebar-control-right"),RED._("keyboard.toggleSidebar"),"core:toggle-sidebar"),s(),RED.sidebar.info.init(),RED.sidebar.help.init(),RED.sidebar.config.init(),RED.sidebar.context.init(),$("#red-ui-editor").width()<600&&RED.menu.setSelected("menu-item-sidebar",!1)},addTab:function(e,t,o,i){var n;"string"==typeof e?n={id:t.id,label:e,name:e,content:t,closeable:o,visible:i}:"object"==typeof e&&(n=e),delete n.closeable,n.wrapper=$("<div>",{style:"height:100%"}).appendTo("#red-ui-sidebar-content"),n.wrapper.append(n.content),n.wrapper.hide(),n.enableOnEdit||(n.shade=$("<div>",{class:"red-ui-sidebar-shade hide"}).appendTo(n.wrapper)),n.toolbar&&($("#red-ui-sidebar-footer").append(n.toolbar),$(n.toolbar).hide()),n.id,RED.menu.addItem("menu-item-view-menu",{id:"menu-item-view-menu-"+n.id,label:n.name,onselect:function(){s(n.id)},group:"sidebar-tabs"}),n.iconClass=n.iconClass||"fa fa-square-o",!1!==(r[n.id]=n).visible&&a.addTab(r[n.id])},removeTab:function(e){a.removeTab(e),$(r[e].wrapper).remove(),r[e].footer&&r[e].footer.remove(),delete r[e],RED.menu.removeItem("menu-item-view-menu-"+e)},show:s,containsTab:o,toggleSidebar:t}}(),RED.palette=function(){var i,E=["config","unknown","deprecated"],D=["subflows","common","function","network","input","output","sequence","parser","storage","analysis","social","advanced"],x={};function R(e,t,o,i){0===$("#red-ui-palette-base-category-"+t).length&&n(e,t,i+":palette.label."+t),$("#red-ui-palette-container-"+t).show(),0===$("#red-ui-palette-"+o).length&&$("#red-ui-palette-base-category-"+t).append('<div id="red-ui-palette-'+o+'"></div>')}function n(e,t,o){var o=((o=RED._(o,{defaultValue:t}))||t).replace(/_/g," "),i=$('<div id="red-ui-palette-container-'+t+'" class="red-ui-palette-category hide"><div id="red-ui-palette-header-'+t+'" class="red-ui-palette-header"><i class="expanded fa fa-angle-down"></i><span>'+o+'</span></div><div class="red-ui-palette-content" id="red-ui-palette-base-category-'+t+'"><div id="red-ui-palette-'+t+'"></div><div id="red-ui-palette-'+t+'-input"></div><div id="red-ui-palette-'+t+'-output"></div><div id="red-ui-palette-'+t+'-function"></div></div></div>').appendTo("#red-ui-palette-container");i.data("category",e),i.data("label",o),x[t]={container:i,close:function(){i.removeClass("red-ui-palette-open"),i.addClass("red-ui-palette-closed"),$("#red-ui-palette-base-category-"+t).slideUp(),$("#red-ui-palette-header-"+t+" i").removeClass("expanded")},open:function(){i.addClass("red-ui-palette-open"),i.removeClass("red-ui-palette-closed"),$("#red-ui-palette-base-category-"+t).slideDown(),$("#red-ui-palette-header-"+t+" i").addClass("expanded")},toggle:function(){i.hasClass("red-ui-palette-open")?x[t].close():x[t].open()}},$("#red-ui-palette-header-"+t).on("click",function(e){x[t].toggle()})}function k(e,t,o,i,n){o.attr("data-palette-label",i);for(var a=(i=RED.utils.sanitize(i)).split(/([ -]|\\n )/),r=[],s="",d=0;d<a.length;d++){var l=a[d];if("\\n "!==l){var c=0==d?"":" ";if(RED.view.calculateTextWidth(s+c+l,"red-ui-palette-label")<82)s+=c+l;else for(0<d&&r.push(s);;){if(!(82<=RED.view.calculateTextWidth(l,"red-ui-palette-label"))){s=l;break}for(var p=l.length;0<p;p--){var u=l.substring(0,p);if(RED.view.calculateTextWidth(u,"red-ui-palette-label")<82){r.push(u),l=l.substring(p);break}}}}else r.push(s),s=""}r.push(s);var f=r.join("<br/>"),h=8+20*r.length;o.css({height:h+"px"}),o.find(".red-ui-palette-label").html(f).attr("dir",RED.text.bidi.resolveBaseTextDir(f)),o.find(".red-ui-palette-port").css({top:h/2-5+"px"});try{!(n=n||$("script[data-help-name='"+t+"']").html())&&e&&(n=RED._(e+":"+t+".paletteHelp"));var g,v="<p><b>"+RED.text.bidi.enforceTextDirectionWithUCC(i)+"</b></p>";(g=$("<div></div>").append($(v+(n||"<p>"+RED._("palette.noInfo")+"</p>").trim()).filter(function(e){return 1==this.nodeType&&"P"==this.nodeName||3==this.nodeType&&0<this.textContent.trim().length}).slice(0,2))).find("a").each(function(){var e=$(this).text();$(this).before(e),$(this).remove()});var m,b,y=RED.nodes.getType(t);y&&(m="",y&&!/^subflow:/.test(t)&&(m=y.set.module+" : "),m+=t,/^subflow:/.test(t)&&$('<button type="button" onclick="RED.workspaces.show(\''+t.substring(8).replace(/'/g,"\\'")+'\'); return false;" class="red-ui-button red-ui-button-small" style="float: right; margin-left: 5px;"><i class="fa fa-pencil"></i></button>').appendTo(g),b=t.replace(/'/g,"\\'"),$('<button type="button" onclick="RED.search.show(\'type:'+b+'\'); return false;" class="red-ui-button red-ui-button-small" style="float: right; margin-left: 5px;"><i class="fa fa-search"></i></button>').appendTo(g),$('<button type="button" onclick="RED.sidebar.help.show(\''+b+'\'); return false;" class="red-ui-button red-ui-button-small" style="float: right; margin-left: 5px;"><i class="fa fa-book"></i></button>').appendTo(g),$("<p>",{style:"font-size: 0.8em"}).text(m).appendTo(g))}catch(e){console.log("Error generating pop-over label for ",t),console.log(e.toString()),g="<p><b>"+i+"</b></p><p>"+RED._("palette.noInfo")+"</p>"}o.data("popover").setContent(g)}function _(e){return $(".red-ui-palette-node[data-palette-type='"+e+"']")}function T(e){return e.replace(/[ /.]/g,"_")}function a(o,i){if(!_(o).length){var e=i.category;if(-1===E.indexOf(e)){var t,n,a,r=T(e),s=r.split("-")[0],d=$("<div>",{class:"red-ui-palette-node"}).attr("data-palette-type",o).data("category",s),l=o;if(void 0!==i.paletteLabel)try{l=("function"==typeof i.paletteLabel?i.paletteLabel.call(i):i.paletteLabel)||""}catch(e){console.log("Definition error: "+o+".paletteLabel",e)}$("<div/>",{class:"red-ui-palette-label"+(!i.align&&0!==i.inputs&&0===i.outputs||"right"===i.align?" red-ui-palette-label-right":"")+("#"===i.color.substring(0,1)&&parseInt("0x"+i.color.substring(1))<(4==i.color.length?2e3:8e6)?" red-ui-palette-label-white":"")}).appendTo(d),i.icon&&(t=RED.utils.getNodeIcon(i),(n=$("<div/>",{class:"red-ui-palette-icon-container"+(!i.align&&0!==i.inputs&&0===i.outputs||"right"===i.align?" red-ui-palette-icon-container-right":"")}).appendTo(d)).attr("data-palette-icon",t),RED.utils.createIconElement(t,n,!0)),d.css("backgroundColor",RED.utils.getNodeColor(o,i)),0<i.outputs&&((a=document.createElement("div")).className="red-ui-palette-port red-ui-palette-port-output",d.append(a)),0<i.inputs&&((a=document.createElement("div")).className="red-ui-palette-port red-ui-palette-port-input",d.append(a)),R(e,s,r,-1!==D.indexOf(s)?"node-red":i.set.id),$("#red-ui-palette-"+r).append(d),d.on("mousedown",function(e){e.preventDefault()});e=RED.popover.create({target:d,trigger:"hover",interactive:!0,width:"300px",content:"hi",delay:{show:750,hide:50}});d.data("popover",e);var u,f,h,g,c,p,v,m,b,y=$("#red-ui-workspace-chart"),w=$("#red-ui-workspace-chart>svg").get(0);$(d).draggable({helper:"clone",appendTo:"#red-ui-editor",revert:"invalid",revertDuration:200,containment:"#red-ui-main-container",start:function(){m=$("#red-ui-palette").width(),b=$("#red-ui-palette").parent().position().top+$("#red-ui-palette-container").position().top,v=null,(p=RED.view.getActiveGroup())&&document.getElementById("group_select_"+p.id).classList.add("red-ui-flow-group-active-hovered"),RED.view.focus()},stop:function(){d3.select(".red-ui-flow-link-splice").classed("red-ui-flow-link-splice",!1),v&&document.getElementById("group_select_"+v.id).classList.remove("red-ui-flow-group-hovered"),p&&document.getElementById("group_select_"+p.id).classList.remove("red-ui-flow-group-active-hovered"),g&&(clearTimeout(g),g=null),c&&(clearTimeout(c),c=null)},drag:function(e,p){var t=_(o);p.originalPosition.left=t.offset().left,f=p.position.left-m+p.helper.width()/2+y.scrollLeft(),h=p.position.top-b+p.helper.height()/2+y.scrollTop()+10,c=c||setTimeout(function(){var e=f/RED.view.scale(),t=h/RED.view.scale(),t=RED.view.getGroupAtPoint(e,t);t!==v&&(v&&document.getElementById("group_select_"+v.id).classList.remove("red-ui-flow-group-hovered"),t&&document.getElementById("group_select_"+t.id).classList.add("red-ui-flow-group-hovered"),(v=t)?$(p.helper).data("group",v):$(p.helper).removeData("group")),c=null},200),0<i.inputs&&0<i.outputs&&(g=g||setTimeout(function(){for(var e,t=[],o=1/0,i=null,t=w.getIntersectionList?((e=w.createSVGRect()).x=f,e.y=h,e.width=1,e.height=1,w.getIntersectionList(e,w)):RED.view.getLinksAtPoint(f,h),n=f/RED.view.scale(),a=h/RED.view.scale(),r=0;r<t.length;r++){var s=d3.select(t[r]);if(s.classed("red-ui-flow-link-background")&&!s.classed("red-ui-flow-link-link"))for(var d=t[r].getTotalLength(),l=0;l<d;l+=10){var c=t[r].getPointAtLength(l),c=(c.x-n)*(c.x-n)+(c.y-a)*(c.y-a);c<200&&c<o&&(o=c,i=t[r])}}u&&u!==i&&d3.select(u.parentNode).classed("red-ui-flow-link-splice",!1),i?d3.select(i.parentNode).classed("red-ui-flow-link-splice",!0):d3.select(".red-ui-flow-link-splice").classed("red-ui-flow-link-splice",!1),u!==i&&(i?$(p.helper).data("splice",d3.select(i).data()[0]):$(p.helper).removeData("splice")),u=i,g=null},200))}});var r=null;0===o.indexOf("subflow:")&&(d.on("dblclick",function(e){RED.workspaces.show(o.substring(8)),e.preventDefault()}),e=RED.nodes.subflow(o.substring(8)),r=RED.utils.renderMarkdown(e.info||"")),k(i.set.id,o,d,l,r),1===$("#red-ui-palette-container-"+s).find(".red-ui-palette-node").length&&x[s].open()}}}function r(e){var t=_(e),e=t.closest(".red-ui-palette-category");t.remove(),0===e.find(".red-ui-palette-node").length&&e.find("i").hasClass("expanded")&&(e.find(".red-ui-palette-content").slideToggle(),e.find("i").toggleClass("expanded"))}function s(e){e=_(e);e.hide();for(var e=e.closest(".red-ui-palette-category"),t=e.find(".red-ui-palette-node"),o=0,i=0;i<t.length;i++)"none"===$(t[i]).css("display")&&(o+=1);o===t.length&&e.hide()}function d(e){e=_(e);e.closest(".red-ui-palette-category").show(),e.show()}function l(e){var t=_("subflow:"+e.id),o=t.find(".red-ui-palette-port-input"),i=t.find(".red-ui-palette-port-output");t.find(".red-ui-palette-label").attr("class","red-ui-palette-label"+(!e._def.align&&0!==e.in.length&&0===e.out.length||"right"===e._def.align?" red-ui-palette-label-right":"")),t.find(".red-ui-palette-icon-container").attr("class","red-ui-palette-icon-container"+(!e._def.align&&0!==e.in.length&&0===e.out.length||"right"===e._def.align?" red-ui-palette-icon-container-right":"")),0===o.length&&0<e.in.length?((n=document.createElement("div")).className="red-ui-palette-port red-ui-palette-port-input",t.append(n)):0!==o.length&&0===e.in.length&&o.remove(),0===i.length&&0<e.out.length?((a=document.createElement("div")).className="red-ui-palette-port red-ui-palette-port-output",t.append(a)):0!==i.length&&0===e.out.length&&i.remove();var n=t.attr("data-palette-label"),o=t.attr("data-palette-info");n===e.name&&o===e.info||(t.attr("data-palette-info",e.info),k("",e.type+":"+e.id,t,e.name,RED.utils.renderMarkdown(e.info||""))),a=t,i=e,i=RED.utils.getNodeIcon(i._def),(a=a.find(".red-ui-palette-icon-container")).attr("data-palette-icon")!==i&&(a.attr("data-palette-icon",i),RED.utils.createIconElement(i,a,!0));var a,n=t.data("category"),o=e.category||"subflows";n!==o&&(R(o,i=T(o),i,"node-red"),a=t.closest(".red-ui-palette-category"),(n=$("#red-ui-palette-"+i)).append(t),1===n.find(".red-ui-palette-node").length&&x[i].open(),t.data("category",o),0===a.find(".red-ui-palette-node").length&&a.find("i").hasClass("expanded")&&(a.find(".red-ui-palette-content").slideToggle(),a.find("i").toggleClass("expanded"))),t.css("backgroundColor",e.color)}return{init:function(){$('<img src="red/images/spin.svg" class="red-ui-palette-spinner hide"/>').appendTo("#red-ui-palette"),$('<div id="red-ui-palette-search" class="red-ui-palette-search hide"><input type="text" data-i18n="[placeholder]palette.filter"></input></div>').appendTo("#red-ui-palette"),$('<div id="red-ui-palette-container" class="red-ui-palette-scroll hide"></div>').appendTo("#red-ui-palette"),$('<div class="red-ui-component-footer"></div>').appendTo("#red-ui-palette"),$('<div id="red-ui-palette-shade" class="hide"></div>').appendTo("#red-ui-palette"),$("#red-ui-palette > .red-ui-palette-spinner").show(),RED.events.on("registry:node-type-added",function(e){var t=RED.nodes.getType(e);a(e,t),t.onpaletteadd&&"function"==typeof t.onpaletteadd&&t.onpaletteadd.call(t)}),RED.events.on("registry:node-type-removed",function(e){r(e)}),RED.events.on("registry:node-set-enabled",function(e){for(var t=0;t<e.types.length;t++){d(e.types[t]);var o=RED.nodes.getType(e.types[t]);o&&o.onpaletteadd&&"function"==typeof o.onpaletteadd&&o.onpaletteadd.call(o)}}),RED.events.on("registry:node-set-disabled",function(e){for(var t=0;t<e.types.length;t++){s(e.types[t]);var o=RED.nodes.getType(e.types[t]);o&&o.onpaletteremove&&"function"==typeof o.onpaletteremove&&o.onpaletteremove.call(o)}}),RED.events.on("registry:node-set-removed",function(e){if(e.added)for(var t=0;t<e.types.length;t++){r(e.types[t]);var o=RED.nodes.getType(e.types[t]);o&&o.onpaletteremove&&"function"==typeof o.onpaletteremove&&o.onpaletteremove.call(o)}}),RED.events.on("subflows:change",l),$("#red-ui-palette-search input").searchBox({delay:100,change:function(){!function(i){var e,n=new RegExp(i.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"i");for(e in $("#red-ui-palette-container .red-ui-palette-node").each(function(e,t){var o=$(t).attr("data-palette-label"),t=$(t).attr("data-palette-type");""===i||n.test(t)||n.test(o)?$(this).show():$(this).hide()}),x)x.hasOwnProperty(e)&&(0===x[e].container.find(".red-ui-palette-node").filter(function(){return"none"!==$(this).css("display")}).length?(x[e].close(),x[e].container.slideUp()):(x[e].open(),x[e].container.show()))}($(this).val())}}),i=$('<div class="red-ui-sidebar-control-left"><i class="fa fa-chevron-left"></i></div>').appendTo($("#red-ui-palette")),RED.popover.tooltip(i,RED._("keyboard.togglePalette"),"core:toggle-palette"),i.on("click",function(){RED.menu.toggleSelected("menu-item-palette")}),$("#red-ui-palette").on("mouseenter",function(){i.toggle("slide",{direction:"left"},200)}),$("#red-ui-palette").on("mouseleave",function(){i.stop(!1,!0),i.hide()});var e=[];RED.settings.paletteCategories?e=RED.settings.paletteCategories:RED.settings.theme("palette.categories")&&(e=RED.settings.theme("palette.categories")),Array.isArray(e)||(e=[]);var t={};e.forEach(function(e){t[e]=!0,n(e,T(e),"palette.label."+T(e))}),D.forEach(function(e){t[e]||n(e,T(e),"palette.label."+T(e))});var o=$('<span class="button-group"></span>').appendTo("#red-ui-palette .red-ui-component-footer");(e=$('<button type="button" class="red-ui-footer-button"><i class="fa fa-angle-double-up"></i></button>').appendTo(o)).on("click",function(e){for(var t in e.preventDefault(),x)x.hasOwnProperty(t)&&x[t].close()}),RED.popover.tooltip(e,RED._("palette.actions.collapse-all")),(o=$('<button type="button" class="red-ui-footer-button"><i class="fa fa-angle-double-down"></i></button>').appendTo(o)).on("click",function(e){for(var t in e.preventDefault(),x)x.hasOwnProperty(t)&&x[t].open()}),RED.popover.tooltip(o,RED._("palette.actions.expand-all")),RED.actions.add("core:toggle-palette",function(e){void 0===e?RED.menu.toggleSelected("menu-item-palette"):function(e){e?($("#red-ui-main-container").removeClass("red-ui-palette-closed"),i.find("i").removeClass("fa-chevron-right").addClass("fa-chevron-left")):($("#red-ui-main-container").addClass("red-ui-palette-closed"),i.hide(),i.find("i").addClass("fa-chevron-right").removeClass("fa-chevron-left"));setTimeout(function(){$(window).trigger("resize")},200)}(e)})},add:a,remove:r,hide:s,show:d,refresh:function(){RED.nodes.eachSubflow(l)},getCategories:function(){var o=[];return $("#red-ui-palette-container .red-ui-palette-category").each(function(e,t){o.push({id:$(t).data("category"),label:$(t).data("label")})}),o}}}(),RED.sidebar.info=function(){var i,n,w,a,E,D,x,R,k,r,s,_={property:!1};function d(){var e;n&&(e=$(i).parent().height()-r.outerHeight(),n.resize(e))}function l(){RED.sidebar.show("info")}function o(e){if(void 0!==e){$(w).empty();var t=$('<table class="red-ui-info-table"></table>').appendTo(w),o=$("<tbody>").appendTo(t);if(null===e)RED.sidebar.info.outliner.select(null),E.empty(),D.text(""),x.hide(),R.hide();else if(Array.isArray(e)){RED.sidebar.info.outliner.select(e),E.empty(),RED.utils.createNodeIcon({type:"_selection_"}).appendTo(E),D.text("Selection"),x.hide(),R.hide(),k=null;var i={nodes:0,flows:0,subflows:0,groups:0};e.forEach(function(e){"tab"===e.type?(i.flows++,i.nodes+=RED.nodes.filterNodes({z:e.id}).length):"subflow"===e.type?i.subflows++:"group"===e.type?i.groups++:i.nodes++});var n=$('<tr class="red-ui-help-info-row"><td>'+RED._("sidebar.info.selection")+"</td><td></td></tr>").appendTo(o),a=$("<div>").appendTo($(n.children()[1]));0<i.flows&&$("<div>").text(RED._("clipboard.flow",{count:i.flows})).appendTo(a),0<i.subflows&&$("<div>").text(RED._("clipboard.subflow",{count:i.subflows})).appendTo(a),0<i.nodes&&$("<div>").text(RED._("clipboard.node",{count:i.nodes})).appendTo(a),0<i.groups&&$("<div>").text(RED._("clipboard.group",{count:i.groups})).appendTo(a)}else{RED.sidebar.info.outliner.select(e);var r=/^subflow(:(.+))?$/.exec(e.type);r&&((b=r[2]?RED.nodes.subflow(r[2]):e).id,y=b.instances.length),E.empty(),RED.utils.createNodeIcon(e).appendTo(E);var s=RED.utils.getNodeLabel(e,e.type+": "+e.id),t=s.indexOf("\\n");-1<t&&(s=s.substring(0,t)+"..."),D.text(s),x.show(),k=e,n=$('<tr class="red-ui-help-info-row"><td></td><td></td></tr>').appendTo(o);s="node";if("subflow"===e.type||r?s="subflow":"tab"===e.type?s="flow":"group"===e.type&&(s="group"),$(n.children()[0]).text(RED._("sidebar.info."+s)),RED.utils.createObjectElement(e.id).appendTo(n.children()[1]),"tab"===e.type||"subflow"===e.type)R.hide();else if("group"===e.type){R.hide(),n=$('<tr class="red-ui-help-info-row"><td>&nbsp;</td><td></td></tr>').appendTo(o);var d={nodes:0,groups:0};RED.group.getNodes(e,!0).forEach(function(e){"group"===e.type?d.groups++:d.nodes++});a=$("<div>").appendTo($(n.children()[1]));0<d.nodes&&$("<div>").text(RED._("clipboard.node",{count:d.nodes})).appendTo(a),0<d.groups&&$("<div>").text(RED._("clipboard.group",{count:d.groups})).appendTo(a)}else{R.show(),r||(n=$('<tr class="red-ui-help-info-row"><td>'+RED._("sidebar.info.type")+"</td><td></td></tr>").appendTo(o),$(n.children()[1]).text(("unknown"===e.type?e._orig:e).type),"unknown"===e.type&&$('<span style="float: right; font-size: 0.8em"><i class="fa fa-warning"></i></span>').prependTo($(n.children()[1])));var l=0;if(!r&&"subflow"!=e.type&&"group"!=e.type){var c,p,u,f,h,g,v,a=$('<tr class="red-ui-help-property-expand blank"><td colspan="2"></td></tr>').appendTo(o);if("unknown"===e.type?(c={},Object.keys(e._orig).forEach(function(e){"type"!==e&&(c[e]={})})):e._def&&(c=e._def.defaults,n=$('<tr class="red-ui-help-info-property-row'+(_.property?"":" hide")+'"><td>'+RED._("sidebar.info.module")+"</td><td></td></tr>").appendTo(o),$(n.children()[1]).text(RED.nodes.getType(e.type).set.module),l++),c)for(var m in c)"name"!=m&&"info"!=m&&c.hasOwnProperty(m)&&(p=e[m],l++,n=$('<tr class="red-ui-help-info-property-row'+(_.property?"":" hide")+'"><td></td><td></td></tr>').appendTo(o),$(n.children()[0]).text(m),c[m].type&&!c[m]._type.array?(u=RED.nodes.node(p))?(f=RED.utils.getNodeLabel(u,p),h=n.children()[1],v=$("<span>",{class:""}).appendTo(h),g=$("<div>",{class:"red-ui-palette-node red-ui-palette-node-small"}).appendTo(v),m=RED.utils.getNodeColor(u.type,u._def),v=RED.utils.getNodeIcon(u._def),g.css({backgroundColor:m,cursor:"pointer"}),m=$("<div/>",{class:"red-ui-palette-icon-container"}).appendTo(g),$("<div/>",{class:"red-ui-palette-icon",style:"background-image: url("+v+")"}).appendTo(m),$("<span></span>").css({verticalAlign:"top",marginLeft:"6px"}).text(f).appendTo(h),g.on("dblclick",function(){RED.editor.editConfig("",u.type,u.id)})):RED.utils.createObjectElement(void 0).appendTo(n.children()[1]):RED.utils.createObjectElement(p).appendTo(n.children()[1]));0<l&&$('<a href="#" class="node-info-property-header'+(_.property?" expanded":"")+'"><span class="red-ui-help-property-more">'+RED._("sidebar.info.showMore")+'</span><span class="red-ui-help-property-less">'+RED._("sidebar.info.showLess")+'</span> <i class="fa fa-caret-down"></i></a>').appendTo(a.children()[0])}"tab"!==e.type&&r&&($('<tr class="blank"><th colspan="2">'+RED._("sidebar.info.subflow")+"</th></tr>").appendTo(o),$('<tr class="node-info-subflow-row"><td>'+RED._("common.label.name")+'</td><td><span class="red-ui-text-bidi-aware" dir="'+RED.text.bidi.resolveBaseTextDir(b.name)+'">'+RED.utils.sanitize(b.name)+"</span></td></tr>").appendTo(o))}r&&(n=$('<tr class="red-ui-help-info-row"><td>'+RED._("subflow.category")+"</td><td></td></tr>").appendTo(o),r=b.category||"subflows",$(n.children()[1]).text(RED._("palette.label."+r,{defaultValue:r})),$('<tr class="node-info-subflow-row"><td>'+RED._("sidebar.info.instances")+"</td><td>"+y+"</td></tr>").appendTo(o),b.meta&&(n=$('<tr class="red-ui-help-info-row"><td>'+RED._("subflow.module")+"</td><td></td></tr>").appendTo(o),$(n.children()[1]).text(b.meta.module||""),n=$('<tr class="red-ui-help-info-row"><td>'+RED._("subflow.version")+"</td><td></td></tr>").appendTo(o),$(n.children()[1]).text(b.meta.version||"")));var b,y="";e._def&&e._def.info&&(b="function"==typeof(b=e._def.info)?b.call(e):b,y+=RED.utils.renderMarkdown(b)),e.info&&(y+=RED.utils.renderMarkdown(e.info||"")),function(e,t){t=function(e){return $(e).find("a").each(function(e){var t=$(this).attr("href");/^https?:/.test(t)&&$(this).attr("target","_blank")}),e}($('<div class="red-ui-help"><span class="red-ui-text-bidi-aware" dir="'+RED.text.bidi.resolveBaseTextDir(e)+'">'+e+"</span></div>")).appendTo(t);t.find(".red-ui-text-bidi-aware").contents().filter(function(){return 3===this.nodeType&&""!==this.textContent.trim()}).wrap("<span></span>");t.find("H3").wrapInner('<a class="red-ui-help-info-header expanded" href="#"></a>').find("a").prepend('<i class="fa fa-angle-right">').on("click",function(e){e.preventDefault();for(var t=$(this).hasClass("expanded"),o=$(this).parent().next();1===o.length&&"H3"!==o[0].nodeName;)o.toggle(!t),o=o.next();$(this).toggleClass("expanded",!t)})}(y,$("<div>").css("padding","0 6px 6px").appendTo(w)),$(".red-ui-sidebar-info-stack").scrollTop(0),$(".node-info-property-header").on("click",function(e){e.preventDefault(),_.property=!_.property,$(this).toggleClass("expanded",_.property),$(".red-ui-help-info-property-row").toggle(_.property)})}}else T()}var c,p,t,u,f,h=(t=!0,u=15e3,f=-1,RED.actions.add("core:toggle-show-tips",function(e){void 0===e?RED.userSettings.toggle("view-show-tips"):((t=e)?v:m)()}),{start:v,stop:m,next:function(){clearInterval(p),c=!0,e()},enabled:function(){return t}});function e(){for(var e,t=Math.floor(Math.random()*f),o=RED._("infotips:info.tip"+t);e=/({{(.*?)}})/.exec(o);){var i=RED.keyboard.getShortcut(e[2]);if(!i)return;o=o.replace(e[1],RED.keyboard.formatKey(i.key))}for(;e=/(\[([a-z]*?)\])/.exec(o);)o=o.replace(e[1],RED.keyboard.formatKey(e[2]));s.html(o).fadeIn(200),c&&(c=null,p=setInterval(g,u))}function g(){s.fadeOut(300,function(){e()})}function v(){if($(".red-ui-sidebar-info").addClass("show-tips"),d(),t&&!c&&!p){if(-1===f)for(;f++,RED._("infotips:info.tip"+f)!=="info.tip"+f;);c=setTimeout(e,1e3)}}function m(){$(".red-ui-sidebar-info").removeClass("show-tips"),d(),clearInterval(p),clearTimeout(c),c=p=null}function T(e){var t;(e=void 0===e?RED.view.selection():e).nodes?1==e.nodes.length?"subflow"===(t=e.nodes[0]).type&&t.direction?o(RED.nodes.subflow(t.z)):o(t):o(e.nodes):e.flows||e.subflows?o(e.flows):(e=RED.workspaces.active(),(e=RED.nodes.workspace(e)||RED.nodes.subflow(e))?o(e):(e=RED.nodes.workspace(RED.workspaces.active()))&&e.info?o(e):o(null))}return RED.events.on("view:selection-changed",T),{init:function(){(i=document.createElement("div")).className="red-ui-sidebar-info",RED.actions.add("core:show-info-tab",l);var e=$("<div>",{class:"red-ui-sidebar-info-stack"}).appendTo(i),t=$("<div>").css({overflow:"hidden",height:"calc(70%)"}).appendTo(e),o=$("<div>").css({overflow:"hidden",height:"100%",display:"flex","flex-direction":"column"}).appendTo(e);a=$("<div>",{class:"red-ui-palette-header red-ui-info-header"}).css({flex:"0 0 auto"}).appendTo(o),E=$("<span>").appendTo(a),D=$("<span>").appendTo(a),R=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-book"></button>').css({position:"absolute",top:"12px",right:"32px"}).on("click",function(e){e.preventDefault(),e.stopPropagation(),k&&RED.sidebar.help.show(k.type)}).appendTo(a),RED.popover.tooltip(R,RED._("sidebar.help.showHelp")),x=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-search"></button>').css({position:"absolute",top:"12px",right:"8px"}).on("click",function(e){e.preventDefault(),e.stopPropagation(),k&&(RED.sidebar.info.outliner.reveal(k),RED.view.reveal(k.id))}).appendTo(a),RED.popover.tooltip(x,RED._("sidebar.help.showInOutline")),w=$("<div>").css({flex:"1 1 auto","overflow-y":"scroll"}).appendTo(o),(n=RED.panels.create({container:e})).ratio(.6),RED.sidebar.info.outliner.build().appendTo(t),RED.sidebar.addTab({id:"info",label:RED._("sidebar.info.label"),name:RED._("sidebar.info.name"),iconClass:"fa fa-info",action:"core:show-info-tab",content:i,pinned:!0,enableOnEdit:!0}),RED.events.on("sidebar:resize",d),$(window).on("resize",d),$(window).on("focus",d),r=$('<div class="red-ui-help-tips"></div>').appendTo(i),s=$('<div class="red-ui-help-tip"></div>').appendTo(r),t=$('<div class="red-ui-help-tips-buttons"></div>').appendTo(r),$('<a href="#" class="red-ui-footer-button"><i class="fa fa-refresh"></a>').appendTo(t).on("click",function(e){e.preventDefault(),h.next()}),$('<a href="#" class="red-ui-footer-button"><i class="fa fa-times"></a>').appendTo(t).on("click",function(e){e.preventDefault(),RED.actions.invoke("core:toggle-show-tips"),RED.notify(RED._("sidebar.info.showTips"))}),h.enabled()?h.start():h.stop()},show:l,refresh:o,clear:function(){o(null)},set:function(e,t){console.warn("Deprecated use of RED.sidebar.info.set - use RED.sidebar.help.set instead"),RED.sidebar.help.set(e,t)}}}(),RED.sidebar.info.outliner=function(){var a,o,r,i,n,s,t,d,l={},c={};function p(){var e=[{label:RED._("menu.label.flows"),expanded:!0,children:[]},{id:"__subflow__",label:RED._("menu.label.subflows"),children:[f("__subflow__")]},{id:"__global__",flow:"__global__",label:RED._("sidebar.info.globalConfig"),types:{},children:[f("__global__")]}];return s=e[0],t=e[1],d={__global__:e[2]},e}var e,u={};function f(e){var t={empty:!0,element:$('<div class="red-ui-info-outline-item red-ui-info-outline-item-empty">').text(RED._("sidebar.info.empty"))};return u[e]=t}function h(e){var t=$("<div>",{class:"red-ui-node-list-item red-ui-info-outline-item"});return RED.utils.createNodeIcon(e,!0).appendTo(t),t.find(".red-ui-node-label").addClass("red-ui-info-outline-item-label"),g(e,t),t}function g(n,t){var e,o,i=$("<div>",{class:"red-ui-info-outline-item-controls red-ui-info-outline-item-hover-controls"}).appendTo(t);"subflow"===n.type&&$('<button type="button" class="red-ui-info-outline-item-control-users red-ui-button red-ui-button-small"><i class="fa fa-toggle-right"></i></button>').text(n.instances.length).appendTo(i).on("click",function(e){e.preventDefault(),e.stopPropagation(),RED.search.show("type:subflow:"+n.id)}),"config"===n._def.category&&"group"!==n.type&&(e=$('<button type="button" class="red-ui-info-outline-item-control-users red-ui-button red-ui-button-small"><i class="fa fa-toggle-right"></i></button>').text(n.users.length).appendTo(i).on("click",function(e){e.preventDefault(),e.stopPropagation(),RED.search.show("uses:"+n.id)}),RED.popover.tooltip(e,function(){return RED._("editor.nodesUse",{count:n.users.length})})),n._def.button&&(o=$('<button type="button" class="red-ui-info-outline-item-control-action red-ui-button red-ui-button-small"><i class="fa fa-toggle-right"></i></button>').appendTo(i).on("click",function(e){e.preventDefault(),e.stopPropagation(),RED.view.clickNodeButton(n)}),RED.popover.tooltip(o,RED._("sidebar.info.triggerAction"))),"tab"===n.type&&$('<button type="button" class="red-ui-info-outline-item-control-hide red-ui-button red-ui-button-small"><i class="fa fa-eye"></i><i class="fa fa-eye-slash"></i></button>').appendTo(i).on("click",function(e){e.preventDefault(),e.stopPropagation();e=!t.hasClass("red-ui-info-outline-item-hidden");t.toggleClass("red-ui-info-outline-item-hidden",e),e?RED.workspaces.hide(n.id):RED.workspaces.show(n.id,null,!0)}),"subflow"!==n.type?(o=$('<button type="button" class="red-ui-info-outline-item-control-disable red-ui-button red-ui-button-small"><i class="fa fa-circle-thin"></i><i class="fa fa-ban"></i></button>').appendTo(i).on("click",function(e){var o,i,t;e.preventDefault(),e.stopPropagation(),"tab"===n.type?n.disabled?RED.workspaces.enable(n.id):RED.workspaces.disable(n.id):"group"===n.type?(t=RED.group.getNodes(n,!0),o={t:"multi",events:[],dirty:RED.nodes.dirty()},t.forEach(function(e){var t;"group"!==e.type&&(void 0===i&&(i=!e.d),!!e.d!==i&&(t={t:"edit",node:e,changed:e.changed,changes:{d:e.d}},e.d?delete e.d:e.d=!0,e.dirty=!0,e.dirtyStatus=!0,e.changed=!0,RED.events.emit("nodes:change",e),o.events.push(t))),0<o.events.length&&(RED.history.push(o),RED.nodes.dirty(!0),RED.view.redraw())})):(t={t:"edit",node:n,changed:n.changed,changes:{d:n.d},dirty:RED.nodes.dirty()},n.d?delete n.d:n.d=!0,n.dirty=!0,n.dirtyStatus=!0,n.changed=!0,RED.events.emit("nodes:change",n),RED.history.push(t),RED.nodes.dirty(!0),RED.view.redraw())}),RED.popover.tooltip(o,function(){return"group"===n.type?RED._("common.label.enable")+" / "+RED._("common.label.disable"):RED._("common.label."+("tab"===n.type&&n.disabled||"tab"!==n.type&&n.d?"enable":"disable"))})):$('<div class="red-ui-info-outline-item-control-spacer">').appendTo(i),i.find("button").on("dblclick",function(e){e.preventDefault(),e.stopPropagation()})}function v(e){l={};var t,o=p();n.empty(),t=e,(e=$("<div>",{class:"red-ui-info-outline-item red-ui-info-outline-item-flow"})).css("width","calc(100% - 40px)"),$("<div>",{class:"red-ui-search-result-description red-ui-info-outline-item-label"}).appendTo(e).text(t.name),t=$("<div>",{class:"red-ui-info-outline-item-controls"}).appendTo(e),t=$('<button class="red-ui-button red-ui-button-small" style="position:absolute;right:5px;top: 3px;"><i class="fa fa-ellipsis-h"></i></button>').appendTo(t).on("click",function(e){e.preventDefault(),RED.projects.editProject()}),RED.popover.tooltip(t,RED._("sidebar.project.showProjectSettings")),e.appendTo(n),i.show(),a.treeList("data",o)}function m(){a.treeList("data",p())}function b(e){e=l[e.workspace];e&&e.element.removeClass("red-ui-info-outline-item-hidden")}function y(e){e=l[e.workspace];e&&e.element.addClass("red-ui-info-outline-item-hidden")}function w(e){var t,o,i,n,a;l[e.id]={id:e.id,element:(t=e,o=$("<div>",{class:"red-ui-info-outline-item red-ui-info-outline-item-flow"}),i=$("<div>",{class:"red-ui-search-result-description red-ui-info-outline-item-label"}).appendTo(o),n="string"==typeof t?t:t.label,-1<(a=n.indexOf("\\n"))&&(n=n.substring(0,a)+"..."),i.text(n),g(t,o),o),children:[],deferBuild:!0,icon:"red-ui-icons red-ui-icons-flow",gutter:T(e)},c[e.id]?(l[e.id].children=c[e.id],delete c[e.id]):l[e.id].children.push(f(e.id)),s.treeList.addChild(l[e.id]),l[e.id].element.toggleClass("red-ui-info-outline-item-disabled",!!e.disabled),l[e.id].treeList.container.toggleClass("red-ui-info-outline-item-disabled",!!e.disabled),L()}function E(e){var t=l[e.id],o=e.label||e.id,i=o.indexOf("\\n");-1<i&&(o=o.substring(0,i)+"..."),t.element.find(".red-ui-info-outline-item-label").text(o),t.element.toggleClass("red-ui-info-outline-item-disabled",!!e.disabled),t.treeList.container.toggleClass("red-ui-info-outline-item-disabled",!!e.disabled),L()}function D(e){var o={};e.forEach(function(e,t){o[e]=t}),s.treeList.sortChildren(function(e,t){return"__global__"===e.id?-1:"__global__"===t.id?1:o[e.id]-o[t.id]})}function x(e){l[e.id]={id:e.id,element:h(e),children:[],deferBuild:!0,gutter:T(e)},c[e.id]?(l[e.id].children=c[e.id],delete c[e.id]):l[e.id].children.push(f(e.id)),u.__subflow__&&(u.__subflow__.treeList.remove(),delete u.__subflow__),t.treeList.addChild(l[e.id]),L()}function R(t){l[t.id].treeList.replaceElement(h(t)),RED.nodes.eachNode(function(e){e.type=="subflow:"+t.id&&l[e.id].treeList.replaceElement(h(e))}),L()}function k(e){var t=l[e.id],o=e.g||e.z||"__global__",i=RED.utils.getNodeLabel(e,e.name||e.type+": "+e.id);i?t.element.find(".red-ui-info-outline-item-label").text(i):t.element.find(".red-ui-info-outline-item-label").html("&nbsp;"),o!==(t.parent.id||t.parent.parent.flow)&&(i=t.parent,t.treeList.remove(!0),0===i.children.length&&(i.config?(i.treeList.remove(),delete d[i.parent.id||i.parent.parent.id].types[e.type],0===i.parent.children.length&&("__global__"===i.parent.id?i.parent.treeList.addChild(f(i.parent.id)):(delete d[i.parent.parent.id],i.parent.treeList.remove(),0===i.parent.parent.children.length&&i.parent.parent.treeList.addChild(f(i.parent.parent.id))))):i.treeList.addChild(f(i.id))),"config"===e._def.category&&"group"!==e.type?(C(o,e.type),d[o].types[e.type].treeList.addChild(l[e.id])):(u[o]&&(u[o].treeList.remove(),delete u[o]),l[o].treeList.addChild(t))),t.element.toggleClass("red-ui-info-outline-item-disabled",!!e.d),"config"===e._def.category&&"group"!==e.type&&t.element.find(".red-ui-info-outline-item-control-users").text(e.users.length),L()}function _(e){var t,o=l[e.id];o.treeList.remove(),delete l[e.id],/^subflow:/.test(e.type)&&(t=e.type.substring(8),l[t]&&l[t].element.find(".red-ui-info-outline-item-control-users").text(RED.nodes.subflow(t).instances.length)),u[e.id]&&delete u[e.id];o=o.parent;0===o.children.length&&(o.config?(o.treeList.remove(),delete d[o.parent.id||e.z].types[e.type],0===o.parent.children.length&&("__global__"===o.parent.id?o.parent.treeList.addChild(f(o.parent.id)):(delete d[e.z],o.parent.treeList.remove(),0===o.parent.parent.children.length&&o.parent.parent.treeList.addChild(f(o.parent.parent.id))))):o.treeList.addChild(f(o.id)))}function T(t){var e=$("<span>",{class:"red-ui-info-outline-gutter red-ui-treeList-gutter-float"}),o=$('<button type="button" class="red-ui-info-outline-item-control-reveal red-ui-button red-ui-button-small"><i class="fa fa-search"></i></button>').appendTo(e).on("click",function(e){e.preventDefault(),e.stopPropagation(),RED.view.reveal(t.id)});return RED.popover.tooltip(o,RED._("sidebar.info.find")),e}function C(e,t){u[e]&&(u[e].treeList.remove(),delete u[e]),d[e]||(d[e]={config:!0,flow:e,types:{},label:RED._("menu.label.displayConfig"),children:[]},l[e].treeList.insertChildAt(d[e],0)),d[e].types[t]||(d[e].types[t]={config:!0,label:t,children:[]},d[e].treeList.addChild(d[e].types[t]))}function j(e){l[e.id]={id:e.id,element:h(e),gutter:T(e)},"group"===e.type&&(l[e.id].children=[],l[e.id].deferBuild=!0,c[e.id]&&(l[e.id].children=c[e.id],delete c[e.id]));var t=e.g||e.z||"__global__";"config"!==e._def.category||"group"===e.type?l[t]?(u[t]&&(u[t].treeList.remove(),delete u[t]),l[t].treeList?l[t].treeList.addChild(l[e.id]):l[t].children.push(l[e.id])):(c[t]=c[t]||[],c[t].push(l[e.id])):(C(t,e.type),d[t].types[e.type].treeList.addChild(l[e.id])),l[e.id].element.toggleClass("red-ui-info-outline-item-disabled",!!e.d),/^subflow:/.test(e.type)&&(e=e.type.substring(8),l[e]&&l[e].element.find(".red-ui-info-outline-item-control-users").text(RED.nodes.subflow(e).instances.length)),L()}function L(){e&&clearTimeout(e),r&&(e=setTimeout(function(){o.searchBox("change")},100))}return{build:function(){var e=$("<div>",{class:"red-ui-info-outline"}).css({height:"100%"}),t=$("<div>",{class:"red-ui-sidebar-header red-ui-info-toolbar"}).appendTo(e);return o=$('<input type="text" data-i18n="[placeholder]menu.label.search">').appendTo(t).searchBox({style:"compact",delay:500,change:function(){var e=$(this).val(),t=RED.search.search(e);if(e){r=e;for(var o={},i=0,n=t.length;i<n;i++)o[t[i].node.id]=!0;a.treeList("filter",function(e){return 0===e.depth||e.id&&l[e.id]&&o[e.id]},!0)}else{r=null,a.treeList("filter",null);e=a.treeList("selected");e.id&&a.treeList("show",e.id)}},options:[{label:RED._("sidebar.info.search.configNodes"),value:"is:config"},{label:RED._("sidebar.info.search.unusedConfigNodes"),value:"is:config is:unused"},{label:RED._("sidebar.info.search.invalidNodes"),value:"is:invalid"},{label:RED._("sidebar.info.search.uknownNodes"),value:"type:unknown"},{label:RED._("sidebar.info.search.unusedSubflows"),value:"is:subflow is:unused"},{label:RED._("sidebar.info.search.hiddenFlows"),value:"is:hidden"}]}),i=$('<div class="red-ui-treeList-label red-ui-info-outline-project"><span class="red-ui-treeList-icon"><i class="fa fa-archive"></i></span></div>').hide().appendTo(e),n=$("<span>").appendTo(i),(a=$("<div>").css({width:"100%"}).appendTo(e).treeList({data:p()})).on("treelistselect",function(e,t){t=RED.nodes.node(t.id)||RED.nodes.group(t.id);t&&("group"===t.type||"config"!==t._def.category||"config"===t._def.category&&RED.sidebar.info.refresh(t))}),a.on("treelistconfirm",function(e,t){t=RED.nodes.node(t.id);t&&("config"===t._def.category?RED.editor.editConfig("",t.type,t.id):RED.editor.edit(t))}),RED.events.on("projects:load",v),RED.events.on("flows:add",w),RED.events.on("flows:remove",_),RED.events.on("flows:change",E),RED.events.on("flows:reorder",D),RED.events.on("subflows:add",x),RED.events.on("subflows:remove",_),RED.events.on("subflows:change",R),RED.events.on("nodes:add",j),RED.events.on("nodes:remove",_),RED.events.on("nodes:change",k),RED.events.on("groups:add",j),RED.events.on("groups:remove",_),RED.events.on("groups:change",k),RED.events.on("workspace:show",b),RED.events.on("workspace:hide",y),RED.events.on("workspace:clear",m),e},search:function(e){o.searchBox("value",e)},select:function(e){e?Array.isArray(e)?a.treeList("select",e.map(function(e){return l[e.id]}),!1):a.treeList("select",l[e.id],!1):a.treeList("clearSelection")},reveal:function(e){a.treeList("show",l[e.id])}}}(),RED.sidebar.help=function(){var i,n,a,r,t,s,d,e;function l(){var e=$(i).parent().height()-n.outerHeight();r.resize(e)}function c(){e=e||setTimeout(function(){e=null,function(){0;var i=RED.nodes.registry.getModuleList(),e=Object.keys(i);e.sort();var n={label:RED._("sidebar.help.nodeHelp"),children:[],expanded:!0},t=[{id:"changelog",label:"Node-RED v"+RED.settings.version,content:b},n],o=RED.nodes.registry.getNodeTypes().filter(function(e){return/subflow/.test(e)});0<o.length&&(n.children.push({label:RED._("menu.label.subflows"),children:[]}),o.forEach(function(e){var t=RED.nodes.getType(e);n.children[0].children.push({id:"node-type:"+e,nodeType:e,subflowLabel:t.label().toLowerCase(),element:h({_def:t,type:t.label()})})}));e.forEach(function(e){var t=i[e],o=[];Object.keys(t.sets).forEach(function(e){t.sets[e].types.forEach(function(e){var t=RED.nodes.getType(e);t?((t=t.set.id+":"+e+".help")==(t=RED._(t))&&(t=""),($("script[data-help-name='"+e+"']").length||t.length)&&o.push({id:"node-type:"+e,nodeType:e,element:h({_def:RED.nodes.getType(e),type:e})})):console.log("Unknown node: "+e)})}),0<o.length&&(o.sort(function(e,t){return e.nodeType.localeCompare(t.nodeType)}),n.children.push({id:e,icon:"fa fa-cube",label:e,children:o}))}),s.treeList("data",t)}()},500)}function p(e){var t=s.treeList("get","node-type:subflow:"+e.id);t.subflowLabel=e._def.label().toLowerCase(),t.treeList.replaceElement(h({_def:e._def,type:e._def.label()}))}function u(){var e=$("#red-ui-sidebar-help-show-toc");e.hasClass("selected")&&(e.removeClass("selected"),t=r.ratio(),d.css({transition:"height 0.2s"}),r.ratio(0),setTimeout(function(){d.css({transition:""})},250))}function f(){var e=$("#red-ui-sidebar-help-show-toc");e.hasClass("selected")||(e.addClass("selected"),d.css({transition:"height 0.2s"}),r.ratio(Math.max(.3,Math.min(t,.7))),setTimeout(function(){d.css({transition:""});var e=s.treeList("selected");e.id&&s.treeList("show",e)},250))}function h(e){var t=$("<div>",{class:"red-ui-node-list-item"}),o=RED.utils.createNodeIcon(e).appendTo(t),i=e.name;if(!i&&e._def&&e._def.paletteLabel)try{i=("function"==typeof e._def.paletteLabel?e._def.paletteLabel.call(e._def):e._def.paletteLabel)||""}catch(e){}return i=i||e.type,$("<div>",{class:"red-ui-node-label"}).text(e.name||e.type).appendTo(o),t}function g(t){a.empty();var e=/^subflow(:(.+))?$/.exec(t);if(e&&e[2]){var o=RED.nodes.subflow(e[2]);i=RED.utils.renderMarkdown(o.info||"")||'<span class="red-ui-help-info-none">'+RED._("sidebar.info.none")+"</span>",n=o.name||t}else{var i,o=RED.nodes.getType(t).set.id+":"+t+".help";o==(i=RED._(o))&&(i=""),i=$("script[data-help-name='"+t+"']").html()||i||'<span class="red-ui-help-info-none">'+RED._("sidebar.info.none")+"</span>";var n,o=RED.nodes.registry.getNodeType(t);if("function"==typeof(n=o&&o.paletteLabel?o.paletteLabel:t))try{n=o.paletteLabel.call(o)}catch(e){n=t}}m(n,i),.7<r.ratio()&&r.ratio(.7),s.treeList("show","node-type:"+t),s.treeList("select","node-type:"+t,!1)}function v(e,t){!1!==t&&RED.sidebar.show("help"),e&&g(e),l()}function m(e,t){a.empty(),e&&$("<h1>",{class:"red-ui-help-title"}).text(e).appendTo(a);t=$('<div class="red-ui-help"><span class="red-ui-text-bidi-aware" dir="'+RED.text.bidi.resolveBaseTextDir(t)+'">'+t+"</span></div>"),$(t).find("a").each(function(e){var t=$(this).attr("href");/^https?:/.test(t)&&$(this).attr("target","_blank")}),t=t.appendTo(a);t.find(".red-ui-text-bidi-aware").contents().filter(function(){return 3===this.nodeType&&""!==this.textContent.trim()}).wrap("<span></span>");t.find("H3").wrapInner('<a class="red-ui-help-info-header expanded" href="#"></a>').find("a").prepend('<i class="fa fa-angle-right">').on("click",function(e){e.preventDefault();for(var t=$(this).hasClass("expanded"),o=$(this).parent().next();1===o.length&&"H3"!==o[0].nodeName;)o.toggle(!t),o=o.next();$(this).toggleClass("expanded",!t)}),a.parent().scrollTop(0)}function b(a){$.get("red/about",function(n){n=RED.utils.sanitize(n),RED.tourGuide.load("./tours/welcome.js",function(e,t){var o,i='<div><img width="50px" src="red/images/node-red-icon.svg" /></div>';t&&(o=RED.settings.version.split("."),(t=t.version.split("."))[0]===o[0]&&t[1]===o[1]&&(i='<div><button type="button" onclick="RED.actions.invoke(\'core:show-welcome-tour\')" class="red-ui-button">'+RED._("tourGuide.takeATour")+"</button></div>")),a('<div style="text-align:center;">'+i+"</div>"+RED.utils.renderMarkdown(n))})})}return RED.events.on("view:selection-changed",function(e){(e=void 0===e?RED.view.selection():e).nodes&&1==e.nodes.length&&("subflow"===(e=e.nodes[0]).type&&e.direction||"group"!==e.type&&g(e.type))}),RED.actions.add("core:show-about",function(){s.treeList("show","changelog"),s.treeList("select","changelog"),v()}),RED.actions.add("core:show-welcome-tour",function(o,i){i=i||function(){},RED.tourGuide.load("./tours/welcome.js",function(e,t){if(e)return console.warn("Failed to load welcome tour",e),void i();e=RED.settings.version.split("."),t=t.version.split(".");if(t[0]===e[0]&&t[1]===e[1]){if(o){if(o===RED.settings.version)return void i();t=o.split(".");if(e[0]<t[0]||e[0]===t[0]&&e[1]<t[1])return void i();if(e[0]===t[0]&&e[1]===t[1]){if(3===t.length&&3===e.length)return void i();if(4===e.length&&(3===t.length||e[3]<t[3]))return void i()}}RED.tourGuide.run("./tours/welcome.js",function(e){RED.settings.set("editor.tours.welcome",RED.settings.version),i()})}else i()})}),{init:function(){(i=document.createElement("div")).className="red-ui-sidebar-info",n=$("<div>",{class:"red-ui-sidebar-header red-ui-info-toolbar"}).appendTo(i),$('<span class="button-group"><a id="red-ui-sidebar-help-show-toc" class="red-ui-button red-ui-button-small selected" href="#"><i class="fa fa-list-ul"></i></a></span>').appendTo(n);var e=n.find("#red-ui-sidebar-help-show-toc");RED.popover.tooltip(e,RED._("sidebar.help.showTopics")),e.on("click",function(e){e.preventDefault(),($(this).hasClass("selected")?u:f)()});var t=$("<div>",{class:"red-ui-sidebar-help-stack"}).appendTo(i);d=$("<div>",{class:"red-ui-sidebar-help-toc"}).appendTo(t);var o,e=$("<div>").css({"overflow-y":"scroll"}).appendTo(t);(r=RED.panels.create({container:t})).ratio(.3),helpSearch=$('<input type="text" data-i18n="[placeholder]sidebar.help.search">').appendTo(n).searchBox({style:"compact",delay:100,change:function(){var e,t=$(this).val().toLowerCase();t?(f(),s.treeList("filter",function(e){return 0===e.depth||(e.nodeType&&-1<e.nodeType.indexOf(t)||e.subflowLabel&&-1<e.subflowLabel.indexOf(t))},!0)):(s.treeList("filter",null),(e=s.treeList("selected")).id&&s.treeList("show",e.id))}}),a=$("<div>",{class:"red-ui-help"}).css({padding:"6px"}).appendTo(e),$('<span class="red-ui-help-info-none">'+RED._("sidebar.help.noHelp")+"</span>").appendTo(a),(s=$("<div>").css({width:"100%"}).appendTo(d).treeList({data:[]})).on("treelistselect",function(e,t){(o=t).nodeType?g(t.nodeType):t.content&&(a.empty(),"string"==typeof t.content?m(t.label,t.content):"function"==typeof t.content&&(0===t.content.length?m(t.label,t.content()):(m(t.label,'<div class="red-ui-component-spinner red-ui-component-spinner-contain"><img src="red/images/spin.svg" /></div>'),t.content(function(e){o===t&&(a.empty(),m(t.label,e))}))))}),RED.sidebar.addTab({id:"help",label:RED._("sidebar.help.label"),name:RED._("sidebar.help.name"),iconClass:"fa fa-book",action:"core:show-help-tab",content:i,pinned:!0,enableOnEdit:!0,onchange:function(){l()}}),$(window).on("resize",l),$(window).on("focus",l),RED.events.on("registry:node-type-added",c),RED.events.on("registry:node-type-removed",c),RED.events.on("subflows:change",p),RED.actions.add("core:show-help-tab",v)},show:v,set:function(e,t){$(a).empty(),m(t,e),u(),v()}}}(),RED.sidebar.config=function(){var s=document.createElement("div");s.className="red-ui-sidebar-node-config",s.id="red-ui-sidebar-node-config",s.tabIndex=0,$('<div class="red-ui-sidebar-header"><span class="button-group"><a class="red-ui-sidebar-header-button-toggle selected" id="red-ui-sidebar-config-filter-all" href="#"><span data-i18n="sidebar.config.filterAll"></span></a><a class="red-ui-sidebar-header-button-toggle" id="red-ui-sidebar-config-filter-unused" href="#"><span data-i18n="sidebar.config.filterUnused"></span></a> </span></div>').appendTo(s);var e=$('<div><a class="red-ui-footer-button" id="red-ui-sidebar-config-collapse-all" href="#"><i class="fa fa-angle-double-up"></i></a> <a class="red-ui-footer-button" id="red-ui-sidebar-config-expand-all" href="#"><i class="fa fa-angle-double-down"></i></a></div>'),n=$("<div>").appendTo(s),a=$("<div>").appendTo(s),r=$("<div>").appendTo(s),i=!1,d={};function l(e,t,o){var i,n,a;return e=e.replace(/\./i,"-"),d[e]?d[e].label!==o&&(d[e].list.parent().find(".red-ui-palette-node-config-label").text(o),d[e].label=o):(i=$('<div class="red-ui-palette-category red-ui-sidebar-config-category" id="red-ui-sidebar-config-category-'+e+'"></div>').appendTo(t),t=$('<div class="red-ui-sidebar-config-tray-header red-ui-palette-header"><i class="fa fa-angle-down expanded"></i></div>').appendTo(i),(o?$('<span class="red-ui-palette-node-config-label"/>').text(o):$('<span class="red-ui-palette-node-config-label" data-i18n="sidebar.config.'+e+'">')).appendTo(t),$('<span class="red-ui-sidebar-node-config-filter-info"></span>').appendTo(t),category=$('<ul class="red-ui-palette-content red-ui-sidebar-node-config-list"></ul>').appendTo(i),category.on("click",function(e){$(s).find(".red-ui-palette-node").removeClass("selected")}),i.i18n(),n=t.find("i"),a={label:o,list:category,size:function(){return a.list.find("li:not(.red-ui-palette-node-config-none)").length},open:function(e){n.hasClass("expanded")||(n.addClass("expanded"),e?a.list.show():a.list.slideDown())},close:function(e){n.hasClass("expanded")&&(n.removeClass("expanded"),e?a.list.hide():a.list.slideUp())},isOpen:function(){return n.hasClass("expanded")}},t.on("click",function(e){a.isOpen()?a.close():a.open()}),d[e]=a),d[e]}function c(e,t){var a,o=l(e.replace(/\./i,"-")),r=o.list;t.sort(function(e,t){return e.type<t.type?-1:e.type>t.type?1:0}),i?(e=t.length,0<(e-=(t=t.filter(function(e){return!1!==e._def.hasUsers&&0===e.users.length})).length)?r.parent().find(".red-ui-sidebar-node-config-filter-info").text(RED._("sidebar.config.filtered",{count:e})).show():r.parent().find(".red-ui-sidebar-node-config-filter-info").hide()):r.parent().find(".red-ui-sidebar-node-config-filter-info").hide(),r.empty(),0===t.length?($('<li class="red-ui-palette-node-config-none" data-i18n="sidebar.config.none">NONE</li>').i18n().appendTo(r),o.close(!0)):(a="",t.forEach(function(t){var e=RED.utils.getNodeLabel(t,t.id);t.type!=a&&($('<li class="red-ui-palette-node-config-type">'+t.type+"</li>").appendTo(r),a=t.type);var o=$('<li class="red-ui-palette-node_id_'+t.id.replace(/\./g,"-")+'"></li>').appendTo(r),i=$('<div class="red-ui-palette-node-config red-ui-palette-node"></div>').appendTo(o);o.data("node",t.id);var e=$('<div class="red-ui-palette-label"></div>').text(e).appendTo(i);t.d&&(i.addClass("red-ui-palette-node-config-disabled"),$('<i class="fa fa-ban"></i>').prependTo(e)),!1!==t._def.hasUsers&&(e=$("<div/>",{class:"red-ui-palette-icon-container red-ui-palette-icon-container-right"}).appendTo(i),0===t.users.length?e.text(0):$('<a href="#"/>').on("click",function(e){e.stopPropagation(),e.preventDefault(),RED.search.show(t.id)}).text(t.users.length).appendTo(e),RED.popover.tooltip(e,RED._("editor.nodesUse",{count:t.users.length})),0===t.users.length&&i.addClass("red-ui-palette-node-config-unused")),i.on("click",function(e){e.stopPropagation(),RED.view.select(!1),e.metaKey?$(this).toggleClass("selected"):($(s).find(".red-ui-palette-node").removeClass("selected"),$(this).addClass("selected")),RED.sidebar.info.refresh(t)}),i.on("dblclick",function(e){e.stopPropagation(),RED.editor.editConfig("",t.type,t.id)});var n=t.users.map(function(e){return e.id});i.on("mouseover",function(e){RED.nodes.eachNode(function(e){-1!=n.indexOf(e.id)&&(e.highlighted=!0,e.dirty=!0)}),RED.view.redraw()}),i.on("mouseout",function(e){RED.nodes.eachNode(function(e){e.highlighted&&(e.highlighted=!1,e.dirty=!0)}),RED.view.redraw()})}),o.open(!0))}function t(){var t={global:!0};l("global",n),RED.nodes.eachWorkspace(function(e){t[e.id.replace(/\./g,"-")]=!0,l(e.id,a,e.label)}),RED.nodes.eachSubflow(function(e){t[e.id.replace(/\./g,"-")]=!0,l(e.id,r,e.name)}),$(".red-ui-sidebar-config-category").each(function(){var e=$(this).attr("id").substring("red-ui-sidebar-config-category-".length);t[e]||($(this).remove(),delete d[e])});var e,o=[],i={};for(e in RED.nodes.eachConfig(function(e){e.z?(i[e.z.replace(/\./g,"-")]=i[e.z.replace(/\./g,"-")]||[],i[e.z.replace(/\./g,"-")].push(e)):e.z||o.push(e)}),t)t.hasOwnProperty(e)&&c(e,i[e]||[]);c("global",o)}return{init:function(){RED.sidebar.addTab({id:"config",label:RED._("sidebar.config.label"),name:RED._("sidebar.config.name"),content:s,toolbar:e,iconClass:"fa fa-cog",action:"core:show-config-tab",onchange:function(){t()}}),RED.actions.add("core:show-config-tab",function(){RED.sidebar.show("config")}),RED.actions.add("core:select-all-config-nodes",function(){$(s).find(".red-ui-palette-node").addClass("selected")}),RED.actions.add("core:delete-config-selection",function(){var a,e=[];$(s).find(".red-ui-palette-node.selected").each(function(){e.push($(this).parent().data("node"))}),0<e.length&&(a={t:"delete",nodes:[],changes:{},dirty:RED.nodes.dirty()},e.forEach(function(e){var t=RED.nodes.node(e);try{t._def.oneditdelete&&t._def.oneditdelete.call(t)}catch(e){console.log("oneditdelete",t.id,t.type,e.toString())}a.nodes.push(t);for(var o=0;o<t.users.length;o++){var i,n=t.users[o];for(i in a.changes[n.id]={changed:n.changed,valid:n.valid},n._def.defaults)n._def.defaults.hasOwnProperty(i)&&n[i]==e&&(a.changes[n.id][i]=e,n[i]="",n.changed=!0,n.dirty=!0);RED.editor.validateNode(n)}RED.nodes.remove(e)}),RED.nodes.dirty(!0),RED.view.redraw(!0),RED.history.push(a))}),RED.events.on("view:selection-changed",function(){$(s).find(".red-ui-palette-node").removeClass("selected")}),$("#red-ui-sidebar-config-collapse-all").on("click",function(e){for(var t in e.preventDefault(),d)d.hasOwnProperty(t)&&d[t].close()}),$("#red-ui-sidebar-config-expand-all").on("click",function(e){for(var t in e.preventDefault(),d)d.hasOwnProperty(t)&&0<d[t].size()&&d[t].open()}),$("#red-ui-sidebar-config-filter-all").on("click",function(e){e.preventDefault(),i&&($(this).addClass("selected"),$("#red-ui-sidebar-config-filter-unused").removeClass("selected"),i=!i,t())}),$("#red-ui-sidebar-config-filter-unused").on("click",function(e){e.preventDefault(),i||($(this).addClass("selected"),$("#red-ui-sidebar-config-filter-all").removeClass("selected"),i=!i,t())}),RED.popover.tooltip($("#red-ui-sidebar-config-filter-all"),RED._("sidebar.config.showAllUnusedConfigNodes")),RED.popover.tooltip($("#red-ui-sidebar-config-filter-unused"),RED._("sidebar.config.showAllUnusedConfigNodes"))},show:function(s){"boolean"==typeof s&&(s?$("#red-ui-sidebar-config-filter-unused"):$("#red-ui-sidebar-config-filter-all")).trigger("click"),t(),"string"==typeof s&&($("#red-ui-sidebar-config-filter-all").trigger("click"),s=s.replace(/\./g,"-"),setTimeout(function(){var e=$(".red-ui-palette-node_id_"+s),t=e.position().top,o=e.height(),i=$(".red-ui-sidebar-node-config"),n=i.height();n<t+o?i.animate({scrollTop:"-="+(n-(t+o)-30)},150):t<0&&i.animate({scrollTop:"+="+(t-10)},150);var a=21,r=function(){a%2==0?e.removeClass("node_highlighted"):e.addClass("node_highlighted"),0<=--a&&setTimeout(r,100)};r()},100)),RED.sidebar.show("config")},refresh:t}}(),RED.sidebar.context=function(){var n,a,r,s,d,l,c,p,u;function f(e,t){p=e,t||s.prop("checked")?e?g(d,"context/node/"+e.id,e.id):g(d):($(d.table).empty(),(e?$('<tr class="red-ui-help-info-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.refresh"></td></tr>'):$('<tr class="red-ui-help-info-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.none"></td></tr>')).appendTo(d.table).i18n(),d.timestamp.html("&nbsp;"))}function h(e,t){u=e,t||r.prop("checked")?e?g(l,"context/flow/"+e.id,e.id):g(l):($(l.table).empty(),$('<tr class="red-ui-help-info-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.refresh"></td></tr>').appendTo(l.table).i18n(),l.timestamp.html("&nbsp;"))}function g(e,t,o){var a,u,f,h,g,i=e.table;o?(a=e,u=t,f=o,h=RED.settings.context.stores,g=a.table,$.getJSON(u,function(e){$(g).empty();var t,o={};for(t in e)if(e.hasOwnProperty(t))for(var i in e[t])e[t].hasOwnProperty(i)&&(o.hasOwnProperty(i)||(o[i]=[]),e[t][i].store=t,o[i].push(e[t][i]));var c=Object.keys(o);c.sort();for(var n=c.length,p=0;p<n;p++)o[c[p]].forEach(function(n){var a=c[p],r=(o[a].length,$('<tr class="red-ui-help-info-row"><td class="red-ui-sidebar-context-property"></td><td></td></tr>').appendTo(g));$(r.children()[0]).text(a);var s=$('<span class="button-group"></span>'),e=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-refresh"></i></button>').appendTo(s).on("click",function(e){e.preventDefault(),e.stopPropagation(),$.getJSON(u+"/"+a+"?store="+n.store,function(e){e.msg===d&&e.format===l||(d=e.msg,l=e.format,s.detach(),$(r.children()[1]).empty(),RED.utils.createObjectElement(RED.utils.decodeObject(d,l),{typeHint:e.format,sourceId:f+"."+a,tools:s,path:""}).appendTo(r.children()[1]))})});RED.popover.tooltip(e,RED._("sidebar.context.refrsh"));e=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-trash"></i></button>').appendTo(s).on("click",function(e){e.preventDefault(),e.stopPropagation();var i=RED.popover.create({trigger:"modal",target:r,direction:"left",content:function(){var e=$("<div>");$('<p data-i18n="sidebar.context.deleteConfirm"></p>').appendTo(e);var t=$("<p>").appendTo(e),o=$('<span class="button-group"></span>').appendTo(t);return $('<button class="red-ui-button" data-i18n="common.label.cancel"></button>').appendTo(o).on("click",function(e){e.preventDefault(),i.close()}),o=$('<span class="button-group"></span>').appendTo(t),$('<button class="red-ui-button primary" data-i18n="common.label.delete"></button>').appendTo(o).on("click",function(e){e.preventDefault(),i.close(),$.ajax({url:u+"/"+a+"?store="+n.store,type:"DELETE"}).done(function(e,t,o){$.getJSON(u+"/"+a+"?store="+n.store,function(e){"undefined"===e.format?(r.remove(),0===g.children().length&&$('<tr class="red-ui-help-info-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.empty"></td></tr>').appendTo(g).i18n()):(d=e.msg,l=e.format,s.detach(),$(r.children()[1]).empty(),RED.utils.createObjectElement(RED.utils.decodeObject(d,l),{typeHint:e.format,sourceId:f+"."+a,tools:s,path:""}).appendTo(r.children()[1]))})}).fail(function(e,t,o){})}),e.i18n()}});i.open()});RED.popover.tooltip(e,RED._("sidebar.context.delete"));var d=n.msg,l=n.format;RED.utils.createObjectElement(RED.utils.decodeObject(d,l),{typeHint:n.format,sourceId:f+"."+a,tools:s,path:""}).appendTo(r.children()[1]),1<h.length&&$("<span>",{class:"red-ui-sidebar-context-property-storename"}).text(n.store).appendTo($(r.children()[0]))});0===n&&$('<tr class="red-ui-help-info-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.empty"></td></tr>').appendTo(g).i18n(),$(a.timestamp).text((new Date).toLocaleString())})):($(i).empty(),$('<tr class="red-ui-help-info-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.none"></td></tr>').appendTo(i).i18n())}function v(){RED.sidebar.show("context")}return{init:function(){(n=$("<div>").css({position:"relative",height:"100%"})).className="red-ui-sidebar-context";var e=$("<div></div>"),t=$("<div>",{class:"red-ui-sidebar-context-stack"}).appendTo(n);a=RED.stack.create({container:t}),(d=a.add({title:RED._("sidebar.context.node"),collapsible:!0})).expand(),d.content.css({height:"100%"}),d.timestamp=$('<div class="red-ui-sidebar-context-updated">&nbsp;</div>').appendTo(d.content);var o=$('<table class="red-ui-info-table"></table>').appendTo(d.content);d.table=$("<tbody>").appendTo(o);var i=$('<div style="float: right"></div>').appendTo(d.header),t=RED.settings.get("editor.context.nodeRefresh",!1);s=$('<input type="checkbox">').prop("checked",t).appendTo(i).toggleButton({baseClass:"red-ui-sidebar-header-button red-ui-button-small",enabledLabel:"",disabledLabel:""}).on("change",function(){var e=$(this).prop("checked");RED.settings.set("editor.context.flowRefresh",e)}),RED.popover.tooltip(s.next(),RED._("sidebar.context.autoRefresh")),t=$('<button class="red-ui-button red-ui-button-small" style="margin-left: 5px"><i class="fa fa-refresh"></i></button>').appendTo(i).on("click",function(e){e.stopPropagation(),e.preventDefault(),f(p,!0)}),RED.popover.tooltip(t,RED._("sidebar.context.refrsh")),(l=a.add({title:RED._("sidebar.context.flow"),collapsible:!0})).expand(),l.content.css({height:"100%"}),l.timestamp=$('<div class="red-ui-sidebar-context-updated">&nbsp;</div>').appendTo(l.content),o=$('<table class="red-ui-info-table"></table>').appendTo(l.content),l.table=$("<tbody>").appendTo(o),i=$('<div style="float: right"></div>').appendTo(l.header),t=RED.settings.get("editor.context.flowRefresh",!1),r=$('<input type="checkbox">').prop("checked",t).appendTo(i).toggleButton({baseClass:"red-ui-sidebar-header-button red-ui-button-small",enabledLabel:"",disabledLabel:""}).on("change",function(){var e=$(this).prop("checked");RED.settings.set("editor.context.flowRefresh",e)}),RED.popover.tooltip(r.next(),RED._("sidebar.context.autoRefresh")),t=$('<button class="red-ui-button red-ui-button-small" style="margin-left: 5px"><i class="fa fa-refresh"></i></button>').appendTo(i).on("click",function(e){e.stopPropagation(),e.preventDefault(),h(u,!0)}),RED.popover.tooltip(t,RED._("sidebar.context.refrsh")),(c=a.add({title:RED._("sidebar.context.global"),collapsible:!0})).expand(),c.content.css({height:"100%"}),c.timestamp=$('<div class="red-ui-sidebar-context-updated">&nbsp;</div>').appendTo(c.content),o=$('<table class="red-ui-info-table"></table>').appendTo(c.content),c.table=$("<tbody>").appendTo(o),i=$('<div style="float: right"></div>').appendTo(c.header),$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-refresh"></i></button>').appendTo(i).on("click",function(e){e.stopPropagation(),e.preventDefault(),g(c,"context/global","global")}),RED.popover.tooltip(i,RED._("sidebar.context.refrsh")),RED.actions.add("core:show-context-tab",v),RED.sidebar.addTab({id:"context",label:RED._("sidebar.context.label"),name:RED._("sidebar.context.name"),iconClass:"fa fa-database",content:n,toolbar:e,enableOnEdit:!0,action:"core:show-context-tab"}),RED.events.on("view:selection-changed",function(e){f(e.nodes&&1===e.nodes.length&&e.nodes[0])}),RED.events.on("workspace:change",function(e){h(RED.nodes.workspace(e.workspace))}),$(c.table).empty(),$('<tr class="red-ui-help-info-row red-ui-search-empty blank" colspan="2"><td data-i18n="sidebar.context.refresh"></td></tr>').appendTo(c.table).i18n(),c.timestamp.html("&nbsp;")}}}(),RED.palette.editor=function(){var d,i,l,y,c,n,p=[],u=[],w={},E={},D={},t={},a="",o=/^(\d+)(\.(\d+))?(\.(\d+))?(-([0-9A-Za-z-]+))?(\.([0-9A-Za-z-.]+))?$/,r=/^\d+$/;function s(e){this.number=0,this.text=e,r.test(e)?(this.number=parseInt(e),this.type="N"):this.type=null==e||e.length<1?"E":"T"}function x(e){e=e.match(o);this.parts=[new s(e[1]),new s(e[3]),new s(e[5]),new s(e[7]),new s(e[9])]}function f(e,t){e=(e=Date.now()-e)<300?300:0;setTimeout(function(){t()},e)}function h(e,t,i,n){i.show();var a=Date.now();$.ajax({url:"nodes/"+e,type:"PUT",data:JSON.stringify({enabled:t}),contentType:"application/json; charset=utf-8"}).done(function(e,t,o){f(a,function(){i.hide(),n()})}).fail(function(e,t,o){f(a,function(){i.hide(),n(e)})})}function g(e,t,o,i){e={module:e};t&&(e.version=t),o&&(e.url=o),$.ajax({url:"nodes",type:"POST",data:JSON.stringify(e),contentType:"application/json; charset=utf-8"}).done(function(e,t,o){i()}).fail(function(e,t,o){i(e)})}function v(e){t.hasOwnProperty(e)||(t[e]=setTimeout(function(){delete t[e],m(e)},100))}function m(e){if(D.hasOwnProperty(e)){var t=D[e].info,o=D[e].elements;if(o){var i,n=0,a=0,r=0;for(i in o.errorList.empty(),D[e].totalUseCount=0,D[e].setUseCount={},t.sets)if(t.sets.hasOwnProperty(i)){var s,d=0,l=t.sets[i],c=o.sets[i];l.err&&(r++,s=l.err,l.err.message?s=l.err.message:l.err.code&&(s=l.err.code),$("<li>").text(s).appendTo(o.errorList)),l.enabled&&(n+=l.types.length),a+=l.types.length;for(var p=0;p<t.sets[i].types.length;p++){var u=t.sets[i].types[p];d+=E[u]||0;var f,h=c.swatches[u];!l.enabled||(f=RED.nodes.getType(u))&&f.color&&(h.css({background:RED.utils.getNodeColor(u,f)}),h.css({border:"1px solid "+function(e){if(i=/^rgba?\(\s*(\d+),\s*(\d+),\s*(\d+)[,)]/.exec(e)){var t=parseInt(i[1]),o=parseInt(i[2]),i=parseInt(i[3]);if(160<(299*t+587*o+114*i)/1e3)return"rgb("+Math.floor(.8*t)+","+Math.floor(.8*o)+","+Math.floor(.8*i)+")"}return e}(h.css("backgroundColor"))}))}D[e].setUseCount[i]=d,D[e].totalUseCount+=d,0<d?(c.enableButton.text(RED._("palette.editor.inuse")),c.enableButton.addClass("disabled")):(c.enableButton.removeClass("disabled"),l.enabled?c.enableButton.text(RED._("palette.editor.disable")):c.enableButton.text(RED._("palette.editor.enable"))),c.setRow.toggleClass("red-ui-palette-module-set-disabled",!l.enabled)}0===r?o.errorRow.hide():o.errorRow.show(),o.setCount.text(RED._("palette.editor.nodeCount",{count:a,label:n===a?a:n+" / "+a})),0<D[e].totalUseCount?(o.enableButton.text(RED._("palette.editor.inuse")),o.enableButton.addClass("disabled"),o.removeButton.hide()):(o.enableButton.removeClass("disabled"),t.local&&o.removeButton.css("display","inline-block"),0===n?o.enableButton.text(RED._("palette.editor.enableall")):o.enableButton.text(RED._("palette.editor.disableall")),o.container.toggleClass("disabled",0===n))}t.pending_version?(o.versionSpan.html(t.version+' <i class="fa fa-long-arrow-right"></i> '+t.pending_version).appendTo(o.metaRow),o.updateButton.text(RED._("palette.editor.updated")).addClass("disabled").css("display","inline-block")):w.hasOwnProperty(e)&&N&&(m=w[e].version,b=t.version,m=new x(m),b=new x(b),0<m.compare(b))&&RED.utils.checkModuleAllowed(e,null,P,A)?(o.updateButton.show(),o.updateButton.text(RED._("palette.editor.update",{version:w[e].version}))):o.updateButton.hide()}else{D[e]={info:RED.nodes.registry.getModule(e)};var g,v=[e];for(g in D[e].info.sets)D[e].info.sets.hasOwnProperty(g)&&(v.push(g),v=v.concat(D[e].info.sets[g].types));D[e].index=v.join(",").toLowerCase(),y.editableList("addItem",D[e])}var m,b}s.prototype.compare=function(e){switch(this.type+e.type){case"EE":return 0;case"NT":case"TE":case"EN":return-1;case"NN":return this.number-e.number;case"TT":return this.text.localeCompare(e.text);case"ET":case"TN":case"NE":return 1}};var b,R=[],k=!(x.prototype.compare=function(e){for(var t=0,o=0,i=this.parts.length;0==t&&o<i;o++)t=this.parts[o].compare(e.parts[o]);return t}),_=L;function T(e,t,o,i){R.push(e||i),e?k=!0:(i.modules&&(i.modules=i.modules.filter(function(e){return!!RED.utils.checkModuleAllowed(e.id,e.version,O,I)&&((w[e.id]=e).index=[e.id],e.keywords&&(e.index=e.index.concat(e.keywords)),e.types&&(e.index=e.index.concat(e.types)),e.updated_at?e.timestamp=new Date(e.updated_at).getTime():e.timestamp=0,e.index=e.index.join(",").toLowerCase(),!0)}),p=p.concat(i.modules)),l.searchBox("count",p.length)),1<n&&$(".red-ui-palette-module-shade-status").html(RED._("palette.editor.loading")+"<br>"+R.length+"/"+n),R.length===n&&(k&&RED.notify(RED._("palette.editor.errors.catalogLoadFailed",{url:t}),"error",!1,8e3),t=250-(Date.now()-b),setTimeout(function(){$("#red-ui-palette-module-install-shade").hide()},Math.max(t,0)))}function C(){var e,t;0===p.length&&(p=[],w={},c.editableList("empty"),$(".red-ui-palette-module-shade-status").text(RED._("palette.editor.loading")),e=RED.settings.theme("palette.catalogues")||["https://catalogue.nodered.org/catalogue.json"],k=!(R=[]),n=e.length,1<e.length&&$(".red-ui-palette-module-shade-status").html(RED._("palette.editor.loading")+"<br>0/"+e.length),$("#red-ui-palette-module-install-shade").show(),b=Date.now(),t=0,e.forEach(function(i,e){$.getJSON(i,{_:(new Date).getTime()},function(e){T(null,i,0,e),function(){for(var e in D)D.hasOwnProperty(e)&&m(e)}()}).fail(function(e,t,o){console.warn("Error loading catalog",i,":",o),T(e,i)}).always(function(){++t===n&&l.searchBox("change")})}))}function j(){if(c.editableList("empty"),""!==l.searchBox("value").trim()){u.sort(_);for(var e=0;e<Math.min(10,u.length);e++)c.editableList("addItem",u[e]);0===u.length&&c.editableList("addItem",{}),10<u.length&&c.editableList("addItem",{start:10,more:u.length-10})}else c.editableList("addItem",{count:p.length})}function L(e,t){var o=l.searchBox("value").trim();if(""===o)return z(e,t);o=e.info.index.indexOf(o)-t.info.index.indexOf(o);return 0==o?z(e,t):o}function z(e,t){return e.info.id.localeCompare(t.info.id)}function S(e,t){return-1*(e.info.timestamp-t.info.timestamp)}var M,O=["*"],I=[],N=!0,P=["*"],A=[];function B(){return C(),d.activateTab("nodes"),M}function V(i,t,n){var e,a;!1!==RED.settings.get("externalModules.palette.allowInstall",!0)?(e=[{text:RED._("common.label.cancel"),click:function(){a.close()}}],i.url&&e.push({text:RED._("palette.editor.confirm.button.review"),class:"primary red-ui-palette-module-install-confirm-button-install",click:function(){var e=i.url||"";window.open(e)}}),e.push({text:RED._("palette.editor.confirm.button.install"),class:"primary red-ui-palette-module-install-confirm-button-install",click:function(){var o=RED.utils.addSpinnerOverlay(t,!0),e=$('<div style="position: relative;bottom: calc(50% + 17px); padding-right: 10px;text-align: right;"></div>').appendTo(o);$('<button class="red-ui-button"></button>').text(RED._("eventLog.view")).appendTo(e).on("click",function(e){e.preventDefault(),RED.actions.invoke("core:show-event-log")}),RED.eventLog.startEvent(RED._("palette.editor.confirm.button.install")+" : "+i.id+" "+i.version),g(i.id,i.version,i.pkg_url,function(e){var t;o.remove(),e&&e.responseJSON&&(t=RED.notify(RED._("palette.editor.errors.installFailed",{module:i.id,message:e.responseJSON.message}),{type:"error",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.close"),click:function(){t.close()}},{text:RED._("eventLog.view"),click:function(){t.close(),RED.actions.invoke("core:show-event-log")}}]})),n(e)}),a.close()}}),a=RED.notify(RED._("palette.editor.confirm.install.body",{module:i.id}),{modal:!0,fixed:!0,buttons:e})):n(new Error("Palette not editable"))}return{init:function(){var e,t;!1!==RED.settings.get("externalModules.palette.allowInstall",!0)&&(e=RED.settings.get("externalModules.palette.allowList"),t=RED.settings.get("externalModules.palette.denyList"),(e||t)&&(O=e,I=t),O=RED.utils.parseModuleList(O),I=RED.utils.parseModuleList(I),e=RED.settings.get("externalModules.palette.allowUpdateList"),t=RED.settings.get("externalModules.palette.denyUpdateList"),(e||t)&&(P=e,A=t),P=RED.utils.parseModuleList(P),A=RED.utils.parseModuleList(A),N=RED.settings.get("externalModules.palette.allowUpdate",!0),function(){M=$('<div id="red-ui-settings-tab-palette"></div>');var t=$('<div id="red-ui-palette-editor"><ul id="red-ui-palette-editor-tabs"></ul></div>').appendTo(M);d=RED.tabs.create({element:M.find("#red-ui-palette-editor-tabs"),onchange:function(e){t.find(".red-ui-palette-editor-tab").hide(),e.content.show(),i&&i.searchBox("value",""),l&&l.searchBox("value",""),"install"===e.id?l&&l.trigger("focus"):i&&i.trigger("focus")},minimumActiveTabWidth:110}),function(e){var t=$("<div>",{class:"red-ui-palette-editor-tab"}).appendTo(e);d.addTab({id:"nodes",label:RED._("palette.editor.tab-nodes"),content:t});e=$("<div>",{class:"red-ui-palette-search"}).appendTo(t);i=$('<input type="text" data-i18n="[placeholder]palette.filter"></input>').appendTo(e).searchBox({delay:200,change:function(){!function(e){a=e.toLowerCase();var t=y.editableList("filter"),o=y.editableList("length");""===e?i.searchBox("count"):i.searchBox("count",t+" / "+o)}($(this).val())}}),y=$("<ol>",{id:"red-ui-palette-module-list",style:"position: absolute;top: 35px;bottom: 0;left: 0;right: 0px;"}).appendTo(t).editableList({addButton:!1,scrollOnAdd:!1,sort:function(e,t){return e.info.name.localeCompare(t.info.name)},filter:function(e){return""===a||(""===a||-1<e.index.indexOf(a))},addItem:function(o,e,r){var t,i,n,a,s,d,l,c,p,u,f=r.info;f?(s=$("<div>",{class:"red-ui-palette-module-header"}).appendTo(o),a=$('<div class="red-ui-palette-module-meta red-ui-palette-module-name"><i class="fa fa-cube"></i></div>').appendTo(s),$("<span>").text(f.name).appendTo(a),l=$('<div class="red-ui-palette-module-meta red-ui-palette-module-version"><i class="fa fa-tag"></i></div>').appendTo(s),t=$("<span>").text(f.version).appendTo(l),i=$('<div class="red-ui-palette-module-meta red-ui-palette-module-errors"><i class="fa fa-warning"></i></div>').hide().appendTo(s),n=$('<ul class="red-ui-palette-module-error-list"></ul>').appendTo(i),d=$("<div>",{class:"red-ui-palette-module-meta"}).appendTo(s),u=$('<a href="#" class="red-ui-button red-ui-button-small red-ui-palette-module-set-button"><i class="fa fa-angle-right red-ui-palette-module-node-chevron"></i> </a>').appendTo(d),a=$("<span>").appendTo(u),l=$("<div>",{class:"red-ui-palette-module-button-group"}).appendTo(d),(s=$('<a href="#" class="red-ui-button red-ui-button-small"></a>').text(RED._("palette.editor.update")).appendTo(l)).attr("id","up_"+Math.floor(1e9*Math.random())),s.on("click",function(e){var i,t,n,a,r,s;e.preventDefault(),$(this).hasClass("disabled")||(t=w[(i=f).name].version,n=w[f.name].pkg_url,a=o,!(r=function(e){})!==RED.settings.get("externalModules.palette.allowInstall",!0)?s=RED.notify(RED._("palette.editor.confirm.update.body",{module:i.name}),{modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){s.close()}},{text:RED._("palette.editor.confirm.button.update"),class:"primary red-ui-palette-module-install-confirm-button-update",click:function(){var o=RED.utils.addSpinnerOverlay(a,!0),e=$('<div style="position: relative;bottom: calc(50% + 17px); padding-right: 10px;text-align: right;"></div>').appendTo(o);$('<button class="red-ui-button"></button>').text(RED._("eventLog.view")).appendTo(e).on("click",function(e){e.preventDefault(),RED.actions.invoke("core:show-event-log")}),RED.eventLog.startEvent(RED._("palette.editor.confirm.button.install")+" : "+i.name+" "+t),g(i.name,t,n,function(e){var t;o.remove(),e&&e.responseJSON&&(t=RED.notify(RED._("palette.editor.errors.updateFailed",{module:i.name,message:e.responseJSON.message}),{type:"error",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.close"),click:function(){t.close()}},{text:RED._("eventLog.view"),click:function(){t.close(),RED.actions.invoke("core:show-event-log")}}]})),r(e)}),s.close()}}]}):r(new Error("Palette not editable")))}),(d=$('<a href="#" class="red-ui-button red-ui-button-small"></a>').text(RED._("palette.editor.remove")).appendTo(l)).attr("id","up_"+Math.floor(1e9*Math.random())),d.on("click",function(e){var n,t,a;e.preventDefault(),n=f,t=o,!(e=function(e){})!==RED.settings.get("externalModules.palette.allowInstall",!0)?a=RED.notify(RED._("palette.editor.confirm.remove.body",{module:n.name}),{modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){a.close()}},{text:RED._("palette.editor.confirm.button.remove"),class:"primary red-ui-palette-module-install-confirm-button-remove",click:function(){var i,o=RED.utils.addSpinnerOverlay(t,!0),e=$('<div style="position: relative;bottom: calc(50% + 17px); padding-right: 10px;text-align: right;"></div>').appendTo(o);$('<button class="red-ui-button"></button>').text(RED._("eventLog.view")).appendTo(e).on("click",function(e){e.preventDefault(),RED.actions.invoke("core:show-event-log")}),RED.eventLog.startEvent(RED._("palette.editor.confirm.button.remove")+" : "+n.name),e=n.name,i=function(e){var t;o.remove(),e&&e.responseJSON&&(t=RED.notify(RED._("palette.editor.errors.removeFailed",{module:n.name,message:e.responseJSON.message}),{type:"error",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.close"),click:function(){t.close()}},{text:RED._("eventLog.view"),click:function(){t.close(),RED.actions.invoke("core:show-event-log")}}]}))},$.ajax({url:"nodes/"+e,type:"DELETE"}).done(function(e,t,o){i()}).fail(function(e,t,o){i(e)}),a.close()}}]}):e(new Error("Palette not editable"))}),f.local||d.hide(),l=$('<a href="#" class="red-ui-button red-ui-button-small"></a>').text(RED._("palette.editor.disableall")).appendTo(l),c=$("<div>",{class:"red-ui-palette-module-content"}).appendTo(o),p=$('<div class="red-ui-palette-module-shade hide"><img src="red/images/spin.svg" class="red-ui-palette-spinner"/></div>').appendTo(o),r.elements={updateButton:s,removeButton:d,enableButton:l,errorRow:i,errorList:n,setCount:a,container:o,shade:p,versionSpan:t,sets:{}},u.on("click",function(e){e.preventDefault(),o.hasClass("expanded")?(o.removeClass("expanded"),c.slideUp()):(o.addClass("expanded"),c.slideDown())}),(u=Object.keys(f.sets)).sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}),u.forEach(function(o){var i=f.sets[o],n=$("<div>",{class:"red-ui-palette-module-set"}).appendTo(c),e=$("<div>",{class:"red-ui-palette-module-set-button-group"}).appendTo(n),a={};i.types.forEach(function(e){var t=$("<div>",{class:"red-ui-palette-module-type"}).appendTo(n);a[e]=$("<span>",{class:"red-ui-palette-module-type-swatch"}).appendTo(t),$("<span>",{class:"red-ui-palette-module-type-node"}).text(e).appendTo(t)});e=$('<a href="#" class="red-ui-button red-ui-button-small"></a>').appendTo(e);e.on("click",function(e){var t;e.preventDefault(),0===r.setUseCount[o]&&(e=RED.nodes.registry.getNodeSet(i.id),p.show(),t=!e.enabled,h(i.id,t,p,function(e){e&&e.responseJSON&&RED.notify(RED._("palette.editor.errors."+(t?"enable":"disable")+"Failed",{module:id,message:e.responseJSON.message}))}))}),r.elements.sets[i.name]={setRow:n,enableButton:e,swatches:a}}),l.on("click",function(e){e.preventDefault(),0===r.totalUseCount&&h(f.name,o.hasClass("disabled"),p,function(e){e&&e.responseJSON&&RED.notify(RED._("palette.editor.errors.installFailed",{module:id,message:e.responseJSON.message}))})}),v(f.name)):$("<div>",{class:"red-ui-search-empty"}).text(RED._("search.empty")).appendTo(o)}})}(t),function(e){var t=$("<div>",{class:"red-ui-palette-editor-tab hide"}).appendTo(e);d.addTab({id:"install",label:RED._("palette.editor.tab-install"),content:t});var o=$("<div>",{class:"red-ui-palette-editor-toolbar"}).appendTo(t),i=$("<div>",{class:"red-ui-palette-search"}).appendTo(t);l=$('<input type="text" data-i18n="[placeholder]palette.search"></input>').appendTo(i).searchBox({delay:300,change:function(){var t=$(this).val().trim().toLowerCase();0<t.length?(u=p.filter(function(e){return-1<e.index.indexOf(t)}).map(function(e){return{info:e}}),j(),l.searchBox("count",u.length+" / "+p.length)):(l.searchBox("count",p.length),c.editableList("empty"),c.editableList("addItem",{count:p.length}))}}),$("<span>").text(RED._("palette.editor.sort")+" ").appendTo(o);var n=$('<span class="button-group"></span>').appendTo(o),e=$('<a href="#" class="red-ui-palette-editor-install-sort-option red-ui-sidebar-header-button-toggle selected"><i class="fa fa-sort-amount-desc"></i></a>').appendTo(n),i=$('<a href="#" class="red-ui-palette-editor-install-sort-option red-ui-sidebar-header-button-toggle" data-i18n="palette.editor.sortAZ"></a>').appendTo(n),n=$('<a href="#" class="red-ui-palette-editor-install-sort-option red-ui-sidebar-header-button-toggle" data-i18n="palette.editor.sortRecent"></a>').appendTo(n);[{button:e,func:L},{button:i,func:z},{button:n,func:S}].forEach(function(t){t.button.on("click",function(e){e.preventDefault(),$(this).hasClass("selected")||($(".red-ui-palette-editor-install-sort-option").removeClass("selected"),$(this).addClass("selected"),_=t.func,j())})});i=$("<span>").appendTo(o),n=$('<a href="#" class="red-ui-sidebar-header-button"><i class="fa fa-refresh"></i></a>').appendTo(i);{var a,r,s;n.on("click",function(e){e.preventDefault(),p=[],w={},C()}),RED.popover.tooltip(n,RED._("palette.editor.refresh")),c=$("<ol>",{style:"position: absolute;top: 79px;bottom: 0;left: 0;right: 0px;"}).appendTo(t).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(t,e,o){if(o.count)$("<div>",{class:"red-ui-search-empty"}).text(RED._("palette.editor.moduleCount",{count:o.count})).appendTo(t);else if(o.more){t.addClass("red-ui-palette-module-more");var i=$("<div>",{class:"red-ui-palette-module-header palette-module"}).appendTo(t);$('<a href="#"></a>').text(RED._("palette.editor.more",{count:o.more})).appendTo(i).on("click",function(e){e.preventDefault(),c.editableList("removeItem",o);for(var t=o.start;t<Math.min(o.start+10,o.start+o.more);t++)c.editableList("addItem",u[t]);10<o.more&&c.editableList("addItem",{start:o.start+10,more:o.more-10})})}else if(o.info){var n=o.info,a=$("<div>",{class:"red-ui-palette-module-header"}).appendTo(t),i=$('<div class="red-ui-palette-module-meta red-ui-palette-module-name"><i class="fa fa-cube"></i></div>').appendTo(a);$("<span>").text(n.name||n.id).appendTo(i),$('<a target="_blank" class="red-ui-palette-module-link"><i class="fa fa-external-link"></i></a>').attr("href",n.url).appendTo(i);i=$('<div class="red-ui-palette-module-meta"></div>').appendTo(a);$("<div>",{class:"red-ui-palette-module-description"}).text(n.description).appendTo(i);i=$('<div class="red-ui-palette-module-meta"></div>').appendTo(a);$('<span class="red-ui-palette-module-version"><i class="fa fa-tag"></i> '+n.version+"</span>").appendTo(i),$('<span class="red-ui-palette-module-updated"><i class="fa fa-calendar"></i> '+function(e){new Date,new Date(e);var t=(Date.now()-new Date(e).getTime())/1e3;return t<60?RED._("palette.editor.times.seconds"):(t=Math.floor(t/60))<10?RED._("palette.editor.times.minutes"):t<60?RED._("palette.editor.times.minutesV",{count:t}):(t=Math.floor(t/60))<24?RED._("palette.editor.times.hoursV",{count:t}):(t=Math.floor(t/24))<7?RED._("palette.editor.times.daysV",{count:t}):(e=Math.floor(t/7))<4?RED._("palette.editor.times.weeksV",{count:e}):(t=Math.floor(e/4),e%=4,t<12?RED._("palette.editor.times.monthsV",{count:t}):(e=Math.floor(t/12),0===(t%=12)?RED._("palette.editor.times.yearsV",{count:e}):RED._("palette.editor.times.year"+(1<e?"s":"")+"MonthsV",{y:e,count:t})))}(n.updated_at)+"</span>").appendTo(i);var r=!1;if(n.types&&0<n.types.length)for(e=0;e<n.types.length;e++){var s=RED.nodes.registry.getNodeSetForType(n.types[e]);if(s){r=s.module;break}}a=$("<div>",{class:"red-ui-palette-module-meta"}).appendTo(a),a=$("<div>",{class:"red-ui-palette-module-button-group"}).appendTo(a),a=$('<a href="#" class="red-ui-button red-ui-button-small"></a>').text(RED._("palette.editor.install")).appendTo(a);a.on("click",function(e){e.preventDefault(),$(this).hasClass("disabled")||V(n,t,function(e){})}),D.hasOwnProperty(n.id)?(a.addClass("disabled"),a.text(RED._("palette.editor.installed"))):r&&(a.addClass("disabled"),a.text(RED._("palette.editor.conflict")),RED.popover.create({target:a,content:RED._("palette.editor.conflictTip",{module:r}),trigger:"hover",direction:"bottom",delay:{show:750,hide:50}})),o.elements={installButton:a}}else $("<div>",{class:"red-ui-search-empty"}).text(RED._("search.empty")).appendTo(t)}}),!1!==RED.settings.get("externalModules.palette.allowUpload",!0)&&(i=$('<span class="button-group">').prependTo(o),n=$('<button type="button" class="red-ui-sidebar-header-button red-ui-palette-editor-upload-button"><label><i class="fa fa-upload"></i><form id="red-ui-palette-editor-upload-form" enctype="multipart/form-data"><input name="tarball" type="file" accept=".tgz,.tar.gz"></label></button>').appendTo(i),(a=n.find('input[type="file"]')).on("change",function(e){0<this.files.length&&(s.text(this.files[0].name),r.slideDown(200))}),r=$('<div class="red-ui-palette-editor-upload"></div>').appendTo(t),o=$("<div>").appendTo(r),i=$('<div class="placeholder-input"><i class="fa fa-upload"></i> </div>').appendTo(o),s=$("<span></span>").appendTo(i),o=$('<div class="red-ui-palette-editor-upload-buttons"></div>').appendTo(o),$('<button class="editor-button"></button>').text(RED._("common.label.cancel")).appendTo(o).on("click",function(e){e.preventDefault(),r.slideUp(200),a.val("")}),$('<button class="editor-button primary"></button>').text(RED._("common.label.upload")).appendTo(o).on("click",function(e){e.preventDefault();var i=RED.utils.addSpinnerOverlay(r,!0),e=$('<div style="position: relative;bottom: calc(50% + 17px); padding-right: 10px;text-align: right;"></div>').appendTo(i);$('<button class="red-ui-button"></button>').text(RED._("eventLog.view")).appendTo(e).on("click",function(e){e.preventDefault(),RED.actions.invoke("core:show-event-log")}),RED.eventLog.startEvent(RED._("palette.editor.confirm.button.install")+" : "+a[0].files[0].name);e=new FormData;e.append("tarball",a[0].files[0]);var n=a[0].files[0].name;$.ajax({url:"nodes",data:e,cache:!1,contentType:!1,processData:!1,method:"POST"}).always(function(e,t,o){i.remove(),a.val(""),r.slideUp(200)}).fail(function(e,t,o){e.responseJSON&&(t=e.responseJSON.message);var i=RED.notify(RED._("palette.editor.errors.installFailed",{module:n,message:t}),{type:"error",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.close"),click:function(){i.close()}},{text:RED._("eventLog.view"),click:function(){i.close(),RED.actions.invoke("core:show-event-log")}}]});a.val(""),r.slideUp(200)})}),RED.popover.tooltip(n,RED._("palette.editor.upload")))}$('<div id="red-ui-palette-module-install-shade" class="red-ui-palette-module-shade hide"><div class="red-ui-palette-module-shade-status"></div><img src="red/images/spin.svg" class="red-ui-palette-spinner"/></div>').appendTo(t)}(t)}(),RED.userSettings.add({id:"palette",title:RED._("palette.editor.palette"),get:B,close:function(){M.detach()},focus:function(){d.resize(),setTimeout(function(){i.trigger("focus")},200)}}),RED.actions.add("core:manage-palette",function(){RED.userSettings.show("palette")}),RED.events.on("registry:module-updated",function(e){v(e.module)}),RED.events.on("registry:node-set-enabled",function(e){v(e.module)}),RED.events.on("registry:node-set-disabled",function(e){v(e.module)}),RED.events.on("registry:node-type-added",function(e){/^subflow:/.test(e)||v(RED.nodes.registry.getNodeSetForType(e).module)}),RED.events.on("registry:node-type-removed",function(e){/^subflow:/.test(e)||v(RED.nodes.registry.getNodeSetForType(e).module)}),RED.events.on("registry:node-set-added",function(e){v(e.module);for(var t=0;t<u.length;t++)if(u[t].info.id===e.module){var o=u[t].elements.installButton;o.addClass("disabled"),o.text(RED._("palette.editor.installed"));break}}),RED.events.on("registry:node-set-removed",function(e){if(!RED.nodes.registry.getModule(e.module)){var t=D[e.module];if(t){y.editableList("removeItem",t),delete D[e.module];for(var o=0;o<u.length;o++)if(u[o].info.id===e.module){var i=u[o].elements.installButton;i.removeClass("disabled"),i.text(RED._("palette.editor.install"));break}}}}),RED.events.on("nodes:add",function(e){/^subflow:/.test(e.type)||(E[e.type]=(E[e.type]||0)+1,1===E[e.type]&&v(RED.nodes.registry.getNodeSetForType(e.type).module))}),RED.events.on("nodes:remove",function(e){E.hasOwnProperty(e.type)&&(E[e.type]--,0===E[e.type]&&(delete E[e.type],v(RED.nodes.registry.getNodeSetForType(e.type).module)))}))},install:V}}(),RED.editor=function(){var l=[],c=!1,o={},v={},m={},p={};function w(e){var t,o,i,n,a=e.valid,r=e.changed;if(e.valid=!0,0===e.type.indexOf("subflow:"))o=(t=RED.nodes.subflow(e.type.substring(8))).valid,n=t.changed,void 0===o&&(o=w(t),n=t.changed),i=u(e,e._def.defaults,e),e.valid=o&&0===i.length,e.changed=e.changed||n,e.validationErrors=i;else if(e._def)i=u(e,e._def.defaults,e),e._def._creds&&(i=i.concat(u(e,e._def.credentials,e._def._creds))),e.valid=0===i.length,e.validationErrors=i;else if("subflow"==e.type){for(var s=RED.nodes.filterNodes({z:e.id}),d=0;d<s.length;d++)o=s[d].valid,n=s[d].changed,void 0===o&&(o=w(s[d]),n=s[d].changed),e.valid=e.valid&&o,e.changed=e.changed||n;for(var l=RED.nodes.filterNodes({type:"subflow:"+e.id}),c={},d=0;d<l.length;d++)l[d].valid=e.valid,l[d].changed=l[d].changed||e.changed,l[d].dirty=!0,c[l[d].z]=!0;Object.keys(c).forEach(function(e){e=RED.nodes.subflow(e);e&&w(e)})}return a===e.valid&&r===e.changed||(e.dirty=!0,(t=RED.nodes.subflow(e.z))&&w(t)),e.valid}function u(e,t,o){var i,n=[];for(i in t)t.hasOwnProperty(i)&&(a(e,t,i,o[i])||n.push(i));return n}function a(t,e,o,i){var n=!0;if(/^\$\([a-zA-Z_][a-zA-Z0-9_]*\)$/.test(i))return 1;if(/^\$\{[a-zA-Z_][a-zA-Z0-9_]*\}$/.test(i))return 1;if((n="required"in e[o]&&e[o].required?""!==i:n)&&"validate"in e[o])try{n=e[o].validate.call(t,i)}catch(e){console.log("Validation error:",t.type,t.id,"property: "+o,"value:",i,e)}return n=n&&e[o].type&&RED.nodes.getType(e[o].type)&&!("validate"in e[o])?i&&"_ADD_"!=i?(i=RED.nodes.node(i))&&(null==i.valid||i.valid):e[o].hasOwnProperty("required")&&!e[o].required:n}function b(e,t){for(var o in e._def.defaults)e._def.defaults.hasOwnProperty(o)&&i(e,e._def.defaults,o,t);if(e._def.credentials)for(o in e._def.credentials)e._def.credentials.hasOwnProperty(o)&&i(e,e._def.credentials,o,t)}function i(e,t,o,i){var n=$("#"+i+"-"+o);0<n.length&&(i=n.val(),t[o].hasOwnProperty("format")&&""!==t[o].format&&"DIV"===n[0].nodeName&&(i=n.text()),a(e,t,o,i)?n.removeClass("input-error"):n.addClass("input-error"))}function f(t,o){t.resize=!0,t.dirty=!0,t.dirtyStatus=!0;var i=[];o&&RED.nodes.eachLink(function(e){e.source===t&&o.hasOwnProperty(e.sourcePort)&&("-1"===o[e.sourcePort]?i.push(e):e.sourcePort=o[e.sourcePort])}),t.hasOwnProperty("__inputs")&&(t.inputs<t.__inputs&&RED.nodes.eachLink(function(e){e.target===t&&e.targetPort>=t.inputs&&-1===i.indexOf(e)&&i.push(e)}),delete t.__inputs),t.hasOwnProperty("__outputs")&&(t.outputs<t.__outputs&&RED.nodes.eachLink(function(e){e.source===t&&e.sourcePort>=t.outputs&&-1===i.indexOf(e)&&i.push(e)}),delete t.__outputs);for(var e=0;e<i.length;e++)RED.nodes.removeLink(i[e]);return i}function y(e,t,o,i){o=$("#"+o+"-"+t);0!==o.length&&("checkbox"===o.attr("type")?o.prop("checked",e[t]):(null==(e=e[t])&&(e=""),void 0!==i&&i[t].hasOwnProperty("format")&&""!==i[t].format&&"DIV"===o[0].nodeName?(o.html(RED.text.format.getHtml(e,i[t].format,{},!1,"en")),RED.text.format.attach(o[0],i[t].format,{},!1,"en")):(o.val(e),"INPUT"!==o[0].nodeName&&"TEXTAREA"!==o[0].nodeName||RED.text.bidi.prepareInput(o))))}function E(t,e,o,i){var n=$("#"+i+"-"+o);void 0!==e&&"format"in e[o]&&""!==e[o].format&&"DIV"===n[0].nodeName?$("#"+i+"-"+o).on("change keyup",function(e){$(this).attr("skipValidation")||b(t,i)}):$("#"+i+"-"+o).on("change",function(e){$(this).attr("skipValidation")||b(t,i)})}function D(e,t,o,i){for(var n in t)t.hasOwnProperty(n)&&("password"==t[n].type?o[n]?$("#"+i+"-"+n).val(o[n]):o["has_"+n]?$("#"+i+"-"+n).val("__PWRD__"):$("#"+i+"-"+n).val(""):y(o,n,i,t),E(e,t,n,i))}function x(d,l,c,p,u,f,h){function t(){var e,t,o,i,n=$("<ul></ul>").appendTo(d),a=$("<div></div>").appendTo(d),r=RED.tabs.create({element:n,onchange:function(e){a.children().hide(),e.content.show(),e.onchange&&e.onchange.call(e),g&&RED.tray.resize()},collapsible:!0,menu:!1}),s=[];for(e in l=l.slice(),m)m.hasOwnProperty(e)&&m[e](c)&&l.push(e);for(o in l.forEach(function(t){try{var e,o,i=v[t];i?("function"==typeof i&&(i=i.call(i,c)),e=$("<div>",{class:"red-ui-tray-content"}).appendTo(a).hide(),i.create.call(i,e),o={id:t,label:i.label,name:i.name,iconClass:i.iconClass,content:e,onchange:function(){i.show&&i.show.call(i)}},r.addTab(o),s.push(i)):console.warn("Unregisted edit pane:",t)}catch(e){console.log(t,e)}}),p.defaults)p.defaults.hasOwnProperty(o)&&(p.defaults[o].type?p.defaults[o]._type.array||((t=RED.nodes.getType(p.defaults[o].type))&&"config"===t.category?t.exclusive?function(t,o,i,n){var a=$("#"+n+"-"+o);a.val(t[o]),a.attr("type","hidden");var e=$("<a>",{id:n+"-edit-"+o,class:"red-ui-button"});a.after(e),t[o]?e.text(RED._("editor.configEdit")):e.text(RED._("editor.configAdd")),e.on("click",function(e){_(o,i,a.val()||"_ADD_",n,t),e.preventDefault()})}(c,o,p.defaults[o].type,u):function(t,o,i,n,e){var a,r,s,d=$("#"+n+"-"+o);0!==d.length&&(s=d.width(),a=d.attr("style"),s=null!==(a=/(^|\s|;)width\s*:\s*([^;]+)/i.exec(a))?a[2].trim():"70%",s=$("<div></div>").css({width:s,display:"inline-flex"}),r=$('<select id="'+n+"-"+o+'"></select>').appendTo(s),d.replaceWith(s),r.css({"flex-grow":1}),k(o,i,t[o],n,e),$('<a id="'+n+"-lookup-"+o+'" class="red-ui-button"><i class="fa fa-pencil"></i></a>').css({"margin-left":"10px"}).appendTo(s),$("#"+n+"-lookup-"+o).on("click",function(e){_(o,i,r.find(":selected").val(),n,t),e.preventDefault()}),e="",s=RED.nodes.node(t[o]),RED.nodes.getType(i),s&&(e=RED.utils.getNodeLabel(s,s.id)),d.val(e))}(c,o,p.defaults[o].type,u,p.defaults[o].filter):(console.log("Unknown type:",p.defaults[o].type),y(c,o,u,p.defaults))):y(c,o,u,p.defaults),E(c,p.defaults,o,u));if(/^subflow:/.test(p.type)||D(c,p.credentials,c.credentials,u),p.oneditprepare)try{p.oneditprepare.call(c)}catch(e){console.log("oneditprepare",c.id,c.type,e.toString()),console.log(e.stack)}for(o in p.defaults)p.defaults.hasOwnProperty(o)&&((i=$("#"+u+"-"+o)).attr("skipValidation",!0),void 0!==i.data("noderedTypedInput")?i.trigger("change",[i.typedInput("type"),i.typedInput("value")]):i.trigger("change"),i.removeAttr("skipValidation"));if(p.credentials)for(o in p.credentials)p.credentials.hasOwnProperty(o)&&((i=$("#"+u+"-"+o)).attr("skipValidation",!0),void 0!==i.data("noderedTypedInput")?i.trigger("change",[i.typedInput("type"),i.typedInput("value")]):i.trigger("change"),i.removeAttr("skipValidation"));b(c,u),g=!0,f&&r.activateTab(f),h&&h(s)}var e,o,i,n,a,g=!1;p.credentials||/^subflow:/.test(p.type)||"group"===c.type||"tab"===c.type?c.credentials?(D(c,p.credentials,c.credentials,u),t()):(o=c.type,/^subflow:/.test(o)&&(o="subflow"),e=o,o=c.id,i=function(e){e&&(c.credentials=e,c.credentials._=$.extend(!0,{},e)),t()},a=setTimeout(function(){n=RED.notify($('<p data-i18n="[prepend]editor.loadCredentials">  <img src="red/images/spin.svg"/></p>').i18n(),{fixed:!0})},800),o="credentials/"+e.replace(/\s+/g,"-")+"/"+o,$.ajax({url:o,dataType:"json",success:function(e){n&&(n.close(),n=null),clearTimeout(a),i(e)},error:function(e,t,o){n&&(n.close(),n=null),clearTimeout(a),RED.notify(RED._("editor.errors.credentialLoadFailed"),"error"),i(null)},timeout:3e4})):t()}function R(){for(var e=l.length-1;e<l.length;e++){var t=l[e];if(i=t.type,"group"===t.type)i=RED._("group.editGroup",{name:RED.utils.sanitize(t.name||t.id)});else if("_expression"===t.type)i=RED._("expressionEditor.title");else if("_js"===t.type)i=RED._("jsEditor.title");else if("_text"===t.type)i=RED._("textEditor.title");else if("_json"===t.type)i=RED._("jsonEditor.title");else if("_markdown"===t.type)i=RED._("markdownEditor.title");else if("_buffer"===t.type)i=RED._("bufferEditor.title");else if("subflow"===t.type)i=RED._("subflow.editSubflow",{name:RED.utils.sanitize(t.name)});else if(0===t.type.indexOf("subflow:"))var o=RED.nodes.subflow(t.type.substring(8)),i=RED._("subflow.editSubflowInstance",{name:RED.utils.sanitize(o.name)});else if(void 0!==t._def){if(void 0!==t._def.paletteLabel)try{i=RED.utils.sanitize(("function"==typeof t._def.paletteLabel?t._def.paletteLabel.call(t._def):t._def.paletteLabel)||"")}catch(e){console.log("Definition error: "+t.type+".paletteLabel",e)}e===l.length-1&&(i=RED.nodes.node(t.id)?RED._("editor.editNode",{type:RED.utils.sanitize(i)}):RED._("editor.addNewConfig",{type:RED.utils.sanitize(i)}))}}return i}function h(t,e){if(t._def.oneditsave){var o={};for(var i in t._def.defaults)t._def.defaults.hasOwnProperty(i)&&("string"==typeof t[i]||"number"==typeof t[i]?o[i]=t[i]:o[i]=$.extend(!0,{},{v:t[i]}).v);try{!0===t._def.oneditsave.call(t)&&(e.changed=!0)}catch(e){console.warn("oneditsave",t.id,t.type,e.toString())}for(i in t._def.defaults)t._def.defaults.hasOwnProperty(i)&&(null===o[i]||"string"==typeof o[i]||"number"==typeof o[i]?o[i]!==t[i]&&(e.changes[i]=o[i],e.changed=!0):"group"===t.type&&"nodes"===i||JSON.stringify(o[i])!==JSON.stringify(t[i])&&(e.changes[i]=o[i],e.changed=!0))}}function g(e,t){return e.__label__<t.__label__?-1:e.__label__>t.__label__?1:0}function k(e,o,t,i,n){if(i){var a=$("#"+i+"-edit-"+e);if(a.length)t?a.text(RED._("editor.configEdit")):a.text(RED._("editor.configAdd")),$("#"+i+"-"+e).val(t);else{var r=$("#"+i+"-"+e),i=RED.nodes.getType(o);r.children().remove();var s=(s=RED.nodes.workspace(RED.workspaces.active()))||RED.nodes.subflow(RED.workspaces.active()),d=[];"function"!=typeof n&&(n=null),RED.nodes.eachConfig(function(e){var t;e.type!=o||e.z&&e.z!==s.id||n&&!n.call(null,e)||(t=RED.utils.getNodeLabel(e,e.id),e.__label__=t+(e.d?" ["+RED._("workspace.disabled")+"]":""),d.push(e))});e=g;"function"==typeof i.sort&&(e=i.sort);try{d.sort(e)}catch(e){console.log("Definition error: "+i.type+".sort",e)}d.forEach(function(e){$('<option value="'+e.id+'"'+(t==e.id?" selected":"")+"></option>").text(RED.text.bidi.enforceTextDirectionWithUCC(e.__label__)).appendTo(r),delete e.__label__});e=o;if(void 0!==i.paletteLabel)try{e=RED.utils.sanitize(("function"==typeof i.paletteLabel?i.paletteLabel.call(i):i.paletteLabel)||o)}catch(e){console.log("Definition error: "+o+".paletteLabel",e)}r.append('<option value="_ADD_"'+(""===t?" selected":"")+">"+RED._("editor.addNewType",{type:e})+"</option>"),window.setTimeout(function(){r.trigger("change")},50)}}}function _(f,h,e,g,v){if(!c){c=!0;var m="_ADD_"==e,s=RED.nodes.getType(h),b=RED.nodes.node(e),y=[],t="",e=RED.nodes.subflow(RED.workspaces.active());if(e&&(t=e.id),null==b){for(var o in b={id:RED.nodes.id(),_def:s,type:h,z:t,users:[]},s.defaults)s.defaults[o].value&&(b[o]=JSON.parse(JSON.stringify(s.defaults[o].value)));b._=s._}l.push(b),RED.view.state(RED.state.EDITING);t={title:R(),resize:function(e){$(".red-ui-tray-content").height(e.height-50);var e=$("#node-config-dialog-edit-form"),t={width:e.width(),height:e.height()};y.forEach(function(e){e.resize&&e.resize.call(e,t)})},open:function(e,n){e.find(".red-ui-tray-header");var a=e.find(".red-ui-tray-body"),r=e.find(".red-ui-tray-footer"),e=$('<div class="red-ui-tray-footer-left"></div>').appendTo(r);$('<input id="node-config-input-node-disabled" type="checkbox">').prop("checked",!!b.d).appendTo(e).toggleButton({enabledIcon:"fa-circle-thin",disabledIcon:"fa-ban",invertState:!0}),!1!==s.hasUsers&&$('<span><i class="fa fa-info-circle"></i> <span id="red-ui-editor-config-user-count"></span></span>').css("margin-left","10px").appendTo(e),r.append('<span class="red-ui-tray-footer-right"><span id="red-ui-editor-config-scope-warning" data-i18n="[title]editor.errors.scopeChange"><i class="fa fa-warning"></i></span><select id="red-ui-editor-config-scope"></select></span>');e=["editor-tab-properties"];b._def.defaults&&b._def.defaults.hasOwnProperty("info")||e.push("editor-tab-description"),x(a,e,b,s,"node-config-input",null,function(e){y=e,b._def.exclusive?$("#red-ui-editor-config-scope").hide():$("#red-ui-editor-config-scope").show(),$("#red-ui-editor-config-scope-warning").hide();var o={};b.users.forEach(function(e){o[e.z]=!0});var t=Object.keys(o).length,i=$("#red-ui-editor-config-scope").empty();i.off("change"),i.append('<option value=""'+(b.z?"":" selected")+' data-i18n="sidebar.config.global"></option>'),i.append('<option disabled data-i18n="sidebar.config.flows"></option>'),RED.nodes.eachWorkspace(function(e){var t=e.label;o[e.id]&&(t="* "+t),$('<option value="'+e.id+'"'+(e.id==b.z?" selected":"")+"></option>").text(t).appendTo(i)}),i.append('<option disabled data-i18n="sidebar.config.subflows"></option>'),RED.nodes.eachSubflow(function(e){var t=e.name;o[e.id]&&(t="* "+t),$('<option value="'+e.id+'"'+(e.id==b.z?" selected":"")+"></option>").text(t).appendTo(i)}),0<t&&i.on("change",function(){var e=$(this).val();""!==e&&(!o[e]||1<t)?$("#red-ui-editor-config-scope-warning").show():$("#red-ui-editor-config-scope-warning").hide()}),!1!==s.hasUsers&&$("#red-ui-editor-config-user-count").text(RED._("editor.nodesUse",{count:b.users.length})).parent().show(),a.i18n(),r.i18n(),c=!1,n()})},close:function(){RED.workspaces.refresh(),y.forEach(function(e){e.close&&e.close.call(e)}),l.pop()},show:function(){b&&(RED.sidebar.info.refresh(b),RED.sidebar.help.show(h,!1))}};t.buttons=[{id:"node-config-dialog-cancel",text:RED._("common.label.cancel"),click:function(){var t=h,o=b.id,e=RED.nodes.getType(t);if(e.oneditcancel&&e.oneditcancel){var i=RED.nodes.node(o);if(i)try{e.oneditcancel.call(i,!1)}catch(e){console.log("oneditcancel",i.id,i.type,e.toString())}else try{e.oneditcancel.call({id:o},!0)}catch(e){console.log("oneditcancel",o,t,e.toString())}}RED.tray.close()}},{id:"node-config-dialog-ok",text:m?RED._("editor.configAdd"):RED._("editor.configUpdate"),class:"primary",click:function(){var e,t,o,i,n={changes:{},changed:!1,outputMap:null},a=f,r=(b.id,h),s=m,d=RED.nodes.getType(r);if(d.oneditsave)try{d.oneditsave.call(b)}catch(e){console.warn("oneditsave",b.id,b.type,e.toString())}for(e in d.defaults)!d.defaults.hasOwnProperty(e)||null!=(i="checkbox"===(o=$("#node-config-input-"+e)).attr("type")?o.prop("checked"):"format"in d.defaults[e]&&""!==d.defaults[e].format&&"DIV"===o[0].nodeName?o.text():o.val())&&i!==b[e]&&(b._def.defaults[e].type&&("_ADD_"==i&&(i=""),(t=RED.nodes.node(b[e]))&&((o=t.users).splice(o.indexOf(b),1),RED.events.emit("nodes:change",t)),(t=RED.nodes.node(i))&&(t.users.push(b),RED.events.emit("nodes:change",t))),b[e]=i);y.forEach(function(e){e.apply&&e.apply.call(e,n)}),b.label=d.label;var l=$("#red-ui-editor-config-scope").val();b.z=l,$("#node-config-input-node-disabled").prop("checked")?!0!==b.d&&(b.d=!0):!0===b.d&&delete b.d,l&&(b.users=b.users.filter(function(e){var t,o=!0;for(t in e._def.defaults)e._def.defaults.hasOwnProperty(t)&&e._def.defaults[t].type===b.type&&e[t]===b.id&&e.z!==l&&(o=!1,e[t]=null,e.dirty=!0,e.changed=!0,w(e));return o})),s&&RED.nodes.add(b),w(b);var c={};c[b.id]=!0;for(var p=b.users.slice();0<p.length;){var u=p.pop();c[u.id]||(c[u.id]=!0,u.users&&(p=p.concat(u.users)),w(u))}RED.nodes.dirty(!0),RED.view.redraw(!0),s||(RED.events.emit("editor:save",b),RED.events.emit("nodes:change",b)),RED.tray.close(function(){var e=null;v&&"function"==typeof v._def.defaults[a].filter&&(e=function(e){return v._def.defaults[a].filter.call(v,e)}),k(a,r,b.id,g,e)})}}],m||t.buttons.unshift({class:"leftButton",text:RED._("editor.configDelete"),click:function(){var t=f,e=b.id,o=h,i=RED.nodes.getType(o);try{i.ondelete&&(console.log("Deprecated API warning: config node type ",o," has an ondelete function - should be oneditdelete"),i.ondelete.call(b)),i.oneditdelete&&i.oneditdelete.call(b)}catch(e){console.log("oneditdelete",b.id,b.type,e.toString())}for(var n={t:"delete",nodes:[b],changes:{},dirty:RED.nodes.dirty()},a=0;a<b.users.length;a++){var r,s=b.users[a];for(r in n.changes[s.id]={changed:s.changed,valid:s.valid},s._def.defaults)s._def.defaults.hasOwnProperty(r)&&s[r]==e&&(n.changes[s.id][r]=e,s[r]="",s.changed=!0,s.dirty=!0);w(s)}RED.nodes.remove(e),RED.nodes.dirty(!0),RED.view.redraw(!0),RED.history.push(n),RED.tray.close(function(){var e=null;v&&"function"==typeof v._def.defaults[t].filter&&(e=function(e){return v._def.defaults[t].filter.call(v,e)}),k(t,o,"",g,e)})}}),RED.tray.show(t)}}function t(e,t){o.hasOwnProperty(e)?(0<l.length&&(t.parent=l[l.length-1].id),l.push({type:e}),t.title=t.title||R(),t.onclose=function(){l.pop()},o[e].show(t)):console.log("Unknown type editor:",e)}return{init:function(){window.ace&&window.ace.config.set("basePath","vendor/ace"),RED.tray.init(),RED.actions.add("core:confirm-edit-tray",function(){$(document.activeElement).blur(),$("#node-dialog-ok").trigger("click"),$("#node-config-dialog-ok").trigger("click")}),RED.actions.add("core:cancel-edit-tray",function(){$(document.activeElement).blur(),$("#node-dialog-cancel").trigger("click"),$("#node-config-dialog-cancel").trigger("click")}),RED.editor.codeEditor.init()},edit:function(r,n){var s,e,d,o,t,i;c||(s=r,e=!(c=!0),d=[],l.push(r),RED.view.state(RED.state.EDITING),o=r.type,"subflow:"==r.type.substring(0,8)&&(o="subflow"),t={title:R(),buttons:[{id:"node-dialog-delete",class:"leftButton",text:RED._("common.label.delete"),click:function(){var e=RED.nodes.dirty(),t=[],o=[],i=RED.nodes.remove(s.id);t.push(s);e={t:"delete",nodes:t=t.concat(i.nodes),links:o=o.concat(i.links),changes:{},dirty:e};RED.nodes.dirty(!0),RED.view.redraw(!0),RED.history.push(e),RED.tray.close()}},{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){if(s._def){if(s._def.oneditcancel)try{s._def.oneditcancel.call(s)}catch(e){console.log("oneditcancel",s.id,s.type,e.toString())}for(var e in s._def.defaults){var t;s._def.defaults.hasOwnProperty(e)&&(!(t=s._def.defaults[e]).type||(t=RED.nodes.getType(t.type))&&t.exclusive&&(""===(t=$("#node-input-"+e).val()||"")||s[e]||RED.nodes.remove(t)))}}RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){var t={changes:{},changed:!1,outputMap:null},e=RED.nodes.dirty();h(s,t),d.forEach(function(e){e.apply&&e.apply.call(e,t)});var o,i,n,a=f(s,t.outputMap);$("#node-input-node-disabled").prop("checked")?!0!==r.d&&(t.changes.d=r.d,t.changed=!0,r.d=!0):!0===r.d&&(t.changes.d=r.d,t.changed=!0,delete r.d),r.resize=!0,t.changed&&(n=s.changed,s.changed=!0,RED.nodes.dirty(!0),o=RED.nodes.subflow(RED.workspaces.active()),i=null,o&&(i=[],RED.nodes.eachNode(function(e){e.type=="subflow:"+RED.workspaces.active()&&(i.push({id:e.id,changed:e.changed}),e.changed=!0,e.dirty=!0,f(e))})),n={t:"edit",node:s,changes:t.changes,links:a,dirty:e,changed:n},t.outputMap&&(n.outputMap=t.outputMap),i&&(n.subflow={instances:i}),RED.history.push(n)),s.dirty=!0,w(s),RED.events.emit("editor:save",s),RED.events.emit("nodes:change",s),RED.tray.close()}}],resize:function(e){p[o]=e.width,$(".red-ui-tray-content").height(e.height-50);var e=$(".red-ui-tray-content form").height(e.height-50-40),t={width:e.width(),height:e.height()};d.forEach(function(e){e.resize&&e.resize.call(e,t)})},open:function(e,t){s.hasOwnProperty("inputs")&&(s.__inputs=s.inputs),s.hasOwnProperty("outputs")&&(s.__outputs=s.outputs);var o=e.find(".red-ui-tray-footer"),i=e.find(".red-ui-tray-body");i.parent().css("overflow","hidden");e=$('<div class="red-ui-tray-footer-left"></div>').appendTo(o);$('<input id="node-input-node-disabled" type="checkbox">').prop("checked",!!r.d).appendTo(e).toggleButton({enabledIcon:"fa-circle-thin",disabledIcon:"fa-ban",invertState:!0});e=["editor-tab-properties"];/^subflow:/.test(r.type)&&e.push("editor-tab-envProperties"),r._def.defaults&&r._def.defaults.hasOwnProperty("info")||e.push("editor-tab-description"),e.push("editor-tab-appearance"),x(i,e,r,r._def,"node-input",n,function(e){d=e,i.i18n(),o.i18n(),c=!1,t()})},close:function(){RED.view.state()!=RED.state.IMPORT_DRAGGING&&RED.view.state(RED.state.DEFAULT),s&&!e&&RED.sidebar.info.refresh(s),RED.workspaces.refresh(),d.forEach(function(e){e.close&&e.close.call(e)}),RED.view.redraw(!0),l.pop()},show:function(){s&&(RED.sidebar.info.refresh(s),RED.sidebar.help.show(s.type,!1))}},p.hasOwnProperty(o)&&(t.width=p[o]),"subflow"===o&&(i=s.type.substring(8),t.buttons.unshift({class:"leftButton",text:RED._("subflow.edit"),click:function(){RED.workspaces.show(i),e=!0,$("#node-dialog-ok").trigger("click")}})),RED.tray.show(t))},editConfig:_,editFlow:function(n,a){var r,e;c||(c=!0,r=[],RED.view.state(RED.state.EDITING),e={title:RED._("workspace.editFlow",{name:RED.utils.sanitize(n.label)}),buttons:[{id:"node-dialog-delete",class:"leftButton"+(1===RED.workspaces.count()?" disabled":""),text:RED._("common.label.delete"),click:function(){RED.workspaces.delete(n),RED.tray.close()}},{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",class:"primary",text:RED._("common.label.done"),click:function(){var t={changes:{},changed:!1,outputMap:null},e=RED.nodes.dirty();r.forEach(function(e){e.apply&&e.apply.call(e,t)});var o=$("#node-input-disabled").prop("checked");n.disabled!==o&&(t.changes.disabled=n.disabled,t.changed=!0,n.disabled=o,$("#red-ui-tab-"+n.id.replace(".","-")).toggleClass("red-ui-workspace-disabled",!!n.disabled),n.id===RED.workspaces.active()&&$("#red-ui-workspace").toggleClass("red-ui-workspace-disabled",!!n.disabled)),t.changed&&(e={t:"edit",changes:t.changes,node:n,dirty:e},n.changed=!0,RED.history.push(e),RED.nodes.dirty(!0),t.changes.hasOwnProperty("disabled")&&(RED.nodes.eachNode(function(e){e.z===n.id&&(e.dirty=!0)}),RED.view.redraw()),RED.workspaces.refresh(),RED.events.emit("flows:change",n)),RED.tray.close()}}],resize:function(e){$(".red-ui-tray-content").height(e.height-50);var e=$(".red-ui-tray-content form").height(e.height-50-40),t={width:e.width(),height:e.height()};r.forEach(function(e){e.resize&&e.resize.call(e,t)})},open:function(e,t){var o=e.find(".red-ui-tray-footer"),i=e.find(".red-ui-tray-body");i.parent().css("overflow","hidden");e=$('<div class="red-ui-tray-footer-left"></div>').appendTo(o);n.hasOwnProperty("disabled")||(n.disabled=!1),$('<input id="node-input-disabled" type="checkbox">').prop("checked",n.disabled).appendTo(e).toggleButton({enabledIcon:"fa-circle-thin",disabledIcon:"fa-ban",invertState:!0}),x(i,["editor-tab-flow-properties","editor-tab-envProperties"],n,{},"node-input",a,function(e){r=e,i.i18n(),o.i18n(),c=!1,t()})},close:function(){RED.view.state()!=RED.state.IMPORT_DRAGGING&&RED.view.state(RED.state.DEFAULT),r.forEach(function(e){e.close&&e.close.call(e)});var e=RED.view.selection();e.nodes||e.links||n.id!==RED.workspaces.active()||RED.sidebar.info.refresh(n)}},RED.tray.show(e))},editSubflow:function(a,r){var s,d,e;c||(c=!0,s=a,d=[],l.push(a),RED.view.state(RED.state.EDITING),e={title:R(),buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",class:"primary",text:RED._("common.label.done"),click:function(){var t={changes:{},changed:!1,outputMap:null},e=RED.nodes.dirty();d.forEach(function(e){e.apply&&e.apply.call(e,t)});var o=$("#subflow-input-name").val();o!=s.name&&(t.changes.name=s.name,s.name=o,t.changed=!0);var i,n=s.env,a=RED.subflow.exportSubflowTemplateEnv($("#node-input-env-container").editableList("items"));a&&0<a.length&&a.forEach(function(e){"cred"===e.type&&(s.credentials=s.credentials||{_:{}},s.credentials[e.name]=e.value,s.credentials["has_"+e.name]=""!==e.value,"__PWRD__"!==e.value&&(t.changed=!0),delete e.value)}),o=a,JSON.stringify(n)!==JSON.stringify(o)&&(s.env=a,t.changes.env=s.env,t.changed=!0),t.changed&&(a=s.changed,s.changed=!0,w(s),i=[],RED.nodes.eachNode(function(e){e.type=="subflow:"+s.id&&(i.push({id:e.id,changed:e.changed}),e._def.color=s.color,e.changed=!0,e.dirty=!0,f(e),w(e))}),RED.events.emit("subflows:change",s),RED.nodes.dirty(!0),a={t:"edit",node:s,changes:t.changes,dirty:e,changed:a,subflow:{instances:i}},RED.history.push(a)),s.dirty=!0,RED.tray.close()}}],resize:function(e){$(".red-ui-tray-content").height(e.height-50);var e=$(".red-ui-tray-content form").height(e.height-50-40),t={width:e.width(),height:e.height()};d.forEach(function(e){e.resize&&e.resize.call(e,t)})},open:function(e,t){var o=e.find(".red-ui-tray-footer"),i=$("<div/>",{class:"red-ui-tray-footer-left"}).appendTo(o),n=e.find(".red-ui-tray-body");n.parent().css("overflow","hidden"),$('<span style="margin-left: 10px"><i class="fa fa-info-circle"></i> <i id="red-ui-editor-subflow-user-count"></i></span>').appendTo(i),s&&RED.sidebar.info.refresh(s);x(n,["editor-tab-properties","editor-tab-subflow-module","editor-tab-description","editor-tab-appearance"],a,a._def,"node-input",r,function(e){d=e,$("#subflow-input-name").val(a.name),RED.text.bidi.prepareInput($("#subflow-input-name")),n.i18n(),o.i18n(),c=!1,t()})},close:function(){RED.view.state()!=RED.state.IMPORT_DRAGGING&&RED.view.state(RED.state.DEFAULT),RED.sidebar.info.refresh(s),RED.workspaces.refresh(),d.forEach(function(e){e.close&&e.close.call(e)}),l.pop(),s=null},show:function(){}},RED.tray.show(e))},editGroup:function(n,a){var i,r,e;c||(c=!0,i=n,l.push(n),RED.view.state(RED.state.EDITING),r=[],e={title:R(),buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",class:"primary",text:RED._("common.label.done"),click:function(){var e,t={changes:{},changed:!1,outputMap:null},o=RED.nodes.dirty();h(i,t),r.forEach(function(e){e.apply&&e.apply.call(e,t)}),t.changed&&(e=i.changed,i.changed=!0,RED.nodes.dirty(!0),e={t:"edit",node:i,changes:t.changes,dirty:o,changed:e},RED.history.push(e),RED.events.emit("groups:change",i)),i.dirty=!0,RED.tray.close(),RED.view.redraw(!0)}}],resize:function(e){p.group=e.width,$(".red-ui-tray-content").height(e.height-50);var e=$(".red-ui-tray-content form").height(e.height-50-40),t={width:e.width(),height:e.height()};r.forEach(function(e){e.resize&&e.resize.call(e,t)})},open:function(e,t){var o=e.find(".red-ui-tray-footer"),i=($("<div/>",{class:"red-ui-tray-footer-left"}).appendTo(o),e.find(".red-ui-tray-body"));i.parent().css("overflow","hidden");x(i,["editor-tab-properties","editor-tab-envProperties","editor-tab-description"],n,n._def,"node-input",a,function(e){r=e,i.i18n(),c=!1,t()})},close:function(){RED.view.state()!=RED.state.IMPORT_DRAGGING&&RED.view.state(RED.state.DEFAULT),RED.sidebar.info.refresh(i),r.forEach(function(e){e.close&&e.close.call(e)}),l.pop(),i=null},show:function(){}},p.hasOwnProperty("group")&&(e.width=p.group),RED.tray.show(e))},editJavaScript:function(e){t("_js",e)},editExpression:function(e){t("_expression",e)},editJSON:function(e){t("_json",e)},editMarkdown:function(e){t("_markdown",e)},editText:function(e){"markdown"==e.mode?t("_markdown",e):t("_text",e)},editBuffer:function(e){t("_buffer",e)},buildEditForm:function(e,t,o,a,i){return(e=$('<form id="'+t+'" class="form-horizontal" autocomplete="off"></form>').appendTo(e)).html($("script[data-template-name='"+o+"']").html()),a=a||"node-red",e.find("[data-i18n]").each(function(){for(var e=$(this).attr("data-i18n").split(";"),t=0;t<e.length;t++){var o,i,n=e[t];-1===n.indexOf(":")&&(i="",0===n.indexOf("[")&&(i=(o=n.split("]"))[0]+"]",n=o[1]),e[t]=i+a+":"+n)}$(this).attr("data-i18n",e.join(";"))}),$('<span style="position: absolute; top: -2000px;"><input id="red-ui-trap-password" type="password"/></span>').prependTo(e),$('<span style="position: absolute; top: -2000px;"><input id="red-ui-trap-username"  type="text"/></span>').prependTo(e),$('<span style="position: absolute; top: -2000px;"><input id="red-ui-trap-user"  type="text"/></span>').prependTo(e),e.on("submit",function(e){e.preventDefault()}),e.find("input").attr("autocomplete","off"),e},validateNode:w,updateNodeProperties:f,showIconPicker:function(){RED.editor.iconPicker.show.apply(null,arguments)},showTypeEditor:t,registerTypeEditor:function(e,t){o[e]=t},createEditor:function(e){return RED.editor.codeEditor.create(e)},get customEditTypes(){return o},registerEditPane:function(e,t,o){o&&(m[e]=o),v[e]=t}}}(),function(){function y(e,t,o,i){var n,a=$("<div>",{class:"red-ui-editor-node-label-form-row"});return void 0===e?($("<span>").text(RED._("editor.noDefaultLabel")).appendTo(a),a.addClass("red-ui-editor-node-label-form-none")):(a.addClass(""),e="red-ui-editor-node-label-form-"+e+"-"+t,$("<label>",{for:e}).text(t+1+".").appendTo(a),n=$("<input>",{type:"text",id:e,placeholder:i}).val(o).appendTo(a),$('<button type="button" class="red-ui-button red-ui-button-small"><i class="fa fa-times"></i></button>').appendTo(a).on("click",function(e){e.preventDefault(),n.val("")})),a}RED.editor.registerEditPane("editor-tab-appearance",function(n){return{label:RED._("editor-tab.appearance"),name:RED._("editor-tab.appearance"),iconClass:"fa fa-object-group",create:function(e){this.content=e,function(e,o){var t,e=$('<form class="dialog-form form-horizontal" autocomplete="off"></form>').appendTo(e);{var i;"subflow"===o.type&&(n=$("<div/>",{class:"form-row"}).appendTo(e),$("<label/>",{for:"subflow-appearance-input-category","data-i18n":"editor:subflow.category"}).appendTo(n),i=$("<select/>",{id:"subflow-appearance-input-category"}).css({width:"250px"}).appendTo(n),$("<input/>",{type:"text",id:"subflow-appearance-input-custom-category"}).css({display:"none","margin-left":"10px",width:"calc(100% - 250px)"}).appendTo(n),(s=RED.palette.getCategories()).sort(function(e,t){return e.label.localeCompare(t.label)}),s.forEach(function(e){i.append($("<option/>").val(e.id).text(e.label))}),i.append($("<option/>").attr("disabled",!0).text("---")),i.append($("<option/>").val("_custom_").text(RED._("palette.addCategory"))),$("#subflow-appearance-input-category").on("change",function(){"_custom_"===$(this).val()?($("#subflow-appearance-input-category").width(120),$("#subflow-appearance-input-custom-category").show()):($("#subflow-appearance-input-category").width(250),$("#subflow-appearance-input-custom-category").hide())}),$("#subflow-appearance-input-category").val(o.category||"subflows"),o.id,$("#red-ui-editor-subflow-user-count").text(RED._("subflow.subflowInstances",{count:o.instances.length})).show())}$('<div class="form-row"><label for="node-input-show-label-btn" data-i18n="editor.label"></label><span style="margin-right: 2px;"/><input type="checkbox" id="node-input-show-label"/></div>').appendTo(e),$("#node-input-show-label").toggleButton({enabledLabel:RED._("editor.show"),disabledLabel:RED._("editor.hide")}),o.hasOwnProperty("l")||(o.l=!o._def.hasOwnProperty("showLabel")||o._def.showLabel);$("#node-input-show-label").prop("checked",o.l).trigger("change"),"subflow"===o.type&&(d=o.color||"#DDAA99",l=$("<div/>",{class:"form-row"}).appendTo(e),$("<label/>").text(RED._("editor.color")).appendTo(l),RED.editor.colorPicker.create({id:"red-ui-editor-node-color",value:d,palette:["#DDAA99","#3FADB5","#87A980","#A6BBCF","#AAAA66","#C0C0C0","#C0DEED","#C7E9C0","#D7D7A0","#D8BFD8","#DAC4B4","#DEB887","#DEBD5C","#E2D96E","#E6E0F8","#E7E7AE","#E9967A","#F3B567","#FDD0A2","#FDF0C2","#FFAAAA","#FFCC66","#FFF0F0","#FFFFFF"],sortPalette:function(e,t){return e.l-t.l}}).appendTo(l),$("#red-ui-editor-node-color").on("change",function(e){var t=$(this).val();r.css("backgroundColor",t);var o=RED.utils.getDarkerColor(t);o!==t&&r.css("border-color",o)}));{var n,a,r,s,d,l,c;o._def.defaults&&o._def.defaults.hasOwnProperty("icon")||(n=$('<div class="form-row"></div>').appendTo(e),$('<label data-i18n="editor.settingIcon">').appendTo(n),a=$('<button type="button" class="red-ui-button red-ui-editor-node-appearance-button">').appendTo(n),$('<i class="fa fa-caret-down"></i>').appendTo(a),r=$("<div>",{class:"red-ui-search-result-node"}).appendTo(a),s=RED.utils.getNodeColor(o.type,o._def),d=RED.utils.getNodeIcon(o._def,o),r.css("backgroundColor",s),(l=RED.utils.getDarkerColor(s))!==s&&r.css("border-color",l),c=$("<div/>",{class:"red-ui-palette-icon-container"}).appendTo(r),RED.utils.createIconElement(d,c,!0),a.on("click",function(e){e.preventDefault();var t=$("#red-ui-editor-node-icon").val()||"",e=t?RED.utils.separateIconPath(t):RED.utils.getDefaultNodeIcon(o._def,o),t=RED.utils.getNodeColor(o.type,o._def);"subflow"===o.type&&(t=$("#red-ui-editor-node-color").val()),RED.editor.iconPicker.show(a,t,e,!1,function(e){$("#red-ui-editor-node-icon").val(e||"");e=RED.utils.getNodeIcon(o._def,{type:o.type,icon:e});RED.utils.createIconElement(e,c,!0)})}),RED.popover.tooltip(a,function(){return $("#red-ui-editor-node-icon").val()||RED._("editor.default")}),$('<input type="hidden" id="red-ui-editor-node-icon">').val(o.icon).appendTo(n))}$('<div class="form-row"><span data-i18n="editor.portLabels"></span></div>').appendTo(e);var p=o.inputs||o._def.inputs||0,u=o.outputs||o._def.outputs||0;"subflow"===o.type&&(p=o.in.length,u=o.out.length);var f=o.inputLabels||[],h=o.outputLabels||[],g=o._def.inputLabels?RED._("editor.defaultLabel"):RED._("editor.noDefaultLabel"),v=o._def.outputLabels?RED._("editor.defaultLabel"):RED._("editor.noDefaultLabel");$('<div class="form-row"><span style="margin-left: 50px;" data-i18n="editor.labelInputs"></span><div id="red-ui-editor-node-label-form-inputs"></div></div>').appendTo(e);var m=$("#red-ui-editor-node-label-form-inputs");if(0<p)for(t=0;t<p;t++)y("input",t,f[t],g).appendTo(m);else y().appendTo(m);$('<div class="form-row"><span style="margin-left: 50px;" data-i18n="editor.labelOutputs"></span><div id="red-ui-editor-node-label-form-outputs"></div></div>').appendTo(e);var b=$("#red-ui-editor-node-label-form-outputs");if(0<u)for(t=0;t<u;t++)y("output",t,h[t],v).appendTo(b);else y().appendTo(b)}(this.content,n),"subflow"===n.type?this.defaultIcon="node-red/subflow.svg":(e=RED.utils.getDefaultNodeIcon(n._def,n),this.defaultIcon=e.module+"/"+e.file,n.icon&&n.icon!==this.defaultIcon?this.isDefaultIcon=!1:this.isDefaultIcon=!0)},resize:function(e){},close:function(){},show:function(){!function(e){var t,o=e._def.inputLabels?RED._("editor.defaultLabel"):RED._("editor.noDefaultLabel"),i=e._def.outputLabels?RED._("editor.defaultLabel"):RED._("editor.noDefaultLabel"),n=$("#red-ui-editor-node-label-form-inputs"),a=$("#red-ui-editor-node-label-form-outputs"),r=$("#node-input-inputs").val();void 0===r?t="subflow"===e.type?e.in.length:e.inputs||e._def.inputs||0:(t=Math.min(1,Math.max(0,parseInt(r))),isNaN(t)&&(t=0));var s,d,l=n.children(),c=l.length;1===c&&$(l[0]).hasClass("red-ui-editor-node-label-form-none")&&c--;if(c<t)for(0===c&&$(l[0]).remove(),d=c;d<t;d++)y("input",d,"",o).appendTo(n);else if(t<c){for(d=t;d<c;d++)$(l[d]).remove();0===t&&y().appendTo(n)}r=$("#node-input-outputs").val();{var p,u;void 0===r?"subflow"===e.type?s=e.out.length:t=e.outputs||e._def.outputs||0:isNaN(r)?(p=JSON.parse(r),e=Object.keys(p),l=a.children(),1===(c=l.length)&&$(l[0]).hasClass("red-ui-editor-node-label-form-none")&&c--,s=0,u=[],e.forEach(function(e){var t=$("#red-ui-editor-node-label-form-output-"+e).parent();0===t.length&&-1!==p[e]?(0===c&&($(l[0]).remove(),c=-1),t=y("output",e,"",i)):t.detach(),-1!==p[e]&&(s++,u.push({i:parseInt(p[e]),r:t}))}),u.sort(function(e,t){return e.i-t.i}),u.forEach(function(e,t){e.r.find("label").text(t+1+"."),e.r.appendTo(a)}),0===u.length&&y("output",d,"").appendTo(a)):s=Math.max(0,parseInt(r))}l=a.children(),1===(c=l.length)&&$(l[0]).hasClass("red-ui-editor-node-label-form-none")&&c--;if(c<s)for(0===c&&$(l[0]).remove(),d=c;d<s;d++)y("output",d,"").appendTo(a);else if(s<c){for(d=s;d<c;d++)$(l[d]).remove();0===s&&y().appendTo(a)}}((this.content,n))},apply:function(e){var t,o;!function(e,t,o){var i=$("#red-ui-editor-node-label-form-inputs").children().find("input"),n=$("#red-ui-editor-node-label-form-outputs").children().find("input"),a=!1,r=!1,s=i.map(function(){var e=$(this).val();return a=a||""!==e,e}).toArray().slice(0,e.inputs);(void 0===e.inputLabels&&a||void 0!==e.inputLabels&&JSON.stringify(s)!==JSON.stringify(e.inputLabels))&&(t.inputLabels=e.inputLabels,e.inputLabels=s,r=!0);a=!1,s=new Array(e.outputs),n.each(function(){var e,t=$(this).attr("id").substring("red-ui-editor-node-label-form-output-".length);o&&o.hasOwnProperty(t)&&-1===(t=parseInt(o[t]))||(e=$(this).val(),a=a||""!==e,s[t]=e)}),(void 0===e.outputLabels&&a||void 0!==e.outputLabels&&JSON.stringify(s)!==JSON.stringify(e.outputLabels))&&(t.outputLabels=e.outputLabels,e.outputLabels=s,r=!0);return r}(n,e.changes,e.outputMap)||(e.changed=!0),n._def.defaults&&n._def.defaults.hasOwnProperty("icon")||(t=$("#red-ui-editor-node-icon").val()||"",this.isDefaultIcon?""!==t&&t!==this.defaultIcon?(e.changes.icon=n.icon,n.icon=t,e.changed=!0):(o=(o=RED.utils.getDefaultNodeIcon(n._def,n)).module+"/"+o.file,this.defaultIcon!==o&&(e.changes.icon=n.icon,n.icon=o,e.changed=!0)):t!==n.icon&&(e.changes.icon=n.icon,n.icon=t,e.changed=!0)),"subflow"===n.type&&((i="subflows"===(i="_custom_"===(i=$("#subflow-appearance-input-category").val().trim())&&""===(i=$("#subflow-appearance-input-custom-category").val().trim())?n.category:i)?"":i)!=n.category&&(e.changes.category=n.category,n.category=i,e.changed=!0),n.color!==(i=$("#red-ui-editor-node-color").val())&&(e.changes.color=n.color,n.color=i,e.changed=!0,RED.utils.clearNodeColorCache(),"subflow"===n.type&&(RED.nodes.getType("subflow:"+n.id).color=i)));var i=!n._def.hasOwnProperty("showLabel")||n._def.showLabel;$("#node-input-show-label").prop("checked")?i?(n.hasOwnProperty("l")&&!n.l&&(e.changes.l=n.l,e.changed=!0),delete n.l):(n.l||(e.changes.l=n.l,e.changed=!0),n.l=!0):i?(!1!==n.l&&(e.changes.l=n.l,e.changed=!0),n.l=!1):(n.hasOwnProperty("l")&&n.l&&(e.changes.l=n.l,e.changed=!0),delete n.l)}}})}(),RED.editor.registerEditPane("editor-tab-description",function(i){return{label:RED._("editor-tab.description"),name:RED._("editor-tab.description"),iconClass:"fa fa-file-text-o",create:function(e){this.editor=function(e,t){var o=$('<form class="dialog-form form-horizontal" autocomplete="off"></form>').appendTo(e),e=($("<div></div>").appendTo(o),$('<div class="form-row node-text-editor-row" style="position:relative; padding-top: 4px; height: 100%"></div>').appendTo(o)),o="node-info-input-info-editor-"+Math.floor(1e3*Math.random());$('<div style="height: 100%" class="node-text-editor" id="'+o+'" ></div>').appendTo(e);o=RED.editor.createEditor({id:o,mode:"ace/mode/markdown",value:""});t.info&&o.getSession().setValue(t.info,-1);return t.infoEditor=o}(e,i),RED.e=this.editor},resize:function(e){this.editor.resize()},close:function(){this.editor.destroy(),this.editor=null},show:function(){this.editor.focus()},apply:function(e){var t=i.info,o=this.editor.getValue();t?""===o.trim()?(e.changed=!0,e.changes.info=t,delete i.info):o!==t&&(e.changed=!0,e.changes.info=t,i.info=o):""!==o.trim()&&(e.changed=!0,e.changes.info=void 0,i.info=o)}}}),RED.editor.registerEditPane("editor-tab-envProperties",function(n){return{label:RED._("editor-tab.envProperties"),name:RED._("editor-tab.envProperties"),iconClass:"fa fa-list",create:function(e){e=$('<form class="dialog-form form-horizontal"></form>').appendTo(e),e=$('<div class="form-row node-input-env-container-row"></div>').appendTo(e);this.list=$("<ol></ol>").appendTo(e),RED.editor.envVarList.create(this.list,n)},resize:function(e){this.list.editableList("height",e.height)},close:function(){},apply:function(t){var e,o=n.env,i=[];/^subflow:/.test(n.type)&&(i=RED.subflow.exportSubflowInstanceEnv(n)),this.list.editableList("items").each(function(e,t){var o,t=t.data("data");t.nameField&&t.valueField&&""!==(o={name:t.nameField.val(),value:t.valueField.typedInput("value"),type:t.valueField.typedInput("type")}).name.trim()&&i.push(o)}),i&&0<i.length&&i.forEach(function(e){"cred"===e.type&&(n.credentials=n.credentials||{_:{}},n.credentials[e.name]=e.value,n.credentials["has_"+e.name]=""!==e.value,"__PWRD__"!==e.value&&(t.changed=!0),delete e.value)}),o||0!==i.length?(e=i,JSON.stringify(o)!==JSON.stringify(e)&&(t.changes.env=n.env,0===i.length?delete n.env:n.env=i,t.changed=!0)):delete n.env}}}),RED.editor.registerEditPane("editor-tab-flow-properties",function(o){return{label:RED._("editor-tab.properties"),name:RED._("editor-tab.properties"),iconClass:"fa fa-cog",create:function(e){e=$('<form id="dialog-form" class="form-horizontal"></form>').appendTo(e);$('<div class="form-row"><label for="node-input-name" data-i18n="[append]editor:common.label.name"><i class="fa fa-tag"></i> </label><input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name"></div>').appendTo(e);$('<div class="form-row node-text-editor-row"><label for="node-input-info" data-i18n="editor:workspace.info" style="width:300px;"></label><div style="min-height:150px;" class="node-text-editor" id="node-input-info"></div></div>').appendTo(e);this.tabflowEditor=RED.editor.createEditor({id:"node-input-info",mode:"ace/mode/markdown",value:""}),$('<input type="text" style="display: none;" />').prependTo(e),e.on("submit",function(e){e.preventDefault()}),$("#node-input-name").val(o.label),RED.text.bidi.prepareInput($("#node-input-name")),this.tabflowEditor.getSession().setValue(o.info||"",-1)},resize:function(e){$("#node-input-info").css("height",e.height-70+"px"),this.tabflowEditor.resize()},close:function(){this.tabflowEditor.destroy()},apply:function(e){var t=$("#node-input-name").val();o.label!=t&&(e.changes.label=o.label,e.changed=!0,o.label=t);t=this.tabflowEditor.getValue();o.info!==t&&(e.changes.info=o.info,e.changed=!0,o.info=t),$("#red-ui-tab-"+o.id.replace(".","-")).toggleClass("red-ui-workspace-disabled",!!o.disabled),$("#red-ui-workspace").toggleClass("red-ui-workspace-disabled",!!o.disabled)}}}),RED.editor.registerEditPane("editor-tab-properties",function(c){return{label:RED._("editor-tab.properties"),name:RED._("editor-tab.properties"),iconClass:"fa fa-cog",create:function(e){var t=c.type;"subflow"===c.type?t="subflow-template":"subflow:"==c.type.substring(0,8)&&(t="subflow");var o="node-red"===c._def.set.module?"node-red":c._def.set.id,i="dialog-form";this.inputClass="node-input","config"===c._def.category&&"group"!==t&&(this.inputClass="node-config-input",i="node-config-dialog-edit-form"),RED.editor.buildEditForm(e,i,t,o,c)},resize:function(e){if(c&&c._def.oneditresize)try{c._def.oneditresize.call(c,e)}catch(e){console.log("oneditresize",c.id,c.type,e.toString())}},close:function(){},apply:function(t){var e,o,i;if(c._def.defaults)for(o in c._def.defaults)if(c._def.defaults.hasOwnProperty(o)){var n,a,r,s,d,l=$("#"+this.inputClass+"-"+o);if("checkbox"===l.attr("type")?e=l.prop("checked"):"select"===l.prop("nodeName")&&"multiple"===l.attr("multiple")?null==(e=l.val())&&(e=[]):e="format"in c._def.defaults[o]&&""!==c._def.defaults[o].format&&"DIV"===l[0].nodeName?l.text():l.val(),null!=e){if("inputs"===o){if(""===e.trim())continue;isNaN(e)?(t.inputMap=JSON.parse(e),n=0,a=!1,Object.keys(t.inputMap).forEach(function(e){isNaN(e)?(n++,delete t.inputMap[e]):(t.inputMap[e]=t.inputMap[e]+"","-1"!==t.inputMap[e]?(n++,t.inputMap[e]!==e?a=!0:delete t.inputMap[e]):a=!0)}),e=n,a&&(t.changed=!0)):e=parseInt(e)}if("outputs"===o){if(""===e.trim())continue;isNaN(e)?(t.outputMap=JSON.parse(e),r=0,s=!1,Object.keys(t.outputMap).forEach(function(e){isNaN(e)?(r++,delete t.outputMap[e]):(t.outputMap[e]=t.outputMap[e]+"","-1"!==t.outputMap[e]?(r++,t.outputMap[e]!==e?s=!0:delete t.outputMap[e]):s=!0)}),e=r,s&&(t.changed=!0)):e=parseInt(e)}c._def.defaults[o].type&&"_ADD_"==e&&(e=""),c[o]!=e&&(c._def.defaults[o].type&&((d=RED.nodes.node(c[o]))&&((l=d.users).splice(l.indexOf(c),1),RED.events.emit("nodes:change",d)),(d=RED.nodes.node(e))&&(d.users.push(c),RED.events.emit("nodes:change",d))),t.changes[o]=c[o],c[o]=e,t.changed=!0)}}c._def.credentials&&(i=c._def.credentials,i=function(e,t,o){var i,n=!1;e.credentials?e.credentials._||(e.credentials._={}):e.credentials={_:{}};for(i in t)if(t.hasOwnProperty(i)){var a=$("#"+o+"-"+i);if(0<a.length){a=a.val();if("password"==t[i].type){if(e.credentials["has_"+i]=""!==a,"__PWRD__"==a)continue;n=!0}(e.credentials[i]=a)!=e.credentials._[i]&&(n=!0)}}return n}(c,i,this.inputClass),t.changed=t.changed||i)}}}),function(){function i(t,o){var i;t.on("change keyup paste",function(){i=i||setTimeout(function(){var e=o(t.val());t.toggleClass("input-error",!!e),i=null})})}RED.editor.registerEditPane("editor-tab-subflow-module",function(n){return{label:RED._("editor-tab.module"),name:RED._("editor-tab.module"),iconClass:"fa fa-cube",create:function(e){!function(e,t){$('<form class="dialog-form form-horizontal" autocomplete="off"><div class="form-row"><label for="subflow-input-module-module" data-i18n="[append]editor:subflow.module"><i class="fa fa-cube"></i> </label><input style="width: calc(100% - 110px)" type="text" id="subflow-input-module-module" data-i18n="[placeholder]common.label.name"></div><div class="form-row"><label for="subflow-input-module-type" data-i18n="[append]editor:subflow.type"> </label><input style="width: calc(100% - 110px)" type="text" id="subflow-input-module-type"></div><div class="form-row"><label for="subflow-input-module-version" data-i18n="[append]editor:subflow.version"></label><input style="width: calc(100% - 110px)" type="text" id="subflow-input-module-version" data-i18n="[placeholder]editor:subflow.versionPlaceholder"></div><div class="form-row"><label for="subflow-input-module-desc" data-i18n="[append]editor:subflow.desc"></label><input style="width: calc(100% - 110px)" type="text" id="subflow-input-module-desc"></div><div class="form-row"><label for="subflow-input-module-license" data-i18n="[append]editor:subflow.license"></label><input style="width: calc(100% - 110px)" type="text" id="subflow-input-module-license"></div><div class="form-row"><label for="subflow-input-module-author" data-i18n="[append]editor:subflow.author"></label><input style="width: calc(100% - 110px)" type="text" id="subflow-input-module-author" data-i18n="[placeholder]editor:subflow.authorPlaceholder"></div><div class="form-row"><label for="subflow-input-module-keywords" data-i18n="[append]editor:subflow.keys"></label><input style="width: calc(100% - 110px)" type="text" id="subflow-input-module-keywords" data-i18n="[placeholder]editor:subflow.keysPlaceholder"></div></form>').appendTo(e);var o=t.meta||{};["module","type","version","author","desc","keywords","license"].forEach(function(e){$("#subflow-input-module-"+e).val(o[e]||"")}),$("#subflow-input-module-type").attr("placeholder",t.id),i($("#subflow-input-module-module"),function(e){var t=(e=e.trim()).length<215;return t=(t=t&&!/^[._]/.test(e))&&!/[A-Z]/.test(e),(t=e!==encodeURIComponent(e)?!!(e=/^@([^\/]+)\/([^\/]+)$/.exec(e))&&(t&&e[1]===encodeURIComponent(e[1])&&e[2]===encodeURIComponent(e[2])):t)?"":"Invalid module name"}),i($("#subflow-input-module-version"),function(e){return""===(e=e.trim())||/^(\d|[1-9]\d*)\.(\d|[1-9]\d*)\.(\d|[1-9]\d*)(-(0|[1-9A-Za-z-][0-9A-Za-z-]*|[0-9]*[A-Za-z-][0-9A-Za-z-]*)(\.(0|[1-9A-Za-z-][0-9A-Za-z-]*|[0-9]*[A-Za-z-][0-9A-Za-z-]*))*)?(\+[0-9A-Za-z-]+(\.[0-9A-Za-z-]+)*)?$/.test(e)?"":"Invalid version number"});e=["none","Apache-2.0","BSD-3-Clause","BSD-2-Clause","GPL-2.0","GPL-3.0","MIT","MPL-2.0","CDDL-1.0","EPL-2.0"],t={types:e.map(function(e){return{value:e,label:"none"===e?RED._("editor:subflow.licenseNone"):e,hasValue:!1}})};t.types.push({value:"_custom_",label:RED._("editor:subflow.licenseOther"),icon:"red/images/typedInput/az.svg"}),o.license?-1<e.indexOf(o.license)?t.default=o.license:t.default="_custom_":t.default="none";$("#subflow-input-module-license").typedInput(t)}(e,n)},resize:function(e){},close:function(){},apply:function(e){var t,o,i=function(){var t,o={};["module","type","version","author","desc","keywords"].forEach(function(e){(t=$("#subflow-input-module-"+e).val().trim())&&(o[e]=t)});var e=$("#subflow-input-module-license").typedInput("type");"_custom_"===e?(t=$("#subflow-input-module-license").val())&&(o.license=t):"none"!==e&&(o.license=e);return o}();t=n.meta,o=i,JSON.stringify(t)!==JSON.stringify(o)&&(e.changes.meta=n.meta,n.meta=i,e.changed=!0)}}})}(),RED.editor.registerTypeEditor("_buffer",{show:function(e){var n=e.value,t=e.complete;0===$("script[data-template-name='_buffer']").length&&$('<script type="text/x-red" data-template-name="_buffer"><div id="red-ui-editor-type-buffer-panels"><div id="red-ui-editor-type-buffer-panel-str" class="red-ui-panel"><div class="form-row" style="margin-bottom: 3px; text-align: right;"><button class="red-ui-editor-type-buffer-type red-ui-button red-ui-button-small"><i class="fa fa-exclamation-circle"></i> <span id="red-ui-editor-type-buffer-type-string" data-i18n="bufferEditor.modeString"></span><span id="red-ui-editor-type-buffer-type-array" data-i18n="bufferEditor.modeArray"></span></button></div><div class="form-row node-text-editor-row"><div class="node-text-editor" id="red-ui-editor-type-buffer-str"></div></div></div><div id="red-ui-editor-type-buffer-panel-bin" class="red-ui-panel"><div class="form-row node-text-editor-row" style="margin-top: 10px; margin-bottom:0;"><div class="node-text-editor" id="red-ui-editor-type-buffer-bin"></div></div></div></div><\/script>').appendTo("#red-ui-editor-node-configs"),RED.view.state(RED.state.EDITING);var s,a,r=[],o={title:e.title,width:"inherit",buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){t(JSON.stringify(s)),RED.tray.close()}}],resize:function(e){var t=$("#dialog-form").height();a&&a.resize(t)},open:function(e){e.find(".red-ui-tray-body");var t,e=RED.editor.buildEditForm(e.find(".red-ui-tray-body"),"dialog-form","_buffer","editor");(r=RED.editor.createEditor({id:"red-ui-editor-type-buffer-str",value:"",mode:"ace/mode/text"})).getSession().setValue(n||"",-1),bufferBinEditor=RED.editor.createEditor({id:"red-ui-editor-type-buffer-bin",value:"",mode:"ace/mode/text",readOnly:!0});function i(e){for(var t=!0,o="string"==typeof e,i=[],n=0,a=(s=o?function(e){for(var t=[],o=0,i=e.length,o=0;o<i;o++){var n=e.charCodeAt(o);n<128?t.push(n):(n<2048?t.push(192|n>>6):(n<55296||57344<=n?t.push(224|n>>12):(o++,n=65536+((1023&n)<<10|1023&e.charAt(o)),t.push(240|n>>18),t.push(128|n>>12&63)),t.push(128|n>>6&63)),t.push(128|63&n))}return t}(e):e).length,n=0;n<a;n++){var r=parseInt(s[n]);if(!o&&(isNaN(r)||r<0||255<r)){t=!1;break}0<n&&(n%8==0?n%16==0?i.push("\n"):i.push("  "):i.push(" ")),i.push((r<16?"0":"")+r.toString(16).toUpperCase())}return t&&($("#red-ui-editor-type-buffer-type-string").toggle(o),$("#red-ui-editor-type-buffer-type-array").toggle(!o),bufferBinEditor.setValue(i.join(""),1)),t}function o(){var e=r.getValue(),t=!1;if(/^[\s]*\[[\s\S]*\][\s]*$/.test(e)){t=!0;try{var o=JSON.parse(e),t=i(o)}catch(e){t=!1}}t||i(e)}r.getSession().on("change",function(){clearTimeout(t),t=setTimeout(o,200)}),o(),e.i18n(),a=RED.panels.create({id:"red-ui-editor-type-buffer-panels",resize:function(e,t){var o=$("#red-ui-editor-type-buffer-panel-str");e-=$(o.children()[0]).outerHeight(!0);o=$(o.children()[1]);e-=parseInt(o.css("marginTop"))+parseInt(o.css("marginBottom")),$("#red-ui-editor-type-buffer-str").css("height",e-5+"px"),r.resize();e=$("#red-ui-editor-type-buffer-panel-bin"),o=$(e.children()[0]);t-=parseInt(o.css("marginTop"))+parseInt(o.css("marginBottom")),$("#red-ui-editor-type-buffer-bin").css("height",t-5+"px"),bufferBinEditor.resize()}}),$(".red-ui-editor-type-buffer-type").on("click",function(e){e.preventDefault(),RED.sidebar.help.set(RED._("bufferEditor.modeDesc"))})},close:function(){e.onclose&&e.onclose(),r.destroy(),bufferBinEditor.destroy()},show:function(){}};RED.tray.show(o)}}),RED.editor.codeEditor=function(){const o="monaco",e={lib:"ace",options:{}};var i=null,n=!1;return{init:function(){var t=RED.editor.codeEditor.settings.lib===o?o:"ace";try{var e=RED.utils.getBrowserInfo();(i=RED.editor.codeEditor[t])&&(t!=o||!e.ie&&window.monaco)||(i=RED.editor.codeEditor.ace),n=i.init()}catch(e){i=null,console.warn("Problem initialising '"+t+"' code editor",e)}n||(i=RED.editor.codeEditor.ace,n=i.init())},get settings(){return RED.settings.get("codeEditor")||e},get editor(){return i},create:function(e){return e||(console.warn("createEditor() options are missing"),e={}),this.editor.type===o&&(e.element||e.id||(e.id="node-backwards-compatability-dummy-editor"),e.element=e.element||$("#"+e.id)[0],e.element||(console.warn("createEditor() options.element or options.id is not valid",e),$("#dialog-form").append('<div id="'+e.id+'" style="display: none;" />'))),this.editor.create(e)}}}(),RED.editor.colorPicker=RED.colorPicker={create:function(c){var e=c.value,t=c.id,p=c.palette||[],u=c.cellWidth||30,f=c.cellHeight||30,h=c.cellMargin||2,g=c.cellPerRow||6,o=$("<div>",{style:"display:inline-block"}),v=$("<input/>",{id:t,type:"hidden",value:e}).appendTo(o),m=$("<input/>",{id:t+"-opacity",type:"hidden",value:c.hasOwnProperty("opacity")?c.opacity:"1"}).appendTo(o),b=$('<button type="button" class="red-ui-button red-ui-editor-node-appearance-button">').appendTo(o);$('<i class="fa fa-caret-down"></i>').appendTo(b);var i=$("<div>",{class:"red-ui-search-result-node"}).appendTo(b);function y(e){var t,o;"none"===e?(n.addClass("red-ui-color-picker-cell-none").css({"background-color":"",opacity:1}),i.css({"border-color":""})):(t=parseFloat(m.val()),n.removeClass("red-ui-color-picker-cell-none").css({"background-color":e,opacity:t}),"#"===(o=RED.utils.getDarkerColor(e))[0]?o+=Math.round(255*Math.floor(100*t)/100).toString(16):o="",i.css({"border-color":o})),c.hasOwnProperty("opacity")&&$(".red-ui-color-picker-opacity-slider-overlay").css({"background-image":"linear-gradient(90deg, transparent 0%, "+e+" 100%)"})}$("<div>",{class:"red-ui-color-picker-cell-none"}).appendTo(i);var n=$("<div>",{class:"red-ui-color-picker-swatch"}).appendTo(i);return b.on("click",function(e){var t=p.length,o=$("<div/>",{class:"red-ui-color-picker"}).css({width:(u+h+h)*g+"px",height:Math.ceil(t/g)*(f+h+h)+"+px"}),i=0,n=null;n=$("<div/>").appendTo(o);var a,r,s,d=$("<input>",{type:"text",value:v.val()}).appendTo(n),l=d;d.on("change",function(e){var t=d.val();v.val(t).trigger("change"),y(t)}),c.none&&(n=$("<div/>").appendTo(o),$("<button/>",{class:"red-ui-color-picker-cell red-ui-color-picker-cell-none"}).css({width:u+"px",height:f+"px",margin:h+"px"}).appendTo(n).on("click",function(e){e.preventDefault(),d.val("none"),d.trigger("change")})),p.forEach(function(t){i%g==0&&(n=$("<div/>").appendTo(o)),$("<button/>",{class:"red-ui-color-picker-cell"}).css({width:u+"px",height:f+"px",margin:h+"px",backgroundColor:t,"border-color":RED.utils.getDarkerColor(t)}).appendTo(n).on("click",function(e){e.preventDefault(),d.val(t),d.trigger("change")}),i++}),(c.none||c.hasOwnProperty("opacity"))&&(n=$("<div/>").appendTo(o),c.hasOwnProperty("opacity")&&((a=$("<div>",{class:"red-ui-color-picker-opacity-slider"}).appendTo(n)).on("mousedown",function(e){e.target!==r[0]&&(e=e.offsetX/a.width(),r.css({left:e*(a.width()-r.outerWidth())+"px"}),e=Math.floor(100*e),m.val(e/100),s.text(e+"%"),y(v.val()))}),$("<div>",{class:"red-ui-color-picker-opacity-slider-overlay"}).appendTo(a),r=$("<div>",{class:"red-ui-color-picker-opacity-slider-handle red-ui-button red-ui-button-small"}).appendTo(a).draggable({containment:"parent",axis:"x",drag:function(e,t){t=Math.max(0,t.position.left/($(this).parent().width()-$(this).outerWidth())),t=Math.floor(100*t);m.val((t=99===t?100:t)/100),s.text(t+"%"),y(v.val())}}),s=$("<small></small>").appendTo(n),setTimeout(function(){r.css({left:parseFloat(m.val())*(a.width()-r.outerWidth())+"px"}),s.text(Math.floor(100*m.val())+"%")},50)));t=RED.popover.panel(o);setTimeout(function(){y(v.val())},50),t.show({target:b,onclose:function(){b.focus()}}),l&&l.focus()}),setTimeout(function(){y(v.val())},50),o}},RED.editor.envVarList=function(){var u="en-US",f=["str","num","bool","json","bin","env"],h=["str","num","bool","json","bin","env","cred"];function g(e,t,o){if(e){if(e[o])return e[o];if(o){o=o.substring(0,2);if(e[o])return e[o]}}return t}return{create:function(l,c){var p="subflow"===c.type;l.css({"min-height":"150px","min-width":"450px"}).editableList({header:p?$('<div><div><div></div><div data-i18n="common.label.name"></div><div data-i18n="editor-tab.defaultValue"></div><div></div></div></div>'):void 0,addItem:function(t,e,o){p&&t.addClass("red-ui-editor-subflow-env-editable");var i=$("<div/>").appendTo(t),n=null,a=null,n=$("<input/>",{class:"node-input-env-name",type:"text",placeholder:RED._("common.label.name")}).attr("autocomplete","disable").appendTo(i).val(o.name);(a=$("<input/>",{style:"width:100%",class:"node-input-env-value",type:"text"}).attr("autocomplete","disable").appendTo(i)).typedInput({default:"str",types:p?f:h}),a.typedInput("type",o.type),"cred"!==o.type||o.value?a.typedInput("value",o.value):c.credentials&&c.credentials[o.name]?a.typedInput("value",c.credentials[o.name]):c.credentials&&c.credentials["has_"+o.name]?a.typedInput("value","__PWRD__"):a.typedInput("value",""),o.nameField=n,o.valueField=a;var r=$("<a/>",{href:"#",class:"red-ui-editableList-item-remove red-ui-button red-ui-button-small"}).appendTo(i);$("<i/>",{class:"fa "+(o.parent?"fa-reply":"fa-remove")}).appendTo(r);var s,d=RED.popover.tooltip(r,RED._("subflow.env.remove"));r.on("click",function(e){e.preventDefault(),d.close(),t.parent().addClass("red-ui-editableList-item-deleting"),t.fadeOut(300,function(){l.editableList("removeItem",o)})}),p&&("cred"===o.type?(o.ui=o.ui||{icon:"",type:"cred"},o.ui.type="cred"):o.ui=o.ui||{icon:"",type:"input",opts:{types:f}},o.ui.label=o.ui.label||{},o.ui.type=o.ui.type||"input",s=$("<div/>").appendTo(t).hide(),$('<a href="#"><i class="fa fa-angle-right"></a>').prependTo(i).on("click",function(e){e.preventDefault(),$(this).hasClass("expanded")?(s.slideUp(),$(this).removeClass("expanded")):(s.slideDown(),$(this).addClass("expanded"))}),function(e,r,t,i){e.addClass("red-ui-editor-subflow-env-ui-row");var o=$("<div></div>").appendTo(e);$("<div></div>").appendTo(o),$("<div>").text(RED._("editor.icon")).appendTo(o),$("<div>").text(RED._("editor.label")).appendTo(o),$("<div>").text(RED._("editor.inputType")).appendTo(o);o=$("<div></div>").appendTo(e);$('<div><i class="red-ui-editableList-item-handle fa fa-bars"></i></div>').appendTo(o);var n={input:{types:f},select:{opts:[]},spinner:{},cred:{}};r.opts?n[r.type]=r.opts:r.opts=n[r.type];var e=$("<div></div>").appendTo(o),a=$('<a href="#"></a>').appendTo(e);a.on("click",function(e){e.preventDefault();e=r.icon||"",e=e?RED.utils.separateIconPath(e):{};RED.editor.iconPicker.show(a,null,e,!0,function(e){a.empty();var t=e||"",e=RED.utils.separateIconPath(t);e&&$('<i class="fa"></i>').addClass(e.file).appendTo(a),r.icon=t})}),r.icon&&(s=RED.utils.separateIconPath(r.icon),$('<i class="fa '+s.file+'"></i>').appendTo(a));var e=$("<div></div>").appendTo(o),s=r.label&&r.label[u]||"",d=$('<input type="text">').val(s).appendTo(e);(r.labelField=d).on("change",function(e){r.label=r.label||{};var t=$(this).val().trim();""===t?delete r.label[u]:r.label[u]=t});e=$('<span class="red-ui-editor-subflow-env-lang-icon"><i class="fa fa-language"></i></span>').appendTo(e);RED.popover.tooltip(e,function(){var e=Object.keys(r.label),o=$("<div>");return-1===e.indexOf(u)&&(e.push(u),e.sort()),e.forEach(function(e){var t=$("<div>").appendTo(o);$("<span>").css({display:"inline-block",width:"120px"}).text(RED._("languages."+e)+(e===u?"*":"")).appendTo(t),$("<span>").text(r.label[e]||"").appendTo(t)}),o}),t.on("change",function(e){d.attr("placeholder",$(this).val())});var l,c,o=$("<div></div>").appendTo(o),p=$('<input type="text">').css("width","100%").appendTo(o);"input"===r.type&&p.val(r.opts.types.join(","));p.typedInput({types:[{value:"input",label:RED._("editor.inputs.input"),icon:"fa fa-i-cursor",showLabel:!1,multiple:!0,options:[{value:"str",label:RED._("editor.types.str"),icon:"red/images/typedInput/az.svg"},{value:"num",label:RED._("editor.types.num"),icon:"red/images/typedInput/09.svg"},{value:"bool",label:RED._("editor.types.bool"),icon:"red/images/typedInput/bool.svg"},{value:"json",label:RED._("editor.types.json"),icon:"red/images/typedInput/json.svg"},{value:"bin",label:RED._("editor.types.bin"),icon:"red/images/typedInput/bin.svg"},{value:"env",label:RED._("editor.types.env"),icon:"red/images/typedInput/env.svg"},{value:"cred",label:RED._("editor.types.cred"),icon:"fa fa-lock"}],default:f,valueLabel:function(e,t){e.css("padding",0);var e=$('<div class="red-ui-editor-subflow-env-input-type"></div>').appendTo(e),o=$('<div class="placeholder-input">').appendTo(e);$('<span><i class="fa fa-i-cursor"></i></span>').appendTo(o),t.length?t.forEach(function(e){var t;/^fa /.test(e.icon)?(t=$("<span>",{style:"max-width:14px; padding: 0 3px; margin-top:-4px; margin-left: 1px"}).appendTo(o),$("<i>",{class:e.icon}).appendTo(t)):$("<img>",{src:e.icon,style:"max-width:14px; padding: 0 3px; margin-top:-4px; margin-left: 1px"}).appendTo(o)}):$('<span class="red-ui-editor-subflow-env-input-type-placeholder"></span>').text(RED._("editor.selectType")).appendTo(o)}},{value:"cred",label:RED._("typedInput.type.cred"),icon:"fa fa-lock",showLabel:!1,valueLabel:function(e,t){e.css("padding",0);e=$('<div class="red-ui-editor-subflow-env-input-type">').css({"border-top-right-radius":"4px","border-bottom-right-radius":"4px"}).appendTo(e);$('<div class="placeholder-input">').html("&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;").appendTo(e)}},{value:"select",label:RED._("editor.inputs.select"),icon:"fa fa-tasks",showLabel:!1,valueLabel:function(e,t){e.css("padding","0"),c=$("<select></select>").appendTo(e),r.opts&&Array.isArray(r.opts.opts)&&r.opts.opts.forEach(function(e){var t=g(e.l,e.l["en-US"]||e.v,u);$("<option>").val(e.v).text(t).appendTo(c)}),c.on("change",function(e){var t=c.val();i.typedInput("value",t)}),c.val(i.typedInput("value"))},expand:{icon:"fa-caret-down",minWidth:400,content:function(e){var e=$('<div class="red-ui-editor-subflow-ui-edit-panel">').appendTo(e),a=$("<ol>").appendTo(e).editableList({header:$("<div><div>"+RED._("editor.select.label")+"</div><div>"+RED._("editor.select.value")+"</div></div>"),addItem:function(e,t,i){var o=$("<div>").appendTo(e),n=g(i.l,"",u);i.label=$('<input type="text">').val(n).appendTo(o),i.label.on("keydown",function(e){13===e.keyCode&&(i.input.focus(),e.preventDefault())});o=$('<span class="red-ui-editor-subflow-env-lang-icon"><i class="fa fa-language"></i></span>').appendTo(o);RED.popover.tooltip(o,function(){return u}),i.input=$('<input type="text">').val(i.v).appendTo(e),i.input.on("keydown",function(e){var t,o;13===e.keyCode&&((o=a.editableList("indexOf",i))+1===a.editableList("length")?(a.editableList("addItem",t={}),setTimeout(function(){t.label&&t.label.focus()},100)):(o=a.editableList("getItemAt",o+1)).label&&o.label.focus(),e.preventDefault())})},sortable:!0,removable:!0,height:160});return 0<r.opts.opts.length?r.opts.opts.forEach(function(e){a.editableList("addItem",$.extend(!0,{},e))}):a.editableList("addItem",{}),{onclose:function(){var e=a.editableList("items"),n=[];e.each(function(e,t){var o=t.data("data"),i=o.label.val().trim(),t=o.input.val();0<i.length&&(o.l=o.l||{},o.l[u]=i),o.v=t,(0<i.length||0<t.length)&&(o={l:o.l,v:o.v},n.push(o))}),r.opts.opts=n,p.typedInput("value",Date.now())}}}}},{value:"checkbox",label:RED._("editor.inputs.checkbox"),icon:"fa fa-check-square-o",showLabel:!1,valueLabel:function(e,t){e.css("padding",0),(l=$('<input type="checkbox">').appendTo(e)).on("change",function(e){i.typedInput("value",$(this).prop("checked")?"true":"false")}),l.prop("checked","true"===i.typedInput("value"))}},{value:"spinner",label:RED._("editor.inputs.spinner"),icon:"fa fa-sort-numeric-asc",showLabel:!1,valueLabel:function(e,t){e.css("padding",0);var o=$('<div class="red-ui-editor-subflow-env-input-type"></div>').appendTo(e),i=$('<div class="placeholder-input">').appendTo(o);$('<span><i class="fa fa-sort-numeric-asc"></i></span>').appendTo(i);var n=r.opts&&r.opts.min,e=r.opts&&r.opts.max,o="";void 0!==n&&void 0!==e?o=Math.min(n,e)+" - "+Math.max(n,e):void 0!==n?o="> "+n:void 0!==e&&(o="< "+e),$("<span>").css("margin-left","15px").text(o).appendTo(i)},expand:{icon:"fa-caret-down",content:function(e){var t=$('<div class="red-ui-editor-subflow-ui-edit-panel">').appendTo(e);t.css("padding","8px 5px");var o=r.opts.min,e=r.opts.max,i=$('<input type="number" style="margin-bottom:0; width:60px">');i.val(o);var n=$('<input type="number" style="margin-bottom:0; width:60px">');return n.val(e),$('<div class="form-row" style="margin-bottom:3px"><label>'+RED._("editor.spinner.min")+"</label></div>").append(i).appendTo(t),$('<div class="form-row" style="margin-bottom:0"><label>'+RED._("editor.spinner.max")+"</label></div>").append(n).appendTo(t),{onclose:function(){var e=i.val().trim(),t=n.val().trim();""!==e?r.opts.min=parseInt(e):delete r.opts.min,""!==t?r.opts.max=parseInt(t):delete r.opts.max,p.typedInput("value",Date.now())}}}}},{value:"none",label:RED._("editor.inputs.none"),icon:"fa fa-times",hasValue:!1},{value:"hide",label:RED._("editor.inputs.hidden"),icon:"fa fa-ban",hasValue:!1}],default:"none"}).on("typedinputtypechange",function(e,t){switch(r.type=$(this).typedInput("type"),r.opts=n[r.type],"input"===r.type?p.typedInput("value",r.opts.types.join(",")):p.typedInput("value",Date.now()),r.type){case"input":i.typedInput("types",r.opts.types);break;case"select":i.typedInput("types",["str"]);break;case"checkbox":i.typedInput("types",["bool"]);break;case"spinner":i.typedInput("types",["num"]);break;case"cred":i.typedInput("types",["cred"]);break;default:i.typedInput("types",f)}"checkbox"===r.type?i.typedInput("type","bool"):"spinner"===r.type&&i.typedInput("type","num"),"checkbox"!==r.type&&(l=null)}).on("change",function(e,t){var o;"input"===r.type&&(o=p.typedInput("value"),r.opts.types=""===o?["str"]:o.split(","),i.typedInput("types",r.opts.types))}),i.on("change",function(e){l&&l.prop("checked","true"===$(this).typedInput("value"))}),p.typedInput("type",r.type)}(s,o.ui,n,a),n.trigger("change"))},sortable:".red-ui-editableList-item-handle",removable:!1});var e,o={},i=[];if(!/^subflow:/.test(c.type)||(e=RED.nodes.subflow(c.type.substring(8))).env&&e.env.forEach(function(e){var t={name:e.name,parent:{type:e.type,value:e.value,ui:e.ui}};i.push(t),o[e.name]=t}),c.env)for(var t=0;t<c.env.length;t++){var n=c.env[t];o.hasOwnProperty(n.name)?(o[n.name].type=n.type,o[n.name].value=n.value):i.push({name:n.name,type:n.type,value:n.value,ui:n.ui})}i.forEach(function(e){e.parent&&e.parent.ui&&"hide"===e.parent.ui.type||!p&&e.parent||l.editableList("addItem",JSON.parse(JSON.stringify(e)))})},setLocale:function(e,t){u=e,t&&t.editableList("items").each(function(e,t){var o=$(this).data("data"),i=o.ui.labelField;i.val(g(o.ui.label,"",u)),i.timeout&&(clearTimeout(i.timeout),delete i.timeout),i.addClass("input-updated"),i.timeout=setTimeout(function(){delete i.timeout,i.removeClass("input-updated")},3e3)})},lookupLabel:g,DEFAULT_ENV_TYPE_LIST:f,DEFAULT_ENV_TYPE_LIST_INC_CRED:h}}(),function(){var s={};RED.editor.registerTypeEditor("_expression",{show:function(e){var u,d,f,i,n=e.parent||"_",a=e.value,t=e.complete;0===$("script[data-template-name='_expression']").length&&$('<script type="text/x-red" data-template-name="_expression"><div id="red-ui-editor-type-expression-panels"><div id="red-ui-editor-type-expression-panel-expr" class="red-ui-panel"><div class="form-row" style="margin-bottom: 3px; text-align: right;"><button class="red-ui-editor-type-expression-legacy red-ui-button red-ui-button-small"><i class="fa fa-exclamation-circle"></i> <span data-i18n="expressionEditor.compatMode"></span></button><button id="red-ui-editor-type-expression-reformat" class="red-ui-button red-ui-button-small"><span data-i18n="expressionEditor.format"></span></button></div><div class="form-row node-text-editor-row"><div class="node-text-editor" id="red-ui-editor-type-expression"></div></div></div><div id="red-ui-editor-type-expression-panel-info" class="red-ui-panel"><div class="form-row"><ul id="red-ui-editor-type-expression-tabs"></ul><div id="red-ui-editor-type-expression-tab-help" class="red-ui-editor-type-expression-tab-content hide"><div><select id="red-ui-editor-type-expression-func"></select><button id="red-ui-editor-type-expression-func-insert" class="red-ui-button" data-i18n="expressionEditor.insert"></button></div><div id="red-ui-editor-type-expression-help"></div></div><div id="red-ui-editor-type-expression-tab-test" class="red-ui-editor-type-expression-tab-content hide"><div><span style="display: inline-block; width: calc(50% - 5px);"><span data-i18n="expressionEditor.data"></span><button style="float: right; margin-right: 5px;" id="node-input-example-reformat" class="red-ui-button red-ui-button-small"><span data-i18n="jsonEditor.format"></span></button></span><span style="display: inline-block; margin-left: 10px; width: calc(50% - 5px);" data-i18n="expressionEditor.result"></span></div><div style="display: inline-block; width: calc(50% - 5px);" class="node-text-editor" id="red-ui-editor-type-expression-test-data"></div><div style="display: inline-block; margin-left: 10px;  width:calc(50% - 5px);" class="node-text-editor" id="red-ui-editor-type-expression-test-result"></div></div></div></div></div><\/script>').appendTo("#red-ui-editor-node-configs"),RED.view.state(RED.state.EDITING);var r={title:e.title,width:"inherit",buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){$("#red-ui-editor-type-expression-help").text(""),t(u.getValue()),RED.tray.close()}}],resize:function(e){var t=$("#dialog-form").height();i&&i.resize(t)},open:function(e){e.find(".red-ui-tray-body").addClass("red-ui-editor-type-expression");var e=RED.editor.buildEditForm(e.find(".red-ui-tray-body"),"dialog-form","_expression","editor"),l=$("#red-ui-editor-type-expression-func");Object.keys(jsonata.functions).forEach(function(e){l.append($("<option></option>").val(e).text(e))}),l.on("change",function(e){var t=$(this).val(),o="<h5>"+t+"("+RED._("jsonata:"+t+".args",{defaultValue:""})+")</h5>",t=RED.utils.renderMarkdown(RED._("jsonata:"+t+".desc",{defaultValue:""}));$("#red-ui-editor-type-expression-help").html(o+"<p>"+t+"</p>")}),u=RED.editor.createEditor({id:"red-ui-editor-type-expression",value:"",mode:"ace/mode/jsonata",options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}});var c=null,p=-1;u.getSession().setValue(a||"",-1),"ace"==u.type&&u.on("changeSelection",function(){var e=u.getCursorPosition(),t=u.getSession().getTokenAt(e.row,e.column);if(t!==c||t&&/paren/.test(t.type)&&e.column!==p){var o,i=null;if((c=t)&&"keyword"===t.type)o=e.row,i=t;else for(var n=0,a=!1,r=t?("paren.rparen"===t.type&&(p=e.column,n=e.column-(t.start+t.value.length)),o=e.row,t.index):(o=e.row-1,-1);null===i&&-1<o;){var s=u.getSession().getTokens(o);for(-1===r&&(r=s.length-1);-1<r;){var d=s[r].type;if(a){if("keyword"===d){i=s[r];break}a=!1}"paren.lparen"===d?n-=s[r].value.length:"paren.rparen"===d&&(n+=s[r].value.length),n<0&&(a=!0,n=0),r--}i||o--}u.session.removeMarker(null),i&&l.val(i.value).trigger("change")}}),e.i18n(),$("#red-ui-editor-type-expression-func-insert").on("click",function(e){e.preventDefault();u.getCursorPosition();e=l.val(),e=jsonata.getFunctionSnippet(e);u.insertSnippet(e),u.focus()}),$("#red-ui-editor-type-expression-reformat").on("click",function(e){e.preventDefault();e=u.getValue()||"";try{e=jsonata.format(e)}catch(e){}u.getSession().setValue(e||"",-1)}),l.change();var t,e=RED.tabs.create({element:$("#red-ui-editor-type-expression-tabs"),onchange:function(e){$(".red-ui-editor-type-expression-tab-content").hide(),e.content.show(),r.resize()}});e.addTab({id:"expression-help",label:RED._("expressionEditor.functionReference"),content:$("#red-ui-editor-type-expression-tab-help")}),e.addTab({id:"expression-tests",label:RED._("expressionEditor.test"),content:$("#red-ui-editor-type-expression-tab-test")}),d=RED.editor.createEditor({id:"red-ui-editor-type-expression-test-data",value:s[n]||'{\n    "payload": "hello world"\n}',mode:"ace/mode/json",lineNumbers:!1}),$(".red-ui-editor-type-expression-legacy").on("click",function(e){e.preventDefault(),RED.sidebar.help.set(RED._("expressionEditor.compatModeDesc"))});function o(){var e,t,o=d.getValue(),i=u.getValue(),n=!1,a=/(^|[^a-zA-Z0-9_'".])msg([^a-zA-Z0-9_'"]|$)/.test(i);$(".red-ui-editor-type-expression-legacy").toggle(a);try{(t=jsonata(i)).assign("flowContext",function(e){return n=!0,null}),t.assign("globalContext",function(e){return n=!0,null})}catch(e){return void f.setValue(RED._("expressionEditor.errors.invalid-expr",{message:e.message}),-1)}try{e=JSON.parse(o)}catch(e){return void f.setValue(RED._("expressionEditor.errors.invalid-msg",{message:e.toString()}))}try{var r,s=t.evaluate(a?{msg:e}:e);if(n)return void f.setValue(RED._("expressionEditor.errors.context-unsupported"),-1);r=void 0!==s?JSON.stringify(s,null,4):RED._("expressionEditor.noMatch"),f.setValue(r,-1)}catch(e){f.setValue(RED._("expressionEditor.errors.eval",{message:e.message}),-1)}}d.getSession().on("change",function(){clearTimeout(t),t=setTimeout(o,200),s[n]=d.getValue()}),u.getSession().on("change",function(){clearTimeout(t),t=setTimeout(o,200)}),f=RED.editor.createEditor({id:"red-ui-editor-type-expression-test-result",value:"",mode:"ace/mode/json",lineNumbers:!1,readOnly:!0}),i=RED.panels.create({id:"red-ui-editor-type-expression-panels",resize:function(e,t){var o=$("#red-ui-editor-type-expression-panel-expr");e-=$(o.children()[0]).outerHeight(!0);o=$(o.children()[1]);e-=parseInt(o.css("marginTop"))+parseInt(o.css("marginBottom")),$("#red-ui-editor-type-expression").css("height",e-5+"px"),u.resize(),t-=$("#red-ui-editor-type-expression-panel-info > .form-row > div:first-child").outerHeight(!0)+20,$(".red-ui-editor-type-expression-tab-content").height(t),$("#red-ui-editor-type-expression-test-data").css("height",t-25+"px"),d.resize(),$("#red-ui-editor-type-expression-test-result").css("height",t-25+"px"),f.resize()}}),$("#node-input-example-reformat").on("click",function(e){e.preventDefault();e=d.getValue()||"";try{e=JSON.stringify(JSON.parse(e),null,4)}catch(e){}d.getSession().setValue(e||"",-1)}),o()},close:function(){e.onclose&&e.onclose(),u.destroy(),d.destroy(),f.destroy()},show:function(){}};RED.tray.show(r)}})}(),RED.editor.iconPicker={show:function(e,r,s,i,d,n){var t=$('<div class="red-ui-icon-picker">'),o=$("<div>",{class:"red-ui-search-container"}).appendTo(t);searchInput=$('<input type="text">').attr("placeholder",RED._("editor.searchIcons")).appendTo(o).searchBox({delay:50,change:function(){var o=$(this).val().trim();""===o?(l.find(".red-ui-icon-list-module").show(),l.find(".red-ui-icon-list-icon").show()):(l.find(".red-ui-icon-list-module").hide(),l.find(".red-ui-icon-list-icon").each(function(e,t){-1===$(t).data("icon").indexOf(o)?$(t).hide():$(t).show()}))}}),$("<div>").appendTo(t);var l=$('<div class="red-ui-icon-list">').appendTo(t),o=$('<div class="red-ui-icon-meta"></div>').appendTo(t),c=$("<span>").appendTo(o);n||$('<button type="button" class="red-ui-button red-ui-button-small">'+RED._("editor.useDefault")+"</button>").appendTo(o).on("click",function(e){e.preventDefault(),p.hide(),d(null)}),!r&&i&&l.addClass("red-ui-icon-list-dark"),setTimeout(function(){var o=RED.nodes.getIconSets();Object.keys(o).forEach(function(a){var e,t;i&&"font-awesome"!==a||n&&"homegear-ui-icons"!==a||!n&&"homegear-ui-icons"===a||0<(e=o[a]).length&&(t=$('<div class="red-ui-icon-list-module"></div>').text(a).appendTo(l),$('<i class="fa fa-cube"></i>').prependTo(t),e.forEach(function(e){var t,o=$("<div>",{class:"red-ui-icon-list-icon"}).appendTo(l),i=$("<div>",{class:"red-ui-search-result-node"}).appendTo(o),n=RED.settings.apiRootUrl+"icons/"+a+"/"+e;"homegear-ui-icons"==a?(n=RED.nodes.homegearUiIcons.getIconUrl(e),o.data("icon",e)):o.data("icon",n),r&&(i.css({backgroundColor:r}),(t=RED.utils.getDarkerColor(r))!==r&&i.css("border-color",t));i=$("<div/>",{class:"red-ui-palette-icon-container"}).appendTo(i);RED.utils.createIconElement(n,i,!0),s.module===a&&s.file===e&&o.addClass("selected"),o.on("mouseover",function(){c.text(e)}),o.on("mouseout",function(){c.html("&nbsp;")}),o.on("click",function(){p.hide(),d(a+"/"+e)})}))}),setTimeout(function(){a.remove()},50)},300);var a=RED.utils.addSpinnerOverlay(l,!0),p=RED.popover.panel(t);p.show({target:e}),t.slideDown(100),searchInput.trigger("focus")}},RED.editor.registerTypeEditor("_js",{show:function(t){var n,o=t.value,e=t.complete;0===$("script[data-template-name='_js']").length&&$('<script type="text/x-red" data-template-name="_js"><div class="form-row node-text-editor-row"><div style="height: 200px;min-height: 150px;" class="node-text-editor" id="node-input-js"></div></div><\/script>').appendTo("#red-ui-editor-node-configs"),RED.view.state(RED.state.EDITING);var i={title:t.title,width:t.width||"inherit",buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){e(n.getValue(),n.getCursorPosition()),RED.tray.close()}}],resize:function(e){for(var t=$("#dialog-form>div:not(.node-text-editor-row)"),o=($("#dialog-form>div.node-text-editor-row"),$("#dialog-form").height()),i=0;i<t.size();i++)o-=$(t[i]).outerHeight(!0);$(".node-text-editor").css("height",o+"px"),n.resize()},open:function(e){e.find(".red-ui-tray-body");e=RED.editor.buildEditForm(e.find(".red-ui-tray-body"),"dialog-form","_js","editor");n=RED.editor.createEditor({id:"node-input-js",mode:t.mode||"ace/mode/javascript",value:o,globals:{msg:!0,context:!0,RED:!0,util:!0,flow:!0,global:!0,console:!0,Buffer:!0,setTimeout:!0,clearTimeout:!0,setInterval:!0,clearInterval:!0},extraLibs:t.extraLibs}),t.cursor&&n.gotoLine(t.cursor.row+1,t.cursor.column,!1),e.i18n(),setTimeout(function(){n.focus()},300)},close:function(){n.destroy(),t.onclose&&t.onclose()},show:function(){}};RED.tray.show(i)}}),function(){var p;function f(e,t,o){var i="";if(0<e.children.length)switch(e.children[Math.max(0,Math.min(e.children.length-1,o))].type){case"string":i="";break;case"number":i=0;break;case"boolean":i=!0;break;case"null":i=null;break;case"object":i={};break;case"array":i=[]}if("array"===e.type)r=e.children.length;else{var n={};e.children.forEach(function(e){n[e.key]=!0});for(var a=2,r="item";n[r];)r="item-"+a++}o=h(r,i,e.depth+1,e);e.treeList.insertChildAt(o,t,!0),e.treeList.expand()}function h(e,t,o,i){var n,a,r,s={depth:o,type:typeof t},d=$('<span class="red-ui-editor-type-json-editor-label">');null!=e&&(n="string"==typeof(s.key=e)?'"'+e+'"':e,(a=$('<span class="red-ui-debug-msg-object-key red-ui-editor-type-json-editor-label-key">').text(n).appendTo(d)).addClass("red-ui-debug-msg-type-"+typeof e),i&&"array"===i.type&&a.addClass("red-ui-editor-type-json-editor-label-array-key"),a.on("click",function(e){var i;"array"!==s.parent.type&&(e.preventDefault(),e.stopPropagation(),e=Math.max(150,a.width()),i=$('<input type="text" class="red-ui-editor-type-json-editor-key">').css({width:e+"px"}).val(""+s.key).insertAfter(a).typedInput({types:["str"]}),$(document).on("mousedown.nr-ui-json-editor",function(e){for(var t=i.next(".red-ui-typedInput-container")[0],o=e.target;"BODY"!==o.nodeName&&o!==t&&!$(o).hasClass("red-ui-typedInput-options");)o=o.parentElement;"BODY"===o.nodeName&&(e=i.typedInput("value"),s.key=e,a.text("string"==typeof e?'"'+e+'"':e),i.remove(),a.show(),$(document).off("mousedown.nr-ui-json-editor"),$(document).off("keydown.nr-ui-json-editor"))}),$(document).on("keydown.nr-ui-json-editor",function(e){27===e.keyCode&&(i.remove(),a.show(),$(document).off("mousedown.nr-ui-json-editor"),$(document).off("keydown.nr-ui-json-editor"))}),a.hide())}),$("<span>").text(" : ").appendTo(d)),Array.isArray(t)?(s.expanded=o<2,s.type="array",s.deferBuild=2<=o,s.children=function(e,t,o){for(var i=[],n=e.length,a=0;a<n;a++)i.push(h(a,e[a],t,o));return i}(t,o+1,s)):null!==t&&"object"===s.type?(s.expanded=o<2,s.children=function(e,t,o){var i,n=[];for(i in e)e.hasOwnProperty(i)&&n.push(h(i,e[i],t,o));return n}(t,o+1,s),s.deferBuild=2<=o):null===(s.value=t)&&(s.type="null");var l,c,p="";switch(s.type){case"string":r="str",p='"'+s.value+'"',l="red-ui-debug-msg-type-string";break;case"number":r="num",p=s.value,l="red-ui-debug-msg-type-number";break;case"boolean":r="bool",p=s.value,l="red-ui-debug-msg-type-other";break;case"null":r=s.type,p=s.type,l="red-ui-debug-msg-type-null";break;case"object":r=s.type,p=s.type,l="red-ui-debug-msg-type-meta";break;case"array":r=s.type,p=s.type+"["+s.children.length+"]",l="red-ui-debug-msg-type-meta"}var u=$('<span class="red-ui-editor-type-json-editor-label-value">').addClass(l).text(p).appendTo(d);return u.on("click",function(e){e.preventDefault(),e.stopPropagation(),"str"===r?p=p.substring(1,p.length-1):"array"!==r&&"object"!==r||(p="");var e=Math.max(150,u.width()),n=$('<input type="text" class="red-ui-editor-type-json-editor-value">').css({width:e+"px"}).val(""+p).insertAfter(u).typedInput({types:["str","num","bool",{value:"null",label:RED._("common.type.null"),hasValue:!1},{value:"array",label:RED._("common.type.array"),hasValue:!1,icon:"red/images/typedInput/json.png"},{value:"object",label:RED._("common.type.object"),hasValue:!1,icon:"red/images/typedInput/json.png"}],default:r});$(document).on("mousedown.nr-ui-json-editor",function(e){for(var t,o=n.next(".red-ui-typedInput-container")[0],i=e.target;"BODY"!==i.nodeName&&i!==o&&!$(i).hasClass("red-ui-typedInput-options");)i=i.parentElement;if("BODY"===i.nodeName){switch(r=n.typedInput("type"),p=n.typedInput("value"),"num"===r&&(p=p.trim(),isNaN(p)?r="str":""===p&&(p=0)),s.value=p,r){case"str":s.children&&(c=s.children),s.treeList.makeLeaf(!0),s.type="string",t="red-ui-debug-msg-type-string",p='"'+p+'"';break;case"num":s.children&&(c=s.children),s.treeList.makeLeaf(!0),s.type="number",t="red-ui-debug-msg-type-number";break;case"bool":s.children&&(c=s.children),s.treeList.makeLeaf(!0),s.type="boolean",t="red-ui-debug-msg-type-other",s.value="true"===p;break;case"null":s.children&&(c=s.children),s.treeList.makeLeaf(!0),s.type="null",t="red-ui-debug-msg-type-null",s.value=p="null";break;case"object":s.treeList.makeParent(c),s.type="object",t="red-ui-debug-msg-type-meta",s.value=p="object",s.children.forEach(function(e,t){var o,i;e.hasOwnProperty("_key")&&(e.key=e._key,delete e._key,(i=e.element.find(".red-ui-editor-type-json-editor-label-key")).removeClass("red-ui-editor-type-json-editor-label-array-key"),"string"==typeof e.key?(o='"'+e.key+'"',i.addClass("red-ui-debug-msg-type-string"),i.removeClass("red-ui-debug-msg-type-number")):(o=e.key,i.removeClass("red-ui-debug-msg-type-string"),i.addClass("red-ui-debug-msg-type-number")),i.text(o))});break;case"array":s.treeList.makeParent(c),s.type="array",t="red-ui-debug-msg-type-meta",s.value=p="array["+s.children.length+"]",s.children.forEach(function(e,t){e._key=e.key,e.key=t,e.element.find(".red-ui-editor-type-json-editor-label-key").addClass("red-ui-editor-type-json-editor-label-array-key").text(""+e.key).removeClass("red-ui-debug-msg-type-string").addClass("red-ui-debug-msg-type-number")})}u.text(p).removeClass().addClass("red-ui-editor-type-json-editor-label-value "+t),n.remove(),u.show(),$(document).off("mousedown.nr-ui-json-editor"),$(document).off("keydown.nr-ui-json-editor")}}),$(document).on("keydown.nr-ui-json-editor",function(e){27===e.keyCode&&(n.remove(),u.show(),"str"===r&&(p='"'+p+'"'),$(document).off("mousedown.nr-ui-json-editor"),$(document).off("keydown.nr-ui-json-editor"))}),u.hide()}),s.gutter=$('<span class="red-ui-editor-type-json-editor-item-gutter"></span>'),(i?$('<span class="red-ui-editor-type-json-editor-item-handle"><i class="fa fa-bars"></span>'):$("<span></span>")).appendTo(s.gutter),$('<button type="button" class="editor-button editor-button-small"><i class="fa fa-caret-down"></button>').appendTo(s.gutter).on("click",function(e){e.preventDefault(),e.stopPropagation(),function(e,r){var t=e.offset(),o=[];r.parent&&(o.push({id:"red-ui-editor-type-json-menu-insert-above",icon:"fa fa-toggle-up",label:RED._("jsonEditor.insertAbove"),onselect:function(){var e=r.parent.children.indexOf(r);f(r.parent,e,e)}}),o.push({id:"red-ui-editor-type-json-menu-insert-below",icon:"fa fa-toggle-down",label:RED._("jsonEditor.insertBelow"),onselect:function(){var e=r.parent.children.indexOf(r)+1;f(r.parent,e,e-1)}})),"array"!==r.type&&"object"!==r.type||o.push({id:"red-ui-editor-type-json-menu-add-child",icon:"fa fa-plus",label:RED._("jsonEditor.addItem"),onselect:function(){f(r,r.children.length,r.children.length-1)}}),r.parent&&(o.push({id:"red-ui-editor-type-json-menu-copy-path",icon:"fa fa-terminal",label:RED._("jsonEditor.copyPath"),onselect:function(){for(var e=r,t="";e.parent;)t=("array"===e.parent.type?"["+e.key+"]":/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e.key)?e.key:'["'+e.key.replace(/"/,'\\"')+'"]')+(0<t.length&&"["!==t[0]?".":"")+t,e=e.parent;RED.clipboard.copyText(t,r.element,"clipboard.copyMessagePath")}}),o.push({id:"red-ui-editor-type-json-menu-duplicate",icon:"fa fa-copy",label:RED._("jsonEditor.duplicate"),onselect:function(){var e=r.key;if("array"===r.parent.type)e=r.parent.children.length;else{var t=/^(.*?)(-(\d+))?$/.exec(e),o={};r.parent.children.forEach(function(e){o[e.key]=!0});var i=t[1],n=2;for(void 0!==t[3]&&(n=parseInt(t[3])),e=i;o[e];)e=i+"-"+n++}var a=h(e,g(r),r.parent.depth+1,r.parent),t=r.parent.children.indexOf(r)+1;r.parent.treeList.insertChildAt(a,t,!0),r.parent.treeList.expand()}}),o.push({id:"red-ui-editor-type-json-menu-delete",icon:"fa fa-times",label:RED._("common.label.delete"),onselect:function(){r.treeList.remove()}})),"array"!==r.type&&"object"!==r.type||(o.push(null),o.push({id:"red-ui-editor-type-json-menu-expand-children",icon:"fa fa-angle-double-down",label:RED._("jsonEditor.expandItems"),onselect:function(){r.treeList.expand(),r.children.forEach(function(e){e.treeList.expand()})}}),o.push({id:"red-ui-editor-type-json-menu-collapse-children",icon:"fa fa-angle-double-up",label:RED._("jsonEditor.collapseItems"),onselect:function(){r.treeList.collapse(),r.children.forEach(function(e){e.treeList.collapse()})}}));var i=RED.menu.init({id:"red-ui-editor-type-json-menu",options:o});i.css({position:"absolute"}),i.on("mouseleave",function(){$(this).hide()}),i.on("mouseup",function(){$(this).hide()}),i.appendTo("body");var n=t.top,e=i.height();(o=$(window).height())<n+e&&(n-=n+e-o+20),i.css({top:n+"px",left:t.left+"px"}),i.show()}($(this),s)}),s.element=d,s}function g(e){var t;switch(e.type){case"string":t=e.value;break;case"number":t=Number(e.value);break;case"boolean":t=e.value;break;case"null":t=null;break;case"object":t={},e.children.forEach(function(e){t[e.key]=g(e)});break;case"array":t=e.children.map(g)}return t}RED.editor.registerTypeEditor("_json",{show:function(o){var a,r,s=o.value,t=o.complete;0===$("script[data-template-name='_json']").length&&$('<script type="text/x-red" data-template-name="_json"><ul id="red-ui-editor-type-json-tabs"></ul><div id="red-ui-editor-type-json-tab-raw" class="red-ui-editor-type-json-tab-content hide"><div class="form-row" style="margin-bottom: 3px; text-align: right;"><button id="node-input-json-reformat" class="red-ui-button red-ui-button-small"><span data-i18n="jsonEditor.format"></span></button></div><div class="form-row node-text-editor-row"><div style="height: 200px;min-height: 150px;" class="node-text-editor" id="node-input-json"></div></div></div><div id="red-ui-editor-type-json-tab-ui" class="red-ui-editor-type-json-tab-content hide"><div id="red-ui-editor-type-json-tab-ui-container"></div></div><\/script>').appendTo("#red-ui-editor-node-configs"),RED.view.state(RED.state.EDITING);function d(){var e=a.getValue();try{return JSON.parse(e),$("#node-dialog-ok").removeClass("disabled"),!0}catch(e){return $("#node-dialog-ok").addClass("disabled"),!1}}var l,c={title:o.title,width:o.width||700,buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){var e;o.requireValid&&!d()||("json-ui"===p?e=l?JSON.stringify(g(l),null,4):a.getValue():"json-raw"===p&&(e=a.getValue()),t&&t(e),RED.tray.close())}}],resize:function(e){var t=$(".red-ui-editor-type-json-tab-content").height();$(".node-text-editor").css("height",t-45+"px"),a.resize()},open:function(e){e.find(".red-ui-tray-body");var t=RED.editor.buildEditForm(e.find(".red-ui-tray-body"),"dialog-form","_json","editor"),e=$("#red-ui-editor-type-json-tab-ui-container").css({height:"100%"}),i=$('<div class="red-ui-debug-msg-payload red-ui-editor-type-json-editor">').appendTo(e).treeList({rootSortable:!1,sortable:".red-ui-editor-type-json-editor-item-handle"}).on("treelistchangeparent",function(e,t){"array"===t.old.type&&t.old.element.find(".red-ui-editor-type-json-editor-label-type").text("array["+t.old.children.length+"]"),"array"===t.item.parent.type&&t.item.parent.element.find(".red-ui-editor-type-json-editor-label-type").text("array["+t.item.parent.children.length+"]")}).on("treelistsort",function(e,o){o.children.forEach(function(e,t){"array"===o.type?(e.key=t,e.element.find(".red-ui-editor-type-json-editor-label-key").text(e.key).removeClass("red-ui-debug-msg-type-string").addClass("red-ui-debug-msg-type-number")):e.element.find(".red-ui-editor-type-json-editor-label-key").text('"'+e.key+'"').removeClass("red-ui-debug-msg-type-number").addClass("red-ui-debug-msg-type-string")})});(a=RED.editor.createEditor({id:"node-input-json",value:"",mode:"ace/mode/json"})).getSession().setValue(s||"",-1),o.requireValid&&(a.getSession().on("change",function(){clearTimeout(r),r=setTimeout(d,200)}),d()),$("#node-input-json-reformat").on("click",function(e){e.preventDefault();e=a.getValue()||"";try{e=JSON.stringify(JSON.parse(e),null,4)}catch(e){}a.getSession().setValue(e||"",-1)}),t.i18n();var n=!1,t=RED.tabs.create({element:$("#red-ui-editor-type-json-tabs"),onchange:function(e){if(p=e.id,$(".red-ui-editor-type-json-tab-content").hide(),n)if("json-raw"===e.id)l&&(t=JSON.stringify(g(l),null,4),a.getSession().setValue(t||"",-1));else if("json-ui"===e.id){var t=a.getValue().trim()||"{}";try{var o=JSON.parse(t);(l=h(null,o,0,null)).class="red-ui-editor-type-json-root-node",i.treeList("data",[l])}catch(e){l=null,i.treeList("data",[{label:RED._("jsonEditor.error.invalidJSON")+e.toString()}])}}e.content.show(),c.resize()}});t.addTab({id:"json-raw",label:RED._("jsonEditor.rawMode"),content:$("#red-ui-editor-type-json-tab-raw")}),t.addTab({id:"json-ui",label:RED._("jsonEditor.uiMode"),content:$("#red-ui-editor-type-json-tab-ui")}),n=!0},close:function(){o.onclose&&o.onclose(),a.destroy()},show:function(){}};RED.tray.show(c)}})}(),function(){var r;RED.editor.registerTypeEditor("_markdown",{show:function(i){var n,a=i.value,e=i.complete;0===$("script[data-template-name='_markdown']").length&&$('<script type="text/x-red" data-template-name="_markdown"><div id="red-ui-editor-type-markdown-panels"><div id="red-ui-editor-type-markdown-panel-editor" class="red-ui-panel"><div style="height: 100%; margin: auto;"><div id="red-ui-editor-type-markdown-toolbar"></div><div class="node-text-editor" style="height: 100%" id="red-ui-editor-type-markdown"></div></div></div><div class="red-ui-panel"><div class="red-ui-editor-type-markdown-panel-preview red-ui-help"></div></div><\/script>').appendTo("#red-ui-editor-node-configs"),RED.view.state(RED.state.EDITING);var t={title:i.title,width:i.width||1/0,buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){e(n.getValue(),n.getCursorPosition()),RED.tray.close()}}],resize:function(e){var t=$("#dialog-form").width();r&&r.resize(t)},open:function(e){e.find(".red-ui-tray-body").addClass("red-ui-editor-type-markdown-editor");var t,o=RED.editor.buildEditForm(e.find(".red-ui-tray-body"),"dialog-form","_markdown","editor");(n=RED.editor.createEditor({id:"red-ui-editor-type-markdown",value:a,mode:"ace/mode/markdown",expandable:!1})).getSession().on("change",function(){clearTimeout(t),t=setTimeout(function(){var e=$(".red-ui-editor-type-markdown-panel-preview").scrollTop();$(".red-ui-editor-type-markdown-panel-preview").html(RED.utils.renderMarkdown(n.getValue())),$(".red-ui-editor-type-markdown-panel-preview").scrollTop(e)},200)}),i.header&&i.header.appendTo(e.find("#red-ui-editor-type-markdown-title")),a&&$(".red-ui-editor-type-markdown-panel-preview").html(RED.utils.renderMarkdown(n.getValue())),(r=RED.panels.create({id:"red-ui-editor-type-markdown-panels",dir:"horizontal",resize:function(e,t){n.resize()}})).ratio(1),$('<span class="button-group" style="float:right"><button type="button" id="node-btn-markdown-preview" class="red-ui-button toggle single"><i class="fa fa-eye"></i></button></span>').appendTo(n.toolbar),$("#node-btn-markdown-preview").on("click",function(e){e.preventDefault(),$(this).hasClass("selected")?($(this).removeClass("selected"),r.ratio(1)):($(this).addClass("selected"),r.ratio(.5))}),RED.popover.tooltip($("#node-btn-markdown-preview"),RED._("markdownEditor.toggle-preview")),i.cursor&&n.gotoLine(i.cursor.row+1,i.cursor.column,!1),o.i18n()},close:function(){n.destroy(),i.onclose&&i.onclose()},show:function(){}};RED.tray.show(t)},buildToolbar:function(e,s){var t={h1:{newline:!0,before:"# ",tooltip:RED._("markdownEditor.heading1")},h2:{newline:!0,before:"## ",tooltip:RED._("markdownEditor.heading2")},h3:{newline:!0,before:"### ",tooltip:RED._("markdownEditor.heading3")},b:{before:"**",after:"**",tooltip:RED._("markdownEditor.bold")},i:{before:"_",after:"_",tooltip:RED._("markdownEditor.italic")},code:{before:"`",after:"`",tooltip:RED._("markdownEditor.code")},ol:{before:" * ",newline:!0,tooltip:RED._("markdownEditor.ordered-list")},ul:{before:" - ",newline:!0,tooltip:RED._("markdownEditor.unordered-list")},bq:{before:"> ",newline:!0,tooltip:RED._("markdownEditor.quote")},link:{before:"[",after:"]()",tooltip:RED._("markdownEditor.link")},hr:{before:"\n---\n\n",tooltip:RED._("markdownEditor.horizontal-rule")}},e=$('<div style="margin-bottom: 5px"><span class="button-group"><button type="button" class="red-ui-button" data-style="h1" style="font-size:1.1em; font-weight: bold">h1</button><button type="button" class="red-ui-button" data-style="h2" style="font-size:1.0em; font-weight: bold">h2</button><button type="button" class="red-ui-button" data-style="h3" style="font-size:0.9em; font-weight: bold">h3</button></span><span class="button-group"><button type="button" class="red-ui-button" data-style="b"><i class="fa fa-bold"></i></button><button type="button" class="red-ui-button" data-style="i"><i class="fa fa-italic"></i></button><button type="button" class="red-ui-button" data-style="code"><i class="fa fa-code"></i></button></span><span class="button-group"><button type="button" class="red-ui-button" data-style="ol"><i class="fa fa-list-ol"></i></button><button type="button" class="red-ui-button" data-style="ul"><i class="fa fa-list-ul"></i></button><button type="button" class="red-ui-button" data-style="bq"><i class="fa fa-quote-left"></i></button><button type="button" class="red-ui-button" data-style="hr"><i class="fa fa-minus"></i></button><button type="button" class="red-ui-button" data-style="link"><i class="fa fa-link"></i></button></span></div>').appendTo(e);return e.find("button[data-style]").each(function(e){var r=t[$(this).data("style")];$(this).on("click",function(e){e.preventDefault();var e=s.getSelectedText(),t=s.selection.getRange();if(r.newline)for(var o=0,i=((r.before||"").match(/\n/g)||[]).length,n=((r.after||"").match(/\n/g)||[]).length,a=t.start.row;a<=t.end.row+o;a++)r.before&&(s.session.insert({row:a,column:0},r.before),o+=i,a+=i),r.after&&(s.session.insert({row:a,column:1/0},r.after),o+=n,a+=n);else s.session.replace(s.selection.getRange(),(r.before||"")+e+(r.after||"")),""===e&&s.gotoLine(t.start.row+1,t.start.column+(r.before||"").length,!1);s.focus()}),r.tooltip&&RED.popover.tooltip($(this),r.tooltip)}),e}})}(),RED.editor.registerTypeEditor("_text",{show:function(t){var o,i=t.value,e=t.complete;0===$("script[data-template-name='_text']").length&&$('<script type="text/x-red" data-template-name="_text"><div class="form-row node-text-editor-row"><div style="height: 200px;min-height: 150px;" class="node-text-editor" id="node-input-text"></div></div><\/script>').appendTo("#red-ui-editor-node-configs"),RED.view.state(RED.state.EDITING);var n={title:t.title,width:t.width||"inherit",buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){e(o.getValue(),o.getCursorPosition()),RED.tray.close()}}],resize:function(e){$("#dialog-form>div:not(.node-text-editor-row)"),$("#dialog-form>div.node-text-editor-row");var t=$("#dialog-form").height();$(".node-text-editor").css("height",t+"px"),o.resize()},open:function(e){e.find(".red-ui-tray-body"),RED.editor.buildEditForm(e.find(".red-ui-tray-body"),"dialog-form","_text","editor");(o=RED.editor.createEditor({id:"node-input-text",value:"",mode:"ace/mode/"+(t.mode||"text")})).getSession().setValue(i||"",-1),t.cursor&&o.gotoLine(t.cursor.row+1,t.cursor.column,!1)},close:function(){o.destroy(),t.onclose&&t.onclose()},show:function(){}};RED.tray.show(n)}}),RED.editor.codeEditor.ace=function(){var t=!1,s={};return{get type(){return"ace"},get initialised(){return t},init:function(e){return s=e||{},t=!0},create:function(e){var t=RED.editor.codeEditor.settings||{},o=e.element||$("#"+e.id)[0],i=$("<div>").appendTo(o),o=$("<div>").appendTo(o).addClass("red-ui-editor-text-container")[0],n=window.ace.edit(o);n.setTheme(t.theme||s.theme||"ace/theme/tomorrow");var a,r=n.getSession();return r.on("changeAnnotation",function(){for(var e=r.getAnnotations()||[],t=e.length,o=e.length;t--;)(/doctype first\. Expected/.test(e[t].text)||/Unexpected End of file\. Expected/.test(e[t].text))&&e.splice(t,1);o>e.length&&r.setAnnotations(e)}),e.mode&&r.setMode(e.mode),e.foldStyle?r.setFoldStyle(e.foldStyle):r.setFoldStyle("markbeginend"),e.options?n.setOptions(e.options):n.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,tooltipFollowsMouse:!1}),e.readOnly&&(n.setOption("readOnly",e.readOnly),n.container.classList.add("ace_read-only")),e.hasOwnProperty("lineNumbers")&&n.renderer.setOption("showGutter",e.lineNumbers),n.$blockScrolling=1/0,e.value&&r.setValue(e.value,-1),e.globals&&setTimeout(function(){r.$worker&&r.$worker.send("setOptions",[{globals:e.globals,maxerr:1e3}])},100),"ace/mode/markdown"===e.mode&&($(o).addClass("red-ui-editor-text-container-toolbar"),n.toolbar=RED.editor.customEditTypes._markdown.buildToolbar(i,n),!1!==e.expandable&&(a=$('<button type="button" class="red-ui-button" style="float: right;"><i class="fa fa-expand"></i></button>').appendTo(n.toolbar),RED.popover.tooltip(a,RED._("markdownEditor.expand")),a.on("click",function(e){e.preventDefault();e=n.getValue();RED.editor.editMarkdown({value:e,width:"Infinity",cursor:n.getCursorPosition(),complete:function(e,t){n.setValue(e,-1),n.gotoLine(t.row+1,t.column,!1),setTimeout(function(){n.focus()},300)}})})),a=$('<button type="button" class="red-ui-editor-text-help red-ui-button red-ui-button-small"><i class="fa fa-question"></i></button>').appendTo($(o).parent()),RED.popover.create({target:a,trigger:"click",size:"small",direction:"left",content:RED._("markdownEditor.format"),autoClose:50}),r.setUseWrapMode(!0)),n._destroy=n.destroy,n.destroy=function(){try{this._destroy()}catch(e){}$(o).remove(),$(i).remove()},n.type="ace",n}}}(),RED.editor.codeEditor.monaco=function(){var n=!1;const v=["vs","vs-dark","hc-black"];let m;const b={assert:{package:"node",module:"assert",path:"node/assert.d.ts"},async_hooks:{package:"node",module:"async_hooks",path:"node/async_hooks.d.ts"},buffer:{package:"node",module:"buffer",path:"node/buffer.d.ts"},child_process:{package:"node",module:"child_process",path:"node/child_process.d.ts"},cluster:{package:"node",module:"cluster",path:"node/cluster.d.ts"},console:{package:"node",module:"console",path:"node/console.d.ts"},constants:{package:"node",module:"constants",path:"node/constants.d.ts"},crypto:{package:"node",module:"crypto",path:"node/crypto.d.ts"},dgram:{package:"node",module:"dgram",path:"node/dgram.d.ts"},dns:{package:"node",module:"dns",path:"node/dns.d.ts"},domain:{package:"node",module:"domain",path:"node/domain.d.ts"},events:{package:"node",module:"events",path:"node/events.d.ts"},fs:{package:"node",module:"fs",path:"node/fs.d.ts"},globals:{package:"node",module:"globals",path:"node/globals.d.ts"},http:{package:"node",module:"http",path:"node/http.d.ts"},http2:{package:"node",module:"http2",path:"node/http2.d.ts"},https:{package:"node",module:"https",path:"node/https.d.ts"},module:{package:"node",module:"module",path:"node/module.d.ts"},net:{package:"node",module:"net",path:"node/net.d.ts"},os:{package:"node",module:"os",path:"node/os.d.ts"},path:{package:"node",module:"path",path:"node/path.d.ts"},perf_hooks:{package:"node",module:"perf_hooks",path:"node/perf_hooks.d.ts"},process:{package:"node",module:"process",path:"node/process.d.ts"},querystring:{package:"node",module:"querystring",path:"node/querystring.d.ts"},readline:{package:"node",module:"readline",path:"node/readline.d.ts"},stream:{package:"node",module:"stream",path:"node/stream.d.ts"},string_decoder:{package:"node",module:"string_decoder",path:"node/string_decoder.d.ts"},timers:{package:"node",module:"timers",path:"node/timers.d.ts"},tls:{package:"node",module:"tls",path:"node/tls.d.ts"},trace_events:{package:"node",module:"trace_events",path:"node/trace_events.d.ts"},tty:{package:"node",module:"tty",path:"node/tty.d.ts"},url:{package:"node",module:"url",path:"node/url.d.ts"},util:{package:"node",module:"util",path:"node/util.d.ts"},v8:{package:"node",module:"v8",path:"node/v8.d.ts"},vm:{package:"node",module:"vm",path:"node/vm.d.ts"},wasi:{package:"node",module:"wasi",path:"node/wasi.d.ts"},worker_threads:{package:"node",module:"worker_threads",path:"node/worker_threads.d.ts"},zlib:{package:"node",module:"zlib",path:"node/zlib.d.ts"},"node-red":{package:"node-red",module:"node-red",path:"node-red/index.d.ts"},"node-red-util":{package:"node-red",module:"util",path:"node-red/util.d.ts"},"node-red-func":{package:"node-red",module:"func",path:"node-red/func.d.ts"}},y=[b["node-red-util"],b["node-red-func"],b.globals,b.console,b.buffer],l={};function w(e,t,o,i){var n="object"==typeof e?e:b[e];if(n){const r=n.package,s=n.module,d=n.path;var a,e=l[d];e?(t||(o.JS[s]=monaco.languages.typescript.javascriptDefaults.addExtraLib(e,"file://types/"+r+"/"+s+"/index.d.ts")),i&&setTimeout(function(){i(null,n)},5)):(a="types/"+d,$.get(a).done(function(e){l[d]=e,t||(o.JS[s]=monaco.languages.typescript.javascriptDefaults.addExtraLib(e,"file://types/"+r+"/"+s+"/index.d.ts")),i&&i(null,n)}).fail(function(e){var t="Failed to load '"+a+"'";l[d]="/* "+t+" */\n",i&&i(e,n),console.warn(t)}))}}function E(e){return!(!e.offsetHeight&&!e.offsetWidth)&&"hidden"!==getComputedStyle(e).visibility}return{get type(){return"monaco"},get initialised(){return n},init:function(e){RED.events.on("editor:close",function(){var t=window.monaco?monaco.editor.getModels():null;if(t&&t.length){console.warn("Cleaning up monaco models left behind. Any node that calls createEditor() should call .destroy().");for(let e=0;e<t.length;e++){const o=t[e];o.isDisposed()||o.dispose()}}}),window.MonacoEnvironment=window.MonacoEnvironment||{},window.MonacoEnvironment.getWorkerUrl=function(e,t){return"json"===t?"./vendor/monaco/dist/json.worker.js":"css"===t||"scss"===t?"./vendor/monaco/dist/css.worker.js":"html"===t||"handlebars"===t?"./vendor/monaco/dist/html.worker.js":"typescript"===t||"javascript"===t?"./vendor/monaco/dist/ts.worker.js":"./vendor/monaco/dist/editor.worker.js"};var o=(RED.editor.codeEditor.settings||{}).options||{};try{const i=function(e,t){(t.rules&&Array.isArray(t.rules)||t.colors)&&(v.push(e),monaco.editor.defineTheme(e,t),monaco.editor.setTheme(e),m=e)};if(o.theme)if("object"==typeof o.theme&&RED.settings.editorTheme.theme){var t=o.theme.name||RED.settings.editorTheme.theme;i(t,o.theme)}else if("string"==typeof o.theme){let t=o.theme;v.includes(t)||$.get("vendor/monaco/dist/theme/"+t+".json",function(e){i(t,e)})}}catch(e){console.warn(e)}function a(e,t,o,i,n){return Array.isArray(o)&&(o=o.join("\n")),{label:e,kind:null==n?monaco.languages.CompletionItemKind.Snippet:n,documentation:{value:o},insertText:t,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,range:i}}return function(e){e.languages.registerCompletionItemProvider("javascript",{provideCompletionItems:function(e,t){var e=e.getWordUntilPosition(t),e={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:e.startColumn,endColumn:e.endColumn};return{suggestions:[a("dowhile","do {\n\t${2}\n} while (${1:condition});","Do-While Statement (JavaScript Language Basics)",e=e),a("while","while (${1:condition}) {\n\t${2}\n}","While Statement (JavaScript Language Basics)",e),a("switch",'switch (${1:msg.topic}) {\n\tcase ${2:"value"}:\n\t\t${3}\n\t\tbreak;\n\tdefault:\n\t\t\n}',"Switch Statement (JavaScript Language Basics)",e),a("trycatch","try {\n\t${2}\n} catch (${1:error}) {\n\t\n};","Try-Catch Statement (JavaScript Language Basics)",e),a("for (for loop)","for (let ${1:index} = 0; ${1:index} < ${2:array}.length; ${1:index}++) {\n\tconst element = ${2:array}[${1:index}];\n\t${3}\n}","for loop",e),a("foreach","${1:array}.forEach(function(${2:element}) {\n\t${3}\n});","forEach(callbackfn: (value: T, index: number, array: readonly T[]) => void, thisArg?: any): void\n\nA function that accepts up to three arguments. forEach calls the callbackfn function one time for each element in the array.",e),a("forin","for (${1:prop} in ${2:obj}) {\n\tif (${2:obj}.hasOwnProperty(${1:prop})) {\n\t\t${3}\n\t}\n}","for in",e),a("forof","for (const ${1:iterator} of ${2:object}) {\n\t${3}\n}","for of",e),a("function","function ${1:methodName}(${2:arguments}) {\n\t${3}\n}","Function Declaration",e),a("func (anonymous function)","var ${1:fn} = function(${2:arguments}) {\n\t${3}\n}","Function Expression",e),a("pt (prototype)","${1:ClassName}.prototype.${2:methodName} = function(${3:arguments}) {\n\t${4}\n}","prototype",e),a("iife","(function(${1:arg}) {\n\t${1}\n})(${1:arg});","immediately-invoked function expression",e),a("call (function call)","${1:methodName}.call(${2:context}, ${3:arguments})","function call",e),a("apply (function apply)","${1:methodName}.apply(${2:context}, [${3:arguments}])","function apply",e),a("jsonparse","JSON.parse(${1:json});","JSON.parse",e),a("jsonstringify","JSON.stringify(${1:obj});","JSON.stringify",e),a("setinterval","setInterval(function() {\n\t${2}\n}, ${1:delay});","setInterval",e),a("settimeout","setTimeout(function() {\n\t${2}\n}, ${1:delay});","setTimeout",e),a("node.log",'node.log(${1:"info"});',"Write an info message to the console (not sent to sidebar)",e),a("node.warn",'node.warn(${1:"my warning"});',"Write a warning to the console and debug sidebar",e),a("node.error",'node.error(${1:"my error message"}, ${2:msg});',"Send an error to the console and debug sidebar. To trigger a Catch node on the same tab, the function should call `node.error` with the original message as a second argument",e),a("node.send","node.send(${1:msg});","async send a msg to the next node",e),a("node.send (multiple)","var ${1:msg1} = {payload:${2:1}};\nvar ${3:msg2} = {payload:${4:2}};\nnode.send([[${1:msg1}, ${3:msg2}]]);","send 1 or more messages out of 1 output",e),a("node.send (multiple outputs)","var ${1:msg1} = {payload:${2:1}};\nvar ${3:msg2} = {payload:${4:2}};\nnode.send([${1:msg1}, ${3:msg2}]);","send more than 1 message out of multiple outputs",e),a("node.status",'node.status({fill:"${1|red,green,yellow,blue,grey|}",shape:"${2|ring,dot|}",text:"${3:message}"});',"Set the status icon and text underneath the function node",e),a("get (node context)",'context.get("${1:name}");',"Get a value from node context",e),a("set (node context)",'context.set("${1:name}", ${1:value});',"Set a value in node context",e),a("get (flow context)",'flow.get("${1:name}");',"Get a value from flow context",e),a("set (flow context)",'flow.set("${1:name}", ${1:value});',"Set a value in flow context",e),a("get (global context)",'global.get("${1:name}");',"Get a value from global context",e),a("set (global context)",'global.set("${1:name}", ${1:value});',"Set a value in global context",e),a("get (env)",'env.get("${1:name}");',"Get env variable value",e),a("cloneMessage (RED.util)","RED.util.cloneMessage(${1:msg});",["```typescript","RED.util.cloneMessage<T extends registry.NodeMessage>(msg: T): T","```","Safely clones a message object. This handles msg.req/msg.res objects that must not be cloned\n","*@param* `msg` — the msg object\n"],e),a("getObjectProperty (RED.util)","RED.util.getObjectProperty(${1:msg},${2:prop});",["```typescript","RED.util.getObjectProperty(msg: object, expr: string): any;","```","Gets a property of an object\n","*@param* `msg` — the msg object\n","*@param* `prop` — the msg object"],e),a("setObjectProperty (RED.util)","RED.util.setObjectProperty(${1:msg},${2:prop},${3:value},${4:createMissing});",["```typescript","RED.util.setObjectProperty(msg: object, prop: string, value: any, createMissing?: boolean): boolean","```","Sets a property of an object\n","`msg` — the object\n","`prop` — the property expression\n","`value` — the value to set\n","`createMissing` — whether to create missing parent properties"],e),a("getMessageProperty (RED.util)","RED.util.getMessageProperty(${1:msg},${2:prop});",["```typescript","RED.util.getMessageProperty(msg: object, expr: string): any;","```","Gets a property of an object\n","*@param* `msg` — the msg object\n","*@param* `prop` — the msg object"],e),a("setMessageProperty (RED.util)","RED.util.setMessageProperty(${1:msg},${2:prop},${3:value},${4:createMissing});",["```typescript","RED.util.setMessageProperty(msg: object, prop: string, value: any, createMissing?: boolean): boolean","```","Sets a property of an object\n","`msg` — the object\n","`prop` — the property expression\n","`value` — the value to set\n","`createMissing` — whether to create missing parent properties"],e)]}}});try{var t={allowJs:!0,checkJs:!0,allowNonTsExtensions:!0,target:monaco.languages.typescript.ScriptTarget.ESNext,strictNullChecks:!1,strictPropertyInitialization:!0,strictFunctionTypes:!0,strictBindCallApply:!0,useDefineForClassFields:!0,moduleResolution:monaco.languages.typescript.ModuleResolutionKind.NodeJs,module:monaco.languages.typescript.ModuleKind.CommonJS,typeRoots:["types"],lib:["esnext"]},o=RED.settings.get("codeEditor.monaco.languages.typescript.javascriptDefaults.compilerOptions")||{},t=Object.assign({},t,o);e.languages.typescript.javascriptDefaults.setCompilerOptions(t);var i={noSemanticValidation:!1,noSyntaxValidation:!1,diagnosticCodesToIgnore:[1108,1375,1378,2307,2322,2339,2345,7043,80001,80004]},n=RED.settings.get("codeEditor.monaco.languages.typescript.javascriptDefaults.diagnosticsOptions")||{},i=Object.assign({},i,n);e.languages.typescript.javascriptDefaults.setDiagnosticsOptions(i)}catch(e){console.warn("monaco - Error setting javascriptDefaults",e)}}(monaco),(o=monaco).languages.register({id:"jsonata"}),o.languages.setMonarchTokensProvider("jsonata",{defaultToken:"invalid",tokenPostfix:".js",keywords:["function","true","true","null","Infinity","NaN","undefined"].concat(Object.keys(jsonata.functions)),operatorsKeywords:["and","or","in"],operators:["<=",">=","!=","==","!=","=>","+","-","*","/","%",":=","~>","?",":","..","@","#","|","^","*","**"],symbols:/[=><!~?:&|+\-*\/\^%@#]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,regexpctl:/[(){}\[\]\$\^|\-*+?\.]/,regexpesc:/\\(?:[bBdDfnrstvwWn0\\\/]|@regexpctl|c[A-Z]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})/,tokenizer:{root:[[/[{}]/,"delimiter.bracket"],{include:"common"}],common:[[/([a-zA-Z][\w$]*)|([$][\w$]*)/,{cases:{"@keywords":"keyword","@operatorsKeywords":"keyword",$2:"variable","@default":"identifier"}}],[/[$][\w\$]*/,"variable"],{include:"@whitespace"},[/\/(?=([^\\\/]|\\.)+\/([gimsuy]*)(\s*)(\.|;|\/|,|\)|\]|\}|$))/,{token:"regexp",bracket:"@open",next:"@regexp"}],[/[()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/(@symbols)|(\.\.)/,{cases:{"@operators":"operator","@default":""}}],[/(@digits)[eE]([\-+]?(@digits))?/,"number.float"],[/(@digits)\.(@digits)([eE][\-+]?(@digits))?/,"number.float"],[/0[xX](@hexdigits)/,"number.hex"],[/0[oO]?(@octaldigits)/,"number.octal"],[/0[bB](@binarydigits)/,"number.binary"],[/(@digits)/,"number"],[/[?:;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"]],whitespace:[[/[ \t\r\n]+/,""],[/\/\*\*(?!\/)/,"comment.doc","@jsdoc"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]],comment:[[/[^\/*]+/,"comment"],[/\*\//,"comment","@pop"],[/[\/*]/,"comment"]],jsdoc:[[/[^\/*]+/,"comment.doc"],[/\*\//,"comment.doc","@pop"],[/[\/*]/,"comment.doc"]],regexp:[[/(\{)(\d+(?:,\d*)?)(\})/,["regexp.escape.control","regexp.escape.control","regexp.escape.control"]],[/(\[)(\^?)(?=(?:[^\]\\\/]|\\.)+)/,["regexp.escape.control",{token:"regexp.escape.control",next:"@regexrange"}]],[/(\()(\?:|\?=|\?!)/,["regexp.escape.control","regexp.escape.control"]],[/[()]/,"regexp.escape.control"],[/@regexpctl/,"regexp.escape.control"],[/[^\\\/]/,"regexp"],[/@regexpesc/,"regexp.escape"],[/\\\./,"regexp.invalid"],[/(\/)([gimsuy]*)/,[{token:"regexp",bracket:"@close",next:"@pop"},"keyword.other"]]],regexrange:[[/-/,"regexp.escape.control"],[/\^/,"regexp.invalid"],[/@regexpesc/,"regexp.escape"],[/[^\]]/,"regexp"],[/\]/,{token:"regexp.escape.control",next:"@pop",bracket:"@close"}]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/\$\{/,{token:"delimiter.bracket",next:"@bracketCounting"}],[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],bracketCounting:[[/\{/,"delimiter.bracket","@bracketCounting"],[/\}/,"delimiter.bracket","@pop"],{include:"common"}]}}),o.languages.setLanguageConfiguration("jsonata",{comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"'",close:"'",notIn:["string","comment"]},{open:'"',close:'"',notIn:["string"]}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{markers:{start:new RegExp("^\\s*//\\s*(?:(?:#?region\\b)|(?:<editor-fold\\b))"),end:new RegExp("^\\s*//\\s*(?:(?:#?endregion\\b)|(?:</editor-fold>))")}}}),o.languages.registerCompletionItemProvider("jsonata",{provideCompletionItems:function(e,t){var o=e.getWordUntilPosition(t);if(o){e=o.startColumn;"$"!==o.word[0]&&1<t.column&&e--;var i={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:e,endColumn:o.endColumn},e=Object.keys(jsonata.functions),o=e.map(function(e){var t=e+"("+RED._("jsonata:"+e+".args",{defaultValue:""})+")",o=RED._("jsonata:"+e+".desc",{defaultValue:""});return a(e,(jsonata.getFunctionSnippet(e)+"").trim(),{value:"`"+t+"`\n\n"+o},i,monaco.languages.CompletionItemKind.Function)});return e.sort(function(e,t){return t.length-e.length}),o.unshift(a("randominteger","(\n\t\\$minimum := ${1:1};\n\t\\$maximum := ${2:10};\n\t\\$round((\\$random() * (\\$maximum-\\$minimum)) + \\$minimum, 0)\n)","Random integer between 2 numbers",i)),{suggestions:o}}}}),o.languages.registerHoverProvider("jsonata",{provideHover:function(e,t){var o=e.getWordAtPosition(t),i=o&&o.word;if(i&&"$"!==i[0]&&1<t.column){i="$"+i,e=RED._("jsonata:"+i+".args",{defaultValue:""});if(e){e=i+"("+e+")",i=RED._("jsonata:"+i+".desc",{defaultValue:""});return{range:new monaco.Range(t.lineNumber,t.column,t.lineNumber,t.column+o.word.length),contents:[{value:"**`"+e+"`**"},{value:i}]}}}}}),function(e){try{var t=RED.settings.get("codeEditor.monaco.languages.json.jsonDefaults.diagnosticOptions"),o=RED.settings.get("codeEditor.monaco.languages.json.jsonDefaults.modeConfiguration"),t=Object.assign({},{validate:!0},t||{});e.languages.json.jsonDefaults.setDiagnosticsOptions(t),o&&e.languages.json.jsonDefaults.setModeConfiguration(o)}catch(e){console.warn("monaco - Error setting up json options",err)}}(monaco),function(e){try{var t=RED.settings.get("codeEditor.monaco.languages.css.cssDefaults.diagnosticsOptions"),o=RED.settings.get("codeEditor.monaco.languages.css.lessDefaults.diagnosticsOption"),i=RED.settings.get("codeEditor.monaco.languages.css.scssDefaults.diagnosticsOption"),n=RED.settings.get("codeEditor.monaco.languages.css.cssDefaults.modeConfiguration"),a=RED.settings.get("codeEditor.monaco.languages.css.lessDefaults.modeConfiguration"),r=RED.settings.get("codeEditor.monaco.languages.css.scssDefaults.modeConfiguration");t&&e.languages.css.cssDefaults.setDiagnosticsOptions(t),o&&e.languages.css.cssDefaults.setDiagnosticsOptions(o),i&&e.languages.css.cssDefaults.setDiagnosticsOptions(i),n&&e.languages.css.cssDefaults.setDiagnosticsOptions(n),a&&e.languages.css.cssDefaults.setDiagnosticsOptions(a),r&&e.languages.css.cssDefaults.setDiagnosticsOptions(r)}catch(e){console.warn("monaco - Error setting up CSS/SCSS/LESS options",err)}}(monaco),function(e){try{var t=RED.settings.get("codeEditor.monaco.languages.html.htmlDefaults.options"),o=RED.settings.get("codeEditor.monaco.languages.html.handlebarDefaults.options");t&&e.languages.html.htmlDefaults.setOptions(t),o&&e.languages.html.handlebarDefaults.setOptions(o)}catch(e){console.warn("monaco - Error setting up html options",err)}}(monaco),y.forEach(function(e){w(e,!0)}),n=!0},create:function(e){function c(e){switch(e=(e="object"==typeof e&&e.path?e.path:e)?e.replace("ace/mode/",""):"text"){case"nrjavascript":case"mjs":e="javascript";break;case"vue":e="html";break;case"appcache":e="shell"}return e}var a,t=RED.editor.codeEditor.settings||{},p={JS:{},TS:{}},r=e.element||$("#"+e.id)[0],s=$("<div>").appendTo(r),r=$("<div>").appendTo(r).addClass("red-ui-editor-text-container")[0],o=$.extend({},t.options,e);o.language=c(e.mode),m&&(o.theme=m),"javascript"==o.language&&(o._language=o.language,o.language="text"),o.minimap||(o.minimap={enabled:!0,maxColumn:50,scale:1,showSlider:"mouseover",renderCharacters:!0}),!1===e.enableBasicAutocompletion&&(o.showSnippets=!1,o.quickSuggestions=!1,o.parameterHints={enabled:!1},o.suggestOnTriggerCharacters=!1,o.acceptSuggestionOnEnter="off",o.tabCompletion="off",o.wordBasedSuggestions=!1),!1===e.enableSnippets&&(o.showSnippets=!1),null==o.mouseWheelZoom&&(o.mouseWheelZoom=!0),null==o.suggestFontSize&&(o.suggestFontSize=12),null==o.formatOnPaste&&(o.formatOnPaste=!0),null==o.foldingHighlight&&(o.foldingHighlight=!0),null==o.foldStyle&&(o.foldStyle=!0),null!=o.readOnly&&(o.readOnly=o.readOnly),!1===o.lineNumbers&&(o.lineNumbers=!1),null==o.theme&&(o.theme=v[0]),null==o.mode&&(o.mode=c(e.mode)),null==o.automaticLayout&&(o.automaticLayout=!0),e.foldStyle&&"none"===e.foldStyle?(o.foldStyle=!1,o.foldingHighlight=!1):(o.foldStyle=!0,o.foldingHighlight=!0),o.roundedSelection=!1!==o.roundedSelection,o.contextmenu=!1!==o.contextmenu,o.snippetSuggestions=!1!==o.enableSnippets,o.value=e.value||"",o.wordSeparators||"jsonata"!=o.language&&"json"!=o.language&&"javascript"!=o.language||(o.wordSeparators="`~!@#%^&*()-=+[{]}|;:'\",.<>/?"),o.fixedOverflowWidgets=!1!==o.fixedOverflowWidgets;var i=RED.utils.getBrowserInfo();function n(t){var i=[],n=[];const a="extraModuleLibs/index.d.ts",r="file://types/extraModuleLibs/index.d.ts";if(t&&0!=t.length){var s=[];Array.prototype.push.apply(s,t);var o={};for(let e=0;e<t.length;e++){var d=t[e],l=d.var,d=d.module;l&&d&&(n.push("import "+l+"_import = require('"+d+"');\n"),i.push("var "+l+": typeof "+l+"_import;\n"));l=b[d];o[d]=l||{package:"other",module:d,path:"other/"+d+".d.ts"}}Object.values(o).forEach(function(e){w(e,!1,p,function(e,t){var o;0==(s=s.filter(function(e){return e.module!=t.module})).length&&(o=n.join("")+("\ndeclare global {\n"+i.join("")+"\n}"),setTimeout(function(){p.JS[a]=monaco.languages.typescript.javascriptDefaults.addExtraLib(o,r)},500))})})}else p.JS[a]=monaco.languages.typescript.javascriptDefaults.addExtraLib(" ",r)}(i.mobile||i.tablet)&&(o.minimap={enabled:!1},o.formatOnType=!1,o.formatOnPaste=!1,o.disableMonospaceOptimizations=!0,o.columnSelection=!1,o.matchBrackets="never",o.maxTokenizationLineLength=1e4,o.stopRenderingLineAfter=2e3,o.roundedSelection=!1,o.trimAutoWhitespace=!1,o.parameterHints={enabled:!1},o.suggestOnTriggerCharacters=!1,o.wordBasedSuggestions=!1,o.suggest={maxVisibleSuggestions:6},!o.accessibilitySupport&&i.android&&(o.accessibilitySupport="off")),t=!1,null==e.clientSideSuggestions&&(0<=(e.mode+"").indexOf("nrjavascript")||e.globals&&(e.globals.RED||e.globals.Buffer))&&(t=!0),i=monaco.languages.typescript.javascriptDefaults.getCompilerOptions(),t?(i.lib=["esnext"],y.forEach(function(e){w(e,!1,p)})):i.lib=["esnext","dom"],monaco.languages.typescript.javascriptDefaults.setCompilerOptions(i),n(o.extraLibs);var u=monaco.editor.create(r,o);try{u._standaloneKeybindingService.addDynamicKeybinding("-editor.action.insertLineAfter",null,()=>{})}catch(e){}u.nodered={refreshModuleLibs:n};for(var d,l=0;l<v.length;l++){var f=v[l];u.addAction(function(t,e){return{id:"set-theme-"+t,label:RED._("monaco.setTheme")+" "+t,precondition:null,keybindingContext:e||null,run:function(e){return e.setTheme(t),null}}}(f))}function h(e,t,o){e.getOption(monaco.editor.EditorOptions.readOnly.id)?e.getModel().pushEditOperations(e.getSelections(),t,function(){return o||null}):e.executeEdits("editor",t)}function g(e,t,o){e?"javascript"==u._mode&&"text"==u._tempMode&&(u._tempMode="",setTimeout(function(){o.parentElement&&u.setMode("javascript",void 0,!1)},t||50)):"javascript"==u._mode&&"text"!=u._tempMode&&o.parentElement&&(u.setMode("text",void 0,!1),u._tempMode="text")}return u.selection={},(u.session=u).renderer={},u.setMode=function(e,t,o){null==o&&(o=!0),e=c(e);var i,n=u.getModel(),a=u.getValue();if(n){var r=u.getScrollTop(),s=u.getScrollLeft(),d=u.getSelections(),l=u.getPosition(),a=n.getValue()||"";try{n.isDisposed()||n.dispose()}catch(e){}u.setModel(null),i=monaco.editor.createModel(a||"",e),u.setModel(i),u.setScrollTop(r,1),u.setScrollLeft(s,1),u.setPosition(l),u.setSelections(d)}else i=monaco.editor.createModel(a||"",e),u.setModel(i);t&&"function"==typeof t&&t(),o&&this.resize()},u.getRange=function(){var e=u.getSelection();return e.start={row:e.selectionStartLineNumber-1,column:e.selectionStartColumn-1},e.end={row:e.endLineNumber-1,column:e.endColumn-1},e},u.selection.getRange=u.getRange,u.session.insert=function(e,t){h(this,[{range:new monaco.Range(e.row+1,e.column+1,e.row+1,e.column+1),text:t,forceMoveMarkers:!0}])},u.setReadOnly=function(e){u.updateOptions({readOnly:e})},u.session.replace=function(e,t){h(this,[{range:e,text:t,forceMoveMarkers:!0}])},u.selectAll=function(){var e=u.getModel().getFullModelRange();u.setSelection(e)},u.clearSelection=function(){u.setPosition({column:1,lineNumber:1})},u.getSelectedText=function(){return u.getModel().getValueInRange(u.getSelection())},u.insertSnippet=function(e){let t=u.getContribution("snippetController2");t.insert(e)},u.destroy=function(){a&&clearInterval(a);try{if(Object.keys(p.JS).length){var t=Object.entries(p.JS);for(let e=0;e<t.length;e++)try{var o=t[e][0];p.JS[o].dispose(),p.JS[o]=null,delete p.JS[o]}catch(e){}}if(Object.keys(p.TS).length){var i=Object.entries(p.TS);for(let e=0;e<i.length;e++)try{var n=i[e][0];p.TS[n].dispose(),p.TS[n]=null,delete p.TS[n]}catch(e){}}}catch(e){}try{var e=this.getModel();e&&!e.isDisposed()&&e.dispose(),this.setModel(null)}catch(e){}$(r).remove(),$(s).remove()},u.resize=function(){u.layout()},u.renderer.updateFull=u.resize.bind(u),u.getSession=function(){return u},u.getLength=function(){var e=u.getModel();return null!==e?e.getLineCount():0},u.scrollToLine=function(e,t){u.revealLine(e,t)},u.moveCursorTo=function(e,t){u.setPosition({lineNumber:e,column:t})},u.getAnnotations=function(){var e=[];try{var n,a,r,s,t=u.getModel();null!==t&&(n=t.getModeId(),a=t._associatedResource.authority,r=t._associatedResource.path,s=t._associatedResource.scheme,e=(monaco.editor.getModelMarkers(t)||[]).filter(function(e){var t=e.resource.authority,o=e.resource.path,i=e.resource.scheme;return e.owner==n&&t===a&&o===r&&i===s}).map(function(e){return{row:e.startLineNumber,column:e.startColumn,endColumn:e.endColumn,endRow:e.endLineNumber,text:e.message,type:monaco.MarkerSeverity[e.severity]?monaco.MarkerSeverity[e.severity].toLowerCase():e.severity}}))}catch(e){console.log("Failed to get editor Annotations",e)}return e||[]},u.gotoLine=function(e,t){u.setPosition({lineNumber:e+1,column:t+1})},u.getCursorPosition=function(){var e=u.getPosition();return{row:e.lineNumber-1,column:e.column-1}},u.setTheme=function(e){monaco.editor.setTheme(e),m=e},u.on=function(e,t){switch(e){case"change":case"input":e="onDidChangeModelContent";break;case"focus":e="onDidFocusEditorWidget";break;case"blur":e="onDidBlurEditorWidget";break;case"paste":e="onDidPaste"}var o;if(u[e])o=u[e];else{if(!monaco.editor[e])return void console.warn("monaco - unknown event: "+e);o=monaco.editor[e]}o(t)},u.getUndoManager=function(){var e={};return e.isClean=function(){try{return!1===u.getModel().canUndo()}catch(e){return!1}}.bind(u),e},u.setFontSize=function(e){u.updateOptions({fontSize:e})},e.cursor&&(t=e.cursor.row||e.cursor.lineNumber,i=e.cursor.column||e.cursor.col,u.gotoLine(t,i)),e.focus&&u.focus(),u._mode=o.language,o._language&&(u._mode=o._language,u._tempMode=o.language),u.onDidBlurEditorWidget(function(){0==E(r)&&g(!1,0,r)}),u.onDidFocusEditorWidget(function(){g(!0,10,r)}),function(o,i){try{var e={root:$(o).closest("div.red-ui-tray-content")[0]||document,attributes:!0,childList:!0};new IntersectionObserver(function(e,t){e.forEach(function(e){i(0<e.intersectionRatio,5,e.target)})},e).observe(o)}catch(e){try{let t=E(r);a=setInterval(function(){var e=E(r);e!=t&&i(e,5,o),t=e},100)}catch(e){}}}(r,g),"markdown"===o.language&&($(r).addClass("red-ui-editor-text-container-toolbar"),u.toolbar=RED.editor.customEditTypes._markdown.buildToolbar(s,u),!1!==e.expandable&&(d=$('<button type="button" class="red-ui-button" style="float: right;"><i class="fa fa-expand"></i></button>').appendTo(u.toolbar),RED.popover.tooltip(d,RED._("markdownEditor.expand")),d.on("click",function(e){e.preventDefault();e=u.getValue();RED.editor.editMarkdown({value:e,width:"Infinity",cursor:u.getCursorPosition(),complete:function(e,t){u.setValue(e,-1),u.gotoLine(t.row+1,t.column,!1),setTimeout(function(){u.focus()},300)}})})),d=$('<button type="button" class="red-ui-editor-text-help red-ui-button red-ui-button-small"><i class="fa fa-question"></i></button>').appendTo($(r).parent()),RED.popover.create({target:d,trigger:"click",size:"small",direction:"left",content:RED._("markdownEditor.format"),autoClose:50})),u.type="monaco",u}}}(),RED.eventLog=function(){var n,i=[],t=!1;return{init:function(){$('<script type="text/x-red" data-template-name="_eventLog"><div class="form-row node-text-editor-row"><div style="height: 100%;min-height: 150px;" class="node-text-editor" id="red-ui-event-log-editor"></div></div><\/script>').appendTo("#red-ui-editor-node-configs"),RED.actions.add("core:show-event-log",RED.eventLog.show)},show:function(){var e;t||(t=!0,e={title:RED._("eventLog.title"),width:1/0,buttons:[{id:"node-dialog-close",text:RED._("common.label.close"),click:function(){RED.tray.close()}}],resize:function(e){for(var t=$("#dialog-form>div:not(.node-text-editor-row)"),o=($("#dialog-form>div.node-text-editor-row"),$("#dialog-form").height()),i=0;i<t.size();i++)o-=$(t[i]).outerHeight(!0);o-=parseInt($("#dialog-form").css("marginTop"))+parseInt($("#dialog-form").css("marginBottom")),$(".node-text-editor").css("height",o+"px"),n.resize()},open:function(e){e.find(".red-ui-tray-body");e=RED.editor.buildEditForm(e.find(".red-ui-tray-body"),"dialog-form","_eventLog","editor");n=RED.editor.createEditor({mode:"ace/mode/shell",id:"red-ui-event-log-editor",value:i.join("\n"),lineNumbers:!1,readOnly:!0,options:{showPrintMargin:!1}}),setTimeout(function(){n.scrollToLine(n.getSession().getLength())},200),e.i18n()},close:function(){n.destroy(),n=null,t=!1},show:function(){}},RED.tray.show(e))},log:function(e,t){var o=new Date(t.ts).toISOString()+" ";t.type&&(o+="["+t.type+"] "),t.data&&(t=(t=t.data).endsWith("\n")?t.substring(0,t.length-1):t).split(/\n/).forEach(function(e){e=o+e,i.push(e),500<i.length&&(i=i.slice(-500)),n&&(n.getSession().insert({row:n.getSession().getLength(),column:0},"\n"+e),n.scrollToLine(n.getSession().getLength()))})},startEvent:function(e){i.push(""),i.push("-----------------------------------------------------------"),i.push((new Date).toISOString()+" "+e),i.push("")}}}(),RED.tray=function(){var h,g=[],v=!1,o=!1;function i(e){var o=$('<div class="red-ui-tray"></div>'),t=$('<div class="red-ui-tray-header editor-tray-header"></div>').appendTo(o),i=$('<div class="red-ui-tray-body-wrapper"></div>').appendTo(o),n=$('<div class="red-ui-tray-body editor-tray-body"></div>').appendTo(i),a=$('<div class="red-ui-tray-footer"></div>').appendTo(o),r=$('<div class="red-ui-tray-resize-handle"></div>').appendTo(o);e.title&&((i=g.map(function(e){return e.options.title})).push(e.title),i='<ul class="red-ui-tray-breadcrumbs"><li>'+i.join("</li><li>")+"</li></ul>",$('<div class="red-ui-tray-titlebar">'+i+"</div>").appendTo(t)),e.width===1/0&&(e.maximized=!0,r.addClass("red-ui-tray-resize-maximised"));var s,d=$('<div class="red-ui-tray-toolbar"></div>').appendTo(t);if(e.buttons)for(var l=0;l<e.buttons.length;l++){var c=e.buttons[l],p=$("<button>").button().appendTo(d);c.id&&p.attr("id",c.id),c.text&&p.text(c.text),c.click&&p.on("click",function(t){return function(e){$(this).hasClass("disabled")||t(e)}}(c.click)),c.class&&(p.addClass(c.class),"primary"===c.class&&(s=c))}o.appendTo(h);var u={tray:o,header:t,body:n,footer:a,options:e,primaryButton:s};function f(){$("#red-ui-header-shade").show(),$("#red-ui-editor-shade").show(),$("#red-ui-palette-shade").show(),$(".red-ui-sidebar-shade").show(),u.preferredWidth=Math.max(o.width(),500),e.maximized||n.css({minWidth:u.preferredWidth-40}),e.width?(e.width>$("#red-ui-editor-stack").position().left-8&&(e.width=$("#red-ui-editor-stack").position().left-8),o.width(e.width)):o.width(u.preferredWidth),u.width=o.width(),u.width>$("#red-ui-editor-stack").position().left-8&&(u.width=Math.max(0,$("#red-ui-editor-stack").position().left-8),o.width(u.width)),$("#red-ui-main-container").scrollLeft(0),o.css({right:-(o.width()+10)+"px",transition:"right 0.25s ease"}),m(),v=!0,setTimeout(function(){setTimeout(function(){e.width||o.width(Math.min(u.preferredWidth,$("#red-ui-editor-stack").position().left-8)),e.resize&&e.resize({width:o.width()}),e.show&&e.show(),setTimeout(function(){v=!1,b(),m()},200),n.find(":focusable:first").trigger("focus")},150),o.css({right:0})},0)}g.push(u),e.maximized||o.draggable({handle:r,axis:"x",start:function(e,t){o.width("auto")},drag:function(e,t){var o=h.position().left+t.position.left;o<7?t.position.left+=7-o:t.position.left>-u.preferredWidth-1&&(t.position.left=-Math.min(h.position().left-7,u.preferredWidth-1)),u.options.resize&&setTimeout(function(){u.options.resize({width:-t.position.left})},0),u.width=-t.position.left},stop:function(e,t){o.width(-t.position.left),o.css({left:""}),u.options.resize&&u.options.resize({width:-t.position.left}),u.width=-t.position.left}}),e.open?1===e.open.length?(e.open(o),f()):e.open(o,f):f()}function m(){var e,t;0<g.length&&((e=g[g.length-1]).options.maximized||e.width>$("#red-ui-editor-stack").position().left-8?(e.width=$("#red-ui-editor-stack").position().left-8,e.tray.width(e.width)):e.width<e.preferredWidth&&(e.width=Math.min($("#red-ui-editor-stack").position().left-8,e.preferredWidth),e.tray.width(e.width)),t=e.tray.height()-e.header.outerHeight()-e.footer.outerHeight(),e.body.height(t),e.options.resize&&e.options.resize({width:e.width,height:t}))}function b(){setTimeout(function(){$("#red-ui-editor-stack").css("zIndex","13")},300)}function n(){$("#red-ui-editor-stack").css("zIndex","9")}return{init:function(){h=$("#red-ui-editor-stack"),$(window).on("resize",m),RED.events.on("sidebar:resize",m),$("#red-ui-editor-shade").on("click",function(){var e;v||(e=g[g.length-1])&&e.primaryButton&&e.primaryButton.click()})},show:function(e){if(n(),e){if(o)throw new Error("Cannot add to stack whilst hidden");var t;0<g.length&&!e.overlay?(t=g[g.length-1],"inherit"===e.width&&(e.width=t.tray.width()),t.tray.css({right:-(t.tray.width()+10)+"px"}),setTimeout(function(){t.tray.detach(),i(e)},250)):(0<g.length&&g[g.length-1].tray.css("z-index",0),RED.events.emit("editor:open"),i(e))}else 0<g.length&&(g[g.length-1].tray.css({right:0}),$("#red-ui-header-shade").show(),$("#red-ui-editor-shade").show(),$("#red-ui-palette-shade").show(),$(".red-ui-sidebar-shade").show(),o=!1)},hide:function(){var e;n(),0<g.length&&((e=g[g.length-1]).tray.css({right:-(e.tray.width()+10)+"px"}),$("#red-ui-header-shade").hide(),$("#red-ui-editor-shade").hide(),$("#red-ui-palette-shade").hide(),$(".red-ui-sidebar-shade").hide(),o=!0)},resize:m,close:function(t){var o;n(),0<g.length&&((o=g.pop()).tray.css({right:-(o.tray.width()+10)+"px"}),setTimeout(function(){try{o.options.close&&o.options.close()}catch(e){}var e;o.tray.remove(),0<g.length&&((e=g[g.length-1]).options.overlay?(m(),e.options.show&&e.options.show()):(e.tray.appendTo("#red-ui-editor-stack"),setTimeout(function(){m(),e.tray.css({right:0}),e.options.show&&(b(),m(),e.options.show())},0))),t&&t(),0===g.length?($("#red-ui-header-shade").hide(),$("#red-ui-editor-shade").hide(),$("#red-ui-palette-shade").hide(),$(".red-ui-sidebar-shade").hide(),RED.events.emit("editor:close"),RED.view.focus()):g[g.length-1].tray.css("z-index","auto")},250))}}}(),RED.clipboard=function(){var u,f,o,n,c,p,s,h,e,t,a=!1,d={};function i(){u=$('<div id="red-ui-clipboard-dialog" class="hide"><form class="dialog-form form-horizontal"></form></div>').appendTo("#red-ui-editor").dialog({modal:!0,autoOpen:!1,width:700,resizable:!1,classes:{"ui-dialog":"red-ui-editor-dialog","ui-dialog-titlebar-close":"hide","ui-widget-overlay":"red-ui-editor-dialog"},buttons:[{id:"red-ui-clipboard-dialog-cancel",text:RED._("common.label.cancel"),click:function(){$(this).dialog("close"),RED.view.focus()}},{id:"red-ui-clipboard-dialog-download",class:"primary",text:RED._("clipboard.download"),click:function(){var e,t,o=$("#red-ui-clipboard-dialog-export-text").val();e="flows.json",o=o,window.navigator.msSaveBlob?(t=new Blob([o],{type:"data:text/plain;charset=utf-8"}),navigator.msSaveBlob(t,e)):((t=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(o)),t.setAttribute("download",e),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)),$(this).dialog("close"),RED.view.focus()}},{id:"red-ui-clipboard-dialog-export",class:"primary",text:RED._("clipboard.export.copy"),click:function(){var e,t,o,i,n,a,r;"red-ui-clipboard-dialog-export-tab-clipboard"===s?(e=$("#red-ui-clipboard-dialog-export-text").val(),$(this).dialog("close"),w(e),RED.notify(RED._("clipboard.nodesExported"),{id:"clipboard"}),RED.view.focus()):(t=$("#red-ui-clipboard-dialog-export-text").val(),(o=d[s].getSelected()).children||(o=o.parent),i=$("#red-ui-clipboard-dialog-tab-library-name").val().trim(),n=function(){$.ajax({url:"library/"+o.library+"/"+o.type+"/"+o.path+i,type:"POST",data:t,contentType:"application/json; charset=utf-8"}).done(function(){$(u).dialog("close"),RED.view.focus(),RED.notify(RED._("library.exportedToLibrary"),"success")}).fail(function(e,t,o){401===e.status?RED.notify(RED._("library.saveFailed",{message:RED._("user.notAuthorized")}),"error"):RED.notify(RED._("library.saveFailed",{message:e.responseText}),"error")})},o.children?(a=!1,o.children.forEach(function(e){e.label===i&&(a=!0)}),a?(u.dialog("close"),r=RED.notify(RED._("clipboard.export.exists",{file:RED.utils.sanitize(i)}),{type:"warning",fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){r.hideNotification(),u.dialog("open")}},{text:RED._("clipboard.export.overwrite"),click:function(){r.hideNotification(),n()}}]})):n()):n())}},{id:"red-ui-clipboard-dialog-ok",class:"primary",text:RED._("common.label.import"),click:function(){var e,t="red-ui-clipboard-dialog-import-opt-new"===$("#red-ui-clipboard-dialog-import-opt > a.selected").attr("id");"red-ui-clipboard-dialog-import-tab-clipboard"===s?E($("#red-ui-clipboard-dialog-import-text").val(),t):(e=d[s].getSelected()).path&&$.get("library/"+e.library+"/"+e.type+"/"+e.path,function(e){E(e,t)}),$(this).dialog("close"),RED.view.focus()}},{id:"red-ui-clipboard-dialog-import-conflict",class:"primary",text:RED._("clipboard.import.importSelected"),click:function(){var t={};$('#red-ui-clipboard-dialog-import-conflicts-list input[type="checkbox"]').each(function(){t[$(this).attr("data-node-id")]=this.checked?"import":"skip"}),$('.red-ui-clipboard-dialog-import-conflicts-controls input[type="checkbox"]').each(function(){$(this).attr("disabled")||(t[$(this).attr("data-node-id")]=this.checked?"replace":"copy")}),h.importOptions.importMap=t;var e=h.importNodes.filter(function(e){return t[e.id]&&!t[e.z]||(t[e.id]=t[e.z]),"skip"!==t[e.id]});RED.view.importNodes(e,h.importOptions),$(this).dialog("close"),RED.view.focus()}}],open:function(e,t){RED.keyboard.disable()},close:function(e){RED.keyboard.enable(),c&&(c.close(!0),p=null)}}),f=u.children(".dialog-form"),o='<div class="form-row"><label style="width:auto;margin-right: 10px;" data-i18n="common.label.export"></label><span id="red-ui-clipboard-dialog-export-rng-group" class="button-group"><a id="red-ui-clipboard-dialog-export-rng-selected" class="red-ui-button toggle" href="#" data-i18n="clipboard.export.selected"></a><a id="red-ui-clipboard-dialog-export-rng-flow" class="red-ui-button toggle" href="#" data-i18n="clipboard.export.current"></a><a id="red-ui-clipboard-dialog-export-rng-full" class="red-ui-button toggle" href="#" data-i18n="clipboard.export.all"></a></span></div><div class="red-ui-clipboard-dialog-box"><div class="red-ui-clipboard-dialog-tabs"><ul id="red-ui-clipboard-dialog-export-tabs"></ul></div><div id="red-ui-clipboard-dialog-export-tabs-content" class="red-ui-clipboard-dialog-tabs-content"><div id="red-ui-clipboard-dialog-export-tab-clipboard" class="red-ui-clipboard-dialog-tab-clipboard"><div id="red-ui-clipboard-dialog-export-tab-clipboard-tab-bar"><ul id="red-ui-clipboard-dialog-export-tab-clipboard-tabs"></ul></div><div class="red-ui-clipboard-dialog-export-tab-clipboard-tab" id="red-ui-clipboard-dialog-export-tab-clipboard-preview"><div id="red-ui-clipboard-dialog-export-tab-clipboard-preview-list"></div></div><div class="red-ui-clipboard-dialog-export-tab-clipboard-tab" id="red-ui-clipboard-dialog-export-tab-clipboard-json"><div class="form-row" style="height:calc(100% - 40px)"><textarea readonly id="red-ui-clipboard-dialog-export-text"></textarea></div><div class="form-row" style="text-align: right;"><span id="red-ui-clipboard-dialog-export-fmt-group" class="button-group"><a id="red-ui-clipboard-dialog-export-fmt-mini" class="red-ui-button red-ui-button-small toggle" href="#" data-i18n="clipboard.export.compact"></a><a id="red-ui-clipboard-dialog-export-fmt-full" class="red-ui-button red-ui-button-small toggle" href="#" data-i18n="clipboard.export.formatted"></a></span></div></div></div><div class="form-row" id="red-ui-clipboard-dialog-export-tab-library-filename"><label data-i18n="clipboard.export.exportAs"></label><input id="red-ui-clipboard-dialog-tab-library-name" type="text"></div></div></div>',n='<div class="red-ui-clipboard-dialog-box" style="margin-bottom: 12px"><div class="red-ui-clipboard-dialog-tabs"><ul id="red-ui-clipboard-dialog-import-tabs"></ul></div><div id="red-ui-clipboard-dialog-import-tabs-content" class="red-ui-clipboard-dialog-tabs-content"><div id="red-ui-clipboard-dialog-import-tab-clipboard" class="red-ui-clipboard-dialog-tab-clipboard"><div class="form-row"><span data-i18n="clipboard.pasteNodes"></span> <a class="red-ui-button" id="red-ui-clipboard-dialog-import-file-upload-btn"><i class="fa fa-upload"></i> <span data-i18n="clipboard.selectFile"></span></a><input type="file" id="red-ui-clipboard-dialog-import-file-upload" accept=".json" style="display:none"></div><div class="form-row" style="height:calc(100% - 47px)"><textarea id="red-ui-clipboard-dialog-import-text"></textarea></div></div></div></div><div class="form-row"><label style="width:auto;margin-right: 10px;" data-i18n="clipboard.import.import"></label><span id="red-ui-clipboard-dialog-import-opt" class="button-group"><a id="red-ui-clipboard-dialog-import-opt-current" class="red-ui-button toggle selected" href="#" data-i18n="clipboard.export.current"></a><a id="red-ui-clipboard-dialog-import-opt-new" class="red-ui-button toggle" href="#" data-i18n="clipboard.import.newFlow"></a></span></div>',importConflictsDialog='<div class="form-row"><div class="form-row"><p data-i18n="clipboard.import.conflictNotification1"></p><p data-i18n="clipboard.import.conflictNotification2"></p></div><div class="red-ui-clipboard-dialog-import-conflicts-list-container"><div id="red-ui-clipboard-dialog-import-conflicts-list"></div></div></div>'}function r(){e&&clearTimeout(e),e=setTimeout(function(){var e=$("#red-ui-clipboard-dialog-tab-library-name"),t=e.val().trim();0<t.length&&!/[\/\\]/.test(t)?(e.removeClass("input-error"),$("#red-ui-clipboard-dialog-export").button("enable")):(e.addClass("input-error"),$("#red-ui-clipboard-dialog-export").button("disable"))},100)}function l(){var e;"red-ui-clipboard-dialog-import-tab-clipboard"===s?(t&&clearTimeout(t),t=setTimeout(function(){var t=$("#red-ui-clipboard-dialog-import-text");if(""===(n=t.val().trim()))return c.close(!0),p=null,t.removeClass("input-error"),void $("#red-ui-clipboard-dialog-ok").button("disable");try{if(!/^\[[\s\S]*\]$/m.test(n))throw new Error(RED._("clipboard.import.errors.notArray"));for(var e=JSON.parse(n),o=0;o<e.length;o++){if("object"!=typeof e[o])throw new Error(RED._("clipboard.import.errors.itemNotObject",{index:o}));if(!e[o].hasOwnProperty("id"))throw new Error(RED._("clipboard.import.errors.missingId",{index:o}));if(!e[o].hasOwnProperty("type"))throw new Error(RED._("clipboard.import.errors.missingType",{index:o}))}p=null,c.close(!0),t.removeClass("input-error"),t.val(n),$("#red-ui-clipboard-dialog-ok").button("enable")}catch(e){if(""!==n){t.addClass("input-error");var i=e.toString();if(i!==p){var n,a=$('<div class="red-ui-clipboard-import-error"></div>').text(i),r=/at position (\d+)/i.exec(i);if(r)l=parseInt(r[1]);else if(r=/at line (\d+) column (\d+)/i.exec(i)){for(var s=parseInt(r[1])-1,t=parseInt(r[2])-1,d=n.split("\n"),l=0,o=0;o<s;o++)l+=d[o].length+1;l+=t}void 0!==l&&(n=n.replace(/\n/g,"↵"),parseInt(r[1]),r=$("<div>").appendTo(a),r=$("<pre>").appendTo(r),$("<span>").text(n.substring(l-12,l)).appendTo(r),$('<span class="error">').text(n.charAt(l)).appendTo(r),$("<span>").text(n.substring(l+1,l+12)).appendTo(r)),c.close(!0).setContent(a).open(),p=i}}else p=null;$("#red-ui-clipboard-dialog-ok").button("disable")}},100)):(e=d[s].getSelected())&&e.label&&!e.children?$("#red-ui-clipboard-dialog-ok").button("enable"):$("#red-ui-clipboard-dialog-ok").button("disable")}function g(e){var i,t;a||(e=e||"clipboard",f.empty(),f.append($(n)),(i=RED.tabs.create({id:"red-ui-clipboard-dialog-import-tabs",vertical:!0,onchange:function(e){$("#red-ui-clipboard-dialog-import-tabs-content").children().hide(),$("#"+e.id).show(),s=e.id,c&&(c.close(!0),p=null),"red-ui-clipboard-dialog-import-tab-clipboard"===e.id?$("#red-ui-clipboard-dialog-import-text").trigger("focus"):d[e.id].focus(),l()}})).addTab({id:"red-ui-clipboard-dialog-import-tab-clipboard",label:RED._("clipboard.clipboard")}),(RED.settings.libraries||[]).forEach(function(e){var t="red-ui-clipboard-dialog-import-tab-"+e.id;i.addTab({id:t,label:RED._(e.label||e.id)});var o=$('<div id="red-ui-clipboard-dialog-import-tab-library" class="red-ui-clipboard-dialog-tab-library"></div>').attr("id",t).hide().appendTo("#red-ui-clipboard-dialog-import-tabs-content"),o=RED.library.createBrowser({container:o,onselect:function(e){e&&e.label&&!e.children?$("#red-ui-clipboard-dialog-ok").button("enable"):$("#red-ui-clipboard-dialog-ok").button("disable")},onconfirm:function(e){e&&e.label&&!e.children&&$("#red-ui-clipboard-dialog-ok").trigger("click")}});b(o,e),d[t]=o}),$("#red-ui-clipboard-dialog-tab-library-name").on("keyup",r),$("#red-ui-clipboard-dialog-tab-library-name").on("paste",function(){setTimeout(r,10)}),$("#red-ui-clipboard-dialog-export").button("enable"),f.i18n(),$("#red-ui-clipboard-dialog-ok").show(),$("#red-ui-clipboard-dialog-cancel").show(),$("#red-ui-clipboard-dialog-export").hide(),$("#red-ui-clipboard-dialog-download").hide(),$("#red-ui-clipboard-dialog-import-conflict").hide(),$("#red-ui-clipboard-dialog-ok").button("disable"),$("#red-ui-clipboard-dialog-import-text").on("keyup",l),$("#red-ui-clipboard-dialog-import-text").on("paste",function(){setTimeout(l,10)}),0===RED.workspaces.active()?($("#red-ui-clipboard-dialog-import-opt-current").addClass("disabled").removeClass("selected"),$("#red-ui-clipboard-dialog-import-opt-new").addClass("selected")):($("#red-ui-clipboard-dialog-import-opt-current").removeClass("disabled").addClass("selected"),$("#red-ui-clipboard-dialog-import-opt-new").removeClass("selected")),$("#red-ui-clipboard-dialog-import-opt > a").on("click",function(e){e.preventDefault(),$(this).hasClass("disabled")||$(this).hasClass("selected")||($(this).parent().children().removeClass("selected"),$(this).addClass("selected"))}),$("#red-ui-clipboard-dialog-import-file-upload").on("change",function(){var e=new FileReader;e.onload=function(){$("#red-ui-clipboard-dialog-import-text").val(e.result),l()},e.readAsText($(this).prop("files")[0])}),$("#red-ui-clipboard-dialog-import-file-upload-btn").on("click",function(e){e.preventDefault(),$("#red-ui-clipboard-dialog-import-file-upload").trigger("click")}),i.activateTab("red-ui-clipboard-dialog-import-tab-"+e),"clipboard"===e&&setTimeout(function(){$("#red-ui-clipboard-dialog-import-text").trigger("focus")},100),t=400,(e=$(window).height())<600&&(t=400-(600-e)),$(".red-ui-clipboard-dialog-box").height(t),u.dialog("option","title",RED._("clipboard.importNodes")).dialog("option","width",700).dialog("open"),c=RED.popover.create({target:$("#red-ui-clipboard-dialog-import-text"),trigger:"manual",direction:"bottom",content:""}))}function v(e){var i,n,t;a||(e=e||"clipboard",f.empty(),f.append($(o)),(i=RED.tabs.create({id:"red-ui-clipboard-dialog-export-tabs",vertical:!0,onchange:function(e){$("#red-ui-clipboard-dialog-export-tabs-content").children().hide(),$("#"+e.id).show(),s=e.id,"red-ui-clipboard-dialog-export-tab-clipboard"===e.id?($("#red-ui-clipboard-dialog-export").button("option","label",RED._("clipboard.export.copy")),$("#red-ui-clipboard-dialog-download").show(),$("#red-ui-clipboard-dialog-export-tab-library-filename").hide()):($("#red-ui-clipboard-dialog-export").button("option","label",RED._("clipboard.export.export")),$("#red-ui-clipboard-dialog-download").hide(),$("#red-ui-clipboard-dialog-export-tab-library-filename").show(),d[s].focus())}})).addTab({id:"red-ui-clipboard-dialog-export-tab-clipboard",label:RED._("clipboard.clipboard")}),(RED.settings.libraries||[]).forEach(function(e){var t,o;e.readOnly||(t="red-ui-clipboard-dialog-export-tab-library-"+e.id,i.addTab({id:t,label:RED._(e.label||e.id)}),o=$('<div class="red-ui-clipboard-dialog-export-tab-library-browser red-ui-clipboard-dialog-tab-library"></div>').attr("id",t).hide().insertBefore("#red-ui-clipboard-dialog-export-tab-library-filename"),b(o=RED.library.createBrowser({container:o,folderTools:!0,onselect:function(e){e&&e.label&&!e.children&&$("#red-ui-clipboard-dialog-tab-library-name").val(e.label)}}),e),d[t]=o)}),$("#red-ui-clipboard-dialog-tab-library-name").on("keyup",r),$("#red-ui-clipboard-dialog-tab-library-name").on("paste",function(){setTimeout(r,10)}),$("#red-ui-clipboard-dialog-export").button("enable"),(t=RED.tabs.create({id:"red-ui-clipboard-dialog-export-tab-clipboard-tabs",onchange:function(e){$(".red-ui-clipboard-dialog-export-tab-clipboard-tab").hide(),$("#"+e.id).show()}})).addTab({id:"red-ui-clipboard-dialog-export-tab-clipboard-preview",label:RED._("clipboard.exportNodes")}),t.addTab({id:"red-ui-clipboard-dialog-export-tab-clipboard-json",label:RED._("editor.types.json")}),$("#red-ui-clipboard-dialog-export-tab-clipboard-preview-list").css({position:"absolute",top:0,right:0,bottom:0,left:0}).treeList({data:[]}),m(),$("#red-ui-clipboard-dialog-tab-library-name").val("flows.json").select(),f.i18n(),n=RED.settings.flowFilePretty?"red-ui-clipboard-dialog-export-fmt-full":"red-ui-clipboard-dialog-export-fmt-mini",$("#red-ui-clipboard-dialog-export-fmt-group > a").on("click",function(e){var t;e.preventDefault(),$(this).hasClass("disabled")||$(this).hasClass("selected")?$("#red-ui-clipboard-dialog-export-text").trigger("focus"):($(this).parent().children().removeClass("selected"),$(this).addClass("selected"),0<(t=$("#red-ui-clipboard-dialog-export-text").val()).length&&(e=JSON.parse(t),t="red-ui-clipboard-dialog-export-fmt-full"===(n=$(this).attr("id"))?JSON.stringify(e,null,4):JSON.stringify(e),$("#red-ui-clipboard-dialog-export-text").val(t),setTimeout(function(){$("#red-ui-clipboard-dialog-export-text").scrollTop(0)},50),$("#red-ui-clipboard-dialog-export-text").trigger("focus")))}),$("#red-ui-clipboard-dialog-export-rng-group > a").on("click",function(e){var t,o,i;e.preventDefault(),$(this).hasClass("disabled")||$(this).hasClass("selected")||($(this).parent().children().removeClass("selected"),$(this).addClass("selected"),t=$(this).attr("id").substring("red-ui-clipboard-dialog-export-rng-".length),e="",o=null,"selected"===t?(0<(i=RED.workspaces.selection()).length?(o=[],i.forEach(function(e){o.push(e),o=(o=o.concat(RED.nodes.groups(e.id))).concat(RED.nodes.filterNodes({z:e.id}))})):o=RED.view.selection().nodes||[],o=RED.nodes.createExportableNodeSet(o.filter(function(e){return"subflow"!==e.type}))):"flow"===t?(i=RED.workspaces.active(),o=(o=RED.nodes.groups(i)).concat(RED.nodes.filterNodes({z:i})),RED.nodes.eachConfig(function(e){e.z===RED.workspaces.active()&&!1===e._def.hasUsers&&o.push(e)}),i=RED.nodes.workspace(i)||RED.nodes.subflow(i),o.unshift(i),o=RED.nodes.createExportableNodeSet(o)):"full"===t&&(o=RED.nodes.createCompleteNodeSet(!1)),0<(e=null!==o?"red-ui-clipboard-dialog-export-fmt-full"===n?JSON.stringify(o,null,4):JSON.stringify(o):e).length?$("#red-ui-clipboard-dialog-export").removeClass("disabled"):$("#red-ui-clipboard-dialog-export").addClass("disabled"),$("#red-ui-clipboard-dialog-export-text").val(e),setTimeout(function(){$("#red-ui-clipboard-dialog-export-text").scrollTop(0),m(t)},50))}),$("#red-ui-clipboard-dialog-ok").hide(),$("#red-ui-clipboard-dialog-cancel").hide(),$("#red-ui-clipboard-dialog-export").hide(),$("#red-ui-clipboard-dialog-import-conflict").hide(),0===RED.workspaces.active()?($("#red-ui-clipboard-dialog-export-rng-selected").addClass("disabled").removeClass("selected"),$("#red-ui-clipboard-dialog-export-rng-flow").addClass("disabled").removeClass("selected"),$("#red-ui-clipboard-dialog-export-rng-full").trigger("click")):0<RED.workspaces.selection().length||RED.view.selection().nodes?$("#red-ui-clipboard-dialog-export-rng-selected").trigger("click"):($("#red-ui-clipboard-dialog-export-rng-selected").addClass("disabled").removeClass("selected"),$("#red-ui-clipboard-dialog-export-rng-flow").trigger("click")),("red-ui-clipboard-dialog-export-fmt-full"===n?$("#red-ui-clipboard-dialog-export-fmt-full"):$("#red-ui-clipboard-dialog-export-fmt-mini")).trigger("click"),i.activateTab("red-ui-clipboard-dialog-export-tab-"+e),t=400,(e=$(window).height())<600&&(t=400-(600-e)),$(".red-ui-clipboard-dialog-box").height(t),u.dialog("option","title",RED._("clipboard.exportNodes")).dialog("option","width",700).dialog("open"),$("#red-ui-clipboard-dialog-export-text").trigger("focus"),$("#red-ui-clipboard-dialog-cancel").show(),$("#red-ui-clipboard-dialog-export").show(),$("#red-ui-clipboard-dialog-download").show(),$("#red-ui-clipboard-dialog-import-conflict").hide())}function m(t){var e=$("#red-ui-clipboard-dialog-export-text").val()||"[]",e=JSON.parse(e),o={},i={},n=[],a=[],r=[];e.forEach(function(e){"tab"===e.type?(o[e.id]={element:x(e),deferBuild:"flow"!==t,expanded:"flow"===t,children:[]},a.push(o[e.id])):"subflow"===e.type?(i[e.id]={element:R(e),deferBuild:!0,children:[]},r.push(i[e.id])):n.push(e)});var s=[],d=[];n.forEach(function(e){var t={element:R(e)};e.z?o[e.z]||i[e.z]?o[e.z]?o[e.z].children.push(t):i[e.z]&&i[e.z].children.push(t):d.push(t):s.push(t)});e=[];0<d.length&&(e=e.concat(d)),"flow"===t?e=e.concat(a):0<a.length&&e.push({label:RED._("menu.label.flows"),deferBuild:20<a.length,expanded:a.length<=20,children:a}),0<r.length&&e.push({label:RED._("menu.label.subflows"),deferBuild:10<r.length,expanded:r.length<=10,children:r}),0<s.length&&e.push({label:RED._("sidebar.info.globalConfig"),deferBuild:10<s.length,expanded:s.length<=10,children:s}),$("#red-ui-clipboard-dialog-export-tab-clipboard-preview-list").treeList("data",e)}function b(e,i){var t,o="fa fa-hdd-o";i.icon&&(o=("font-awesome"===(t=RED.utils.separateIconPath(i.icon)).module?"fa ":"")+t.file),e.data([{library:i.id,type:"flows",icon:o,label:RED._(i.label||i.id),path:"",expanded:!0,children:[{library:i.id,type:"flows",icon:"fa fa-cube",label:"flows",path:"",expanded:!0,children:function(t,o){RED.library.loadLibraryFolder(i.id,"flows","",function(e){o.children=e,t(e)})}}]}],!0)}function y(){$("#red-ui-drop-target").hide()}function w(e,t,o){var i=!1,n=document.activeElement;"string"!=typeof e&&(e=JSON.stringify(e,function(e,t){if(null!==t&&"object"==typeof t&&t.__enc__){if(t.hasOwnProperty("data")&&t.hasOwnProperty("length"))return i=t.data.length!==t.length,t.data;if("function"===t.type||"internal"===t.type)return;if("number"===t.type)return null;if("bigint"===t.type)return t.data.toString();if("undefined"===t.type)return}return t})),i&&(o+="_truncated"),navigator.clipboard.writeText(e).then(function(){var e;t&&(e=RED.popover.create({target:t,direction:"left",size:"small",content:RED._(o)}),setTimeout(function(){e.close()},1e3),e.open()),n&&$(n).focus()}).catch(e=>{console.error("Failed to copy:",e)})}function E(t,o){var i=t;if("string"==typeof t)try{if(0===(t=t.trim()).length)return;i=JSON.parse(t)}catch(e){t=new Error(RED._("clipboard.invalidFlow",{message:e.message}));throw t.code="NODE_RED",t}var n,a,r,s,o={generateIds:!1,addFlow:o};try{RED.view.importNodes(i,o)}catch(e){n=e.importConfig,a=i,r=o,s=RED.notify("<p>"+RED._("clipboard.import.conflictNotification1")+"</p>",{type:"info",fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){s.close()}},{text:RED._("clipboard.import.viewNodes"),click:function(){s.close(),function(i,e,t){var o,n;h={importConfig:i,importNodes:e,importOptions:t};var a,r=[],s=!1;for(o in i.subflows)i.subflows.hasOwnProperty(o)&&(s||(r.push({gutter:$('<span data-i18n="menu.label.subflows"></span>'),label:"",class:"red-ui-clipboard-dialog-import-conflicts-item-header"}),s=!0),n=i.subflows[o],d=i.conflicted[n.id],c=D(n,d,l=!d),a={id:n.id,gutter:c.gutter.element,element:c.element,class:l?"":"disabled",deferBuild:!0,children:[]},r.push(a),i.zMap[o]&&i.zMap[o].forEach(function(e){var t=D(e,i.conflicted[e.id],l,c.gutter.cb);a.children.push({id:e.id,gutter:t.gutter.element,element:t.element,class:l?"":"disabled"})}));for(o in s=!1,i.tabs){var d,l,c;i.tabs.hasOwnProperty(o)&&(s||(r.push({gutter:$('<span data-i18n="menu.label.flows"></span>'),label:"",class:"red-ui-clipboard-dialog-import-conflicts-item-header"}),s=!0),n=i.tabs[o],d=i.conflicted[n.id],c=D(n,d,l=!0),a={id:n.id,gutter:c.gutter.element,element:c.element,icon:"red-ui-icons red-ui-icons-flow",deferBuild:!0,class:l?"":"disabled",children:[]},r.push(a),i.zMap[o]&&i.zMap[o].forEach(function(e){var t=D(e,i.conflicted[e.id],l,c.gutter.cb);a.children.push({id:e.id,gutter:t.gutter.element,element:t.element,class:l?"":"disabled"})}))}s=!1;var p=[];i.all.forEach(function(e){var t,o;"tab"===e.type||"subflow"===e.type||i.tabs[e.z]||i.subflows[e.z]||(t=D(e,t=i.conflicted[e.id],o=!t||!i.configs[e.id]),o={id:e.id,gutter:t.gutter.element,element:t.element,class:o?"":"disabled"},i.configs[e.id]?p.push(o):(s||(r.push({gutter:$('<span data-i18n="menu.label.nodes"></span>'),label:"",class:"red-ui-clipboard-dialog-import-conflicts-item-header"}),s=!0),r.push(o)))}),0<p.length&&(r.push({gutter:$('<span data-i18n="menu.label.displayConfig"></span>'),label:"",class:"red-ui-clipboard-dialog-import-conflicts-item-header"}),s=!0,r=r.concat(p));f.empty(),f.append($(importConflictsDialog));$("#red-ui-clipboard-dialog-import-conflicts-list").css({position:"absolute",top:0,right:0,bottom:0,left:0}).treeList({data:r});f.i18n();e=400,t=$(window).height();t<600&&(e=400-(600-t));$(".red-ui-clipboard-dialog-box").height(e),$("#red-ui-clipboard-dialog-ok").hide(),$("#red-ui-clipboard-dialog-cancel").show(),$("#red-ui-clipboard-dialog-export").hide(),$("#red-ui-clipboard-dialog-download").hide(),$("#red-ui-clipboard-dialog-import-conflict").show(),u.dialog("option","title",RED._("clipboard.importNodes")).dialog("option","width",500).dialog("open")}(n,a,r)}},{text:RED._("clipboard.import.importCopy"),click:function(){s.close(),r.generateIds=!0,RED.view.importNodes(a,r)}}]})}}function D(e,t,o,i){var n="tab"===e.type?x(e):R(e),a=$("<div>",{class:"red-ui-clipboard-dialog-import-conflicts-controls"}).appendTo(n);return a.on("click",function(e){e.stopPropagation()}),t&&!i&&(a=$("<label><input "+(o?"":"disabled ")+'type="checkbox" data-node-id="'+e.id+'"> <span data-i18n="clipboard.import.replace"></span></label>').appendTo(a),("tab"===e.type||"subflow"!==e.type&&e.hasOwnProperty("x")&&e.hasOwnProperty("y"))&&a.hide()),{element:n,gutter:function(e,t,o){var i=$("<label>",{class:"red-ui-clipboard-dialog-import-conflicts-gutter"}),t=$('<input data-node-id="'+e.id+'" type="checkbox" '+(t?"checked":"")+">").appendTo(i);o&&(t.attr("disabled",!0),o.addChild(t));i.on("click",function(e){e.stopPropagation()}),t.on("change",function(e){var t=this.checked;i.parent().toggleClass("disabled",!t),i.parent().find('.red-ui-clipboard-dialog-import-conflicts-controls  input[type="checkbox"]').attr("disabled",!t),n.forEach(function(e){e.attr("checked",t),e.trigger("change")})});var n=[];return{cb:{addChild:function(e){n.push(e)}},element:i}}(e,o,i)}}function x(e){(e=JSON.parse(JSON.stringify(e)))._def=RED.nodes.getType(e.type)||{},e._def&&(e._=e._def._);var t=$("<div>",{class:"red-ui-info-outline-item red-ui-info-outline-item-flow"}),o=$("<div>",{class:"red-ui-search-result-description red-ui-info-outline-item-label"}).appendTo(t),i="string"==typeof e?e:e.label,e=i.indexOf("\\n");return-1<e&&(i=i.substring(0,e)+"..."),o.text(i),t}function R(e){(e=JSON.parse(JSON.stringify(e)))._def=RED.nodes.getType(e.type)||{},e._def&&(e._=e._def._);var t=$("<div>",{class:"red-ui-node-list-item"});return RED.utils.createNodeIcon(e,!0).appendTo(t),t}return{init:function(){i(),RED.actions.add("core:show-export-dialog",v),RED.actions.add("core:show-import-dialog",g),RED.actions.add("core:show-library-export-dialog",function(){v("library")}),RED.actions.add("core:show-library-import-dialog",function(){g("library")}),RED.actions.add("core:show-examples-import-dialog",function(){g("examples")}),RED.events.on("editor:open",function(){a=!0}),RED.events.on("editor:close",function(){a=!1}),RED.events.on("search:open",function(){a=!0}),RED.events.on("search:close",function(){a=!1}),RED.events.on("actionList:open",function(){a=!0}),RED.events.on("actionList:close",function(){a=!1}),RED.events.on("type-search:open",function(){a=!0}),RED.events.on("type-search:close",function(){a=!1}),$('<div id="red-ui-drop-target"><div data-i18n="[append]workspace.dropFlowHere"><i class="fa fa-download"></i><br></div></div>').appendTo("#red-ui-editor"),RED.keyboard.add("#red-ui-drop-target","escape",y),$("#red-ui-workspace-chart").on("dragenter",function(e){-1==$.inArray("text/plain",e.originalEvent.dataTransfer.types)&&-1==$.inArray("Files",e.originalEvent.dataTransfer.types)||$("#red-ui-drop-target").css({display:"table"}).focus()}),$("#red-ui-drop-target").on("dragover",function(e){-1==$.inArray("text/plain",e.originalEvent.dataTransfer.types)&&-1==$.inArray("Files",e.originalEvent.dataTransfer.types)||e.preventDefault()}).on("dragleave",function(e){y()}).on("drop",function(e){try{var t,o,i,n;-1!=$.inArray("text/plain",e.originalEvent.dataTransfer.types)?E(t=(t=e.originalEvent.dataTransfer.getData("text/plain")).substring(t.indexOf("["),t.lastIndexOf("]")+1)):-1==$.inArray("Files",e.originalEvent.dataTransfer.types)||1===(o=e.originalEvent.dataTransfer.files).length&&(i=o[0],(n=new FileReader).onload=function(e){E(e.target.result)},n.readAsText(i))}catch(e){}y(),e.preventDefault()})},import:g,export:v,copyText:w}}(),RED.library=function(){var a,c,r,p,e;function s(i,n,a,t){$.getJSON("library/"+i+"/"+n+"/"+a,function(e){e=e.map(function(e){return"string"==typeof e?{library:i,type:n,icon:"fa fa-folder",label:e,path:a+e+"/",children:function(t,o){s(i,n,a+e+"/",function(e){o.children=e,t(e)})}}:{library:i,type:n,icon:"fa fa-file-o",label:e.fn,path:a+e.fn,props:e}});e.sort(function(e,t){return e.children&&!t.children?-1:!e.children&&t.children?1:e.label.localeCompare(t.label)}),t(e)})}function t(t){e&&clearTimeout(e),e=setTimeout(function(){var e=t.val().trim();0<e.length&&!/[\/\\]/.test(e)?(t.removeClass("input-error"),$("#red-ui-library-dialog-save-button").button("enable")):(t.addClass("input-error"),$("#red-ui-library-dialog-save-button").button("disable"))},100)}return{init:function(){$('<div id="red-ui-library-dialog-save" class="hide"><form class="form-horizontal"><div class="red-ui-library-dialog-box" style="height: 400px; position:relative; "><div id="red-ui-library-dialog-save-browser"></div><div class="form-row"><label data-i18n="clipboard.export.exportAs"></label><input id="red-ui-library-dialog-save-filename" type="text"></div></div></form></div>').appendTo("#red-ui-editor").i18n(),$('<div id="red-ui-library-dialog-load" class="hide"><form class="form-horizontal"><div class="red-ui-library-dialog-box" style="height: 400px; position:relative; "><div id="red-ui-library-dialog-load-panes"><div class="red-ui-panel" id="red-ui-library-dialog-load-browser"></div><div class="red-ui-panel"><div id="red-ui-library-dialog-load-preview"><div class="red-ui-panel" id="red-ui-library-dialog-load-preview-text" style="position:relative; height: 50%; overflow-y: hidden;"></div><div class="red-ui-panel" id="red-ui-library-dialog-load-preview-details"><table id="red-ui-library-dialog-load-preview-details-table" class="red-ui-info-table"></table></div></div></div></div></div></form></div>').appendTo("#red-ui-editor").i18n(),$("#red-ui-library-dialog-save").dialog({title:RED._("library.saveToLibrary"),modal:!0,autoOpen:!1,width:800,resizable:!1,open:function(e,t){RED.keyboard.disable()},close:function(e,t){RED.keyboard.enable()},classes:{"ui-dialog":"red-ui-editor-dialog","ui-dialog-titlebar-close":"hide","ui-widget-overlay":"red-ui-editor-dialog"},buttons:[{text:RED._("common.label.cancel"),click:function(){$(this).dialog("close")}},{id:"red-ui-library-dialog-save-button",text:RED._("common.label.save"),class:"primary",click:function(){!function(){var e=p.elementPrefix||"node-input-",t=$("#"+e+"name").val().trim();""===t&&(t=RED._("library.unnamedType",{type:p.type}));var o=$("#red-ui-library-dialog-save-filename").val().trim(),i=c.getSelected();i.children||(i=i.parent);for(var n,a,r={},s=0;s<p.fields.length;s++){var d=p.fields[s];"name"===d?r.name=t:"object"==typeof d?r[d.name]=d.get():r[d]=$("#"+e+d).val()}function l(){$.ajax({url:"library/"+i.library+"/"+i.type+"/"+i.path+o,type:"POST",data:JSON.stringify(r),contentType:"application/json; charset=utf-8"}).done(function(e,t,o){RED.notify(RED._("library.savedType",{type:p.type}),"success")}).fail(function(e,t,o){401===e.status?RED.notify(RED._("library.saveFailed",{message:RED._("user.notAuthorized")}),"error"):RED.notify(RED._("library.saveFailed",{message:e.responseText}),"error")})}r.text=p.editor.getValue(),i.children?(n=!1,i.children.forEach(function(e){e.label===o&&(n=!0)}),n?($("#red-ui-library-dialog-save").dialog("close"),a=RED.notify(RED._("clipboard.export.exists",{file:RED.utils.sanitize(o)}),{type:"warning",fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){a.hideNotification(),$("#red-ui-library-dialog-save").dialog("open")}},{text:RED._("clipboard.export.overwrite"),click:function(){a.hideNotification(),l()}}]})):l()):l()}(),$(this).dialog("close")}}]}),c=RED.library.createBrowser({container:$("#red-ui-library-dialog-save-browser"),folderTools:!0,onselect:function(e){e.label&&(e.children||($("#red-ui-library-dialog-save-filename").val(e.label),e=e.parent),!1===e.writable?$("#red-ui-library-dialog-save-button").button("disable"):$("#red-ui-library-dialog-save-button").button("enable"))}}),$("#red-ui-library-dialog-save-filename").on("keyup",function(){t($(this))}),$("#red-ui-library-dialog-save-filename").on("paste",function(){var e=$(this);setTimeout(function(){t(e)},10)}),$("#red-ui-library-dialog-load").dialog({modal:!0,autoOpen:!1,width:800,resizable:!1,classes:{"ui-dialog":"red-ui-editor-dialog","ui-dialog-titlebar-close":"hide","ui-widget-overlay":"red-ui-editor-dialog"},buttons:[{text:RED._("common.label.cancel"),click:function(){$(this).dialog("close")}},{text:RED._("common.label.load"),class:"primary",click:function(){if(selectedLibraryItem){for(var e=p.elementPrefix||"node-input-",t=0;t<p.fields.length;t++){var o,i=p.fields[t];"object"==typeof i?(o=selectedLibraryItem[i.name],i.set(o)):$("#"+e+i).val(selectedLibraryItem[i])}p.editor.setValue(r.getValue(),-1)}$(this).dialog("close")}}],open:function(e){RED.keyboard.disable(),$(this).parent().find(".ui-dialog-titlebar-close").hide(),r.resize()},close:function(e){RED.keyboard.enable(),r&&(r.destroy(),r=null)}}),a=RED.library.createBrowser({container:$("#red-ui-library-dialog-load-browser"),onselect:function(i){var n=$("#red-ui-library-dialog-load-preview-details-table").empty();selectedLibraryItem=i.props,i&&i.label&&!i.children?$.get("library/"+i.library+"/"+i.type+"/"+i.path,function(e){var t,o=$('<tr class="red-ui-help-info-row"><td>Type</td><td></td></tr>').appendTo(n);for(t in $(o.children()[1]).text(p.type),i.props.hasOwnProperty("name")&&(o=$('<tr class="red-ui-help-info-row"><td>Name</td><td>'+i.props.name+"</td></tr>").appendTo(n),$(o.children()[1]).text(i.props.name)),i.props)i.props.hasOwnProperty(t)&&"name"!==t&&"fn"!==t&&(o=$('<tr class="red-ui-help-info-row"><td></td><td></td></tr>').appendTo(n),$(o.children()[0]).text(t),RED.utils.createObjectElement(i.props[t]).appendTo(o.children()[1]));r.setValue(e,-1)}):r.setValue("",-1)}}),RED.panels.create({container:$("#red-ui-library-dialog-load-panes"),dir:"horizontal",resize:function(){r.resize()}}),RED.panels.create({container:$("#red-ui-library-dialog-load-preview"),dir:"vertical",resize:function(){r.resize()}})},create:function(i){var n=i.elementPrefix||"node-input-";i.editor.setText&&(i.editor.setValue=function(e,t){i.editor.setText.call(i.editor,e)}),i.editor.getText&&(i.editor.getValue=i.editor.getText),$("#"+n+"name").css("width","calc(100% - 52px)").after('<div style="margin-left:5px; display: inline-block;position: relative;"><a id="node-input-'+i.type+'-lookup" class="red-ui-button"><i class="fa fa-book"></i> <i class="fa fa-caret-down"></i></a></div>'),RED.menu.init({id:"node-input-"+i.type+"-lookup",options:[{id:"node-input-"+i.type+"-menu-open-library",label:RED._("library.openLibrary"),onselect:function(){var e={id:"red-ui-library-dialog-load-preview-text",mode:i.mode,readOnly:!0,highlightActiveLine:!1,highlightGutterLine:!1,contextmenu:!1};(r=RED.editor.createEditor(e)).isACE&&(i.mode&&r.getSession().setMode(i.mode),r.setOptions({readOnly:!0,highlightActiveLine:!1,highlightGutterLine:!1}),r.renderer.$cursorLayer.element.style.opacity=0,r.$blockScrolling=1/0),p=i;var t=[];(RED.settings.libraries||[]).forEach(function(e){e.types&&-1===e.types.indexOf(i.url)||t.push({library:e.id,type:i.url,icon:e.icon||"fa fa-hdd-o",label:RED._(e.label||e.id),path:"",expanded:!0,writable:!1,children:[{library:e.id,type:i.url,icon:"fa fa-cube",label:i.type,path:"",expanded:!1,children:function(t,o){s(e.id,i.url,"",function(e){o.children=e,t(e)})}}]})}),a.data(t),setTimeout(function(){a.select(t[0].children[0])},200);var o=400,e=$(window).height();e<570&&(o=400-(570-e)),$("#red-ui-library-dialog-load .red-ui-library-dialog-box").height(o),$("#red-ui-library-dialog-load").dialog("option","title",RED._("library.typeLibrary",{type:i.type})).dialog("open")}},{id:"node-input-"+i.type+"-menu-save-library",label:RED._("library.saveToLibrary"),onselect:function(){p=i;var e=$("#"+n+"name").val().replace(/(^\s*)|(\s*$)/g,"").replace(/[^\w-]/g,"-");""===e&&(e="unnamed-"+i.type),$("#red-ui-library-dialog-save-filename").attr("value",e+"."+(i.ext||"txt"));var t=[];(RED.settings.libraries||[]).forEach(function(e){e.types&&-1===e.types.indexOf(i.url)||t.push({library:e.id,type:i.url,icon:e.icon||"fa fa-hdd-o",label:RED._(e.label||e.id),path:"",expanded:!0,writable:!1,children:[{library:e.id,type:i.url,icon:"fa fa-cube",label:i.type,path:"",expanded:!1,children:function(t,o){s(e.id,i.url,"",function(e){o.children=e,t(e)})}}]})}),c.data(t),setTimeout(function(){c.select(t[0].children[0])},200);var o=400,e=$(window).height();e<570&&(o=400-(570-e)),$("#red-ui-library-dialog-save .red-ui-library-dialog-box").height(o),$("#red-ui-library-dialog-save").dialog("open")}}]})},createBrowser:function(o){var e=$('<div class="red-ui-library-browser"></div>').appendTo(o.container),i=$("<div>").css({width:"100%",height:"100%"}).appendTo(e).treeList({}).on("treelistselect",function(e,t){o.onselect&&o.onselect(t)}).on("treelistconfirm",function(e,t){o.onconfirm&&o.onconfirm(t)}),n=$("<div>").css({position:"absolute",bottom:"6px",right:"8px"}),a=$('<button class="red-ui-button red-ui-button-small" type="button"><i class="fa fa-ellipsis-h"></i></button>').on("click",function(e){e.preventDefault(),e.stopPropagation();var t=a.offset(),e=RED.menu.init({id:"red-ui-library-browser-menu",options:[{id:"red-ui-library-browser-menu-addFolder",label:RED._("library.newFolder"),onselect:function(){var o="new-folder",r={},s=i.treeList("selected");(s=!s.children?s.parent:s).treeList.expand(function(){s.children.forEach(function(e){/^new-folder/.test(e.label)&&(r[e.label]=!0)});for(var e=2;r[o];)o="new-folder-"+e++;s.treeList.expand();function t(){var e=n.val().trim();if(""!==e){for(var t=0;t<s.children.length;t++)if(s.children[t].label===e)return i(),0;a.treeList.remove();var o={library:s.library,type:s.type,icon:"fa fa-folder",children:[],label:e,path:a.path+e+"/"};s.treeList.addChild(o,!0)}else i()}function i(){a.treeList.remove()}var n=$('<input type="text" class="red-ui-treeList-input">').val(o),a={icon:"fa fa-folder-o",children:[],path:s.path,element:n};n.on("keydown",function(e){e.stopPropagation(),13===e.keyCode?t():27===e.keyCode&&i()}),n.on("blur",function(){t()}),s.treeList.addChild(a),setTimeout(function(){n.trigger("focus"),n.select()},400)})}}]}).on("mouseleave",function(){$(this).remove(),i.focus()}).on("mouseup",function(){var e=$(this);e.hide(),i.focus(),setTimeout(function(){e.remove()},100)}).appendTo("body");e.css({position:"absolute",top:t.top+"px",left:t.left-e.width()+20+"px"}).show()}).appendTo(n);return o.folderTools&&i.on("treelistselect",function(e,t){!1!==t.writable&&t.treeList&&n.appendTo(t.treeList.label)}),{select:function(e){i.treeList("select",e)},getSelected:function(){return i.treeList("selected")},focus:function(){i.focus()},data:function(e,t){i.treeList("data",e),t&&setTimeout(function(){i.treeList("select",e[0])},100)}}},export:function(){console.warn("Deprecated call to RED.library.export")},loadLibraryFolder:s}}(),RED.notifications=function(){var e,v,m={},b={show:function(){e++,$("#red-ui-full-shade").show()},hide:function(){0===--e&&$("#red-ui-full-shade").hide()}},y=[],w=e=0;function t(e,n,a,r){var s={};if(null!==n&&"object"==typeof n?(a=(s=n).fixed,r=s.timeout,n=s.type):(s.type=n,s.fixed=a,s.timeout=s.timeout),s.id&&m.hasOwnProperty(s.id))return m[s.id].update(e,s),m[s.id];if(s.modal&&b.show(),4<y.length)for(var t=y.length,o=0;4<t&&o<y.length;o+=1){var i=y[o];i.fixed||(window.clearTimeout(i.timeoutid),i.close(),--t)}var d,l,c,p,u,f,h,g=document.createElement("div");return g.id="red-ui-notification-"+w,g.className="red-ui-notification",g.options=s,g.fixed=a,n&&(g.className="red-ui-notification red-ui-notification-"+n),s.width&&(d=$("#red-ui-notifications").width(),s.width>d&&(d=-(s.width-d)/2,$(g).css({width:s.width+"px",marginLeft:d+"px"}))),g.style.display="none","string"==typeof e?(/<p>/i.test(e)||(e="<p>"+e+"</p>"),g.innerHTML=e):$(g).append(e),s.buttons&&(l=$('<div class="ui-dialog-buttonset"></div>').appendTo(g),s.buttons.forEach(function(e){var t=$("<button>").html(e.text).on("click",e.click).appendTo(l);e.id&&t.attr("id",e.id),e.class&&t.addClass(e.class)})),$("#red-ui-notifications").append(g),RED.notifications.hide||$(g).slideDown(300),g.close=(c=g,function(){c.closed||(c.closed=!0,y.splice(y.indexOf(c),1),s.id&&(delete m[s.id],0===Object.keys(m).length&&v.hide()),RED.notifications.hide?c.parentNode.removeChild(c):$(c).slideUp(300,function(){c.parentNode.removeChild(c)}),c.options.modal&&b.hide())}),g.hideNotification=(p=g,function(){p.closed||(p.hidden=!0,RED.notifications.hide||$(p).slideUp(300))}),g.showNotification=(u=g,function(){!u.closed&&u.hidden&&(u.hidden=!1,RED.notifications.hide||$(u).slideDown(300))}),g.update=(f=g,function(e,t){var o,i;"string"==typeof e?(/<p>/i.test(e)||(e="<p>"+e+"</p>"),f.innerHTML=e):$(f).empty().append(e),"number"==typeof t?f.options.timeout=o=t:void 0!==t&&(!s.modal&&t.modal?(f.options.modal=!0,b.show()):s.modal&&!1===t.modal&&(f.options.modal=!1,b.hide()),(e=t.hasOwnProperty("type")?t.type:n)&&(g.className="red-ui-notification red-ui-notification-"+e),a&&!1!==t.fixed||(o=(t.hasOwnProperty("timeout")?t.timeout:r)||5e3),t.buttons&&(i=$('<div style="margin-top: 20px;" class="ui-dialog-buttonset"></div>').appendTo(f),t.buttons.forEach(function(e){var t=$("<button>").text(e.text).on("click",e.click).appendTo(i);e.id&&t.attr("id",e.id),e.class&&t.addClass(e.class)}))),$(f).off("click.red-ui-notification-close"),void 0!==o&&0<o?(window.clearTimeout(f.timeoutid),f.timeoutid=window.setTimeout(f.close,o),setTimeout(function(){$(f).on("click.red-ui-notification-close",function(){f.close(),window.clearTimeout(f.timeoutid)})},50)):window.clearTimeout(f.timeoutid),f.hidden?f.showNotification():t&&t.silent||($(f).addClass("red-ui-notification-shake-horizontal"),setTimeout(function(){$(f).removeClass("red-ui-notification-shake-horizontal")},300))}),a||($(g).on("click.red-ui-notification-close",(h=g,function(){h.close(),window.clearTimeout(h.timeoutid)})),g.timeoutid=window.setTimeout(g.close,r||5e3)),y.push(g),s.id&&(m[s.id]=g,s.fixed&&v.show()),w+=1,g}return{init:function(){$('<div id="red-ui-notifications"></div>').appendTo("#red-ui-editor"),v=$("<li></li>").prependTo(".red-ui-header-toolbar").hide(),$('<a class="button" href="#"><i class="fa fa-warning"></i></a>').appendTo(v).on("click",function(){!function(){for(var e in m)m.hasOwnProperty(e)&&m[e].showNotification()}()})},notify:RED.notify=t}}(),RED.search=function(){var r,s,t,o=!1,n=null,a=-1,d=!1,l=[],v={},c=[];function p(e){(t=RED.utils.getNodeLabel(e))&&(t=(""+t).toLowerCase(),v[t]=v[t]||{},v[t][e.id]={node:e,label:t});var t=t||e.label||e.name||e.id||"",o=["id","type","name","label","info"];e._def&&e._def.defaults&&(o=o.concat(Object.keys(e._def.defaults)));for(var i=0;i<o.length;i++)e.hasOwnProperty(o[i])&&("group"===e.type&&"nodes"===o[i]||!function t(o,i,e){if("string"==typeof e||"number"==typeof e)e=(""+e).toLowerCase(),v[e]=v[e]||{},v[e][o.id]={node:o,label:i};else if(Array.isArray(e))e.forEach(function(e){t(o,i,e)});else if("object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&t(o,i,e[n])}(e,t,e[o[i]]))}function m(e,t,o){var i=new RegExp("(?:^| )is:"+t+"(?: |$)");return i.exec(e)&&(e=e.replace(i," ").trim(),o[t]=!0),e}function u(e){var t,o=[],i=[],n=/(?:^| )type:([^ ]+)/.exec(e);n&&(e=e.replace(/(?:^| )type:[^ ]+/,""),t=n[1]);var a={};e=m(e,"invalid",a),e=m(e,"unused",a),e=m(e,"config",a),e=m(e,"subflow",a),e=function(e,t,o){for(var i,n=new RegExp("(?:^| )"+t+":([^ ]+)(?: |$)");i=n.exec(e);)e=e.replace(n," ").trim(),o[t]=o[t]||[],o[t].push(i[1]);return e}(e=m(e,"hidden",a),"uses",a);n=0<Object.keys(a).length;if(0<(e=e.trim()).length||t||n){e=e.toLowerCase();for(var r=[],s={},i=a.uses||Object.keys(v),d=0;d<i.length;d++){var l=i[d],c=i[d].indexOf(e);if(-1<c)for(var p=Object.keys(v[l]),u=0;u<p.length;u++){var f=v[l][p[u]],h="config"===f.node._def.category&&"group"!==f.node.type;if(!a.uses||l!==f.node.id){if(a.hasOwnProperty("invalid")){var g=!f.node.hasOwnProperty("valid")||f.node.valid;if(a.invalid===g)continue}if(!(a.hasOwnProperty("config")&&a.config!==h||a.hasOwnProperty("subflow")&&a.subflow!==("subflow"===f.node.type))){if(a.hasOwnProperty("hidden")){if("tab"!==f.node.type)continue;if(!RED.workspaces.isHidden(f.node.id))continue}if(a.hasOwnProperty("unused")){h="subflow"===f.node.type&&0===f.node.instances.length||h&&0===f.node.users.length;if(a.unused!==h)continue}t&&f.node.type!==t||(s[f.node.id]=s[f.node.id]={node:f.node,label:f.label},s[f.node.id].index=Math.min(s[f.node.id].index||1/0,c))}}}}for((r=Object.keys(s)).sort(function(e,t){return s[e].index-s[t].index}),d=0;d<r.length;d++)o.push(s[r[d]])}return o}function f(){var e,t,o,i=s.find("li.selected");1===i.length&&(t=(e=s.parent()).height(),e.scrollTop(),t<(o=i.position().top)+(i=i.height())?e.animate({scrollTop:"-="+(t-(o+i)-10)},50):o<0&&e.animate({scrollTop:"+="+(o-10)},50))}function h(){0<l.length&&(s.editableList("addItem",{historyHeader:!0}),l.forEach(function(e){s.editableList("addItem",{history:!0,value:e})}))}function g(e){var t=r.val(),t=l.indexOf(t);-1<t&&l.splice(t,1),l.unshift(r.val()),b(),RED.view.reveal(e.id)}function e(e){o||(d||(t=document.activeElement,$("#red-ui-header-shade").show(),$("#red-ui-editor-shade").show(),$("#red-ui-palette-shade").show(),$("#red-ui-sidebar-shade").show(),$("#red-ui-sidebar-separator").hide(),null===n?function(){n=$("<div>",{id:"red-ui-search",class:"red-ui-search"}).appendTo("#red-ui-main-container");var e=$("<div>",{class:"red-ui-search-container"}).appendTo(n);r=$('<input type="text" data-i18n="[placeholder]menu.label.searchInput">').appendTo(e).searchBox({delay:200,change:function(){s.editableList("empty"),a=-1;var e=$(this).val();if(""!==e)if(0<(c=u(e)).length){for(i=0;i<Math.min(c.length,25);i++)s.editableList("addItem",c[i]);25<c.length&&s.editableList("addItem",{more:{results:c,start:25}})}else s.editableList("addItem",{});else h()}}),$('<button type="button" class="red-ui-button red-ui-button-small"><i class="fa fa-caret-right"></button>').appendTo(e).on("click",function(e){e.preventDefault(),RED.sidebar.info.outliner.search(r.val()),b()}),r.on("keydown",function(e){if(0<c.length)if(40===e.keyCode)o=s.children(),a<o.length-1&&(-1<a&&$(o[a]).removeClass("selected"),a++),$(o[a]).addClass("selected"),f(),e.preventDefault();else if(38===e.keyCode)o=s.children(),0<a&&(a<o.length&&$(o[a]).removeClass("selected"),a--),$(o[a]).addClass("selected"),f(),e.preventDefault();else if(13===e.keyCode){var t,o=s.children();if($(o[a]).hasClass("red-ui-search-more"))if(t=$(o[a]).find(".red-ui-editableList-item-content").data("data")){for(s.editableList("removeItem",t),i=t.more.start;i<Math.min(c.length,t.more.start+25);i++)s.editableList("addItem",c[i]);c.length>t.more.start+25&&s.editableList("addItem",{more:{results:c,start:t.more.start+25}})}$(o[a]).hasClass("red-ui-search-history")?(t=$(o[a]).find(".red-ui-editableList-item-content").data("data"))&&r.searchBox("value",t.value):$(o[a]).hasClass("red-ui-search-historyHeader")||0<c.length&&g(c[Math.max(0,a)].node)}}),r.i18n(),e=$("<div>",{class:"red-ui-search-results-container"}).appendTo(n),s=$("<ol>",{style:"position: absolute;top: 5px;bottom: 5px;left: 5px;right: 5px;"}).appendTo(e).editableList({addButton:!1,addItem:function(e,t,o){var i,n,a=o.node;o.historyHeader?(e.parent().addClass("red-ui-search-historyHeader"),$("<div>",{class:"red-ui-search-empty"}).text(RED._("search.history")).appendTo(e),$('<button type="button" class="red-ui-button red-ui-button-small"></button>').text(RED._("search.clear")).appendTo(e).on("click",function(e){e.preventDefault(),l=[],s.editableList("empty")})):o.history?(e.parent().addClass("red-ui-search-history"),(i=$("<a>",{href:"#",class:"red-ui-search-result"}).appendTo(e)).text(o.value),i.on("click",function(e){e.preventDefault(),r.searchBox("value",o.value),r.focus()}),$('<button type="button" class="red-ui-button red-ui-button-small"><i class="fa fa-remove"></i></button>').appendTo(e).on("click",function(e){e.preventDefault();e=l.indexOf(o.value);l.splice(e,1),s.editableList("removeItem",o)})):o.more?(e.parent().addClass("red-ui-search-more"),(i=$("<a>",{href:"#",class:"red-ui-search-result red-ui-search-empty"}).appendTo(e)).text(RED._("palette.editor.more",{count:o.more.results.length-o.more.start})),i.on("click",function(e){for(e.preventDefault(),s.editableList("removeItem",o),t=o.more.start;t<Math.min(c.length,o.more.start+25);t++)s.editableList("addItem",c[t]);c.length>o.more.start+25&&s.editableList("addItem",{more:{results:c,start:o.more.start+25}})})):void 0===a?$("<div>",{class:"red-ui-search-empty"}).text(RED._("search.empty")).appendTo(e):(a._def,i=$("<a>",{href:"#",class:"red-ui-search-result"}).appendTo(e),RED.utils.createNodeIcon(a).appendTo(i),n=$("<div>",{class:"red-ui-search-result-node-description"}).appendTo(i),a.z&&(e=(e=RED.nodes.workspace(a.z))?"flow:"+e.label:"subflow:"+(e=RED.nodes.subflow(a.z)).name,$("<div>",{class:"red-ui-search-result-node-flow"}).text(e).appendTo(n)),$("<div>",{class:"red-ui-search-result-node-label"}).text(o.label||a.id).appendTo(n),$("<div>",{class:"red-ui-search-result-node-type"}).text(a.type).appendTo(n),$("<div>",{class:"red-ui-search-result-node-id"}).text(a.id).appendTo(n),i.on("click",function(e){e.preventDefault(),g(a)}))},scrollOnAdd:!1})}():s.editableList("empty"),n.slideDown(300),r.searchBox("value",e),e&&""!==e||h(),RED.events.emit("search:open"),d=!0),r.trigger("focus"))}function b(){d&&(d=!1,$("#red-ui-header-shade").hide(),$("#red-ui-editor-shade").hide(),$("#red-ui-palette-shade").hide(),$("#red-ui-sidebar-shade").hide(),$("#red-ui-sidebar-separator").show(),null!==n&&n.slideUp(200,function(){r.searchBox("value","")}),RED.events.emit("search:close"),t&&($(t).trigger("focus"),t=null))}function y(){v={}}function w(e){p(e)}function E(e){for(var t=Object.keys(v),o=0,i=t.length;o<i;o++)delete v[t[o]][e.id],0===Object.keys(v[t[o]]).length&&delete v[t[o]]}function D(e){E(e),w(e)}return{init:function(){RED.actions.add("core:search",e),RED.events.on("editor:open",function(){o=!0}),RED.events.on("editor:close",function(){o=!1}),RED.events.on("type-search:open",function(){o=!0}),RED.events.on("type-search:close",function(){o=!1}),RED.events.on("actionList:open",function(){o=!0}),RED.events.on("actionList:close",function(){o=!1}),RED.keyboard.add("red-ui-search","escape",b),$("#red-ui-header-shade").on("mousedown",b),$("#red-ui-editor-shade").on("mousedown",b),$("#red-ui-palette-shade").on("mousedown",b),$("#red-ui-sidebar-shade").on("mousedown",b),RED.events.on("workspace:clear",y),RED.events.on("flows:add",w),RED.events.on("flows:remove",E),RED.events.on("flows:change",D),RED.events.on("subflows:add",w),RED.events.on("subflows:remove",E),RED.events.on("subflows:change",D),RED.events.on("nodes:add",w),RED.events.on("nodes:remove",E),RED.events.on("nodes:change",D),RED.events.on("groups:add",w),RED.events.on("groups:remove",E),RED.events.on("groups:change",D)},show:e,hide:b,search:u}}(),RED.actionList=function(){var o,n,i,a=!1,r=null,s=!1,d="",l=[];function c(){var e,t,o,i=n.find("li.selected");1===i.length&&(t=(e=n.parent()).height(),e.scrollTop(),t<(o=i.position().top)+(i=i.height())?e.animate({scrollTop:"-="+(t-(o+i)-10)},50):o<0&&e.animate({scrollTop:"+="+(o-10)},50))}function p(e){t(),e&&RED.actions.invoke(e.id)}function e(e){var t;a||(s||(i=document.activeElement,$("#red-ui-header-shade").show(),$("#red-ui-editor-shade").show(),$("#red-ui-palette-shade").show(),$("#red-ui-sidebar-shade").show(),$("#red-ui-sidebar-separator").hide(),null===r&&function(){r=$("<div>",{id:"red-ui-actionList",class:"red-ui-search"}).appendTo("#red-ui-main-container");var e=$("<div>",{class:"red-ui-search-container"}).appendTo(r);(o=$('<input type="text" data-i18n="[placeholder]keyboard.filterActions">').appendTo(e).searchBox({change:function(){d=$(this).val().trim(),l=d.split(" "),n.editableList("filter"),n.find("li.selected").removeClass("selected");var e=n.children(":visible");e.length&&$(e[0]).addClass("selected")}})).on("keydown",function(e){var t,o,i;40===e.keyCode?((o=n.find("li.selected")).length?(i=o.nextAll(":visible").first()).length&&(o.removeClass("selected"),i.addClass("selected")):(t=n.children(":visible")).length&&$(t[0]).addClass("selected"),c(),e.preventDefault()):38===e.keyCode?((i=(o=n.find("li.selected")).prevAll(":visible").first()).length&&(o.removeClass("selected"),i.addClass("selected")),c(),e.preventDefault()):13===e.keyCode&&(o=n.find("li.selected"),p(n.editableList("getItem",o)))}),o.i18n(),e=$("<div>",{class:"red-ui-search-results-container"}).appendTo(r),n=$("<ol>",{style:"position: absolute;top: 5px;bottom: 5px;left: 5px;right: 5px;"}).appendTo(e).editableList({addButton:!1,addItem:function(e,t,o){var i;void 0===o.id?$("<div>",{class:"red-ui-search-empty"}).text(RED._("search.empty")).appendTo(e):(i=$("<a>",{href:"#",class:"red-ui-search-result"}).appendTo(e),e=$("<div>",{class:"red-ui-search-result-action"}).appendTo(i),$("<div>").text(o.label).appendTo(e),o.key&&$("<div>",{class:"red-ui-search-result-action-key"}).html(RED.keyboard.formatKey(o.key)).appendTo(e),i.on("click",function(e){e.preventDefault(),p(o)}))},scrollOnAdd:!1,filter:function(e){if(""===d)return!0;for(var t=0,o=0;o<l.length;o++){var i=e._label.indexOf(l[o],t);if(!(-1<i))return!1;t=i}return!0}})}(),r.slideDown(300),o.searchBox("value",e),n.editableList("empty"),results=[],(t=RED.actions.list()).sort(function(e,t){return e.id.localeCompare(t.id)}),t.forEach(function(e){e.label=e.id.replace(/:/,": ").replace(/-/g," ").replace(/(^| )./g,function(){return arguments[0].toUpperCase()}),e._label=e.label.toLowerCase(),n.editableList("addItem",e)}),RED.events.emit("actionList:open"),s=!0),o.trigger("focus"),(t=n.children(":visible")).length&&$(t[0]).addClass("selected"))}function t(){s&&(s=!1,$("#red-ui-header-shade").hide(),$("#red-ui-editor-shade").hide(),$("#red-ui-palette-shade").hide(),$("#red-ui-sidebar-shade").hide(),$("#red-ui-sidebar-separator").show(),null!==r&&r.slideUp(200,function(){o.searchBox("value","")}),RED.events.emit("actionList:close"),i&&($(i).trigger("focus"),i=null))}return{init:function(){RED.actions.add("core:show-action-list",e),RED.events.on("editor:open",function(){a=!0}),RED.events.on("editor:close",function(){a=!1}),RED.events.on("search:open",function(){a=!0}),RED.events.on("search:close",function(){a=!1}),RED.events.on("type-search:open",function(){a=!0}),RED.events.on("type-search:close",function(){a=!1}),RED.keyboard.add("red-ui-actionList","escape",function(){t()}),$("#red-ui-header-shade").on("mousedown",t),$("#red-ui-editor-shade").on("mousedown",t),$("#red-ui-palette-shade").on("mousedown",t),$("#red-ui-sidebar-shade").on("mousedown",t)},show:e,hide:t}}(),RED.typeSearch=function(){var d,l,t,n,o,i,a=null,c=-1,r=!1,s="",p={};function u(){var e,t,o,i=l.find("li.selected");1===i.length&&(t=(e=l.parent()).height(),e.scrollTop(),t<(o=i.position().top)+(i=i.height())?e.animate({scrollTop:"-="+(t-(o+i)-10)},50):o<0&&e.animate({scrollTop:"+="+(o-10)},50))}function f(e,t){var o=a.position();o.top=o.top+t+"px",o.left=o.left+e+"px",a.css(o),i(e,t)}function h(){a=$("<div>",{id:"red-ui-type-search",class:"red-ui-search red-ui-type-search"}).appendTo("#red-ui-main-container");var e=$("<div>",{class:"red-ui-search-container"}).appendTo(a);(d=$('<input type="text" id="red-ui-type-search-input">').attr("placeholder",RED._("search.addNode")).appendTo(e).searchBox({delay:50,change:function(){var e;e=$(this).val(),s=e.toLowerCase(),l.editableList("filter"),l.editableList("sort"),setTimeout(function(){c=0,l.children().removeClass("selected"),l.children(":visible:first").addClass("selected")},100)}})).on("keydown",function(e){var t,o,i=l.children(":visible");40===e.keyCode&&e.shiftKey?(e.preventDefault(),f(0,10)):38===e.keyCode&&e.shiftKey?(e.preventDefault(),f(0,-10)):39===e.keyCode&&e.shiftKey?(e.preventDefault(),f(10,0)):37===e.keyCode&&e.shiftKey?(e.preventDefault(),f(-10,0)):0<i.length?40===e.keyCode?(c<i.length-1&&(-1<c&&$(i[c]).removeClass("selected"),c++),$(i[c]).addClass("selected"),u(),e.preventDefault()):38===e.keyCode?(0<c&&(c<i.length&&$(i[c]).removeClass("selected"),c--),$(i[c]).addClass("selected"),u(),e.preventDefault()):(e.metaKey||e.ctrlKey)&&13===e.keyCode?(e.preventDefault(),(o=Math.max(0,c))<i.length&&(t=$(i[o]).find(".red-ui-editableList-item-content").data("data"),p[t.type]=Date.now(),0===t.def.outputs?g(t):n(t.type,!0),$("#red-ui-type-search-input").val("").trigger("keyup"),setTimeout(function(){$("#red-ui-type-search-input").focus()},100))):13===e.keyCode&&(e.preventDefault(),(o=Math.max(0,c))<i.length&&g($(i[o]).find(".red-ui-editableList-item-content").data("data"))):13===e.keyCode&&(e.stopPropagation(),e.preventDefault())}),t=$("<div>",{class:"red-ui-search-results-container"}).appendTo(a),l=$("<ol>",{style:"position: absolute;top: 0;bottom: 0;left: 0;right: 0;"}).appendTo(t).editableList({addButton:!1,filter:function(e){return""===s||!e.recent&&!e.common&&(""===s||-1<e.index.indexOf(s))},sort:function(e,t){if(""===s)return e.i-t.i;var o=e.index.indexOf(s),i=t.index.indexOf(s);return-1===o?1:-1===i?-1:o===i?y(e,t):o-i},addItem:function(e,t,o){var i=o.def;o.index=o.type.toLowerCase(),o.separator&&e.addClass("red-ui-search-result-separator");var n=$("<div>",{class:"red-ui-search-result"}).appendTo(e),a=$("<div>",{class:"red-ui-search-result-node"}).appendTo(n),r=RED.utils.getNodeColor(o.type,i),e=RED.utils.getNodeIcon(i);a.css("backgroundColor",r);r=$("<div/>",{class:"red-ui-palette-icon-container"}).appendTo(a);RED.utils.createIconElement(e,r,!1),0<i.inputs&&$("<div/>",{class:"red-ui-search-result-node-port"}).appendTo(a),0<i.outputs&&$("<div/>",{class:"red-ui-search-result-node-port red-ui-search-result-node-output"}).appendTo(a);i=$("<div>",{class:"red-ui-search-result-description"}).appendTo(n),a=o.label;o.index+="|"+a.toLowerCase(),$("<div>",{class:"red-ui-search-result-node-label"}).text(a).appendTo(i),n.on("click",function(e){e.preventDefault(),g(o)})},scrollOnAdd:!1})}function g(e){m(),p[e.type]=Date.now(),n(e.type)}function v(e){if(r){for(var t=$(e.target);"body"!==t.prop("nodeName").toLowerCase();){if("red-ui-type-search"===t.attr("id"))return;t=t.parent()}m(!0),o&&o()}}function m(e){r&&(r=!1,null!==a&&t.slideUp(e?50:200,function(){a.hide(),d.searchBox("value","")}),RED.events.emit("type-search:close"),RED.view.focus(),$(document).off("mousedown.red-ui-type-search"),$(document).off("mouseup.red-ui-type-search"),$(document).off("click.red-ui-type-search"),$(document).off("touchstart.red-ui-type-search"))}function b(t,e){var o=t;if(void 0!==e.paletteLabel)try{o=("function"==typeof e.paletteLabel?e.paletteLabel.call(e):e.paletteLabel)||"",o+=" ("+t+")"}catch(e){console.log("Definition error: "+t+".paletteLabel",e)}return o}function y(e,t){e=e.label.toLowerCase(),t=t.label.toLowerCase();return e<t?-1:e===t?0:1}function w(e,t,o){return!e||(!e.type||t===e.type)&&(!e.input||0<o.inputs)&&(!e.output||0<o.outputs)}function E(t){l.editableList("empty"),d.searchBox("value","").focus(),c=-1;var o=["inject","debug","function","change","switch"].filter(function(e){return w(t.filter,e,RED.nodes.getType(e))});(e=Object.keys(p)).sort(function(e,t){return p[t]-p[e]});var e=e.filter(function(e){return w(t.filter,e,RED.nodes.getType(e))&&-1===o.indexOf(e)}),i=[];RED.nodes.registry.getNodeTypes().forEach(function(e){var t=RED.nodes.getType(e);"config"!==t.category&&"unknown"!==e&&"tab"!==e&&i.push({type:e,def:t,label:b(e,t)})}),i.sort(y);for(var n,a=0,r=0;r<o.length;r++){var s=RED.nodes.getType(o[r]);s&&((n={type:o[r],common:!0,def:s,i:a++}).label=b(n.type,n.def),r===o.length-1&&(n.separator=!0),l.editableList("addItem",n))}for(r=0;r<Math.min(5,e.length);r++)(n={type:e[r],def:RED.nodes.getType(e[r]),recent:!0,i:a++}).label=b(n.type,n.def),r===e.length-1&&(n.separator=!0),l.editableList("addItem",n);for(r=0;r<i.length;r++)w(t.filter,i[r].type,i[r].def)&&(i[r].i=a++,l.editableList("addItem",i[r]));setTimeout(function(){c=0,l.children(":first").addClass("selected")},100)}return{show:function(e){r?(a.hide(),t.hide()):(null===a&&(h(),RED.keyboard.add("red-ui-type-search","escape",function(){m(),o&&o()})),r=!0),$(document).off("mousedown.red-ui-type-search"),$(document).off("mouseup.red-ui-type-search"),$(document).off("click.red-ui-type-search"),$(document).off("touchstart.red-ui-type-search"),$(document).off("mousedown.red-ui-type-search"),setTimeout(function(){$(document).on("mousedown.red-ui-type-search",v),$(document).on("mouseup.red-ui-type-search",v),$(document).on("click.red-ui-type-search",v),$(document).on("touchstart.red-ui-type-search",v)},200),E(e),n=e.add,o=e.cancel,i=e.move,RED.events.emit("type-search:open"),$("#red-ui-main-container").height()-e.y-150<0&&(e.y=e.y-235),a.css({left:e.x+"px",top:e.y+"px"}).show(),t.slideDown(300),setTimeout(function(){t.find(".red-ui-editableList-container").scrollTop(0),e.disableFocus||d.trigger("focus")},200)},refresh:E,hide:m}}(),RED.subflow=function(){function r(e,t){var o={x:50,y:30};t||(o.x+=110);var i=[].concat(e.out).concat(e.in);e.status&&i.push(e.status),i.sort(function(e,t){return e.x-t.x});for(var n=0;n<i.length;n++){var a=i[n];a.x==o.x&&a.y==o.y&&(o.x+=55)}return o}function n(){var t=RED.nodes.subflow(RED.workspaces.active());if(0!==t.in.length){"undefined"==typeof removedSubflowInputs&&(removedSubflowInputs=[t.in[t.in.length-1]]);var e=[];for(removedSubflowInputs.sort(function(e,t){return t.i-e.i}),i=0;i<removedSubflowInputs.length;i++){var o=removedSubflowInputs[i];t.in.splice(o.i,1);var n=[],a=[];RED.nodes.eachLink(function(e){"subflow"==e.source.type&&e.source.z==t.id&&e.source.i==o.i&&n.push(e),e.source.type=="subflow:"+t.id&&(e.sourcePort==output.i?n.push(e):e.targetPort>o.i&&a.push(e))}),n.forEach(function(e){RED.nodes.removeLink(e)}),a.forEach(function(e){e.targetPort--});for(var e=e.concat(n),r=o.i;r<t.in.length;r++)t.in[r].i--,t.in[r].dirty=!0}return t.changed=!0,RED.events.emit("subflows:change",t),{subflowInputs:removedSubflowInputs,links:e}}}function s(e){var t=RED.nodes.subflow(RED.workspaces.active());if(0!==t.out.length){var o=[];for((e=void 0===e?[t.out[t.out.length-1]]:e).sort(function(e,t){return t.i-e.i}),i=0;i<e.length;i++){var n=e[i];t.out.splice(n.i,1);var a=[],r=[];RED.nodes.eachLink(function(e){"subflow"==e.target.type&&e.target.z==t.id&&e.target.i==n.i&&a.push(e),e.source.type=="subflow:"+t.id&&(e.sourcePort==n.i?a.push(e):e.sourcePort>n.i&&r.push(e))}),a.forEach(function(e){RED.nodes.removeLink(e)}),r.forEach(function(e){e.sourcePort--});for(var o=o.concat(a),s=n.i;s<t.out.length;s++)t.out[s].i--,t.out[s].dirty=!0}return t.changed=!0,RED.events.emit("subflows:change",t),{subflowOutputs:e,links:o}}}function d(){var t=RED.nodes.subflow(RED.workspaces.active());if(t.status){var o=[];return RED.nodes.eachLink(function(e){"subflow"==e.target.type&&e.target.z==t.id&&"status"==e.target.direction&&o.push(e)}),o.forEach(function(e){RED.nodes.removeLink(e)}),delete t.status,$("#red-ui-subflow-status").prop("checked",!!t.status),$("#red-ui-subflow-status").parent().parent().toggleClass("active",!!t.status),{links:o}}}function l(t){var o=RED.nodes.subflow(RED.workspaces.active());c(o);var i=[];if(o)return RED.nodes.filterNodes({type:"subflow:"+o.id}).forEach(function(e){i.push({id:e.id,changed:e.changed}),t&&(e.changed=!0),e.inputs=o.in.length,e.outputs=o.out.length,e.resize=!0,e.dirty=!0,RED.editor.updateNodeProperties(e)}),RED.editor.validateNode(o),{instances:i}}function c(e){e&&($("#red-ui-subflow-input-add").toggleClass("active",0!==e.in.length),$("#red-ui-subflow-input-remove").toggleClass("active",0===e.in.length),$("#red-ui-subflow-input .spinner-value").text(e.in.length),$("#red-ui-subflow-output .spinner-value").text(e.out.length),$("#red-ui-subflow-status").prop("checked",!!e.status),$("#red-ui-subflow-status").parent().parent().toggleClass("active",!!e.status))}function t(a){var e=$("#red-ui-workspace-toolbar");e.empty(),$('<a class="button" id="red-ui-subflow-edit" href="#" data-i18n="[append]subflow.editSubflowProperties"><i class="fa fa-pencil"></i> </a>').appendTo(e),$('<span style="margin-left: 5px;" data-i18n="subflow.input"></span> <div id="red-ui-subflow-input" style="display: inline-block;" class="button-group spinner-group"><a id="red-ui-subflow-input-remove" class="button" href="#"><i class="fa fa-minus"></i></a><div class="spinner-value">3</div><a id="red-ui-subflow-input-add" class="button" href="#"><i class="fa fa-plus"></i></a></div>').appendTo(e),$('<span style="margin-left: 5px;" data-i18n="subflow.output"></span> <div id="red-ui-subflow-output" style="display: inline-block;" class="button-group spinner-group"><a id="red-ui-subflow-output-remove" class="button" href="#"><i class="fa fa-minus"></i></a><div class="spinner-value">3</div><a id="red-ui-subflow-output-add" class="button" href="#"><i class="fa fa-plus"></i></a></div>').appendTo(e),$('<span class="button-group" style="display: none"><span class="button" style="padding:0"><label for="red-ui-subflow-status"><input id="red-ui-subflow-status" type="checkbox"> <span data-i18n="subflow.status"></span></label></span></span>').appendTo(e),$('<a class="button" id="red-ui-subflow-delete" href="#" data-i18n="[append]subflow.deleteSubflow"><i class="fa fa-trash"></i> </a>').appendTo(e),e.i18n(),$("#red-ui-subflow-output-remove").on("click",function(e){e.preventDefault();var t=RED.nodes.dirty(),o=a.changed,i=s();i&&(e=l(!0),RED.history.push({t:"delete",links:i.links,subflowOutputs:i.subflowOutputs,changed:o,dirty:t,subflow:{instances:e.instances}}),RED.view.select(),RED.nodes.dirty(!0),RED.view.redraw(!0))}),$("#red-ui-subflow-output-add").on("click",function(e){var t,o,i;e.preventDefault(),t=RED.nodes.subflow(RED.workspaces.active()),o=r(t,!1),i={type:"subflow",direction:"out",z:t.id,i:t.out.length,x:o.x,y:o.y,id:RED.nodes.id()},e=t.out.length,t.out.push(i),t.dirty=!0,o=RED.nodes.dirty(),i=t.changed,t.changed=!0,e={t:"edit",node:t,dirty:o,changed:i,subflow:{outputCount:e,instances:l(!0).instances}},RED.history.push(e),RED.view.select(),RED.nodes.dirty(!0),RED.view.redraw(),$("#red-ui-subflow-output .spinner-value").text(t.out.length),RED.events.emit("subflows:change",t)}),$("#red-ui-subflow-input-add").on("click",function(e){var t,o,i;e.preventDefault(),t=RED.nodes.subflow(RED.workspaces.active()),o=r(t,!0),i={type:"subflow",direction:"in",z:t.id,i:t.in.length,x:o.x,y:o.y,id:RED.nodes.id()},e=t.in.length,t.in.push(i),t.dirty=!0,o=RED.nodes.dirty(),i=t.changed,t.changed=!0,e={t:"edit",node:t,dirty:o,changed:i,subflow:{inputCount:e,instances:l(!0).instances}},RED.history.push(e),RED.view.select(),RED.nodes.dirty(!0),RED.view.redraw(),$("#red-ui-subflow-input .spinner-value").html(t.in.length),RED.events.emit("subflows:change",t)}),$("#red-ui-subflow-input-remove").on("click",function(e){e.preventDefault();var t=RED.nodes.dirty(),o=a.changed;a.changed=!0;var i=n();i&&(e=l(!0),RED.history.push({t:"delete",links:i.links,changed:o,subflowInputs:i.subflowInputs,dirty:t,subflow:{instances:e.instances}}),RED.view.select(),RED.nodes.dirty(!0),RED.view.redraw(!0))}),$("#red-ui-subflow-status").on("change",function(e){var t,o,i,n;this.checked?(n=RED.nodes.subflow(RED.workspaces.active())).status||(o=r(n,!1),i={type:"subflow",direction:"status",z:n.id,x:o.x,y:o.y,id:RED.nodes.id()},n.status=i,n.dirty=!0,o=RED.nodes.dirty(),i=n.changed,l(n.changed=!0),RED.history.push({t:"edit",node:n,dirty:o,changed:i,subflow:{status:!0}}),RED.view.select(),RED.nodes.dirty(!0),RED.view.redraw(),RED.events.emit("subflows:change",n),$("#red-ui-subflow-status").prop("checked",!!n.status),$("#red-ui-subflow-status").parent().parent().toggleClass("active",!!n.status)):(t=a.status,o=a.changed,(i=d())&&(a.changed=!0,n=RED.nodes.dirty(),RED.history.push({t:"delete",links:i.links,changed:o,dirty:n,subflow:{id:a.id,status:t}}),RED.view.select(),RED.nodes.dirty(!0),RED.view.redraw()))}),$("#red-ui-subflow-edit").on("click",function(e){RED.editor.editSubflow(RED.nodes.subflow(RED.workspaces.active())),e.preventDefault()}),$("#red-ui-subflow-delete").on("click",function(e){e.preventDefault();var t,o=RED.nodes.subflow(RED.workspaces.active());function i(){var e=RED.nodes.dirty(),t=p(RED.workspaces.active());t.t="delete",t.dirty=e,RED.history.push(t)}0<o.instances.length?(e=$("<div>"),$("<p>").text(RED._("subflow.subflowInstances",{count:o.instances.length})).appendTo(e),$("<p>").text(RED._("subflow.confirmDelete")).appendTo(e),t=RED.notify(e,{modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.close()}},{text:RED._("workspace.confirmDelete"),class:"primary",click:function(){t.close(),i()}}]})):i()}),c(a),$("#red-ui-workspace-chart").css({"margin-top":"40px"}),$("#red-ui-workspace-toolbar").show()}function p(t,o){var i=[],e=[],n=[],a=RED.nodes.subflow(t);RED.nodes.eachNode(function(e){o||e.type!="subflow:"+t||i.push(e),e.z==t&&i.push(e)}),RED.nodes.eachConfig(function(e){e.z==t&&i.push(e)}),RED.nodes.groups(t).forEach(function(e){n.push(e)});for(var r=[],s=0;s<i.length;s++)var d=RED.nodes.remove(i[s].id),e=e.concat(d.links),r=r.concat(d.nodes);for(i=i.concat(r),n=RED.nodes.groups(t).filter(function(e){return!e.g}),s=0;s<n.length;s++)n[s].nodes.forEach(function(e){"group"===e.type&&n.push(e)});for(s=n.length-1;0<=s;s--)RED.nodes.removeGroup(n[s]);return RED.nodes.removeSubflow(a),RED.workspaces.remove(a),RED.nodes.dirty(!0),RED.view.redraw(),{nodes:i,links:e,groups:n,subflows:[a]}}function e(){var t=0;RED.nodes.eachSubflow(function(e){e=new RegExp("^Subflow (\\d+)$").exec(e.name);e&&(t=Math.max(t,e[1]))});var e="Subflow "+(t+1),o=RED.nodes.id(),e={type:"subflow",id:o,name:e,info:"",in:[],out:[]};RED.nodes.addSubflow(e),RED.history.push({t:"createSubflow",subflow:{subflow:e},dirty:RED.nodes.dirty()}),RED.workspaces.show(o),RED.nodes.dirty(!0)}function a(e,t,o){e.empty();for(var i=0;i<t.length;i++){var n=t[i];n.ui&&"hide"===n.ui.type||function(e,t,o,i){o.label=o.label||{},("cred"===t.type||t.parent&&"cred"===t.parent.type)&&!o.type?(o.type="cred",o.opts={}):o.type?o.opts||(o.opts="select"===o.type?{opts:[]}:{}):(o.type="input",o.opts={types:RED.editor.envVarList.DEFAULT_ENV_TYPE_LIST});var n=o.label||{},a=RED.i18n.lang(),r=RED.editor.envVarList.lookupLabel(n,n["en-US"]||t.name,a),s=$("<label>").appendTo(e);$("<span>&nbsp;</span>").appendTo(e);var d,l=$("<span></span>").appendTo(s);!o.icon||(d=RED.utils.separateIconPath(o.icon))&&$("<i class='fa "+d.file+"'/>").appendTo(l),"checkbox"!==o.type&&(d=o.icon?{"padding-left":"5px"}:{},$("<span>").css(d).text(r).appendTo(s),"none"===o.type&&s.width("100%"));var c={value:"",type:"str"};switch(t.parent&&(c.value=t.parent.value,c.type=t.parent.type),t.hasOwnProperty("value")&&(c.value=t.value),t.hasOwnProperty("type")&&(c.type=t.type),o.type){case"input":var p,u=$('<input type="text">').css("width","70%").appendTo(e);o.opts.types&&0<o.opts.types.length?(p=c.type,-1===o.opts.types.indexOf(p)&&(p=o.opts.types[0]),u.typedInput({types:o.opts.types,default:p}),u.typedInput("value",c.value)):u.val(c.value);break;case"select":u=$("<select>").css("width","70%").appendTo(e),o.opts.opts&&o.opts.opts.forEach(function(e){$("<option>").val(e.v).text(RED.editor.envVarList.lookupLabel(e.l,e.l["en-US"]||e.v,a)).appendTo(u)}),u.val(c.value);break;case"checkbox":s.css("cursor","default");var f=$("<label>").css("width","70%").appendTo(e);u=$('<input type="checkbox">').css({marginTop:0,width:"auto",height:"34px"}).appendTo(f),l.css({"padding-left":"5px"}).appendTo(f),$("<span>").css({"padding-left":"5px"}).text(r).appendTo(f);f=!1,f="bool"===c.type?"true"===c.value:"num"===c.type?"0"!==c.value:""!==c.value;u.prop("checked",f);break;case"spinner":u=$("<input>").css("width","70%").appendTo(e);f={};o.opts.hasOwnProperty("min")&&(f.min=o.opts.min),o.opts.hasOwnProperty("max")&&(f.max=o.opts.max),u.spinner(f).parent().width("70%"),u.val(c.value);break;case"cred":u=$('<input type="password">').css("width","70%").appendTo(e),i.credentials?i.credentials[t.name]?u.val(i.credentials[t.name]):i.credentials["has_"+t.name]?u.val("__PWRD__"):u.val(""):u.val(""),u.typedInput({types:["cred"],default:"cred"})}u&&u.attr("id",h(t.name))}($("<div/>",{class:"form-row"}).appendTo(e),n,n.ui||{},o)}}function u(e,s){if(e){var d=[];return e.each(function(e){var t=$(this).data("data"),o=(t.parent?t.name:t.nameField.val()).trim();if(""!==o||t.ui&&"none"===t.ui.type){var i=t.valueField,n=i.typedInput("value"),i=i.typedInput("type");if(s||!t.parent||t.parent.value!==n||t.parent.type!==i){var a={name:o,type:i,value:n};if(t.ui){var r={icon:t.ui.icon,label:$.extend(!0,{},t.ui.label),type:t.ui.type,opts:$.extend(!0,{},t.ui.opts)};switch(r.icon||delete r.icon,$.isEmptyObject(r.label)&&delete r.label,r.type){case"input":JSON.stringify(r.opts)===JSON.stringify({types:RED.editor.envVarList.DEFAULT_ENV_TYPE_LIST})&&(delete r.type,delete r.opts);break;case"cred":"cred"===a.type&&delete r.type,delete r.opts;break;case"select":r.opts&&$.isEmptyObject(r.opts.opts)&&delete r.opts;break;case"spinner":$.isEmptyObject(r.opts)&&delete r.opts;break;default:delete r.opts}$.isEmptyObject(r)||(a.ui=r)}d.push(a)}}}),d}return null}function o(a){var o={},r=[];if(/^subflow:/.test(a.type)){var e=RED.nodes.subflow(a.type.substring(8));if(e.env&&e.env.forEach(function(e){var t={name:e.name,parent:{type:e.type,value:e.value},ui:$.extend(!0,{},e.ui)};r.push(t),o[e.name]=t}),a.env)for(var t=0;t<a.env.length;t++){var i=a.env[t];o.hasOwnProperty(i.name)&&(o[i.name].type=i.type,o[i.name].value=i.value)}}else a._def.subflowModule&&Object.keys(a._def.defaults).forEach(function(e){if("name"!==e){var t,o=a._def.defaults[e],i=a[e],n=i;if(o.ui&&"cred"===o.ui.type)t="cred";else switch(typeof i){case"string":t="str";break;case"number":t="num";break;case"boolean":t="bool",n=i?"true":"false";break;default:t=i.type,n=i.value}o={name:e,type:t,value:n,parent:{type:o.type,value:o.value},ui:$.extend(!0,{},o.ui)};r.push(o)}});return r}function h(e){return"node-input-subflow-env-"+e.replace(/[^a-z0-9-_]/gi,"_")}return{init:function(){RED.events.on("workspace:change",function(e){e=RED.nodes.subflow(e.workspace);e?t(e):($("#red-ui-workspace-toolbar").hide().empty(),$("#red-ui-workspace-chart").css({"margin-top":"0"}))}),RED.actions.add("core:create-subflow",e),$('<script type="text/x-red" data-template-name="subflow"><div class="form-row"><label for="node-input-name" data-i18n="[append]editor:common.label.name"><i class="fa fa-tag"></i> </label><input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name"></div><div id="subflow-input-ui"></div><\/script>').appendTo("#red-ui-editor-node-configs"),$('<script type="text/x-red" data-template-name="subflow-template"><div class="form-row"><label for="subflow-input-name" data-i18n="[append]common.label.name"><i class="fa fa-tag"></i>  </label><input type="text" id="subflow-input-name" data-i18n="[placeholder]common.label.name"></div><div class="form-row"><ul style="margin-bottom: 20px;" id="subflow-env-tabs"></ul></div><div id="subflow-env-tabs-content"><div id="subflow-env-tab-edit"><div class="form-row node-input-env-container-row" id="subflow-input-edit-ui"><ol id="node-input-env-container"></ol><div class="node-input-env-locales-row"><i class="fa fa-language"></i> <select id="subflow-input-env-locale"></select></div></div></div><div id="subflow-env-tab-preview"><div id="subflow-input-ui"/></div></div><\/script>').appendTo("#red-ui-editor-node-configs")},createSubflow:e,removeSubflow:p,refresh:l,removeInput:n,removeOutput:s,removeStatus:d,buildEditForm:function(e,t){"subflow-template"===e?(function(t,o){var e=RED.tabs.create({id:"subflow-env-tabs",onchange:function(e){"subflow-env-tab-preview"===e.id&&a($("#subflow-input-ui"),u(t.editableList("items"),!0),o),$("#subflow-env-tabs-content").children().hide(),$("#"+e.id).show()}});e.addTab({id:"subflow-env-tab-edit",label:RED._("editor-tab.envProperties")}),e.addTab({id:"subflow-env-tab-preview",label:RED._("editor-tab.preview")}),e=RED.settings.theme("languages").map(function(e){var t=RED._("languages."+e);return{text:t||e,val:e}}).sort(function(e,t){return e.text.localeCompare(t.text)}),RED.popover.tooltip($(".node-input-env-locales-row i"),RED._("editor.locale"));var i=$("#subflow-input-env-locale");e.forEach(function(e){var t={value:e.val};"en-US"===e.val&&(t.selected=""),$("<option/>",t).text(e.text).appendTo(i)}),e=RED.i18n.lang(),i.val(e),i.on("change",function(){RED.editor.envVarList.setLocale($(this).val(),$("#node-input-env-container"))}),RED.editor.envVarList.setLocale(e)}($("#node-input-env-container"),t),RED.editor.envVarList.create($("#node-input-env-container"),t)):"subflow"===e&&a($("#subflow-input-ui"),o(t),t)},exportSubflowTemplateEnv:u,exportSubflowInstanceEnv:function(e){var n=[];return o(e).forEach(function(e){var t,o=e.ui||{};o.type?o.opts=o.opts||{}:e.parent&&"cred"===e.parent.type?o.type="cred":(o.type="input",o.opts={types:RED.editor.envVarList.DEFAULT_ENV_TYPE_LIST});var i=$("#"+h(e.name));if(i.length||"cred"===o.type){switch(t={name:e.name},o.type){case"input":o.opts.types&&0<o.opts.types.length?(t.value=i.typedInput("value"),t.type=i.typedInput("type")):(t.value=i.val(),t.type="string");break;case"cred":t.value=i.val(),t.type="cred";break;case"spinner":t.value=i.val(),t.type="int";break;case"select":t.value=i.val(),t.type="string";break;case"checkbox":t.type="bool",t.value=""+i.prop("checked")}"cred"!==o.type&&t.type===e.parent.type&&t.value===e.parent.value||n.push(t)}}),n}}}(),RED.group=function(){for(var t=["#ff0000","#ffC000","#ffff00","#92d04f","#0070c0","#001f60","#6f2fa0","#000000","#777777"],o=t.length,e=0,i=3*t.length;e<i;e++){var n=e%o,a=Math.floor(e/o)+1,r=t[n],s=parseInt(r.substring(1,3),16),d=parseInt(r.substring(3,5),16),l=parseInt(r.substring(5,7),16),c=(255-d)/(3+(n==o-1?0:1)),r=(255-l)/(3+(n==o-1?0:1)),l=(((s=Math.min(255,Math.floor(s+a*((255-s)/(3+(n==o-1?0:1))))))<<16)+((d=Math.min(255,Math.floor(d+a*c)))<<8)+(l=Math.min(255,Math.floor(l+a*r)))).toString(16);t.push("#"+"000000".slice(0,6-l.length)+l)}var p,u={label:!0,"label-position":"nw"};function f(e){var t=/^rgb\((\d+), (\d+), (\d+)\)$/.exec(e);if(t){t=((parseInt(t[1])<<16)+(parseInt(t[2])<<8)+parseInt(t[3])).toString(16);return"#"+"000000".slice(0,6-t.length)+t}return e}function h(e){var t=[],o=RED.nodes.group(e.g);return e.nodes.forEach(function(e){t.push(e),o?(e.g=o.id,o.nodes.push(e),o.dirty=!0,e.dirty=!0):delete e.g,"group"===e.type?RED.events.emit("groups:change",e):RED.events.emit("nodes:change",e)}),RED.nodes.removeGroup(e),t}function g(e){if(0!==e.length){if(!(0<e.filter(function(e){return"subflow"===e.type}).length)){var t={id:RED.nodes.id(),type:"group",nodes:[],style:JSON.parse(JSON.stringify(u)),x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,w:0,h:0,_def:RED.group.def};t.z=e[0].z,RED.nodes.addGroup(t);try{v(t,e)}catch(e){return void RED.notify(e,"error")}return t}RED.notify(RED._("group.errors.cannotAddSubflowPorts"),"error")}}function v(e,t){var o,i,n,a,r;for(Array.isArray(t)||(t=[t]),o=0;o<t.length;o++){if(!(r=t[o]).z)throw new Error("Cannot add node without a z property to a group");if(i){if(i!==r.z)throw new Error("Cannot add nooes with different z properties")}else i=r.z;if(r.g&&!n){if(0!==o)throw new Error(RED._("group.errors.cannotCreateDiffGroups"));n=r.g}if(n!==r.g)throw new Error(RED._("group.errors.cannotCreateDiffGroups"))}for(n&&((n=RED.nodes.group(n)).nodes.push(e),n.dirty=!0,e.g=n.id),o=0;o<t.length;o++)"subflow"!==(r=t[o]).type&&(!n||r.g!==n.id||-1<(a=n.nodes.indexOf(r))&&n.nodes.splice(a,1),r.g=e.id,r.dirty=!0,e.nodes.push(r),e.x=Math.min(e.x,r.x-r.w/2-25-(r._def.button&&"right"!==r._def.align?20:0)),e.y=Math.min(e.y,r.y-r.h/2-25),e.w=Math.max(e.w,r.x+r.w/2+25+(r._def.button&&"right"==r._def.align?20:0)-e.x),e.h=Math.max(e.h,r.y+r.h/2+25-e.y),"group"===r.type?RED.events.emit("groups:change",r):RED.events.emit("nodes:change",r));n&&RED.events.emit("groups:change",e),b(e)}function m(e,t,o){var i;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++)if(t[n].g!==e.id)return;for(var a=RED.nodes.group(e.g),n=0;n<t.length;n++){(i=t[n]).dirty=!0;var r=e.nodes.indexOf(i);e.nodes.splice(r,1),o&&e.g?(i.g=e.g,a.nodes.push(i)):delete i.g,"group"===i.type?RED.events.emit("groups:change",i):RED.events.emit("nodes:change",i)}b(e)}function b(e){for(e.dirty=!0;e;)e.dirty=!0,e=RED.nodes.group(e.g)}return{def:{defaults:{name:{value:""},style:{value:{label:!0}},nodes:{value:[]},env:{value:[]}},category:"config",oneditprepare:function(){var e=this.style||{};RED.editor.colorPicker.create({id:"node-input-style-stroke",value:e.stroke||u.stroke||"#a4a4a4",palette:t,cellPerRow:o,cellWidth:16,cellHeight:16,cellMargin:3,none:!0,opacity:e.hasOwnProperty("stroke-opacity")?e["stroke-opacity"]:u.hasOwnProperty("stroke-opacity")?u["stroke-opacity"]:1}).appendTo("#node-input-row-style-stroke"),RED.editor.colorPicker.create({id:"node-input-style-fill",value:e.fill||u.fill||"none",palette:t,cellPerRow:o,cellWidth:16,cellHeight:16,cellMargin:3,none:!0,opacity:e.hasOwnProperty("fill-opacity")?e["fill-opacity"]:u.hasOwnProperty("fill-opacity")?u["fill-opacity"]:1}).appendTo("#node-input-row-style-fill"),function(e){var t=$("<div>",{style:"display:inline-block"}),c=$("<input/>",{id:e.id,type:"hidden",value:e.value}).appendTo(t),p=$('<button type="button" class="red-ui-button red-ui-editor-node-appearance-button">').appendTo(t);$('<i class="fa fa-caret-down"></i>').appendTo(p);function u(){var e=c.val();o.removeClass().addClass("red-ui-group-layout-picker-cell-text red-ui-group-layout-text-pos-"+e)}var e=$("<div>",{class:"red-ui-search-result-node"}).appendTo(p),o=$("<div>",{class:"red-ui-group-layout-picker-cell-text red-ui-group-layout-text-pos-"}).appendTo(e);return p.on("click",function(e){var t,o=$("<div/>",{class:"red-ui-group-layout-picker"}).css({width:"126px"});$("<div/>").appendTo(o);for(var i=0;i<2;i++)for(var n="ns"[i],a=$("<div/>").appendTo(o),r=0;r<3;r++){var s=n+["w","","e"][r],d=$("<button/>",{class:"red-ui-search-result-node red-ui-button","data-pos":s}).appendTo(a);d.on("click",function(e){e.preventDefault(),c.val($(this).data("pos")),l.hide(),u()}),$("<div>",{class:"red-ui-group-layout-picker-cell-text red-ui-group-layout-text-pos-"+s}).appendTo(d),s===c.val()&&(t=d)}u();var l=RED.popover.panel(o);l.show({target:p,onclose:function(){p.focus()}}),t&&t.focus()}),u(),t}({id:"node-input-style-label-position",value:e["label-position"]||"nw"}).appendTo("#node-input-row-style-label-position"),RED.editor.colorPicker.create({id:"node-input-style-color",value:e.color||u.color||"#a4a4a4",palette:t,cellPerRow:o,cellWidth:16,cellHeight:16,cellMargin:3}).appendTo("#node-input-row-style-label-color"),$("#node-input-style-label").toggleButton({enabledLabel:RED._("editor.show"),disabledLabel:RED._("editor.show")}),$("#node-input-style-label").on("change",function(e){$("#node-input-row-style-label-options").toggle($(this).prop("checked"))}),$("#node-input-style-label").prop("checked",this.style.label),$("#node-input-style-label").trigger("change")},oneditresize:function(e){},oneditsave:function(){this.style.stroke=$("#node-input-style-stroke").val(),this.style.fill=$("#node-input-style-fill").val(),this.style["stroke-opacity"]=$("#node-input-style-stroke-opacity").val(),this.style["fill-opacity"]=$("#node-input-style-fill-opacity").val(),this.style.label=$("#node-input-style-label").prop("checked"),this.style.label?(this.style["label-position"]=$("#node-input-style-label-position").val(),this.style.color=$("#node-input-style-color").val()):(delete this.style["label-position"],delete this.style.color);var t=this;["stroke","fill","stroke-opacity","fill-opacity","color","label-position"].forEach(function(e){t.style[e]===u[e]&&delete t.style[e]}),this.resize=!0},set:{module:"node-red"}},init:function(){RED.events.on("view:selection-changed",function(e){var t=!!e.nodes,o=!1,i=!1,n=!1,a=!1;t&&(a=1===e.nodes.length&&"group"===e.nodes[0].type,e.nodes.forEach(function(e){"group"===e.type&&(o=!0),e.g&&(n=!0)}),o&&(i=1<e.nodes.length)),RED.menu.setDisabled("menu-item-group-group",!t),RED.menu.setDisabled("menu-item-group-ungroup",!o),RED.menu.setDisabled("menu-item-group-merge",!i),RED.menu.setDisabled("menu-item-group-remove",!n),RED.menu.setDisabled("menu-item-edit-copy-group-style",!a),RED.menu.setDisabled("menu-item-edit-paste-group-style",!o)}),RED.actions.add("core:group-selection",function(){var e,t;RED.view.state()===RED.state.DEFAULT&&(!(t=RED.view.selection()).nodes||(e=g(t.nodes))&&(t={t:"createGroup",groups:[e],dirty:RED.nodes.dirty()},RED.history.push(t),RED.view.select({nodes:[e]}),RED.nodes.dirty(!0)))}),RED.actions.add("core:ungroup-selection",function(){var e,t,o;RED.view.state()!==RED.state.DEFAULT||(e=RED.view.selection()).nodes&&(t=[],groups=e.nodes.filter(function(e){return"group"===e.type}),o={t:"ungroup",groups:[],dirty:RED.nodes.dirty()},RED.history.push(o),groups.forEach(function(e){t=t.concat(h(e)),o.groups.push(e)}),RED.history.push(o),RED.view.select({nodes:t}),RED.nodes.dirty(!0))}),RED.actions.add("core:merge-selection-to-group",function(){!function(){if(RED.view.state()===RED.state.DEFAULT){var e=RED.view.selection();if(e.nodes){for(var t,o,i,n=[],a={t:"multi",events:[]},r={t:"ungroup",groups:[]},s=0;s<e.nodes.length;s++)if(t=e.nodes[s],0===s)o=t.g;else if(t.g!==o)return RED.notify(RED._("group.errors.cannotCreateDiffGroups"),"error");for(s=0;s<e.nodes.length;s++)"group"===(t=e.nodes[s]).type?(i=i||t,r.groups.push(t),n=n.concat(h(t))):n.push(t),t.dirty=!0;0<r.groups.length&&a.events.push(r);var d=g(n);d&&(i&&(d.style=i.style,d.name=i.name),RED.view.select({nodes:[d]})),a.events.push({t:"createGroup",groups:[d],dirty:RED.nodes.dirty()}),RED.history.push(a),RED.nodes.dirty(!0)}}}()}),RED.actions.add("core:remove-selection-from-group",function(){!function(){if(RED.view.state()===RED.state.DEFAULT){var e=RED.view.selection();if(e.nodes){var t=RED.nodes.group(e.nodes[0].g);if(t)try{m(t,e.nodes,!0);var o={t:"removeFromGroup",dirty:RED.nodes.dirty(),group:t,nodes:e.nodes};RED.history.push(o),RED.nodes.dirty(!0)}catch(e){return RED.notify(e,"error")}RED.view.select({nodes:e.nodes})}}}()}),RED.actions.add("core:copy-group-style",function(){var e;RED.view.state()!==RED.state.DEFAULT||(e=RED.view.selection()).nodes&&1===e.nodes.length&&"group"===e.nodes[0].type&&(p=JSON.parse(JSON.stringify(e.nodes[0].style)),RED.notify(RED._("clipboard.groupStyleCopied"),{id:"clipboard"}),RED.menu.setDisabled("menu-item-edit-paste-group-style",!1))}),RED.actions.add("core:paste-group-style",function(){var e,t;RED.view.state()===RED.state.DEFAULT&&(!p||(e=RED.view.selection()).nodes&&(t={t:"multi",events:[],dirty:RED.nodes.dirty()},e.nodes.forEach(function(e){"group"===e.type&&(t.events.push({t:"edit",node:e,changes:{style:JSON.parse(JSON.stringify(e.style))},dirty:RED.nodes.dirty()}),e.style=JSON.parse(JSON.stringify(p)),e.dirty=!0)}),0<t.events.length&&(RED.history.push(t),RED.nodes.dirty(!0),RED.view.redraw())))}),$('<script type="text/x-red" data-template-name="group"><div class="form-row"><label for="node-input-name" data-i18n="[append]editor:common.label.name"><i class="fa fa-tag"></i> </label><input type="text" id="node-input-name" data-i18n="[placeholder]common.label.name"></div><div class="form-row" id="node-input-row-style-stroke"><label data-i18n="editor:common.label.style"></label><label style="width: 70px;margin-right:10px" for="node-input-style-stroke" data-i18n="editor:common.label.line"></label></div><div class="form-row" style="padding-left: 100px;" id="node-input-row-style-fill"><label style="width: 70px;margin-right: 10px "  for="node-input-style-fill" data-i18n="editor:common.label.fill"></label></div><div class="form-row"><label for="node-input-style-label" data-i18n="editor:common.label.label"></label><input type="checkbox" id="node-input-style-label"/></div><div class="form-row" id="node-input-row-style-label-options"><div style="margin-left: 100px; display: inline-block"><div class="form-row"><span style="display: inline-block; min-width: 140px"  id="node-input-row-style-label-color"><label style="width: 70px;margin-right: 10px" for="node-input-style-fill" data-i18n="editor:common.label.color"></label></span></div><div class="form-row"><span style="display: inline-block; min-width: 140px;" id="node-input-row-style-label-position"><label style="width: 70px;margin-right: 10px " for="node-input-style-label-position" data-i18n="editor:common.label.position"></label></span></div></div></div><\/script>').appendTo("#red-ui-editor-node-configs");var e=$("<div>",{class:"red-ui-flow-group-body",style:"position: absolute; top: -1000px;"}).appendTo(document.body),t=getComputedStyle(e[0]);u={stroke:f(t.stroke),"stroke-opacity":t.strokeOpacity,fill:f(t.fill),"fill-opacity":t.fillOpacity,label:!0,"label-position":"nw"},e.remove(),e=$("<div>",{class:"red-ui-flow-group-label",style:"position: absolute; top: -1000px;"}).appendTo(document.body),t=getComputedStyle(e[0]),u.color=f(t.fill),e.remove()},createGroup:g,ungroup:h,addToGroup:v,removeFromGroup:m,getNodes:function t(e,o,i){var n=[];return e.nodes.forEach(function(e){"group"===e.type&&i||n.push(e),o&&"group"===e.type&&(n=n.concat(t(e,o,i)))}),n},contains:function e(t,o){if(o.g===t.id)return!0;for(var i=0;i<t.nodes.length;i++)if("group"===t.nodes[i].type&&e(t.nodes[i],o))return!0;return!1},markDirty:b}}(),RED.userSettings=function(){var t=700,o=!1,a=[];function e(e){a.push(e)}function r(n){var e;o||(RED.user.hasPermission("settings.write")?(o=!0,e={title:RED._("menu.label.userSettings"),buttons:[{id:"node-dialog-ok",text:RED._("common.label.close"),class:"primary",click:function(){RED.tray.close()}}],resize:function(e){t=e.width},open:function(e){var t=e.find(".red-ui-tray-body"),e=$("<div></div>").appendTo(t),t=$("<div></div>",{class:"red-ui-settings-tabs-container"}).appendTo(e);$("<ul></ul>",{id:"user-settings-tabs"}).appendTo(t);var o=RED.tabs.create({id:"user-settings-tabs",vertical:!0,onchange:function(e){setTimeout(function(){i.children().hide(),$("#"+e.id).show(),e.pane.focus&&e.pane.focus()},50)}}),i=$("<div></div>",{class:"red-ui-settings-tabs-content"}).appendTo(e);a.forEach(function(e){o.addTab({id:"red-ui-settings-tab-"+e.id,label:e.title,pane:e}),e.get().hide().appendTo(i)}),e.i18n(),o.activateTab("red-ui-settings-tab-"+(n||"view")),$("#red-ui-sidebar-shade").show()},close:function(){o=!1,a.forEach(function(e){e.close&&e.close()}),$("#red-ui-sidebar-shade").hide()},show:function(){}},null!==t&&(e.width=t),RED.tray.show(e)):RED.notify(RED._("user.errors.settings"),"error"))}var s=[{options:[]},{title:"menu.label.view.grid",options:[{setting:"view-show-grid",oldSetting:"menu-menu-item-view-show-grid",label:"menu.label.view.showGrid",default:!0,toggle:!0,onchange:"core:toggle-show-grid"},{setting:"view-snap-grid",oldSetting:"menu-menu-item-view-snap-grid",label:"menu.label.view.snapGrid",default:!0,toggle:!0,onchange:"core:toggle-snap-grid"},{setting:"view-grid-size",label:"menu.label.view.gridSize",type:"number",default:10,onchange:RED.view.gridSize}]},{title:"menu.label.nodes",options:[{setting:"view-node-status",oldSetting:"menu-menu-item-status",label:"menu.label.displayStatus",default:!0,toggle:!0,onchange:"core:toggle-status"},{setting:"view-node-show-label",label:"menu.label.showNodeLabelDefault",default:!0,toggle:!0}]},{title:"menu.label.other",options:[{setting:"view-show-tips",oldSettings:"menu-menu-item-show-tips",label:"menu.label.showTips",toggle:!0,default:!0,onchange:"core:toggle-show-tips"},{setting:"view-show-welcome-tours",label:"menu.label.showWelcomeTours",toggle:!0,default:!0}]}],d={};function l(){var n=$('<div id="red-ui-settings-tab-view" class="red-ui-help"></div>'),a=RED.settings.get("editor")||{};return a.view=a.view||{},s.forEach(function(e){e.title&&$("<h3></h3>").text(RED._(e.title)).appendTo(n),e.options.forEach(function(e){var i,t=e.local?localStorage.getItem(e.setting):a.view[e.setting],o=$('<div class="red-ui-settings-row"></div>').appendTo(n);e.toggle?$('<label for="user-settings-'+e.setting+'"><input id="user-settings-'+e.setting+'" type="checkbox"> '+RED._(e.label)+"</label>").appendTo(o).find("input").prop("checked",t):e.options?($('<label for="user-settings-'+e.setting+'">'+RED._(e.label)+"</label>").appendTo(o),i=$('<select id="user-settings-'+e.setting+'"></select>').appendTo(o),"function"==typeof e.options&&(e.options(function(e){e.forEach(function(e){var t=e,o=e;"string"!=typeof e&&(t=e.val,o=e.text),$("<option>").val(t).text(o).appendTo(i)})}),i.val(t))):($('<label for="user-settings-'+e.setting+'">'+RED._(e.label)+"</label>").appendTo(o),$('<input id="user-settings-'+e.setting+'" type="'+(e.type||"text")+'">').appendTo(o).val(t))})}),n}function c(e,t){var o=d[e];o.local?localStorage.setItem(o.setting,t):((e=RED.settings.get("editor")||{}).view=e.view||{},e.view[o.setting]=t,RED.settings.set("editor",e),(e="string"==typeof(e=o.onchange)?RED.actions.get(e):e)&&e.call(o,t))}return{init:function(){RED.actions.add("core:show-user-settings",r),RED.actions.add("core:show-help",function(){r("keyboard")}),e({id:"view",title:RED._("menu.label.view.view"),get:l,close:function(){s.forEach(function(e){e.options.forEach(function(e){var t=$("#user-settings-"+e.setting);e.toggle?c(e.setting,t.prop("checked")):c(e.setting,t.val())})})}});var i=RED.settings.get("editor")||{};i.view=i.view||{};var n=!1;s.forEach(function(e){e.options.forEach(function(e){var t,o;e.local?d[e.setting]=e:(!e.oldSetting||null!=(o=RED.settings.get(e.oldSetting))&&(i.view[e.setting]=o,n=!0,RED.settings.remove(e.oldSetting)),d[e.setting]=e,null==(t=i.view[e.setting])&&e.hasOwnProperty("default")&&(t=e.default,i.view[e.setting]=t,n=!0),!e.onchange||(o="string"==typeof(o=e.onchange)?RED.actions.get(o):o)&&o.call(e,t))})}),n&&RED.settings.set("editor",i)},toggle:function(e){var t=d[e],o=RED.settings.get("editor")||{};o.view=o.view||{},c(e,!o.view[t.setting])},show:r,add:e}}(),RED.projects=function(){var B,n,V;function u(e){var t="git_missing_user"===e.code?RED.notify("<p>"+RED._("projects.errors.no-username-email")+"</p>",{fixed:!0,type:"error",buttons:[{text:RED._("common.label.cancel"),click:function(){t.close()}},{text:RED._("projects.config-git"),click:function(){RED.userSettings.show("gitconfig"),t.close()}}]}):(console.log(e),RED.notify("<p>"+RED._("projects.errors.unexpected")+":</p><p>"+e.message+"</p><small>"+RED._("projects.errors.code")+": "+e.code+"</small>",{fixed:!0,modal:!0,type:"error",buttons:[{text:RED._("common.label.close"),click:function(){t.close()}}]}))}var a={};function t(){var b=$('<div class="red-ui-projects-dialog-screen-start-hero"></div>');$('<span><i class="fa fa-files-o fa-2x"></i> &nbsp; &nbsp; <i class="fa fa-long-arrow-right fa-2x"></i> &nbsp; &nbsp; <i class="fa fa-archive fa-2x"></i></span>').appendTo(b),$("<hr>").appendTo(b);var x,R,k,_,T,C,j,L,z,S,M,O,d,r,s,y,w,E,D,I,N,P,A,f,h,l,c,g={};a={welcome:{content:function(e){var t=$('<div class="red-ui-projects-dialog-screen-start"></div>');b.appendTo(t);var o=$('<div class="red-ui-projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text(RED._("projects.welcome.hello")).appendTo(o),$("<p>").text(RED._("projects.welcome.desc0")).appendTo(o),$("<p>").text(RED._("projects.welcome.desc1")).appendTo(o),$("<p>").text(RED._("projects.welcome.desc2")).appendTo(o);var i=$('<div style="text-align: center"></div>').appendTo(o),o=$('<button data-type="empty" class="red-ui-button red-ui-projects-dialog-button red-ui-projects-dialog-screen-create-type"><i class="fa fa-archive fa-2x"></i><i style="position: absolute;" class="fa fa-asterisk"></i><br/>'+RED._("projects.welcome.create")+"</button>").appendTo(i),i=$('<button data-type="clone" class="red-ui-button red-ui-projects-dialog-button red-ui-projects-dialog-screen-create-type"><i class="fa fa-archive fa-2x"></i><i style="position: absolute;" class="fa fa-git"></i><br/>'+RED._("projects.welcome.clone")+"</button>").appendTo(i);return o.on("click",function(e){e.preventDefault(),g={action:"create"},p("git-config")}),i.on("click",function(e){e.preventDefault(),g={action:"clone"},p("git-config")}),t},buttons:[{text:RED._("projects.welcome.openExistingProject"),class:"secondary",click:function(){g={action:"open"},p("git-config")}},{text:RED._("projects.welcome.not-right-now"),click:function(){g={},$(this).dialog("close")}}]},"git-config":{content:function(e){var t=!1,o=RED.settings.get("git");o&&o.user?o=o.user:RED.settings.git&&RED.settings.git.globalUser&&(t=!0,o=RED.settings.git.globalUser);function i(){var e=l.val().trim(),t=c.val().trim(),t=0<e.length&&0<t.length;$("#red-ui-projects-dialog-git-config").prop("disabled",!t).toggleClass("disabled ui-button-disabled ui-state-disabled",!t)}var n=$('<div class="red-ui-projects-dialog-screen-start"></div>');b.appendTo(n);var a=$('<div class="red-ui-projects-dialog-screen-start-body"></div>').appendTo(n);$("<p>").text(RED._("projects.git-config.setup")).appendTo(a),$("<p>").text(RED._("projects.git-config.desc0")).appendTo(a),$("<p>").text(RED._("projects.git-config.desc1")).appendTo(a),t&&$("<p>").text(RED._("projects.git-config.desc2")).appendTo(a),$("<p>").text(RED._("projects.git-config.desc3")).appendTo(a);t=$('<div class="form-row"></div>').appendTo(a);return $('<label for="">'+RED._("projects.git-config.username")+"</label>").appendTo(t),(l=$('<input type="text">').val(o&&o.name||"").appendTo(t)).on("change keyup paste",i),t=$('<div class="form-row"></div>').appendTo(a),$('<label for="">'+RED._("projects.git-config.email")+"</label>").appendTo(t),(c=$('<input type="text">').val(o&&o.email||"").appendTo(t)).on("change keyup paste",i),setTimeout(function(){l.trigger("focus"),i()},50),n},buttons:[{text:RED._("common.label.back"),click:function(){p("welcome")}},{id:"red-ui-projects-dialog-git-config",text:RED._("common.label.next"),class:"primary",click:function(){var e=RED.settings.get("git")||{};e.user=e.user||{},e.user.name=l.val(),e.user.email=c.val(),RED.settings.set("git",e),"create"===g.action?p("project-details"):"clone"===g.action?p("clone-project"):"open"===g.action&&p("create",{screen:"open"})}}]},"project-details":{content:function(e){var o=null,i=!1;$.getJSON("projects",function(e){o={},e.projects.forEach(function(e){o[e]=!0,i&&(i=!1,a())})});var t=$('<div class="red-ui-projects-dialog-screen-start"></div>');b.appendTo(t);var n=$('<div class="red-ui-projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text(RED._("projects.project-details.create")).appendTo(n),$("<p>").text(RED._("projects.project-details.desc0")).appendTo(n),$("<p>").text(RED._("projects.project-details.desc1")).appendTo(n),$("<p>").text(RED._("projects.project-details.desc2")).appendTo(n);var a=function(){var e=f.val(),t=!0;if(p){if(null===o)return void(i=!0);c.empty(),!/^[a-zA-Z0-9\-_]+$/.test(e)||o[e]?(f.addClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>').appendTo(c),t=d=!1,o[e]?projectNameSublabel.text(RED._("projects.project-details.already-exists")):projectNameSublabel.text(RED._("projects.project-details.must-contain"))):(f.removeClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-check"></i>').appendTo(c),projectNameSublabel.text(RED._("projects.project-details.must-contain")),d=!0),u=e}t=d,$("#red-ui-projects-dialog-create-name").prop("disabled",!t).toggleClass("disabled ui-button-disabled ui-state-disabled",!t)},r=$('<div class="form-row"></div>').appendTo(n);$('<label for="red-ui-projects-dialog-screen-create-project-name">'+RED._("projects.project-details.project-name")+"</label>").appendTo(r);var s=$('<div style="position:relative;"></div>').appendTo(r);f=$('<input id="red-ui-projects-dialog-screen-create-project-name" type="text"></input>').val(g.name||"").appendTo(s);var d,l,c=$('<div class="red-ui-projects-dialog-screen-input-status"></div>').appendTo(s),p=!1,u="";return f.on("change keyup paste",function(){if(p=f.val()!==u,l)clearTimeout(l);else if(p&&(c.empty(),$('<img src="red/images/spin.svg"/>').appendTo(c),""===f.val()))return void a();l=setTimeout(function(){a(),l=null},300)}),projectNameSublabel=$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.project-details.must-contain")+"</small></label>").appendTo(r).find("small"),r=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-empty"></div>').appendTo(n),$('<label for="red-ui-projects-dialog-screen-create-project-desc">'+RED._("projects.project-details.desc")+"</label>").appendTo(r),h=$('<input id="red-ui-projects-dialog-screen-create-project-desc" type="text">').val(g.summary||"").appendTo(r),$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.project-details.opt")+"</small></label>").appendTo(r),setTimeout(function(){f.trigger("focus"),f.trigger("change")},50),t},buttons:function(e){return[{text:RED._("common.label.back"),click:function(){p("git-config")}},{id:"red-ui-projects-dialog-create-name",disabled:!0,text:RED._("common.label.next"),class:"primary disabled",click:function(){g.name=f.val(),g.summary=h.val(),p("default-files",e)}}]}},"clone-project":{content:function(e){var t=$('<div class="red-ui-projects-dialog-screen-start"></div>');b.appendTo(t);var o=$('<div class="red-ui-projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text(RED._("projects.clone-project.clone")).appendTo(o),$("<p>").text(RED._("projects.clone-project.desc0")).appendTo(o);var i=null,n=!1;$.getJSON("projects",function(e){i={},e.projects.forEach(function(e){i[e]=!0,n&&(n=!1,a())})});var a=function(){var e=y.val(),t=!0;if(p){if(null===i)return void(n=!0);c.empty(),!/^[a-zA-Z0-9\-_]+$/.test(e)||i[e]?(y.addClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>').appendTo(c),t=d=!1,i[e]?N.text(RED._("projects.clone-project.already-exists")):N.text(RED._("projects.clone-project.must-contain"))):(y.removeClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-check"></i>').appendTo(c),N.text(RED._("projects.clone-project.must-contain")),d=!0),u=e}var t=d,o=E.val(),e=0<o.length&&!/\s/.test(o);/^https?:\/\/[^/]+@/i.test(o)&&($("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.clone-project.no-info-in-url")),e=!1),e?E.removeClass("input-error"):(h&&E.addClass("input-error"),t=!1),/^https?:\/\//.test(o)?($(".red-ui-projects-dialog-screen-create-row-creds").show(),$(".red-ui-projects-dialog-screen-create-row-sshkey").hide()):/^(?:ssh|[\S]+?@[\S]+?):(?:\/\/)?/.test(o)?($(".red-ui-projects-dialog-screen-create-row-creds").hide(),$(".red-ui-projects-dialog-screen-create-row-sshkey").show()):($(".red-ui-projects-dialog-screen-create-row-creds").hide(),$(".red-ui-projects-dialog-screen-create-row-sshkey").hide()),$("#red-ui-projects-dialog-clone-project").prop("disabled",!t).toggleClass("disabled ui-button-disabled ui-state-disabled",!t)},r=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-empty red-ui-projects-dialog-screen-create-row-clone"></div>').appendTo(o);$('<label for="red-ui-projects-dialog-screen-create-project-name">'+RED._("projects.clone-project.project-name")+"</label>").appendTo(r);var s=$('<div style="position:relative;"></div>').appendTo(r);y=$('<input id="red-ui-projects-dialog-screen-create-project-name" type="text"></input>').appendTo(s);var d,l,c=$('<div class="red-ui-projects-dialog-screen-input-status"></div>').appendTo(s),p=!1,u="",f="";y.on("change keyup paste",function(){if(p=y.val()!==u,l)clearTimeout(l);else if(p&&(c.empty(),$('<img src="red/images/spin.svg"/>').appendTo(c),""===y.val()))return void a();l=setTimeout(function(){a(),l=null},300)}),N=$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.clone-project.must-contain")+"</small></label>").appendTo(r).find("small"),r=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-clone"></div>').appendTo(o),$('<label for="red-ui-projects-dialog-screen-create-project-repo">'+RED._("projects.clone-project.git-url")+"</label>").appendTo(r),E=$('<input id="red-ui-projects-dialog-screen-create-project-repo" type="text" placeholder="https://git.example.com/path/my-project.git"></input>').appendTo(r),$('<label id="red-ui-projects-dialog-screen-create-project-repo-label" class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.clone-project.protocols")+"</small></label>").appendTo(r);var h=!1,g="";E.on("change keyup paste",function(){h=!0;var e=$(this).val();g!==e&&$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.clone-project.protocols")),g=e;var t=/\/([^/]+?)(?:\.git)?$/.exec(e);t&&(""!==(e=y.val())&&e!==f||(f=t[1],y.val(f),y.trigger("change"))),a()});var v=$('<div class="red-ui-projects-dialog-screen-create-row"></div>').appendTo(o);r=$('<div class="form-row red-ui-projects-dialog-screen-create-row-auth-error"></div>').hide().appendTo(v),$('<div><i class="fa fa-warning"></i> '+RED._("projects.clone-project.auth-failed")+"</div>").appendTo(r),r=$('<div class="hide form-row red-ui-projects-dialog-screen-create-row-creds"></div>').hide().appendTo(v);s=$('<div style="width: calc(50% - 10px); display:inline-block;"></div>').appendTo(r);$('<label for="red-ui-projects-dialog-screen-create-project-repo-user">'+RED._("projects.clone-project.username")+"</label>").appendTo(s),D=$('<input id="red-ui-projects-dialog-screen-create-project-repo-user" type="text"></input>').appendTo(s),s=$('<div style="width: calc(50% - 10px); margin-left: 20px; display:inline-block;"></div>').appendTo(r),$('<label for="red-ui-projects-dialog-screen-create-project-repo-pass">'+RED._("projects.clone-project.passwd")+"</label>").appendTo(s),(I=$('<input style="width:100%" id="red-ui-projects-dialog-screen-create-project-repo-pass" type="password"></input>').appendTo(s)).typedInput({type:"cred"}),r=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-sshkey"></div>').hide().appendTo(v),s=$('<div style="width: calc(50% - 10px); display:inline-block;"></div>').appendTo(r),$('<label for="red-ui-projects-dialog-screen-create-project-repo-passphrase">'+RED._("projects.clone-project.ssh-key")+"</label>").appendTo(s),P=$("<select>",{style:"width: 100%"}).appendTo(s),$.getJSON("settings/user/keys",function(e){var t=0;e.keys.forEach(function(e){P.append($("<option></option>").val(e.name).text(e.name)),t++}),0===t?(P.addClass("input-error"),P.attr("disabled",!0),m.show()):(P.removeClass("input-error"),P.attr("disabled",!1),m.hide())}),s=$('<div style="width: calc(50% - 10px); margin-left: 20px; display:inline-block;"></div>').appendTo(r),$('<label for="red-ui-projects-dialog-screen-create-project-repo-passphrase">'+RED._("projects.clone-project.passphrase")+"</label>").appendTo(s),(A=$('<input id="red-ui-projects-dialog-screen-create-project-repo-passphrase" type="password"></input>').appendTo(s)).typedInput({type:"cred"}),s=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-sshkey"></div>').appendTo(v);var m=$('<div class="red-ui-projects-dialog-screen-create-row-auth-error-no-keys"></div>').hide().appendTo(s);return $('<div class="form-row"><i class="fa fa-warning"></i> '+RED._("projects.clone-project.ssh-key-desc")+"</div>").appendTo(m),s=$('<div style="text-align: center">').appendTo(m),$('<button class="red-ui-button red-ui-projects-dialog-button">'+RED._("projects.clone-project.ssh-key-add")+"</button>").appendTo(s).on("click",function(e){e.preventDefault(),B.dialog("close"),RED.userSettings.show("gitconfig"),setTimeout(function(){$("#user-settings-gitconfig-add-key").trigger("click")},500)}),r=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-clone"></div>').appendTo(o),$("<label>"+RED._("projects.clone-project.credential-key")+"</label>").appendTo(r),(w=$('<input style="width: 100%" type="password"></input>').appendTo(r)).typedInput({type:"cred"}),t},buttons:function(e){return[{text:RED._("common.label.back"),click:function(){p("git-config")}},{id:"red-ui-projects-dialog-clone-project",disabled:!0,text:RED._("common.label.clone"),class:"primary disabled",click:function(){$(".red-ui-projects-dialog-screen-create-type.selected").data("type");var e={name:y.val()};e.credentialSecret=w.val();var t=E.val();if(/^(?:ssh|[\d\w\.\-_]+@[\w\.]+):(?:\/\/)?/.test(t)){var o=P.val();if(!o)return void console.log(RED._("projects.clone-project.cant-get-ssh-key"));e.git={remotes:{origin:{url:t,keyFile:o,passphrase:A.val()}}}}else e.git={remotes:{origin:{url:t,username:D.val(),password:I.val()}}};$(".red-ui-projects-dialog-screen-create-row-auth-error").hide(),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.clone-project.protocols")),D.removeClass("input-error"),I.removeClass("input-error"),P.removeClass("input-error"),A.removeClass("input-error"),RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(e.name),H({url:"projects",type:"POST",handleAuthFail:!1,responses:{200:function(e){B.dialog("close")},400:{project_exists:function(e){console.log(RED._("projects.clone-project.already-exists2"))},git_error:function(e){console.log(RED._("projects.clone-project.git-error"),e)},git_connection_failed:function(e){E.addClass("input-error"),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.clone-project.connection-failed"))},git_not_a_repository:function(e){E.addClass("input-error"),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.clone-project.not-git-repo"))},git_repository_not_found:function(e){E.addClass("input-error"),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.clone-project.repo-not-found"))},git_auth_failed:function(e){$(".red-ui-projects-dialog-screen-create-row-auth-error").show(),D.addClass("input-error"),I.addClass("input-error"),P.addClass("input-error"),A.addClass("input-error")},missing_flow_file:function(e){B.dialog("close")},missing_package_file:function(e){B.dialog("close")},project_empty:function(e){B.dialog("close")},credentials_load_failed:function(e){B.dialog("close")},"*":function(e){u(e),$(B).dialog("close")}}}},e).then(function(){RED.menu.setDisabled("menu-item-projects-open",!1),RED.menu.setDisabled("menu-item-projects-settings",!1),RED.events.emit("project:change",{name:name})}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]}},"default-files":{content:function(e){var t=$('<div class="red-ui-projects-dialog-screen-start"></div>');b.appendTo(t);var o=$('<div class="red-ui-projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text(RED._("projects.default-files.create")).appendTo(o),$("<p>").text(RED._("projects.default-files.desc0")).appendTo(o),$("<p>").text(RED._("projects.default-files.desc1")).appendTo(o),!e.existingProject&&RED.settings.files&&$("<p>").text(RED._("projects.default-files.desc2")).appendTo(o);function i(){var e=!0,t=r.val();""!==t&&/\.json$/.test(t)?(r.hasClass("input-error")&&(r.removeClass("input-error"),r.next().empty()),s.hasClass("input-error")&&(s.removeClass("input-error"),s.next().empty()),s.text(t.substring(0,t.length-5)+"_cred.json")):(e=!1,r.hasClass("input-error")||(r.addClass("input-error"),r.next().empty().append('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>')),s.text(""),s.hasClass("input-error")||(s.addClass("input-error"),s.next().empty().append('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>'))),$("#red-ui-projects-dialog-create-default-files").prop("disabled",!e).toggleClass("disabled ui-button-disabled ui-state-disabled",!e)}var n=$('<div class="form-row"></div>').appendTo(o);$('<label for="red-ui-projects-dialog-screen-create-project-file">'+RED._("projects.default-files.flow-file")+"</label>").appendTo(n);var a=$('<div style="position:relative;"></div>').appendTo(n),e=g.files&&g.files.flow||RED.settings.files&&RED.settings.files.flow||"flow.json";r=$('<input id="red-ui-projects-dialog-screen-create-project-file" type="text">').val(e).on("change keyup paste",i).appendTo(a),$('<div class="red-ui-projects-dialog-screen-input-status"></div>').appendTo(a),$('<label class="red-ui-projects-edit-form-sublabel"><small>*.json</small></label>').appendTo(n);e=g.files&&g.files.credentials||RED.settings.files&&RED.settings.files.credentials||"flow_cred.json",n=$('<div class="form-row"></div>').appendTo(o);return $('<label for="red-ui-projects-dialog-screen-create-project-credfile">'+RED._("projects.default-files.credentials-file")+"</label>").appendTo(n),a=$('<div style="position:relative;"></div>').appendTo(n),s=$('<div style="width: 100%" class="uneditable-input" id="red-ui-projects-dialog-screen-create-project-credentials">').text(e).appendTo(a),$('<div class="red-ui-projects-dialog-screen-input-status"></div>').appendTo(a),setTimeout(function(){r.trigger("focus"),i()},50),t},buttons:function(e){return[{text:RED._(e.existingProject?"common.label.cancel":"common.label.back"),click:function(){e.existingProject?$(this).dialog("close"):p("project-details",e)}},{id:"red-ui-projects-dialog-create-default-files",text:RED._("common.label.next"),class:"primary",click:function(){g.files={flow:r.val(),credentials:s.text()},e.existingProject||(g.migrateFiles=!0),p("encryption-config",e)}}]}},"encryption-config":{content:function(e){var t=$('<div class="red-ui-projects-dialog-screen-start"></div>');b.appendTo(t);var o=$('<div class="red-ui-projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text(RED._("projects.encryption-config.setup")).appendTo(o),e.existingProject?($("<p>").text(RED._("projects.encryption-config.desc0")).appendTo(o),$("<p>").text(RED._("projects.encryption-config.desc1")).appendTo(o)):"disabled"===RED.settings.flowEncryptionType?($("<p>").text(RED._("projects.encryption-config.desc2")).appendTo(o),$("<p>").text(RED._("projects.encryption-config.desc3")).appendTo(o),$("<p>").text(RED._("projects.encryption-config.desc4")).appendTo(o)):("user"===RED.settings.flowEncryptionType?$("<p>").text(RED._("projects.encryption-config.desc5")).appendTo(o):"system"===RED.settings.flowEncryptionType&&$("<p>").text(RED._("projects.encryption-config.desc6")).appendTo(o),$("<p>").text(RED._("projects.encryption-config.desc7")).appendTo(o));function i(){var e=!0;"enabled"===$("input[name=projects-encryption-type]:checked").val()&&"custom"===$("input[name=projects-encryption-key]:checked").val()&&(e=e&&""!==d.val()),$("#red-ui-projects-dialog-create-encryption").prop("disabled",!e).toggleClass("disabled ui-button-disabled ui-state-disabled",!e)}e=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-empty"></div>').appendTo(o);$("<label>"+RED._("projects.encryption-config.credentials")+"</label>").appendTo(e);var o=$('<div class="red-ui-projects-dialog-credentials-box">').appendTo(e),n=$('<div class="red-ui-projects-dialog-credentials-box-right">').appendTo(o),a=$('<div class="red-ui-projects-dialog-credentials-box-left">').appendTo(o),r=$('<div class="form-row red-ui-projects-dialog-credentials-box-enabled"></div>').appendTo(a);$('<label class="red-ui-projects-edit-form-inline-label"><input type="radio" name="projects-encryption-type" value="enabled"> <i class="fa fa-lock"></i> <span>'+RED._("projects.encryption-config.enable")+"</span></label>").appendTo(r);var s=$('<div class="form-row red-ui-projects-dialog-credentials-box-disabled"></div>').appendTo(a);return $('<label class="red-ui-projects-edit-form-inline-label"><input type="radio" name="projects-encryption-type" value="disabled"> <i class="fa fa-unlock"></i> <span>'+RED._("projects.encryption-config.disable")+"</span></label>").appendTo(s),a.find("input[name=projects-encryption-type]").on("click",function(e){var t,o;"enabled"===$(this).val()?(t=r,o=s,$(".projects-encryption-enabled-row").show(),$(".projects-encryption-disabled-row").hide(),"custom"===$("input[name=projects-encryption-key]:checked").val()&&d.trigger("focus")):(o=r,t=s,$(".projects-encryption-enabled-row").hide(),$(".projects-encryption-disabled-row").show()),t.removeClass("disabled"),o.addClass("disabled"),i()}),e=$('<div class="form-row projects-encryption-enabled-row"></div>').appendTo(n),$('<label class="red-ui-projects-edit-form-inline-label '+("user"!==RED.settings.flowEncryptionType?"disabled":"")+'" style="margin-left: 5px"><input '+("user"!==RED.settings.flowEncryptionType?RED._("projects.encryption-config.disabled"):"")+' type="radio" style="vertical-align: middle; margin-top:0; margin-right: 10px;" value="default" name="projects-encryption-key"> <span style="vertical-align: middle;">'+RED._("projects.encryption-config.copy")+"</span></label>").appendTo(e),e=$('<div class="form-row projects-encryption-enabled-row"></div>').appendTo(n),$('<label class="red-ui-projects-edit-form-inline-label" style="margin-left: 5px"><input type="radio" style="vertical-align: middle; margin-top:0; margin-right: 10px;" value="custom" name="projects-encryption-key"> <span style="vertical-align: middle;">'+RED._("projects.encryption-config.use-custom")+"</span></label>").appendTo(e),e=$('<div class="projects-encryption-enabled-row"></div>').appendTo(n),(d=$('<input disabled type="password" style="margin-left: 25px; width: calc(100% - 30px);"></input>').appendTo(e)).typedInput({type:"cred"}),d.on("change keyup paste",i),e=$('<div class="form-row projects-encryption-disabled-row"></div>').hide().appendTo(n),$('<div class="" style="padding: 5px 20px;"><i class="fa fa-warning"></i> '+RED._("projects.encryption-config.desc8")+"</div>").appendTo(e),n.find("input[name=projects-encryption-key]").on("click",function(){var e=$(this).val();d.attr("disabled","default"===e),"custom"===e&&d.trigger("focus"),i()}),setTimeout(function(){a.find("input[name=projects-encryption-type][value=enabled]").trigger("click"),("user"!==RED.settings.flowEncryptionType?n.find("input[name=projects-encryption-key][value=custom]"):n.find("input[name=projects-encryption-key][value=default]")).trigger("click"),i()},100),t},buttons:function(i){return[{text:RED._("common.label.back"),click:function(){p("default-files",i)}},{id:"red-ui-projects-dialog-create-encryption",text:RED._(i.existingProject?"projects.encryption-config.create-project-files":"projects.encryption-config.create-project"),class:"primary disabled",disabled:!0,click:function(){"enabled"===$("input[name=projects-encryption-type]:checked").val()?"custom"===$("input[name=projects-encryption-key]:checked").val()&&(g.credentialSecret=d.val()):g.credentialSecret=!1,RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(g.name);var e="POST",t="projects";i.existingProject&&(g.initialise=!0,e="PUT",t="projects/"+V.name);var o=this;H({url:t,type:e,requireCleanWorkspace:!0,handleAuthFail:!1,responses:{200:function(e){g={},i.existingProject?$(o).dialog("close"):(p("create-success"),RED.menu.setDisabled("menu-item-projects-open",!1),RED.menu.setDisabled("menu-item-projects-settings",!1))},400:{project_exists:function(e){console.log(RED._("projects.encryption-config.already-exists"))},git_error:function(e){console.log(RED._("projects.encryption-config.git-error"),e)},git_connection_failed:function(e){projectRepoInput.addClass("input-error")},git_auth_failed:function(e){projectRepoUserInput.addClass("input-error"),projectRepoPasswordInput.addClass("input-error"),console.log(RED._("projects.encryption-config.git-auth-error"),e)},"*":function(e){u(e),$(B).dialog("close")}}}},g).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]}},"create-success":{content:function(e){var t=$('<div class="red-ui-projects-dialog-screen-start"></div>');b.appendTo(t);var o=$('<div class="red-ui-projects-dialog-screen-start-body"></div>').appendTo(t);return $("<p>").text(RED._("projects.create-success.success")).appendTo(o),$("<p>").text(RED._("projects.create-success.desc0")).appendTo(o),$("<p>").text(RED._("projects.create-success.desc1")).appendTo(o),$("<p>").text(RED._("projects.create-success.desc2")).appendTo(o),t},buttons:[{text:RED._("common.label.done"),click:function(){$(this).dialog("close")}}]},create:{title:RED._("projects.create.projects"),content:function(e){var n=null;O=null;var a=!1;$.getJSON("projects",function(e){n={},e.projects.forEach(function(e){n[e]=!0,a&&(a=!1,i())})});var t=$('<div class="red-ui-projects-dialog-screen-create"></div>'),i=function(){var e=x.val(),t=!0;if(f){if(null===n)return void(a=!0);u.empty(),!/^[a-zA-Z0-9\-_]+$/.test(e)||n[e]?(x.addClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>').appendTo(u),t=c=!1,n[e]?z.text(RED._("projects.create.already-exists")):z.text(RED._("projects.create.must-contain"))):(x.removeClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-check"></i>').appendTo(u),z.text(RED._("projects.create.must-contain")),c=!0),h=e}var o,t=c,i=$(".red-ui-projects-dialog-screen-create-type.selected").data("type");"copy"===i?t=!1:"clone"===i?(e=0<(o=T.val()).length&&!/\s/.test(o),/^https?:\/\/[^/]+@/i.test(o)&&($("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.create.no-info-in-url")),e=!1),e?T.removeClass("input-error"):(w&&T.addClass("input-error"),t=!1),/^https?:\/\//.test(o)?($(".red-ui-projects-dialog-screen-create-row-creds").show(),$(".red-ui-projects-dialog-screen-create-row-sshkey").hide()):/^(?:ssh|[\S]+?@[\S]+?):(?:\/\/)?/.test(o)?($(".red-ui-projects-dialog-screen-create-row-creds").hide(),$(".red-ui-projects-dialog-screen-create-row-sshkey").show()):($(".red-ui-projects-dialog-screen-create-row-creds").hide(),$(".red-ui-projects-dialog-screen-create-row-sshkey").hide())):"empty"===i?(""!==(o=k.val())&&/\.json$/.test(o)?k.hasClass("input-error")&&(k.removeClass("input-error"),k.next().empty()):(t=!1,k.hasClass("input-error")||(k.addClass("input-error"),k.next().empty().append('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>'))),"enabled"===$("input[name=projects-encryption-type]:checked").val()&&"custom"===$("input[name=projects-encryption-key]:checked").val()&&(t=t&&""!==C.val())):"open"===i&&(t=!!O),$("#red-ui-projects-dialog-create").prop("disabled",!t).toggleClass("disabled ui-button-disabled ui-state-disabled",!t)},o=$('<div class="form-row button-group"></div>').appendTo(t),r=$('<button data-type="open" class="red-ui-button red-ui-projects-dialog-button red-ui-projects-dialog-screen-create-type toggle"><i class="fa fa-archive fa-2x"></i><i style="position: absolute;" class="fa fa-folder-open"></i><br/>'+RED._("projects.create.open")+"</button>").appendTo(o),s=$('<button data-type="empty" class="red-ui-button red-ui-projects-dialog-button red-ui-projects-dialog-screen-create-type toggle"><i class="fa fa-archive fa-2x"></i><i style="position: absolute;" class="fa fa-asterisk"></i><br/>'+RED._("projects.create.create")+"</button>").appendTo(o),d=$('<button data-type="clone" class="red-ui-button red-ui-projects-dialog-button red-ui-projects-dialog-screen-create-type toggle"><i class="fa fa-archive fa-2x"></i><i style="position: absolute;" class="fa fa-git"></i><br/>'+RED._("projects.create.clone")+"</button>").appendTo(o);o.find(".red-ui-projects-dialog-screen-create-type").on("click",function(e){switch(e.preventDefault(),t.find(".red-ui-projects-dialog-screen-create-type").removeClass("selected"),$(this).addClass("selected"),t.find(".red-ui-projects-dialog-screen-create-row").hide(),t.find(".red-ui-projects-dialog-screen-create-row-"+$(this).data("type")).show(),i(),x.trigger("focus"),$(this).data("type")){case"open":$("#red-ui-projects-dialog-create").text(RED._("projects.create.open"));break;case"empty":$("#red-ui-projects-dialog-create").text(RED._("projects.create.create"));break;case"clone":$("#red-ui-projects-dialog-create").text(RED._("projects.create.clone"))}}),o=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-open"></div>').hide().appendTo(t),function(r){r=r||{};var i,e=$("<div></div>",{class:"red-ui-projects-dialog-project-list-container"}),t="",o=$("<div>",{class:"red-ui-search-container"}).appendTo(e),s=$('<input id="red-ui-projects-dialog-project-list-search" type="text" placeholder="'+RED._("projects.create-project-list.search")+'">').appendTo(o).searchBox({delay:200,change:function(){t=$(this).val().toLowerCase(),l.editableList("filter"),i&&!i.is(":visible")&&i.children().children().removeClass("selected"),(i=l.children(":visible").first()).children().children().addClass("selected"),r.select&&r.select(i.children().data("data")),d()}});s.on("keydown",function(e){if(40===e.keyCode){e.preventDefault();var t=i;if(i){for(;0!==(t=t.next()).length&&!t.is(":visible"););if(0===t.length)return;i.children().children().removeClass("selected")}else t=l.children(":visible").first();(i=t).children().children().addClass("selected"),r.select&&r.select(i.children().data("data")),d()}else if(38===e.keyCode){e.preventDefault();var o=i;if(i){for(;0!==(o=o.prev()).length&&!o.is(":visible"););if(0===o.length)return;i.children().children().removeClass("selected")}else o=l.children(":visible").first();(i=o).children().children().addClass("selected"),r.select&&r.select(i.children().data("data")),d()}else 13===e.keyCode&&(e.preventDefault(),i&&r.dblclick&&r.dblclick(i.children().data("data")))}),s.i18n();var d=function(){var e,t,o,i=l.find(".red-ui-projects-dialog-project-list-entry.selected").parent().parent();1===i.length&&(t=(e=n).height(),e.scrollTop(),t<(o=i.position().top)+(i=i.height())?e.animate({scrollTop:"-="+(t-o-i)},50):o<0&&e.animate({scrollTop:"+="+o},50))},n=$("<div></div>",{class:"red-ui-projects-dialog-project-list-inner-container"}).appendTo(e),l=$("<ol>",{class:"red-ui-projects-dialog-project-list"}).appendTo(n).editableList({addButton:!1,height:"auto",scrollOnAdd:!1,addItem:function(n,e,a){var t,o=$("<div></div>",{class:"red-ui-projects-dialog-project-list-entry"}).appendTo(n);$('<span class="red-ui-projects-dialog-project-list-entry-icon"><i class="fa fa-archive"></i></span>').appendTo(o),$('<span class="red-ui-projects-dialog-project-list-entry-name" style=""></span>').text(a.name).appendTo(o),V&&V.name===a.name&&(o.addClass("projects-list-entry-current"),$('<span class="red-ui-projects-dialog-project-list-entry-current">'+RED._("projects.create-project-list.current")+"</span>").appendTo(o),!1===r.canSelectActive)||(o.addClass("selectable"),t=$('<div class="red-ui-projects-dialog-project-list-entry-tools"></div>').appendTo(o),$('<button class="red-ui-button red-ui-projects-dialog-button red-ui-button-small" style="float: right;"><i class="fa fa-trash"></i></button>').appendTo(t).on("click",function(e){var t,o,i;e.stopPropagation(),e.preventDefault(),e=n,t=a.name,o=function(e){e||n.fadeOut(300,function(){l.editableList("removeItem",a),r.delete&&r.delete(a)})},i=$('<div class="red-ui-projects-dialog-project-list-entry-delete-confirm"></div>').on("click",function(e){e.stopPropagation()}).appendTo(e),$("<span>").text(RED._("projects.delete.confirm")).appendTo(i),$('<button class="red-ui-button red-ui-projects-dialog-button">'+RED._("common.label.cancel")+"</button>").appendTo(i).on("click",function(e){e.stopPropagation(),i.remove(),o(!0)}),$('<button class="red-ui-button red-ui-projects-dialog-button primary">'+RED._("common.label.delete")+"</button>").appendTo(i).on("click",function(e){e.stopPropagation(),i.remove(),H({url:"projects/"+t,type:"DELETE",responses:{200:function(e){o(!1)},400:{unexpected_error:function(e){i.remove(),o(!0)}}}})}),setTimeout(function(){i.css("left",0)},50)}),n.on("click",function(e){$(".red-ui-projects-dialog-project-list-entry").removeClass("selected"),o.addClass("selected"),i=n.parent(),r.select&&r.select(a),d(),s.trigger("focus")}),r.dblclick&&n.on("dblclick",function(e){e.preventDefault(),r.dblclick(a)}))},filter:function(e){return""===t||-1!==e.name.toLowerCase().indexOf(t)}});return $.getJSON("projects",function(e){e.projects.forEach(function(e){l.editableList("addItem",{name:e})})}),e}({canSelectActive:!1,dblclick:function(e){O=e,$("#red-ui-projects-dialog-create").trigger("click")},select:function(e){O=e,i()},delete:function(e){n&&delete n[e.name],O=null,i()}}).appendTo(o),o=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-empty red-ui-projects-dialog-screen-create-row-clone"></div>').appendTo(t),$('<label for="red-ui-projects-dialog-screen-create-project-name">'+RED._("projects.create.project-name")+"</label>").appendTo(o);var l=$('<div style="position:relative;"></div>').appendTo(o);x=$('<input id="red-ui-projects-dialog-screen-create-project-name" type="text"></input>').appendTo(l);var c,p,u=$('<div class="red-ui-projects-dialog-screen-input-status"></div>').appendTo(l),f=!1,h="",g="";x.on("change keyup paste",function(){if(f=x.val()!==h,p)clearTimeout(p);else if(f&&(u.empty(),$('<img src="red/images/spin.svg"/>').appendTo(u),""===x.val()))return void i();p=setTimeout(function(){i(),p=null},300)}),z=$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.create.must-contain")+"</small></label>").appendTo(o).find("small"),o=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-empty"></div>').appendTo(t),$('<label for="red-ui-projects-dialog-screen-create-project-desc">'+RED._("projects.create.desc")+"</label>").appendTo(o),R=$('<input id="red-ui-projects-dialog-screen-create-project-desc" type="text">').appendTo(o),$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.create.opt")+"</small></label>").appendTo(o),o=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-empty"></div>').appendTo(t),$('<label for="red-ui-projects-dialog-screen-create-project-file">'+RED._("projects.create.flow-file")+"</label>").appendTo(o),l=$('<div style="position:relative;"></div>').appendTo(o),k=$('<input id="red-ui-projects-dialog-screen-create-project-file" type="text">').val("flow.json").on("change keyup paste",i).appendTo(l),$('<div class="red-ui-projects-dialog-screen-input-status"></div>').appendTo(l),$('<label class="red-ui-projects-edit-form-sublabel"><small>*.json</small></label>').appendTo(o),o=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-empty"></div>').appendTo(t),$("<label>"+RED._("projects.create.credentials")+"</label>").appendTo(o);var v=$('<div class="red-ui-projects-dialog-credentials-box">').appendTo(o),m=$('<div class="red-ui-projects-dialog-credentials-box-right">').appendTo(v),v=$('<div class="red-ui-projects-dialog-credentials-box-left">').appendTo(v),b=$('<div class="form-row red-ui-projects-dialog-credentials-box-enabled"></div>').appendTo(v);$('<label class="red-ui-projects-edit-form-inline-label"><input type="radio" name="projects-encryption-type" value="enabled"> <i class="fa fa-lock"></i> <span>'+RED._("projects.encryption-config.enable")+"</span></label>").appendTo(b);var y=$('<div class="form-row red-ui-projects-dialog-credentials-box-disabled disabled"></div>').appendTo(v);$('<label class="red-ui-projects-edit-form-inline-label"><input type="radio" name="projects-encryption-type" value="disabled"> <i class="fa fa-unlock"></i> <span>'+RED._("projects.encryption-config.disable")+"</span></label>").appendTo(y),v.find("input[name=projects-encryption-type]").on("click",function(e){var t,o;"enabled"===$(this).val()?(t=b,o=y,$(".projects-encryption-enabled-row").show(),$(".projects-encryption-disabled-row").hide(),"custom"===$("input[name=projects-encryption-key]:checked").val()&&C.trigger("focus")):(o=b,t=y,$(".projects-encryption-enabled-row").hide(),$(".projects-encryption-disabled-row").show()),t.removeClass("disabled"),o.addClass("disabled"),i()}),o=$('<div class="form-row projects-encryption-enabled-row"></div>').appendTo(m),$('<label class="red-ui-projects-edit-form-inline-label">'+RED._("projects.create.encryption-key")+"</label>").appendTo(o),(C=$('<input type="password"></input>').appendTo(o)).typedInput({type:"cred"}),C.on("change keyup paste",i),$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.create.desc0")+"</small></label>").appendTo(o),o=$('<div class="form-row projects-encryption-disabled-row"></div>').hide().appendTo(m),$('<div class="" style="padding: 5px 20px;"><i class="fa fa-warning"></i> '+RED._("projects.create.desc1")+"</div>").appendTo(o),m.find("input[name=projects-encryption-key]").on("click",function(){var e=$(this).val();C.attr("disabled","default"===e),"custom"===e&&C.trigger("focus"),i()}),o=$('<div class="hide form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-clone"></div>').appendTo(t),$('<label for="red-ui-projects-dialog-screen-create-project-repo">'+RED._("projects.create.git-url")+"</label>").appendTo(o),T=$('<input id="red-ui-projects-dialog-screen-create-project-repo" type="text" placeholder="https://git.example.com/path/my-project.git"></input>').appendTo(o),$('<label id="red-ui-projects-dialog-screen-create-project-repo-label" class="red-ui-projects-edit-form-sublabel"><small>'+RED._("projects.create.protocols")+"</small></label>").appendTo(o);var w=!1,E="";T.on("change keyup paste",function(){w=!0;var e=$(this).val();E!==e&&$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.create.protocols")),E=e;var t=/\/([^/]+?)(?:\.git)?$/.exec(e);t&&(""!==(e=x.val())&&e!==g||(g=t[1],x.val(g),x.trigger("change"))),i()});m=$('<div class="hide red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-clone"></div>').hide().appendTo(t);o=$('<div class="form-row red-ui-projects-dialog-screen-create-row-auth-error"></div>').hide().appendTo(m),$('<div><i class="fa fa-warning"></i> '+RED._("projects.create.auth-failed")+"</div>").appendTo(o),o=$('<div class="hide form-row red-ui-projects-dialog-screen-create-row-creds"></div>').hide().appendTo(m);l=$('<div style="width: calc(50% - 10px); display:inline-block;"></div>').appendTo(o);$('<label for="red-ui-projects-dialog-screen-create-project-repo-user">'+RED._("projects.create.username")+"</label>").appendTo(l),j=$('<input id="red-ui-projects-dialog-screen-create-project-repo-user" type="text"></input>').appendTo(l),l=$('<div style="width: calc(50% - 10px); margin-left: 20px; display:inline-block;"></div>').appendTo(o),$('<label for="red-ui-projects-dialog-screen-create-project-repo-pass">'+RED._("projects.create.password")+"</label>").appendTo(l),(L=$('<input style="width:100%" id="red-ui-projects-dialog-screen-create-project-repo-pass" type="password"></input>').appendTo(l)).typedInput({type:"cred"}),o=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-sshkey"></div>').hide().appendTo(m),l=$('<div style="width: calc(50% - 10px); display:inline-block;"></div>').appendTo(o),$('<label for="red-ui-projects-dialog-screen-create-project-repo-passphrase">'+RED._("projects.create.ssh-key")+"</label>").appendTo(l),S=$("<select>",{style:"width: 100%"}).appendTo(l),$.getJSON("settings/user/keys",function(e){var t=0;e.keys.forEach(function(e){S.append($("<option></option>").val(e.name).text(e.name)),t++}),0===t?(S.addClass("input-error"),S.attr("disabled",!0),D.show()):(S.removeClass("input-error"),S.attr("disabled",!1),D.hide())}),l=$('<div style="width: calc(50% - 10px); margin-left: 20px; display:inline-block;"></div>').appendTo(o),$('<label for="red-ui-projects-dialog-screen-create-project-repo-passphrase">'+RED._("projects.create.passphrase")+"</label>").appendTo(l),(M=$('<input id="red-ui-projects-dialog-screen-create-project-repo-passphrase" type="password"></input>').appendTo(l)).typedInput({type:"cred"}),l=$('<div class="form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-sshkey"></div>').appendTo(m);var D=$('<div class="red-ui-projects-dialog-screen-create-row-auth-error-no-keys"></div>').hide().appendTo(l);switch($('<div class="form-row"><i class="fa fa-warning"></i> '+RED._("projects.create.desc2")+"</div>").appendTo(D),l=$('<div style="text-align: center">').appendTo(D),$('<button class="red-ui-button red-ui-projects-dialog-button">'+RED._("projects.create.add-ssh-key")+"</button>").appendTo(l).on("click",function(e){e.preventDefault(),$("#red-ui-projects-dialog-cancel").trigger("click"),RED.userSettings.show("gitconfig"),setTimeout(function(){$("#user-settings-gitconfig-add-key").trigger("click")},500)}),o=$('<div class="hide form-row red-ui-projects-dialog-screen-create-row red-ui-projects-dialog-screen-create-row-clone"></div>').appendTo(t),$("<label>"+RED._("projects.create.credentials-encryption-key")+"</label>").appendTo(o),(_=$('<input style="width:100%" type="password"></input>').appendTo(o)).typedInput({type:"cred"}),e.screen||"empty"){case"empty":s.trigger("click");break;case"open":r.trigger("click");break;case"clone":d.trigger("click")}return setTimeout(function(){("open"!==(e.screen||"empty")?x:$("#red-ui-projects-dialog-project-list-search")).trigger("focus")},50),t},buttons:function(e){var t;switch(e.screen||"empty"){case"open":t=RED._("projects.create.open");break;case"empty":t=RED._("projects.create.create");break;case"clone":t=RED._("projects.create.clone")}return[{id:"red-ui-projects-dialog-cancel",text:RED._("common.label.cancel"),click:function(){$(this).dialog("close")}},{id:"red-ui-projects-dialog-create",text:t,class:"primary disabled",disabled:!0,click:function(){var t,o,e=$(".red-ui-projects-dialog-screen-create-type.selected").data("type"),i={name:x.val()};if("empty"===e){i.summary=R.val(),i.files={flow:k.val()};var n=$("input[name=projects-encryption-type]:checked").val();i.credentialSecret="enabled"===n&&C.val()}else if("copy"===e)i.copy=(void 0).name;else if("clone"===e){i.credentialSecret=_.val();var a=T.val();if(/^(?:ssh|[\d\w\.\-_]+@[\w\.]+):(?:\/\/)?/.test(a)){n=S.val();if(!n)return void console.log(RED._("projects.create.cant-get-ssh-key-path"));i.git={remotes:{origin:{url:a,keyFile:n,passphrase:M.val()}}}}else i.git={remotes:{origin:{url:a,username:j.val(),password:L.val()}}}}else if("open"===e)return t=O.name,o=function(e,t){e&&"credentials_load_failed"!==e.code&&console.log(RED._("projects.create.unexpected_error"),e)},RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(t),void H({url:"projects/"+t,type:"PUT",responses:{200:function(e){o(null,e)},400:{credentials_load_failed:function(e){B.dialog("close"),RED.events.emit("project:change",{name:t}),o(null,e)},"*":o}}},{active:!0}).then(function(){B.dialog("close"),RED.events.emit("project:change",{name:t})}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)});$(".red-ui-projects-dialog-screen-create-row-auth-error").hide(),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.create.protocols")),j.removeClass("input-error"),L.removeClass("input-error"),S.removeClass("input-error"),M.removeClass("input-error"),RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(i.name),H({url:"projects",type:"POST",handleAuthFail:!1,responses:{200:function(e){B.dialog("close")},400:{project_exists:function(e){console.log(RED._("projects.create.already-exists-2"))},git_error:function(e){console.log(RED._("projects.create.git-error"),e)},git_connection_failed:function(e){T.addClass("input-error"),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.create.con-failed"))},git_not_a_repository:function(e){T.addClass("input-error"),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.create.not-git"))},git_repository_not_found:function(e){T.addClass("input-error"),$("#red-ui-projects-dialog-screen-create-project-repo-label small").text(RED._("projects.create.no-resource"))},git_auth_failed:function(e){$(".red-ui-projects-dialog-screen-create-row-auth-error").show(),j.addClass("input-error"),L.addClass("input-error"),S.addClass("input-error"),M.addClass("input-error")},missing_flow_file:function(e){B.dialog("close")},missing_package_file:function(e){B.dialog("close")},project_empty:function(e){B.dialog("close")},credentials_load_failed:function(e){B.dialog("close")},"*":function(e){u(e),$(B).dialog("close")}}}},i).then(function(){RED.events.emit("project:change",{name:name})}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]}}}}function p(e,t){B||RED.projects.init();var o=a[e],i=o.content(t||{});n.empty();e=o.buttons;"function"==typeof e&&(e=e(t||{})),B.dialog("option","buttons",e),n.append(i);e=590,i=$(window).height();i<750&&(e=590-(750-i)),$(".red-ui-projects-dialog-box").height(e),$(".red-ui-projects-dialog-project-list-inner-container").height(Math.max(500,e)-180),B.dialog("option","title",o.title||""),B.dialog("open")}function e(e){var t,o;RED.nodes.dirty()&&(t=RED._("projects.require-clean.confirm"),o=RED.notify(t,{type:"info",fixed:!0,modal:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){o.close(),e(!0)}},{text:RED._("common.label.cont"),click:function(){o.close(),e(!1)}}]}))}function H(l,c){var t,o;if(l.requireCleanWorkspace&&RED.nodes.dirty())return e(function(e){e?l.cancel&&(l.cancel(),o&&o()):(delete l.requireCleanWorkspace,H(l,c).then(function(){t&&t()}).always(function(){o&&o()}))}),{then:function(e){return t=e,{always:function(e){o=e}}},always:function(e){o=e}};var p,u,i=Date.now();return $(".red-ui-component-spinner").show(),$("#red-ui-projects-dialog").parent().find(".ui-dialog-buttonset").children().css("visibility","hidden"),c&&(l.data=JSON.stringify(c),l.contentType="application/json; charset=utf-8"),$.ajax(l).done(function(e,t,o){l.responses&&l.responses[200]&&(p=l.responses[200],u=e)}).fail(function(o,e,t){var i;if(l.responses&&l.responses[o.status]){if("function"==typeof(i=l.responses[o.status]))return void(u={error:(p=i).statusText});if(!1===l.handleAuthFail||"git_auth_failed"!==o.responseJSON.code&&"git_host_key_verification_failed"!==o.responseJSON.code){if(i[o.responseJSON.code])return p=i[o.responseJSON.code],void(u=o.responseJSON);if(i["*"])return p=i["*"],void(u=o.responseJSON)}else{if("git_auth_failed"===o.responseJSON.code){var n,a=V.git.remotes[o.responseJSON.remote||l.remote||"origin"].fetch,r=$('<div><div class="form-row">'+RED._("projects.send-req.auth-req")+':</div><div class="form-row"><div style="margin-left: 20px;">'+a+"</div></div></div>"),s=!1;/^https?:\/\//.test(a)?($('<div class="form-row"><label for="projects-user-auth-username">'+RED._("projects.send-req.username")+'</label><input id="projects-user-auth-username" type="text"></input></div><div class="form-row"><label for="projects-user-auth-password">'+RED._("projects.send-req.password")+'</label><input id="projects-user-auth-password" type="password"></input></div>').appendTo(r),r.find("#projects-user-auth-password").typedInput({type:"cred"})):/^(?:ssh|[\d\w\.\-_]+@[\w\.]+):(?:\/\/)?/.test(a)&&(s=!0,a=$('<div class="form-row"></div>').appendTo(r),$('<label for="projects-user-auth-key">SSH Key</label>').appendTo(a),n=$('<select id="projects-user-auth-key">').width("70%").appendTo(a),$.getJSON("settings/user/keys",function(e){e.keys.forEach(function(e){n.append($("<option></option>").val(e.name).text(e.name)),0})}),a=$('<div class="form-row"></div>').appendTo(r),$('<label for="projects-user-auth-passphrase">'+RED._("projects.send-req.passphrase")+"</label>").appendTo(a),$('<input id="projects-user-auth-passphrase" type="password"></input>').appendTo(a).typedInput({type:"cred"}));var d=RED.notify(r,{type:"error",fixed:!0,modal:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){d.close()}},{text:'<span><i class="fa fa-refresh"></i> '+RED._("projects.send-req.retry")+"</span>",click:function(){c=c||{};var e={};s?(e.keyFile=$("#projects-user-auth-key").val(),e.passphrase=$("#projects-user-auth-passphrase").val()):(e.username=$("#projects-user-auth-username").val(),e.password=$("#projects-user-auth-password").val());function t(e){e?(console.log(RED._("projects.send-req.update-failed")),console.log(e)):(H(l,c),d.close())}H({url:"projects/"+V.name+"/remotes/"+(o.responseJSON.remote||l.remote||"origin"),type:"PUT",responses:{0:function(e){t(e)},200:function(e){t(null)},400:{unexpected_error:function(e){t(e)}}}},{auth:e})}}]});return}if("git_host_key_verification_failed"===o.responseJSON.code){r=$('<div><div class="form-row">'+RED._("projects.send-req.host-key-verify-failed")+"</div></div>"),d=RED.notify(r,{type:"error",fixed:!0,modal:!0,buttons:[{text:RED._("common.label.close"),click:function(){d.close()}}]});return}}}console.log(i),console.log(RED._("projects.send-req.unhandled")+":"),console.log(o),console.log(e),console.log(t)}).always(function(){var e=Date.now()-i,e=Math.max(0,500-e);setTimeout(function(){$(".red-ui-component-spinner").hide(),$("#red-ui-projects-dialog").parent().find(".ui-dialog-buttonset").children().css("visibility",""),p&&p(u)},e)})}function o(i){var n,a="",r=new Set,s=[],d="",l=$('<div class="red-ui-projects-branch-list">').appendTo(i.container),c=$('<input type="text">').attr("placeholder",i.placeholder).appendTo(l).searchBox({delay:200,change:function(){a=$(this).val();var e=!1,t=!1,o=/^([^/]+)\/[^/.~*?\[]/.exec(a);o&&-1<s.indexOf(o[1])&&(t=e=!0),!e&&/(\.\.|\/\.|[?*[~^: \\]|\/\/|\/.$|\/$)/.test(a)?(n.hasClass("input-error")||(n.addClass("input-error"),n.find("i").addClass("fa-warning").removeClass("fa-code-fork")),n.find("span").text(RED._("projects.create-branch-list.invalid")+": "+(t?"":d)+a)):(n.hasClass("input-error")&&(n.removeClass("input-error"),n.find("i").removeClass("fa-warning").addClass("fa-code-fork")),n.find("span").text(RED._("projects.create-branch-list.create")+":"),n.find(".red-ui-sidebar-vc-branch-list-entry-create-name").text((t?"":d)+a)),p.editableList("filter")}}),p=$("<ol>",{style:"height: 130px;"}).appendTo(l);return p.editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,o){e=$('<div class="red-ui-sidebar-vc-branch-list-entry">').appendTo(e);o.hasOwnProperty("commit")?($('<i class="fa fa-code-fork"></i>').appendTo(e),$("<span>").text(o.name).appendTo(e),o.current&&(e.addClass("selected"),$('<span class="current"></span>').text(i.currentLabel||RED._("projects.create-branch-list.current")).appendTo(e))):(n=e,$('<i class="fa fa-code-fork"></i>').appendTo(e),$("<span>").text(RED._("projects.create-branch-list.create")+":").appendTo(e),$('<div class="red-ui-sidebar-vc-branch-list-entry-create-name" style="margin-left: 10px;">').text(o.name).appendTo(e)),e.on("click",function(e){var t;e.preventDefault(),$(this).hasClass("input-error")||(t={},o.hasOwnProperty("commit")?($(this).hasClass("selected")&&(t.current=!0),t.name=o.name):(t.name=c.val(),t.create=!0,i.remotes&&((e=/^([^/]+)\/[^/.~*?\[]/.exec(t.name))&&-1!==s.indexOf(e[1])||(t.name=s[0]+"/"+t.name))),i.onselect&&i.onselect(t))})},filter:function(e){var t,o=!e.hasOwnProperty("commit"),i=a;return 0<s.length&&(t=/^([^/]+)\/[^/.~*?\[]/.exec(i),""===i||t&&-1!=s.indexOf(t[1])||(i=s[0]+"/"+i)),o&&""!==i&&!r.has(i)||!o&&-1!==e.name.indexOf(a)}}),{refresh:function(e){c.searchBox("value",""),p.editableList("empty");var t=Date.now(),o=f(l).addClass("red-ui-component-spinner-contain");i.remotes?(s=i.remotes(),d=s[0]+"/"):(d="",s=[]),r=new Set,H({url:e,type:"GET",responses:{0:function(e){console.log(e)},200:function(e){e.branches,e.branches.forEach(function(e){p.editableList("addItem",e),r.add(e.name)}),p.editableList("addItem",{}),setTimeout(function(){o.remove()},Math.max(300-(Date.now()-t),0))},400:{git_connection_failed:function(e){RED.notify(e.message,"error")},git_not_a_repository:function(e){RED.notify(e.message,"error")},git_repository_not_found:function(e){RED.notify(e.message,"error")},unexpected_error:function(e){u(e)}}}})},filter:function(){p.editableList("filter")},focus:function(){c.trigger("focus")}}}function f(e){return $('<div class="red-ui-component-spinner"><img src="red/images/spin.svg"/></div>').appendTo(e)}function i(){createProjectOptions={},V?p("create",{screen:"empty"}):p("welcome")}return{init:function(){B=$('<div id="red-ui-projects-dialog" class="hide red-ui-projects-edit-form"><div class="red-ui-projects-dialog-box"><form class="form-horizontal"></form><div class="red-ui-component-spinner hide"><img src="red/images/spin.svg"/></div></div></div>').appendTo("#red-ui-editor").dialog({modal:!0,autoOpen:!1,width:600,resizable:!1,open:function(e){RED.keyboard.disable()},close:function(e){RED.keyboard.enable()},classes:{"ui-dialog":"red-ui-editor-dialog","ui-dialog-titlebar-close":"hide","ui-widget-overlay":"red-ui-editor-dialog"}}),n=B.find("form"),RED.actions.add("core:new-project",RED.projects.newProject),RED.actions.add("core:open-project",RED.projects.selectProject),RED.actions.add("core:show-project-settings",RED.projects.settings.show);var e={sendRequest:H,createBranchList:o,addSpinnerOverlay:f,reportUnexpectedError:u};RED.projects.settings.init(e),RED.projects.userSettings.init(e),RED.sidebar.versionControl.init(e),t()},showStartup:function(){console.warn("showStartup"),RED.user.hasPermission("projects.write")?p("welcome"):RED.notify(RED._("user.errors.notAuthorized"),"error")},newProject:function(){if(RED.user.hasPermission("projects.write"))return RED.nodes.dirty()?e(function(e){e||i()}):void i();RED.notify(RED._("user.errors.notAuthorized"),"error")},selectProject:function(){if(RED.user.hasPermission("projects.write"))return RED.nodes.dirty()?e(function(e){e||p("create",{screen:"open"})}):void p("create",{screen:"open"});RED.notify(RED._("user.errors.notAuthorized"),"error")},showCredentialsPrompt:function(){RED.user.hasPermission("projects.write")?RED.projects.settings.show("settings"):RED.notify(RED._("user.errors.notAuthorized"),"error")},showFilesPrompt:function(){RED.user.hasPermission("projects.write")?(RED.projects.settings.show("settings"),setTimeout(function(){$("#project-settings-tab-settings-file-edit").trigger("click")},200)):RED.notify(RED._("user.errors.notAuthorized"),"error")},showProjectDependencies:function(){RED.projects.settings.show("deps")},createDefaultFileSet:function(){if(!V)throw new Error(RED._("projects.create-default-file-set.no-active"));if(!V.empty)throw new Error(RED._("projects.create-default-file-set.no-empty"));RED.user.hasPermission("projects.write")?(createProjectOptions={},p("default-files",{existingProject:!0})):RED.notify(RED._("user.errors.notAuthorized"),"error")},createDefaultPackageFile:function(){RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(V.name),H({url:"projects/"+V.name,type:"PUT",requireCleanWorkspace:!0,handleAuthFail:!1,responses:{200:function(e){},400:{git_error:function(e){console.log(RED._("projects.create-default-file-set.git-error"),e)},missing_flow_file:function(e){$(B).dialog("close")},"*":function(e){u(e),$(B).dialog("close")}}}},{initialise:!0}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})},refresh:function(t){$.getJSON("projects",function(e){e.active?$.getJSON("projects/"+e.active,function(e){V=e,RED.events.emit("projects:load",V),RED.sidebar.versionControl.refresh(!0),t&&t(V)}):t&&t(null)})},editProject:function(){RED.projects.settings.show()},getActiveProject:function(){return V}}}(),RED.projects.settings=function(){var B,V,t=700,o=!1,r=[];function i(e){r.push(e)}function s(i,n){RED.editor.editMarkdown({title:RED._("sidebar.project.editDescription"),header:$('<span><i class="fa fa-book"></i> README.md</span>'),value:i.description,complete:function(o){n.empty();function t(e,t){if(e)return s(i,n);i.description=o,d(i,n)}var e=V.addSpinnerOverlay(n);V.sendRequest({url:"projects/"+i.name,type:"PUT",responses:{0:function(e){t(e)},200:function(e){t(null),RED.sidebar.versionControl.refresh(!0)},400:{"*":function(e){V.reportUnexpectedError(e),t(e)}}}},{description:o}).always(function(){e.remove()})}})}function d(e,t){t.empty();var e=e.description?RED.utils.renderMarkdown(e.description):'<span class="red-ui-help-info-none">'+RED._("sidebar.project.noDescriptionAvailable")+"</span>";(e=$('<span class="red-ui-text-bidi-aware" dir="'+RED.text.bidi.resolveBaseTextDir(e)+'">'+e+"</span>"),$(e).find("a").each(function(e){var t=$(this).attr("href");/^https?:/.test(t)&&$(this).attr("target","_blank")}),e.appendTo(t)).find(".red-ui-text-bidi-aware").contents().filter(function(){return 3===this.nodeType&&""!==this.textContent.trim()}).wrap("<span></span>")}function f(a,r,s,d,l){var c=s.prev();c.hide(),s.empty(),l.empty();var e=$('<span class="button-row" style="position: relative; float: right; margin-right:0;"></span>').appendTo(s),p=$('<input type="text" style="width: calc(100% - 150px); margin-right: 10px;">').val(r||"").appendTo(s),u=$('<input type="text" style="width: calc(100% - 150px); margin-right: 10px;">').val(d||"").appendTo(l);$('<button class="red-ui-button">'+RED._("common.label.cancel")+"</button>").appendTo(e).on("click",function(e){e.preventDefault(),h(a.summary,s),g(a.version,l),c.show()}),$('<button class="red-ui-button">'+RED._("common.label.save")+"</button>").appendTo(e).on("click",function(e){e.preventDefault();var o=p.val(),i=u.val();h(o,s),g(i,l);function t(e,t){if(e)return n.remove(),f(a,r,s,d,l);a.summary=o,a.version=i,n.remove(),h(a.summary,s),g(a.version,l),c.show()}var n=V.addSpinnerOverlay(s).addClass("red-ui-component-spinner-contain");V.sendRequest({url:"projects/"+a.name,type:"PUT",responses:{0:function(e){t(e)},200:function(e){RED.sidebar.versionControl.refresh(!0),t(null)},400:{"*":function(e){V.reportUnexpectedError(e),t(e)}}}},{summary:o,version:i})})}function h(e,t){t.empty(),e?t.text(e).removeClass("red-ui-help-info-none"):t.text(RED._("sidebar.project.noSummaryAvailable")).addClass("red-ui-help-info-none")}function g(e,t){t.empty(),e&&t.text(e)}function n(t){var e=$('<div id="red-ui-project-settings-tab-main" class="red-ui-project-settings-tab-pane red-ui-help"></div>');$("<h1>").text(t.name).appendTo(e);var o=$('<div style="position: relative">').appendTo(e),i=$("<div></div>").appendTo(o),n=$("<div></div>").addClass("red-ui-help-info-none").appendTo(o);h(t.summary,i),g(t.version,n),RED.user.hasPermission("projects.write")&&$('<button class="red-ui-button red-ui-button-small" style="float: right;">'+RED._("sidebar.project.editDescription")+"</button>").prependTo(o).on("click",function(e){e.preventDefault(),f(t,t.summary,i,t.version,n)}),$("<hr>").appendTo(e);var o=$('<div class="red-ui-help" style="position: relative"></div>').appendTo(e),a=$("<div>",{style:"min-height: 200px"}).appendTo(o);return d(t,a),RED.user.hasPermission("projects.write")&&$('<button class="red-ui-button red-ui-button-small" style="float: right;">'+RED._("sidebar.project.editReadme")+"</button>").prependTo(o).on("click",function(e){e.preventDefault(),s(t,a)}),e}function l(e,t){t.editableList("empty");var o,i=0;for(n in b)b.hasOwnProperty(n)&&(t.editableList("addItem",{id:b[n].module,version:b[n].version,count:b[n].count,known:e.dependencies.hasOwnProperty(n),installed:!0}),i++,0===b[n].count&&0,e.dependencies.hasOwnProperty(n)||0);if(e.dependencies)for(var n in e.dependencies)e.dependencies.hasOwnProperty(n)&&!b.hasOwnProperty(n)&&(o=!!RED.nodes.registry.getModule(n),t.editableList("addItem",{id:n,version:e.dependencies[n],count:0,known:!0,installed:o}),i++,o?0:0);0===i&&t.editableList("addItem",{index:0,label:RED._("sidebar.project.projectSettings.none")})}function c(e,t,o,i){function n(e,t){if(r.remove(),e)return i(e);a.dependencies=o,RED.sidebar.versionControl.refresh(!0),i()}var a=RED.projects.getActiveProject(),r=V.addSpinnerOverlay(t).addClass("red-ui-component-spinner-contain");V.sendRequest({url:"projects/"+a.name,type:"PUT",responses:{0:function(e){n(e)},200:function(e){RED.sidebar.versionControl.refresh(!0),n(null)},400:{"*":function(e){n(e)}}}},{dependencies:o})}function a(s){var t=$('<div id="red-ui-project-settings-tab-deps" class="red-ui-project-settings-tab-pane red-ui-help"></div>');RED.user.hasPermission("projects.write")&&$('<button class="red-ui-button red-ui-button-small" style="margin-top:10px;float: right;">'+RED._("sidebar.project.projectSettings.edit")+"</button>").appendTo(t).on("click",function(e){e.preventDefault(),function i(n,e,a,r){e=e||JSON.stringify(n.dependencies||{},"",4);"{}"===e&&(e="{\n\n}"),RED.editor.editJSON({title:RED._("sidebar.project.editDependencies"),value:e,requireValid:!0,complete:function(t){try{var o=JSON.parse(t);c(0,a,o,function(e){return e?i(n,t,a,r):(n.dependencies=o,void l(n,r))})}catch(e){i(n,t,a,r)}}})}(s,null,t,d)});var d=$("<ol>",{style:"position: absolute;top: 60px;bottom: 20px;left: 20px;right: 20px;"}).appendTo(t);return d.editableList({addButton:!1,addItem:function(t,e,o){var i,n,a,r=$("<div>",{class:"red-ui-palette-module-header"}).appendTo(t);o.label?(0===o.index?r.addClass("red-ui-search-empty"):t.parent().addClass("red-ui-palette-module-section"),r.text(o.label)):(r.addClass("red-ui-palette-module-header"),o.installed?0===o.count?r.addClass("red-ui-palette-module-unused"):o.known||r.addClass("red-ui-palette-module-unknown"):r.addClass("red-ui-palette-module-not-installed"),o.element=r,n=$('<div class="red-ui-palette-module-meta red-ui-palette-module-name"></div>').appendTo(r),i="fa-cube",o.installed||(i="fa-warning"),i=$('<i class="fa '+i+'"></i>').appendTo(n),o.icon=i,$("<span>").text(o.id).appendTo(n),n=$('<div class="red-ui-palette-module-meta red-ui-palette-module-version"><i class="fa fa-tag"></i></div>').appendTo(r),$("<span>").text(o.version).appendTo(n),n=$('<div class="red-ui-palette-module-meta"></div>').appendTo(r),a=$('<div class="red-ui-palette-module-button-group"></div>').appendTo(n),RED.user.hasPermission("projects.write")&&(o.installed||!1===RED.settings.get("externalModules.palette.allowInstall",!0)?o.known&&0===o.count?$('<a href="#" class="red-ui-button red-ui-button-small">'+RED._("sidebar.project.projectSettings.removeFromProject")+"</a>").appendTo(a).on("click",function(e){e.preventDefault();e=$.extend(!0,{},s.dependencies);delete e[o.id],c(0,t,e,function(e){e?console.log(e):t.fadeOut(200,function(){d.editableList("removeItem",o)})})}):o.known||$('<a href="#" class="red-ui-button red-ui-button-small">'+RED._("sidebar.project.projectSettings.addToProject")+"</a>").appendTo(a).on("click",function(e){e.preventDefault();e=$.extend(!0,{},s.dependencies);e[o.id]=b[o.id].version,c(0,t,e,function(e){e?console.log(e):(a.remove(),r.removeClass("red-ui-palette-module-unknown"))})}):$('<a href="#" class="red-ui-button red-ui-button-small">'+RED._("sidebar.project.projectSettings.install")+"</a>").appendTo(a).on("click",function(e){e.preventDefault(),RED.palette.editor.install(o,t,function(e){e||(o.installed=!0,RED.utils.addSpinnerOverlay(t,!0),setTimeout(function(){d.editableList("removeItem",o),b={},RED.nodes.eachNode(m),RED.nodes.eachConfig(m),b.hasOwnProperty(o.id)?o.count=b[o.id].count:o.count=0,d.editableList("addItem",o)},500))})})))},sort:function(e,t){return e.id.localeCompare(t.id)}}),l(s,d),t}function H(e,t,i,a,r){var s=$('<div class="red-ui-projects-file-listing-container"></div>',{style:"position: relative; min-height: 175px; height: 175px;"}).hide().appendTo(e),d=V.addSpinnerOverlay(s);return $.getJSON("projects/"+t.name+"/files",function(t){var e=(e=Object.keys(t)).filter(function(e){return!t[e].status||!/D/.test(t[e].status)}),o={};e.sort(),e.forEach(function(e){e.split("/").reduce(function(e,t,o,i){if(t)return o<i.length-1?e[t]=e[t]||{}:e[t]=!0,e[t]},o)});var n=function(e,t,o){var i={name:e||"/",path:o+(o?"/":"")+e};return!0===t?i.type="f":(i.type="d",i.children=[],i.path=i.path,Object.keys(t).forEach(function(e){i.children.push(n(e,t[e],i.path))}),i.children.sort(function(e,t){return e.hasOwnProperty("children")&&!t.hasOwnProperty("children")?-1:!e.hasOwnProperty("children")&&t.hasOwnProperty("children")?1:e.name.localeCompare(t.name)})),i},o=n("",o,"");!function a(e,t,r,s,d,o){o=o||"";var i=$("<ol>",{class:"red-ui-projects-dialog-file-list",style:o}).appendTo(e).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,o){var i,n=$("<div></div>",{class:"red-ui-projects-dialog-file-list-entry"}).appendTo(e);o.children?($('<span class="red-ui-projects-dialog-file-list-entry-folder"><i class="fa fa-angle-right"></i> <i class="fa fa-folder-o"></i></span>').appendTo(n),0<o.children.length&&(i=$("<div></div>",{style:"padding-left: 20px;"}).appendTo(e),0===r.indexOf(o.path+"/")?n.addClass("expanded"):i.hide(),a(i,o.children,r,s,d),n.addClass("selectable"),n.on("click",function(e){$(this).hasClass("expanded")?($(this).removeClass("expanded"),i.slideUp(200)):($(this).addClass("expanded"),i.slideDown(200))}))):(e="fa-file-o",/\.json$/i.test(o.name)?e="fa-file-code-o":/\.md$/i.test(o.name)?e="fa-book":/^\.git/i.test(o.name)&&(e="fa-code-fork",n.addClass("red-ui-projects-dialog-file-list-entry-file-type-git")),$('<span class="red-ui-projects-dialog-file-list-entry-file"> <i class="fa '+e+'"></i></span>').appendTo(n),s(o)?(n.addClass("selectable"),o.path===r&&n.addClass("selected"),n.on("click",function(e){$(".red-ui-projects-dialog-file-list-entry.selected").removeClass("selected"),$(this).addClass("selected"),d(o.path,!0)}),n.on("dblclick",function(e){e.preventDefault(),d(o.path,!0)})):n.addClass("unselectable")),$('<span class="red-ui-projects-dialog-file-list-entry-name" style=""></span>').text(o.name).appendTo(n)}});o||i.parent().css("overflow-y","");t.forEach(function(e){i.editableList("addItem",e)})}(s,o.children,i,a,r,"height: 175px"),d.remove()}),s}function p(a,e){var t,o=$("<h3></h3>").text(RED._("sidebar.project.projectSettings.files")).appendTo(e),i=$('<div class="red-ui-settings-section"></div>').appendTo(e);RED.user.hasPermission("projects.write")&&(t=$('<button type="button" id="red-ui-project-settings-tab-settings-file-edit" class="red-ui-button red-ui-button-small" style="float: right;">'+RED._("sidebar.project.projectSettings.edit")+"</button>").appendTo(o).on("click",function(e){e.preventDefault(),N.show(),t.hide(),a.files.package||(l.find(".red-ui-projects-edit-form-sublabel-text").text(RED._("sidebar.project.projectSettings.packageCreate")),l.show()),d.show(),f.hide(),g.show(),v.show(),h(),D.addClass("uneditable-input"),$(".red-ui-settings-row-credentials").show(),D.css("height","auto"),_.hide(),x.show()})),c=$('<div class="red-ui-settings-row"></div>').appendTo(i),$('<label for=""></label>').text(RED._("sidebar.project.projectSettings.package")).appendTo(c);var n=$('<div class="uneditable-input" style="padding:0">').appendTo(c),r=$('<span style="display:inline-block;  padding: 6px">').text(a.files.package||"package.json").appendTo(n),s=$('<input type="hidden">').val(a.files.package||"package.json").appendTo(n),d=$('<button type="button" class="red-ui-button toggle single" style="border-top-right-radius: 4px; border-bottom-right-radius: 4px; width: 36px; height: 34px; position: absolute; top: -1px; right: -1px;"><i class="fa fa-folder-open-o"></i></button>').hide().appendTo(n).on("click",function(e){var t;$(this).hasClass("selected")?($(this).removeClass("selected"),n.find(".red-ui-projects-file-listing-container").slideUp(200,function(){$(this).remove(),n.css("height","")}),n.css("color","")):($(this).addClass("selected"),n.css("color","inherit"),t=H(n,a,s.val(),function(e){return e.children||/package\.json$/.test(e.path)},function(e,t){e&&(s.val(e),r.text(e),e=e.substring(0,e.length-12),u.text(e),b.text(e),h(),l.hide()),t&&$(d).trigger("click"),E()}),n.css("height","auto"),setTimeout(function(){t.slideDown(200)},50))});RED.popover.tooltip(d,RED._("sidebar.project.projectSettings.selectFile"));var l=$('<label style="margin-left: 110px" class="red-ui-projects-edit-form-sublabel"><small><span class="form-warning"><i class="fa fa-warning"></i> <span class="red-ui-projects-edit-form-sublabel-text"></span></small></label>').appendTo(c).hide();a.files.package||(l.find(".red-ui-projects-edit-form-sublabel-text").text(RED._("sidebar.project.projectSettings.fileNotExist")),l.show());var e=a.files.package||"package.json",o=e.substring(0,e.length-12),c=$('<div class="red-ui-settings-row"></div>').appendTo(i);$('<label for=""></label>').text(RED._("sidebar.project.projectSettings.flow")).appendTo(c);var p=$('<div class="uneditable-input" style="padding:0">').appendTo(c),u=$('<span style="display:inline-block; padding: 6px 0 6px 6px">').text(o).appendTo(p),e="flows.json";a.files.flow&&(e=0===a.files.flow.indexOf(o)?a.files.flow.substring(o.length):a.files.flow);var f=$('<span style="display:inline-block; padding: 6px 6px 6px 0">').text(e).appendTo(p),h=function(){g.css({width:"calc(100% - "+(v.width()+u.width())+"px)"})},g=$('<input type="text" style="padding-left:1px; margin-top: -2px; margin-bottom: 0;border: none;">').val(e).hide().appendTo(p),v=$('<button type="button" class="red-ui-button toggle single" style="border-top-right-radius: 4px; border-bottom-right-radius: 4px; width: 36px; height: 34px; position: absolute; top: -1px; right: -1px;"><i class="fa fa-folder-open-o"></i></button>').hide().appendTo(p).on("click",function(e){var t,o,i,n;$(this).hasClass("selected")?($(this).removeClass("selected"),p.find(".red-ui-projects-file-listing-container").slideUp(200,function(){$(this).remove(),p.css("height","")}),p.css("color","")):($(this).addClass("selected"),p.css("color","inherit"),t=s.val(),o=t.substring(0,t.length-12),i=new RegExp("^"+o+".*.json$"),n=H(p,a,g.val(),function(e){return!/package.json$/.test(e.path)&&i.test(e.path)&&!/_cred\.json$/.test(e.path)},function(e,t){e&&g.val(e.substring(o.length)),t&&$(v).trigger("click"),E()}),p.css("height","auto"),setTimeout(function(){n.slideDown(200)},50))});RED.popover.tooltip(v,RED._("sidebar.project.projectSettings.selectFile")),c=$('<div class="red-ui-settings-row"></div>').appendTo(i),$('<label for=""></label>').text(RED._("sidebar.project.projectSettings.credentials")).appendTo(c);var m="flows_cred.json";a.files.credentials&&(m=0===a.files.flow.indexOf(o)?a.files.credentials.substring(o.length):a.files.credentials);var e=$('<div class="uneditable-input" style="padding:0">').appendTo(c),b=$('<span style="display:inline-block;padding: 6px 0 6px 6px">').text(o).appendTo(e),y=$('<span style="display:inline-block; padding: 6px 6px 6px 0">').text(m).appendTo(e),w=$('<input type="hidden">').val(m).insertAfter(e),E=function(){var e=g.val(),t=/^(.+?)(\.[^.]*)?$/.exec(e);t?y.text(t[1]+"_cred"+(t[2]||".json")):""===e&&y.text(""),w.val(y.text());t=""===e||/\.\./.test(e)||/\/$/.test(e),e=t||""===y.text();L.is(":visible")&&(z.toggleClass("input-error",""===z.val()),e=e||""===z.val()),S.is(":visible")&&(O.toggleClass("input-error",""===O.val()),e=e||""===O.val()),g.toggleClass("input-error",t),P.toggleClass("disabled",e),P.prop("disabled",e)};g.on("change keyup paste",E),c=$('<div class="red-ui-settings-row"></div>').appendTo(i),$("<label></label>").appendTo(c);var D=$('<span><i class="user-settings-credentials-state-icon fa"></i> <span class="user-settings-credentials-state"></span></span>').appendTo(c),x=$('<span class="button-group" style="margin-left: -72px;">').hide().appendTo(c);D.css("color","#666"),x.css("vertical-align","top");var R=$('<button type="button" class="red-ui-button" style="vertical-align: top; width: 36px; margin-bottom: 10px"><i class="fa fa-trash-o"></i></button>').appendTo(x).on("click",function(e){e.preventDefault(),$(this).hasClass("selected")?($(this).removeClass("selected"),_.hide()):(O.val(""),L.hide(),S.show(),$(this).addClass("selected"),k.removeClass("selected"),j.show(),I.show(),T.hide(),C.hide(),_.show()),E()});RED.popover.tooltip(R,RED._("sidebar.project.projectSettings.resetTheEncryptionKey"));var k=$('<button type="button" class="red-ui-button" style="border-top-right-radius: 4px; border-bottom-right-radius: 4px; vertical-align: top; width: 36px; margin-bottom: 10px"><i class="fa fa-pencil"></i></button>').appendTo(x).on("click",function(e){e.preventDefault(),$(this).hasClass("selected")?($(this).removeClass("selected"),_.hide()):(z.val(""),O.val(""),a.settings.credentialSecretInvalid||!a.settings.credentialsEncrypted?(T.show(),C.hide(),L.hide()):(L.show(),T.hide(),C.show()),S.show(),k.addClass("selected"),R.removeClass("selected"),j.hide(),I.hide(),_.show()),E()});RED.popover.tooltip(k,RED._("sidebar.project.projectSettings.changeTheEncryptionKey")),$('<div class="red-ui-settings-row red-ui-settings-row-credentials"></div>').hide().appendTo(i);var _=$("<div>",{style:"margin-top:10px"}).hide().appendTo(D),T=$('<div style="margin: 20px 0 10px 5px;">'+RED._("sidebar.project.projectSettings.setTheEncryptionKey")+"</div>").hide().appendTo(_),C=$('<div style="margin: 20px 0 10px 5px;">'+RED._("sidebar.project.projectSettings.changeTheEncryptionKey")+"</div>").hide().appendTo(_),j=$('<div style="margin: 20px 0 10px 5px;">'+RED._("sidebar.project.projectSettings.resetTheEncryptionKey")+"</div>").hide().appendTo(_),L=$('<div class="red-ui-settings-row red-ui-settings-row-credentials"></div>').appendTo(_);$('<label for=""></label>').text(RED._("sidebar.project.projectSettings.currentKey")).appendTo(L);var z=$('<input type="text">').appendTo(L).typedInput({type:"cred"}).on("change keyup paste",function(){B&&(B.close(),B=null),E()}),S=$('<div class="red-ui-settings-row red-ui-settings-row-credentials"></div>').appendTo(_);$('<label for=""></label>').text(RED._("sidebar.project.projectSettings.newKey")).appendTo(S);function M(){t.show(),N.hide(),d.hide(),f.show(),g.hide(),v.hide(),D.removeClass("uneditable-input"),D.css("height",""),v.removeClass("selected"),p.find(".red-ui-projects-file-listing-container").remove(),p.css("height",""),p.css("color",""),$(".red-ui-settings-row-credentials").hide(),_.hide(),x.hide(),R.removeClass("selected"),k.removeClass("selected")}var O=$('<input type="text">').appendTo(S).typedInput({type:"cred"}).on("change keyup paste",E),I=$('<div class="form-tips form-warning" style="margin: 10px;"><i class="fa fa-warning"></i>'+RED._("sidebar.project.projectSettings.credentialsAlert")+"</div>").hide().appendTo(_),N=$('<span class="button-row" style="position: relative; float: right; margin-right:0;"></span>').hide().appendTo(i);$('<button type="button" class="red-ui-button">'+RED._("common.label.cancel")+"</button>").appendTo(N).on("click",function(e){e.preventDefault();e=a.files.package||"package.json",e=e.substring(0,e.length-12);u.text(e),b.text(e),r.text(a.files.package||"package.json"),a.files.package?l.hide():(l.find(".red-ui-projects-edit-form-sublabel-text").text(RED._("sidebar.project.projectSettings.fileNotExist")),l.show()),g.val(f.text()),y.text(m),M()});var P=$('<button type="button" class="red-ui-button">'+RED._("common.label.save")+"</button>").appendTo(N).on("click",function(e){e.preventDefault();function t(e){o.remove(),e?V.reportUnexpectedError(e):(f.text(g.val()),y.text(w.val()),l.hide(),M())}var o=V.addSpinnerOverlay(i),e=(e=s.val()).substring(0,e.length-12),e={files:{package:s.val(),flow:e+g.val(),credentials:e+w.val()}};R.hasClass("selected")&&(e.resetCredentialSecret=!0),(R.hasClass("selected")||k.hasClass("selected"))&&(e.credentialSecret=O.val(),L.is(":visible")&&(e.currentCredentialSecret=z.val())),RED.deploy.setDeployInflight(!0),V.sendRequest({url:"projects/"+a.name,type:"PUT",responses:{0:function(e){t(e)},200:function(e){a=e,RED.sidebar.versionControl.refresh(!0),A(),t()},400:{credentials_load_failed:function(e){t(e)},missing_current_credential_key:function(e){z.addClass("input-error"),B=RED.popover.create({target:z,direction:"right",size:"small",content:"Incorrect key",autoClose:3e3}).open(),t(e)},"*":function(e){t(e)}}}},e).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}),A=function(){a.settings.credentialSecretInvalid?(D.find(".user-settings-credentials-state-icon").removeClass().addClass("user-settings-credentials-state-icon fa fa-warning"),D.find(".user-settings-credentials-state").text(RED._("sidebar.project.projectSettings.invalidEncryptionKey"))):a.settings.credentialsEncrypted?(D.find(".user-settings-credentials-state-icon").removeClass().addClass("user-settings-credentials-state-icon fa fa-lock"),D.find(".user-settings-credentials-state").text(RED._("sidebar.project.projectSettings.encryptionEnabled"))):(D.find(".user-settings-credentials-state-icon").removeClass().addClass("user-settings-credentials-state-icon fa fa-unlock"),D.find(".user-settings-credentials-state").text(RED._("sidebar.project.projectSettings.encryptionDisabled"))),R.toggleClass("disabled",!a.settings.credentialSecretInvalid&&!a.settings.credentialsEncrypted),R.prop("disabled",!a.settings.credentialSecretInvalid&&!a.settings.credentialsEncrypted)};E(),A()}function u(a,e){$("<h3></h3>").text(RED._("sidebar.project.projectSettings.versionControl")).appendTo(e),function(r,e){e=$('<div class="red-ui-settings-section"></div>').appendTo(e),$("<h4></h4>").text(RED._("sidebar.project.projectSettings.branches")).appendTo(e);var e=$('<div class="red-ui-settings-row red-ui-projects-dialog-list"></div>').appendTo(e),s=$("<ol>").appendTo(e).editableList({height:"auto",addButton:!1,scrollOnAdd:!1,addItem:function(n,e,a){var t=$('<div class="red-ui-projects-dialog-list-entry">').appendTo(n);if(a.empty)return t.addClass("red-ui-search-empty"),void t.text(RED._("sidebar.project.projectSettings.noBranches"));a.current&&t.addClass("current"),$('<span class="entry-icon"><i class="fa fa-code-fork"></i></span>').appendTo(t);var o=$("<span>").appendTo(t),i=$("<div>").appendTo(o);$('<span class="entry-name">').text(a.name).appendTo(i),a.commit&&$('<span class="entry-detail">').text(a.commit.sha).appendTo(i),a.remote&&(o=$("<div>").appendTo(o),$('<span class="entry-detail entry-remote-name">').text(a.remote||"").appendTo(o),0<a.status.ahead+a.status.behind&&$('<span class="entry-detail"><i class="fa fa-long-arrow-up"></i> <span>'+a.status.ahead+'</span> <i class="fa fa-long-arrow-down"></i> <span>'+a.status.behind+"</span></span>").appendTo(o)),a.current||(t=$('<span class="entry-tools">').appendTo(t),$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-trash"></i></button>').appendTo(t).on("click",function(e){e.preventDefault();var o=V.addSpinnerOverlay(n).addClass("red-ui-component-spinner-contain"),i=RED.notify(RED._("sidebar.project.projectSettings.deleteConfirm",{name:a.name}),{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){o.remove(),i.close()}},{text:"Delete branch",click:function(){i.close();var t={url:"projects/"+r.name+"/branches/"+a.name,type:"DELETE",responses:{200:function(e){n.fadeOut(200,function(){s.editableList("removeItem",a),o.remove()})},400:{git_delete_branch_unmerged:function(e){i=RED.notify(RED._("sidebar.project.projectSettings.unmergedConfirm",{name:a.name}),{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){o.remove(),i.close()}},{text:RED._("sidebar.project.projectSettings.deleteUnmergedBranch"),click:function(){t.url+="?force=true",i.close(),V.sendRequest(t)}}]})},"*":function(e){V.reportUnexpectedError(e),o.remove()}}}};V.sendRequest(t)}}]})}))}});$.getJSON("projects/"+r.name+"/branches",function(e){e.branches&&(0<e.branches.length?(e.branches.sort(function(e,t){return e.current?-1:t.current?1:e.name.localeCompare(t.name)}),e.branches.forEach(function(e){s.editableList("addItem",e)})):s.editableList("addItem",{empty:!0}))})}(a,e);var t=$('<div class="red-ui-settings-section"></div>').appendTo(e),e=$("<h4></h4>").text(RED._("sidebar.project.projectSettings.gitRemotes")).appendTo(t),o=$('<button class="red-ui-button red-ui-button-small" style="float: right; margin-right: 10px;">'+RED._("sidebar.project.projectSettings.addRemote")+"</button>").appendTo(e).on("click",function(e){o.attr("disabled",!0),i.slideDown(200,function(){i[0].scrollIntoView(),s?(u.val("origin"),h.trigger("focus")):u.trigger("focus"),l()})}),r={empty:!0},s=!0,e=$('<div class="red-ui-settings-row"></div>').appendTo(t),i=$('<div class="red-ui-projects-dialog-list-dialog"></div>').hide().appendTo(e),e=$('<div class="red-ui-settings-row red-ui-projects-dialog-list"></div>').appendTo(t),d=$("<ol>").appendTo(e);d.editableList({addButton:!1,height:"auto",addItem:function(i,e,n){var t,o=$('<div class="red-ui-projects-dialog-list-entry">').appendTo(i);n.empty?(o.addClass("red-ui-search-empty"),o.text(RED._("sidebar.project.projectSettings.noRemotes"))):($('<span class="entry-icon"><i class="fa fa-globe"></i></span>').appendTo(o),t=$("<span>").appendTo(o),$('<div class="entry-name">').text(n.name).appendTo(t),n.urls.fetch===n.urls.push?$('<div class="entry-detail">').text(n.urls.fetch).appendTo(t):($('<div class="entry-detail">').text("fetch: "+n.urls.fetch).appendTo(t),$('<div class="entry-detail">').text("push: "+n.urls.push).appendTo(t)),o=$('<span class="entry-tools">').appendTo(o),$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-trash"></i></button>').appendTo(o).on("click",function(e){e.preventDefault();var t=V.addSpinnerOverlay(i).addClass("red-ui-component-spinner-contain"),o=RED.notify(RED._("sidebar.project.projectSettings.deleteRemoteConfrim",{name:n.name}),{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),o.close()}},{text:RED._("sidebar.project.projectSettings.deleteRemote"),click:function(){o.close(),a.git.branches.remote&&0===a.git.branches.remote.indexOf(n.name+"/")&&delete a.git.branches.remote,a.git.branches.remoteAlt&&0===a.git.branches.remoteAlt.indexOf(n.name+"/")&&delete a.git.branches.remoteAlt;var e="projects/"+a.name+"/remotes/"+n.name;V.sendRequest({url:e,type:"DELETE",responses:{200:function(e){i.fadeOut(200,function(){d.editableList("removeItem",n),setTimeout(t.remove,100),0===e.remotes.length?(delete a.git.remotes,s=!0,d.editableList("addItem",r)):(a.git.remotes={},e.remotes.forEach(function(e){var t=e.name;delete e.name,a.git.remotes[t]=e})),delete a.git.branches.remoteAlt,RED.sidebar.versionControl.refresh()})},400:{"*":function(e){V.reportUnexpectedError(e),t.remove()}}}})}}]})}))}});var n,l=function(){var e=/^[a-zA-Z0-9\-_]+$/.test(u.val()),t=h.val(),o=0<t.length&&!/\s/.test(t);/^https?:\/\/[^/]+@/i.test(t)?(g.text(RED._("sidebar.project.projectSettings.urlRule2")),o=!1):g.text(RED._("sidebar.project.projectSettings.urlRule")),v.attr("disabled",!e||!o),u.toggleClass("input-error",c&&!e),h.toggleClass("input-error",p&&!o),n&&(n.close(),n=null)},c=!1,p=!1;$('<div class="red-ui-projects-dialog-list-dialog-header">').text(RED._("sidebar.project.projectSettings.addRemote2")).appendTo(i),e=$('<div class="red-ui-settings-row"></div>').appendTo(i),$('<label for=""></label>').text(RED._("sidebar.project.projectSettings.remoteName")).appendTo(e);var u=$('<input type="text">').appendTo(e).on("change keyup paste",function(){c=!0,l()});$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("sidebar.project.projectSettings.nameRule")+"</small></label>").appendTo(e).find("small"),e=$('<div class="red-ui-settings-row"></div>').appendTo(i),$('<label for=""></label>').text(RED._("sidebar.project.projectSettings.url")).appendTo(e);function f(){o.attr("disabled",!1),i.hide(),u.val(""),h.val(""),n&&(n.close(),n=null)}var h=$('<input type="text">').appendTo(e).on("change keyup paste",function(){p=!0,l()}),g=$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("sidebar.project.projectSettings.urlRule")+"</small></label>").appendTo(e).find("small"),e=$('<span class="button-row" style="position: relative; float: right; margin: 10px;"></span>').appendTo(i);$('<button class="red-ui-button">'+RED._("common.label.cancel")+"</button>").appendTo(e).on("click",function(e){e.preventDefault(),f()});var v=$('<button class="red-ui-button">'+RED._("sidebar.project.projectSettings.addRemote2")+"</button>").appendTo(e).on("click",function(e){e.preventDefault();function t(e){o.remove(),e||f()}var o=V.addSpinnerOverlay(i).addClass("red-ui-component-spinner-contain"),e={name:u.val(),url:h.val()};RED.deploy.setDeployInflight(!0),V.sendRequest({url:"projects/"+a.name+"/remotes",type:"POST",responses:{0:function(e){t(e)},200:function(e){a.git.remotes={},e.remotes.forEach(function(e){var t=e.name;delete e.name,a.git.remotes[t]=e}),m(),RED.sidebar.versionControl.refresh(),t()},400:{git_remote_already_exists:function(e){n=RED.popover.create({target:u,direction:"right",size:"small",content:"Remote already exists",autoClose:6e3}).open(),u.addClass("input-error"),t(e)},"*":function(e){V.reportUnexpectedError(e),t(e)}}}},e)}),m=function(){d.editableList("empty");var e=0;if(a.git.hasOwnProperty("remotes"))for(var t in a.git.remotes)a.git.remotes.hasOwnProperty(t)&&(e++,d.editableList("addItem",{name:t,urls:a.git.remotes[t]}));(s=0===e)&&d.editableList("addItem",r)};m()}function v(e){var t=$('<div id="red-ui-project-settings-tab-settings" class="red-ui-project-settings-tab-pane red-ui-help"></div>');return p(e,t),u(e,t),t}function m(e){/^subflow:/.test(e.type)||"node-red"!==(e=RED.nodes.registry.getNodeSetForType(e.type).module)&&(b.hasOwnProperty(e)||(b[e]={module:e,version:RED.nodes.registry.getModule(e).version,count:0,known:!1}),b[e].count++)}var b={};return{init:function(e){V=e,i({id:"main",title:RED._("sidebar.project.name"),get:n,close:function(){}}),i({id:"deps",title:RED._("sidebar.project.dependencies"),get:a,close:function(){}}),i({id:"settings",title:RED._("sidebar.project.settings"),get:v,close:function(){B&&(B.close(),B=null)}}),RED.events.on("nodes:add",m),RED.events.on("nodes:remove",function(e){/^subflow:/.test(e.type)||"node-red"!==(e=RED.nodes.registry.getNodeSetForType(e.type).module)&&b.hasOwnProperty(e)&&(b[e].count--,0===b[e].count&&(b[e].known||delete b[e]))})},show:function(a){var e;o||(RED.user.hasPermission("projects.write")?(o=!0,e={title:RED._("sidebar.project.projectSettings.title"),buttons:[{id:"node-dialog-ok",text:RED._("common.label.close"),class:"primary",click:function(){RED.tray.close()}}],resize:function(e){t=e.width},open:function(e){var t=RED.projects.getActiveProject(),o=e.find(".red-ui-tray-body"),e=$("<div></div>").appendTo(o),o=$("<div></div>",{class:"red-ui-settings-tabs-container"}).appendTo(e);$("<ul></ul>",{id:"user-settings-tabs"}).appendTo(o);var i=RED.tabs.create({id:"user-settings-tabs",vertical:!0,onchange:function(e){setTimeout(function(){n.children().hide(),$("#"+e.id).show(),e.pane.focus&&e.pane.focus()},50)}}),n=$("<div></div>",{class:"red-ui-settings-tabs-content"}).appendTo(e);r.forEach(function(e){i.addTab({id:"red-ui-project-settings-tab-"+e.id,label:e.title,pane:e}),e.get(t).hide().appendTo(n)}),e.i18n(),i.activateTab("red-ui-project-settings-tab-"+(a||"main")),$("#red-ui-sidebar-shade").show()},close:function(){o=!1,r.forEach(function(e){e.close&&e.close()}),$("#red-ui-sidebar-shade").hide()},show:function(){}},null!==t&&(e.width=t),RED.tray.show(e)):RED.notify(RED._("user.errors.notAuthorized"),"error"))},switchProject:function(e){b={}}}}(),RED.projects.userSettings=function(){var a,m,b;function r(e){$("<h3></h3>").text(RED._("editor:sidebar.project.userSettings.sshKeys")).appendTo(e);function t(){var e=/^[a-zA-Z0-9\-_]+$/.test(d.val());d.toggleClass("input-error",s&&!e);var t=c.val(),o=0===t.length||8<=t.length;c.toggleClass("input-error",!o),o?0===t.length?p.text(RED._("editor:sidebar.project.userSettings.optional")):p.text(""):p.text(RED._("editor:sidebar.project.userSettings.passphraseShort")),u.attr("disabled",!(e=e&&o)),i&&(i.close(),i=null)}var i,o=$('<div class="red-ui-settings-section"></div>').appendTo(e),n=$('<div class="red-ui-settings-section-description"></div>').appendTo(o).text(RED._("editor:sidebar.project.userSettings.sshKeysTip")),a=$('<button id="user-settings-gitconfig-add-key" class="red-ui-button red-ui-button-small" style="float: right; margin-right: 10px;">'+RED._("editor:sidebar.project.userSettings.add")+"</button>").appendTo(n).on("click",function(e){a.attr("disabled",!0),u.attr("disabled",!0),r.slideDown(200),d.trigger("focus")}),e=$('<div class="red-ui-settings-row"></div>').appendTo(o),r=$('<div class="red-ui-projects-dialog-list-dialog"></div>').hide().appendTo(e);$('<div class="red-ui-projects-dialog-list-dialog-header">').text(RED._("editor:sidebar.project.userSettings.addSshKey")).appendTo(r);n=$("<div>").appendTo(r),e=$('<div class="red-ui-settings-row"></div>').appendTo(n);$('<div class="red-ui-settings-section-description"></div>').appendTo(e).text(RED._("editor:sidebar.project.userSettings.addSshKeyTip")),e=$('<div class="red-ui-settings-row"></div>').appendTo(n),$('<label for=""></label>').text(RED._("editor:sidebar.project.userSettings.name")).appendTo(e);var s=!1,d=$('<input type="text">').appendTo(e).on("change keyup paste",function(){s=!0,t()});$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("editor:sidebar.project.userSettings.nameRule")+"</small></label>").appendTo(e).find("small");n=$("<div>").appendTo(n);e=$('<div class="red-ui-settings-row"></div>').appendTo(n),$('<label for=""></label>').text(RED._("editor:sidebar.project.userSettings.passphrase")).appendTo(e);function l(){a.attr("disabled",!1),r.hide(),d.val(""),s=!1,c.val(""),i&&(i.close(),i=null)}var c=$('<input type="password">').appendTo(e).on("change keyup paste",t),p=$('<label class="red-ui-projects-edit-form-sublabel"><small>'+RED._("editor:sidebar.project.userSettings.optional")+"</small></label>").appendTo(e).find("small"),n=$('<span class="button-row" style="position: relative; float: right; margin: 10px;"></span>').appendTo(r);$('<button class="red-ui-button">'+RED._("editor:sidebar.project.userSettings.cancel")+"</button>").appendTo(n).on("click",function(e){e.preventDefault(),l()});var u=$('<button class="red-ui-button">'+RED._("editor:sidebar.project.userSettings.generate")+"</button>").appendTo(n).on("click",function(e){e.preventDefault();var t=b.addSpinnerOverlay(r).addClass("red-ui-component-spinner-contain"),o={name:d.val(),type:"generate"};o.comment=m.val(),o.password=c.val(),o.size=4096;function i(e){t.remove(),e||l()}RED.deploy.setDeployInflight(!0),b.sendRequest({url:"settings/user/keys",type:"POST",responses:{0:function(e){i(e)},200:function(e){v(o.name),i()},400:{unexpected_error:function(e){console.log(e),i(e)}}}},o)});e=$('<div class="red-ui-settings-row red-ui-projects-dialog-list"></div>').appendTo(o);function f(e,t){var e=$('<div class="red-ui-projects-dialog-ssh-public-key">',{style:"position:relative"}).appendTo(e),o=$("<pre>",{style:"min-height: 80px"}).appendTo(e),i=b.addSpinnerOverlay(o).addClass("red-ui-component-spinner-contain"),t={url:"settings/user/keys/"+t.name,type:"GET",responses:{200:function(e){o.text(e.publickey),i.remove()},400:{unexpected_error:function(e){console.log(e),i.remove()}}}};return b.sendRequest(t),t=$('<span class="button-row" style="position: relative; float: right; margin: 10px;"></span>').appendTo(e),$('<button class="red-ui-button red-ui-button-small">'+RED._("editor:sidebar.project.userSettings.copyPublicKey")+"</button>").appendTo(t).on("click",function(e){try{e.stopPropagation(),e.preventDefault(),document.getSelection().selectAllChildren(o[0]);document.execCommand("copy");document.getSelection().empty()}catch(e){}}),e}var h={empty:!0},g=$('<ol class="red-ui-projects-dialog-ssh-key-list">').appendTo(e).editableList({height:"auto",addButton:!1,scrollOnAdd:!1,addItem:function(i,e,n){var t=$('<div class="red-ui-projects-dialog-list-entry">').appendTo(i);if(n.empty)return t.addClass("red-ui-search-empty"),void t.text(RED._("editor:sidebar.project.userSettings.noSshKeys"));var o=$('<div class="red-ui-projects-dialog-ssh-key-header">').appendTo(t);$('<span class="entry-icon"><i class="fa fa-key"></i></span>').appendTo(o),$('<span class="entry-name">').text(n.name).appendTo(o);var a,r=$('<span class="button-row entry-tools">').appendTo(o);o.on("click",function(e){a?a.slideUp(200,function(){a.remove(),a=null}):a=f(t,n)}),n.system||$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-trash"></i></button>').appendTo(r).on("click",function(e){e.stopPropagation();var t=b.addSpinnerOverlay(i).addClass("red-ui-component-spinner-contain"),o=RED.notify(RED._("editor:sidebar.project.userSettings.deleteConfirm",{name:n.name}),{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),o.close()}},{text:RED._("editor:sidebar.project.userSettings.delete"),click:function(){o.close();var e="settings/user/keys/"+n.name;b.sendRequest({url:e,type:"DELETE",responses:{200:function(e){i.fadeOut(200,function(){g.editableList("removeItem",n),setTimeout(t.remove,100),0===g.editableList("length")&&g.editableList("addItem",h)})},400:{unexpected_error:function(e){console.log(e),t.remove()}}}})}}]})}),n.expand&&(a=f(t,n))}}),v=function(t){$.getJSON("settings/user/keys",function(e){e.keys&&(e.keys.sort(function(e,t){return e.name.localeCompare(t.name)}),g.editableList("empty"),e.keys.forEach(function(e){e.name===t&&(e.expand=!0),g.editableList("addItem",e)}),0===g.editableList("length")&&g.editableList("addItem",h))})};v()}function t(e){var t,o,i,n=$('<div id="red-ui-settings-tab-gitconfig" class="project-settings-tab-pane red-ui-help"></div>');return function(e){var t=RED.settings.get("git")||{};t.user=t.user||{},$("<h3></h3>").text(RED._("editor:sidebar.project.userSettings.committerDetail")).appendTo(e);var o=$('<div class="red-ui-settings-section"></div>').appendTo(e);$('<div class="red-ui-settings-section-description"></div>').appendTo(o).text(RED._("editor:sidebar.project.userSettings.committerTip")),e=$('<div class="red-ui-settings-row"></div>').appendTo(o),$('<label for="user-settings-gitconfig-username"></label>').text(RED._("editor:sidebar.project.userSettings.userName")).appendTo(e),(a=$('<input type="text" id="user-settings-gitconfig-username">').appendTo(e)).val(t.user.name||""),e=$('<div class="red-ui-settings-row"></div>').appendTo(o),$('<label for="user-settings-gitconfig-email"></label>').text(RED._("editor:sidebar.project.userSettings.email")).appendTo(e),(m=$('<input type="text" id="user-settings-gitconfig-email">').appendTo(e)).val(t.user.email||"")}(n),t=n,o=RED.settings.theme("projects.workflow.mode","manual"),(i=RED.settings.get("git")||{}).workflow=i.workflow||{},i.workflow.mode=i.workflow.mode||o,$("<h3></h3>").text(RED._("editor:sidebar.project.userSettings.workflow")).appendTo(t),o=$('<div class="red-ui-settings-section"></div>').appendTo(t),$('<div class="red-ui-settings-section-description"></div>').appendTo(o).text(RED._("editor:sidebar.project.userSettings.workfowTip")),t=$('<div class="red-ui-settings-row"></div>').appendTo(o),$('<label><input type="radio" name="user-setting-gitworkflow" value="manual"> <div style="margin-left: 3px; display: inline-block"><div data-i18n="editor:sidebar.project.userSettings.workflowManual"></div><div style="color:#aaa;" data-i18n="editor:sidebar.project.userSettings.workflowManualTip"></div></div></label>').appendTo(t),t=$('<div class="red-ui-settings-row"></div>').appendTo(o),$('<label><input type="radio" name="user-setting-gitworkflow" value="auto"> <div style="margin-left: 3px; display: inline-block"><div data-i18n="editor:sidebar.project.userSettings.workflowAuto"></div><div style="color:#aaa;" data-i18n="editor:sidebar.project.userSettings.workflowAutoTip"></div></div></label>').appendTo(t),o.find('[name="user-setting-gitworkflow"][type="radio"][value="'+i.workflow.mode+'"]').prop("checked",!0),r(n),n}return{init:function(e){b=e,RED.userSettings.add({id:"gitconfig",title:RED._("editor:sidebar.project.userSettings.gitConfig"),get:t,close:function(){var e=RED.settings.get("git")||{};e.user=e.user||{},e.user.name=a.val(),e.user.email=m.val(),e.workflow=e.workflow||{},e.workflow.mode=$('[name="user-setting-gitworkflow"][type="radio"]:checked').val(),RED.settings.set("git",e)}})}}}(),RED.sidebar.versionControl=function(){var D,x,R,k,_,T,a,C,j,L,z,S,M,r,O,I,N,P={};function A(t,a,e,r){t.addClass("red-ui-sidebar-vc-change-entry");var i=$("<div>").appendTo(t);if(a.label)return t.addClass("red-ui-help-info-none"),i.text(a.label),void(a.button&&(i.css({display:"inline-block",maxWidth:"300px",textAlign:"left"}),c=$('<div style="float: right; margin: 5px; height: 50px;"></div>').appendTo(i),$('<button class="red-ui-button red-ui-button-small"></button>').text(a.button.label).appendTo(c).on("click",a.button.click)));var n,o,s=$('<i class=""></i>').appendTo(i),d=$('<a href="#">').appendTo(i).on("click",function(e){var o,i,n;e.preventDefault(),o=a,i=r,n=RED.projects.getActiveProject(),O.sendRequest({url:"projects/"+n.name+"/diff/"+("staged"===i?"index":"tree")+"/"+encodeURIComponent(o.file),type:"GET",responses:{0:function(e){console.log(e)},200:function(e){var t="unstaged"===i?RED._("sidebar.project.versionControl.unstagedChanges")+" : "+o.file:"staged"===i?RED._("sidebar.project.versionControl.stagedChanges")+" : "+o.file:RED._("sidebar.project.versionControl.resolveConflicts")+" : "+o.file,t={diff:e.diff,title:t,unmerged:"unmerged"===i,project:n};"unstaged"==i?(t.oldRevTitle=" "===o.indexStatus?RED._("sidebar.project.versionControl.head"):RED._("sidebar.project.versionControl.staged"),t.newRevTitle=RED._("sidebar.project.versionControl.unstaged"),t.oldRev=" "===o.indexStatus?"@":":0",t.newRev="_"):"staged"===i?(t.oldRevTitle=RED._("sidebar.project.versionControl.head"),t.newRevTitle=RED._("sidebar.project.versionControl.staged"),t.oldRev="@",t.newRev=":0"):(t.oldRevTitle=RED._("sidebar.project.versionControl.local"),t.newRevTitle=RED._("sidebar.project.versionControl.remote"),t.commonRev=":1",t.oldRev=":2",t.newRev=":3",t.onresolve=function(e){O.sendRequest({url:"projects/"+n.name+"/resolve/"+encodeURIComponent(o.file),type:"POST",responses:{0:function(e){console.log(e)},200:function(e){F(!0)},400:{unexpected_error:function(e){console.log(e)}}}},{resolutions:e.resolutions[o.file]})}),RED.diff.showUnifiedDiff(t)},400:{unexpected_error:function(e){console.log(e)}}}})}),l=$("<span>").appendTo(d),c=$('<div class="red-ui-sidebar-vc-change-entry-tools">').appendTo(t);"unstaged"===r&&(o=$('<span class="button-group" style="margin-right: 5px;"></span>').appendTo(c),n=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-reply"></i></button>').appendTo(o).on("click",function(e){e.preventDefault();var t=O.addSpinnerOverlay(i).addClass("red-ui-component-spinner-contain"),o=RED.notify(RED._("sidebar.project.versionControl.revert",{file:a.file}),{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),o.close()}},{text:RED._("sidebar.project.versionControl.revertChanges"),click:function(){o.close();var e={url:"projects/"+RED.projects.getActiveProject().name+"/files/_/"+a.file,type:"DELETE",responses:{200:function(e){t.remove()},400:{unexpected_error:function(e){t.remove(),console.log(e)}}}};RED.deploy.setDeployInflight(!0),O.sendRequest(e).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]})}),RED.popover.tooltip(n,RED._("sidebar.project.versionControl.revertChanges"))),o=$('<span class="button-group"></span>').appendTo(c),"unmerged"!==r&&(o=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-'+("unstaged"===r?"plus":"minus")+'"></i></button>').appendTo(o).on("click",function(e){e.preventDefault();e=RED.projects.getActiveProject();a.spinner=O.addSpinnerOverlay(t).addClass("projects-version-control-spinner-sidebar"),O.sendRequest({url:"projects/"+e.name+"/stage/"+encodeURIComponent(a.file),type:"unstaged"===r?"POST":"DELETE",responses:{0:function(e){console.log(e)},200:function(e){G(e)},400:{unexpected_error:function(e){console.log(e)}}}},{})}),RED.popover.tooltip(o,RED._("sidebar.project.versionControl."+("unstaged"===r?"stage":"unstage")+"Change"))),a["update"+("unstaged"===r?"Unstaged":"Staged")]=function(e,t){i.removeClass();var o="",o="A"===t?(i.addClass("red-ui-diff-state-added"),"fa-plus-square"):"?"===t?(i.addClass("red-ui-diff-state-unchanged"),"fa-question-circle-o"):"D"===t?(i.addClass("red-ui-diff-state-deleted"),"fa-minus-square"):"M"===t?(i.addClass("red-ui-diff-state-changed"),"fa-square"):"R"===t?(i.addClass("red-ui-diff-state-changed"),"fa-toggle-right"):("U"===t&&i.addClass("red-ui-diff-state-conflicted"),"fa-exclamation-triangle");l.empty(),$("<span>").text(e.file.replace(/\\(.)/g,"$1")).appendTo(l),e.oldName&&($('<i class="fa fa-long-arrow-right"></i>').prependTo(l),$("<span>").text(e.oldName.replace(/\\(.)/g,"$1")).prependTo(l)),s.removeClass(),s.addClass("fa "+o),e.spinner&&(e.spinner.remove(),delete e.spinner),n&&n.toggle("?"!==t),d.toggleClass("disabled","D"===t||"?"===t)},a["update"+("unstaged"===r?"Unstaged":"Staged")](a,e)}function B(e){var t=Date.now()/1e3-e,o=Math.floor(t/86400);if(30<o)return new Date(1e3*e).toLocaleDateString();if(0<o)return RED._("sidebar.project.versionControl.daysAgo",{count:o});o=Math.floor(t/3600);if(0<o)return RED._("sidebar.project.versionControl.hoursAgo",{count:o});t=Math.floor(t/60);return 0<t?RED._("sidebar.project.versionControl.minsAgo",{count:t}):RED._("sidebar.project.versionControl.secondsAgo")}function V(e,t){var o=RED.projects.getActiveProject();(a=t?O.addSpinnerOverlay(R.parent()):O.addSpinnerOverlay(_.parent())).addClass("red-ui-component-spinner-sidebar"),O.sendRequest({url:"projects/"+o.name+"/stage",type:t?"POST":"DELETE",responses:{0:function(e){console.log(e)},200:function(e){G(e)},400:{unexpected_error:function(e){console.log(e)}}}},t?{files:e}:void 0)}var n=!1;function H(i,n,e,a,t){var r=O.addSpinnerOverlay(e),e=i+"?limit="+(a||20);t&&(e+="&before="+t),O.sendRequest({url:e,type:"GET",responses:{0:function(e){console.log(e)},200:function(e){var t;e.commits.forEach(function(e){n.editableList("addItem",e),t=e.sha}),n.loadMoreItem&&(n.editableList("removeItem",n.loadMoreItem),delete n.loadMoreItem);var o=n.editableList("length");o<e.total&&(n.loadMoreItem={totalKnown:o,total:e.total,url:i,before:t+"~1",limit:a},n.editableList("addItem",n.loadMoreItem)),r.remove()},400:{unexpected_error:function(e){console.log(e)}}}})}function G(e){var i=e.files;a&&(a.remove(),a=null),(r=!!e.merging)?(D.addClass("red-ui-sidebar-vc-merging"),C.show()):(D.removeClass("red-ui-sidebar-vc-merging"),C.hide()),R.editableList("removeItem",I),_.editableList("removeItem",I),j.editableList("removeItem",N);var t=Object.keys(i).filter(function(e){return"f"===i[e].type});t.sort();var n=Date.now()+Math.floor(100*Math.random());t.forEach(function(e){var t=i[e],o=!1;t.status&&(t.file=e,t.indexStatus=t.status[0],t.treeStatus=t.status[1],("A"===t.indexStatus&&/[AU]/.test(t.treeStatus)||"U"===t.indexStatus&&/[DAU]/.test(t.treeStatus)||"D"===t.indexStatus&&/[DU]/.test(t.treeStatus))&&(t.unmerged=!0),P[e]?(P[e].unmerged&&!t.unmerged?(j.editableList("removeItem",P[e]),o=!0):!P[e].unmerged&&t.unmerged&&(R.editableList("removeItem",P[e]),_.editableList("removeItem",P[e])),P[e].status!==t.status&&(" "!==P[e].treeStatus?" "===t.treeStatus?R.editableList("removeItem",P[e]):t.treeStatus!==P[e].treeStatus&&P[e].updateUnstaged(t,t.treeStatus):o=!0," "!==P[e].indexStatus&&"?"!==P[e].indexStatus?" "===t.indexStatus||"?"===t.indexStatus?_.editableList("removeItem",P[e]):t.indexStatus!==P[e].indexStatus&&P[e].updateStaged(t,t.indexStatus):o=!0),P[e].status=t.status,P[e].indexStatus=t.indexStatus,P[e].treeStatus=t.treeStatus,P[e].oldName=t.oldName,P[e].unmerged=t.unmerged):(o=!0,P[e]=t),P[e].updateIndex=n,o&&(t.unmerged?j.editableList("addItem",P[e]):(" "!==t.treeStatus&&R.editableList("addItem",P[e])," "!==t.indexStatus&&"?"!==t.indexStatus&&_.editableList("addItem",P[e]))))}),Object.keys(P).forEach(function(e){P[e].updateIndex!==n&&(R.editableList("removeItem",P[e]),_.editableList("removeItem",P[e]),delete P[e])});var o=_.editableList("length"),e=R.editableList("length"),t=j.editableList("length");L.prop("disabled",r&&0<t||!r&&0===o),k.prop("disabled",0===e),T.prop("disabled",0===o),0===o&&_.editableList("addItem",I),0===e&&R.editableList("addItem",I),0===t&&j.editableList("addItem",N)}function F(e,t){var i;n||(e&&(P={},R.editableList("empty"),_.editableList("empty"),j.editableList("empty")),RED.user.hasPermission("projects.write")&&(n=!0,function(){S.editableList("empty");var e=RED.projects.getActiveProject();e&&H("projects/"+e.name+"/commits",S,S.parent())}(),(i=RED.projects.getActiveProject())?(e="projects/"+i.name+"/status",t&&(e+="?remote=true"),$.getJSON(e,function(e){G(e),$("#red-ui-sidebar-vc-local-branch").text(e.branches.local),$("#red-ui-sidebar-vc-remote-branch").text(e.branches.remote||RED._("sidebar.project.versionControl.none"));var t=e.commits.ahead||0,o=e.commits.behind||0;i.git.hasOwnProperty("remotes")?e.branches.hasOwnProperty("remoteError")&&"git_remote_gone"!==e.branches.remoteError.code?($("#red-ui-sidebar-vc-repo-status-auth-issue").show(),$("#red-ui-sidebar-vc-repo-status-stats").hide(),$("#red-ui-sidebar-vc-repo-branch").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-toolbar-message").hide(),$("#red-ui-sidebar-vc-repo-toolbar-error-message").show()):($("#red-ui-sidebar-vc-repo-toolbar-message").show(),$("#red-ui-sidebar-vc-repo-toolbar-error-message").hide(),$("#red-ui-sidebar-vc-repo-status-auth-issue").hide(),$("#red-ui-sidebar-vc-repo-status-stats").show(),$("#red-ui-sidebar-vc-repo-branch").prop("disabled",!1),$("#red-ui-sidebar-vc-repo-status-button").show(),e.branches.hasOwnProperty("remote")?U(t,o):($("#red-ui-sidebar-vc-commits-ahead").text(""),$("#red-ui-sidebar-vc-commits-behind").text(""),$("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.notTracking")),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!0))):$("#red-ui-sidebar-vc-repo-status-button").hide(),n=!1,$(".red-ui-sidebar-vc-shade").hide()}).fail(function(){n=!1})):($(".red-ui-sidebar-vc-shade").show(),R.editableList("empty"),_.editableList("empty"),j.editableList("empty"))))}function U(e,t){$("#red-ui-sidebar-vc-commits-ahead").text(e),$("#red-ui-sidebar-vc-commits-behind").text(t),r?($("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.statusUnmergedChanged")),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!0)):0<e&&0===t?($("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.commitsAhead",{count:e})),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!1)):0===e&&0<t?($("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.commitsBehind",{count:t})),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!1),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!0)):0<e&&0<t?($("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.commitsAheadAndBehind1",{count:t})+RED._("sidebar.project.versionControl.commitsAheadAndBehind2",{count:e})+RED._("sidebar.project.versionControl.commitsAheadAndBehind3",{count:t})),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!1),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!0)):0===e&&0===t&&($("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.repositoryUpToDate")),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!0))}function J(){F(),RED.sidebar.show("version-control")}return{init:function(e){O=e,RED.actions.add("core:show-version-control-tab",J),RED.events.on("deploy",function(){var e,t=RED.projects.getActiveProject();t&&(e=RED.settings.theme("projects.workflow.mode","manual"),"auto"===(((RED.settings.get("git")||{}).workflow||{}).mode||e)?F(!0):(P={},R.editableList("empty"),_.editableList("empty"),j.editableList("empty"),$.getJSON("projects/"+t.name+"/status",function(e){G(e)})))}),RED.events.on("login",function(){F(!0)}),D=$("<div>",{class:"red-ui-sidebar-vc"});var t=$("<div>",{class:"red-ui-sidebar-vc-stack"}).appendTo(D);x=RED.stack.create({container:t,fill:!0,singleExpanded:!0}),(z=x.add({title:RED._("sidebar.project.versionControl.localChanges"),collapsible:!0})).expand(),z.content.css({height:"100%"});var o=$('<div style="float: right"></div>').appendTo(z.header),e=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-refresh"></i></button>').appendTo(o).on("click",function(e){e.preventDefault(),e.stopPropagation(),F(!0)});RED.popover.tooltip(e,RED._("sidebar.project.versionControl.refreshChanges")),I={label:RED._("sidebar.project.versionControl.none")},N={label:RED._("sidebar.project.versionControl.conflictResolve")};var i=$('<div class="red-ui-sidebar-vc-change-container"></div>').appendTo(z.content),t=$('<div class="red-ui-sidebar-vc-change-header">'+RED._("sidebar.project.versionControl.localFiles")+"</div>").appendTo(i);k=$('<button class="red-ui-button red-ui-button-small" style="position: absolute; right: 5px; top: 5px;"><i class="fa fa-plus"></i> '+RED._("sidebar.project.versionControl.all")+"</button>").appendTo(t).on("click",function(e){e.preventDefault(),e.stopPropagation(),V(Object.keys(P).filter(function(e){return" "!==P[e].treeStatus}),!0)}),RED.popover.tooltip(k,RED._("sidebar.project.versionControl.stageAllChange")),(R=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0; right:0; left:0;"}).appendTo(i)).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,o){A(e,o,o.treeStatus,"unstaged")},sort:function(e,t){return"?"===e.treeStatus&&"?"!==t.treeStatus?1:"?"!==e.treeStatus&&"?"===t.treeStatus?-1:e.file.localeCompare(t.file)}}),C=$('<div class="red-ui-sidebar-vc-change-container"></div>').appendTo(z.content);var t=$('<div class="red-ui-sidebar-vc-change-header">'+RED._("sidebar.project.versionControl.unmergedChanges")+"</div>").appendTo(C),o=$('<div style="position: absolute; right: 5px; top: 5px;"></div>').appendTo(t),n=$('<button class="red-ui-button red-ui-button-small" style="margin-right: 5px;">'+RED._("sidebar.project.versionControl.abortMerge")+"</button>").appendTo(o).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=O.addSpinnerOverlay(C),e=RED.projects.getActiveProject();RED.deploy.setDeployInflight(!0),O.sendRequest({url:"projects/"+e.name+"/merge",type:"DELETE",responses:{0:function(e){console.log(e)},200:function(e){t.remove(),F(!0)},400:{unexpected_error:function(e){console.log(e)}}}}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})});(j=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0; right:0; left:0;"}).appendTo(C)).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,o){o===N&&(o.button={label:RED._("sidebar.project.versionControl.commit"),click:function(e){e.preventDefault(),e.stopPropagation(),r()}}),A(e,o,o.treeStatus,"unmerged")},sort:function(e,t){return"?"===e.treeStatus&&"?"!==t.treeStatus?1:"?"!==e.treeStatus&&"?"===t.treeStatus?-1:e.file.localeCompare(t.file)}});var a=$('<div class="red-ui-sidebar-vc-change-container"></div>').appendTo(z.content);t=$('<div class="red-ui-sidebar-vc-change-header">'+RED._("sidebar.project.versionControl.changeToCommit")+"</div>").appendTo(a),o=$('<div style="position: absolute; right: 5px; top: 5px;"></div>').appendTo(t);var r=function(){s.val(""),l.prop("disabled",!0),i.css("height","30px"),C.is(":visible")?(C.css("height","30px"),a.css("height","calc(100% - 60px - 175px)")):a.css("height","calc(100% - 30px - 175px)"),commitBox.show(),setTimeout(function(){commitBox.css("height","175px")},10),k.prop("disabled",!0),T.prop("disabled",!0),L.prop("disabled",!0),n.prop("disabled",!0),s.trigger("focus")};L=$('<button class="red-ui-button red-ui-button-small" style="margin-right: 5px;">'+RED._("sidebar.project.versionControl.commit")+"</button>").appendTo(o).on("click",function(e){e.preventDefault(),e.stopPropagation(),r()}),RED.popover.tooltip(L,RED._("sidebar.project.versionControl.commitChanges")),T=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-minus"></i> '+RED._("sidebar.project.versionControl.all")+"</button>").appendTo(o).on("click",function(e){e.preventDefault(),e.stopPropagation(),V(Object.keys(P).filter(function(e){return" "!==P[e].indexStatus&&"?"!==P[e].indexStatus}),!1)}),RED.popover.tooltip(T,RED._("sidebar.project.versionControl.unstageAllChange")),(_=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0; right:0; left:0;"}).appendTo(a)).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,o){A(e,o,o.indexStatus,"staged")},sort:function(e,t){return e.file.localeCompare(t.file)}}),commitBox=$('<div class="red-ui-sidebar-vc-slide-box red-ui-sidebar-vc-slide-box-bottom"></div>').hide().appendTo(z.content);var s=$("<textarea></textarea>").attr("placeholder",RED._("sidebar.project.versionControl.commitPlaceholder")).appendTo(commitBox).on("change keyup paste",function(){l.prop("disabled",""===$(this).val().trim())}),t=$('<div class="red-ui-sidebar-vc-slide-box-toolbar button-group">').appendTo(commitBox),d=$('<button class="red-ui-button">'+RED._("sidebar.project.versionControl.cancelCapital")+"</button>").appendTo(t).on("click",function(e){e.preventDefault(),s.val(""),i.css("height",""),C.css("height",""),a.css("height",""),commitBox.css("height",0),setTimeout(function(){commitBox.hide()},200),k.prop("disabled",!1),T.prop("disabled",!1),L.prop("disabled",!1),n.prop("disabled",!1)}),l=$('<button class="red-ui-button">'+RED._("sidebar.project.versionControl.commitCapital")+"</button>").appendTo(t).on("click",function(e){e.preventDefault();var t=O.addSpinnerOverlay(l).addClass("red-ui-component-spinner-sidebar"),e=RED.projects.getActiveProject();RED.deploy.setDeployInflight(!0),O.sendRequest({url:"projects/"+e.name+"/commit",type:"POST",responses:{0:function(e){console.log(e)},200:function(e){t.remove(),d.trigger("click"),F(!0)},400:{"*":function(e){O.reportUnexpectedError(e)}}}},{message:s.val()}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}),t=x.add({title:RED._("sidebar.project.versionControl.commitHistory"),collapsible:!0});o=$('<div style="float: right"></div>').appendTo(t.header),e=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-refresh"></i></button>').appendTo(o).on("click",function(e){e.preventDefault(),e.stopPropagation(),F(!0,!0)}),RED.popover.tooltip(e,RED._("sidebar.project.versionControl.refreshCommitHistory"));var e=$('<div class="red-ui-sidebar-vc-change-header" style="text-align: right;"></div>').appendTo(t.content),c=$('<button class="red-ui-button red-ui-button-small"><i class="fa fa-code-fork"></i> '+RED._("sidebar.project.versionControl.branch")+' <span id="red-ui-sidebar-vc-local-branch"></span></button>').appendTo(e).on("click",function(e){e.preventDefault(),$(this).hasClass("selected")?u():(v(),M.show(),$(this).addClass("selected"),e=RED.projects.getActiveProject(),h.refresh("projects/"+e.name+"/branches"),f.show(),setTimeout(function(){f.css("height","215px"),h.focus()},100))});RED.popover.tooltip(c,RED._("sidebar.project.versionControl.changeLocalBranch"));var p=$('<button class="red-ui-button red-ui-button-small" style="margin-left: 10px;" id="red-ui-sidebar-vc-repo-status-button"><span id="red-ui-sidebar-vc-repo-status-stats"><i class="fa fa-long-arrow-up"></i> <span id="red-ui-sidebar-vc-commits-ahead"></span> <i class="fa fa-long-arrow-down"></i> <span id="red-ui-sidebar-vc-commits-behind"></span></span><span id="red-ui-sidebar-vc-repo-status-auth-issue"><i class="fa fa-warning"></i></span></button>').appendTo(e).on("click",function(e){e.preventDefault(),$(this).hasClass("selected")?v():(u(),M.show(),$(this).addClass("selected"),e=RED.projects.getActiveProject(),$("#red-ui-sidebar-vc-repo-toolbar-set-upstream-row").toggle(!!e.git.branches.remoteAlt),g.show(),setTimeout(function(){g.css("height","265px")},100))});RED.popover.tooltip(p,RED._("sidebar.project.versionControl.manageRemoteBranch")),S=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0px; right:0; left:0;"}).appendTo(t.content),M=$('<div class="red-ui-shade" style="z-Index: 3"></div>').css("top","30px").hide().appendTo(t.content),S.editableList({addButton:!1,scrollOnAdd:!1,addItem:function(t,e,o){var i,n;t.addClass("red-ui-sidebar-vc-commit-entry"),o.url?(t.addClass("red-ui-sidebar-vc-commit-more"),t.text("+ "+(o.total-o.totalKnown)+RED._("sidebar.project.versionControl.moreCommits")),t.on("click",function(e){e.preventDefault(),H(o.url,S,t,o.limit,o.before)})):(t.on("click",function(e){var t=RED.projects.getActiveProject();t&&$.getJSON("projects/"+t.name+"/commits/"+o.sha,function(e){e.project=t,e.parents=o.parents,e.oldRev=o.sha+"~1",e.newRev=o.sha,e.oldRevTitle=RED._("sidebar.project.versionControl.commitCapital")+" "+o.sha.substring(0,7)+"~1",e.newRevTitle=RED._("sidebar.project.versionControl.commitCapital")+" "+o.sha.substring(0,7),e.date=B(parseInt(o.date)),RED.diff.showCommitDiff(e)})}),i=$("<div>").appendTo(t),$('<div class="red-ui-sidebar-vc-commit-subject">').text(o.subject).appendTo(i),o.refs&&(n=$('<div class="red-ui-sidebar-vc-commit-refs">').appendTo(i),o.refs.forEach(function(e){var t=e;/HEAD -> /.test(e)&&(t=e.substring(8)),$('<span class="red-ui-sidebar-vc-commit-ref">').text(t).appendTo(n)}),t.addClass("red-ui-sidebar-vc-commit-head")),$('<div class="red-ui-sidebar-vc-commit-sha">').text(o.sha.substring(0,7)).appendTo(i),$('<div class="red-ui-sidebar-vc-commit-date">').text(B(parseInt(o.date))).appendTo(i))}});var u=function(e){c.removeClass("selected"),f.css("height","0"),M.hide(),setTimeout(function(){f.hide(),e&&e()},200)},f=$('<div class="red-ui-sidebar-vc-slide-box red-ui-sidebar-vc-slide-box-top" style="top:30px;"></div>').hide().appendTo(t.content);$('<div class="red-ui-sidebar-vc-slide-box-header"></div>').text(RED._("sidebar.project.versionControl.changeLocalBranch")).appendTo(f);var h=O.createBranchList({placeholder:RED._("sidebar.project.versionControl.createBranchPlaceholder"),container:f,onselect:function(e){if(e.current)return u();var t=O.addSpinnerOverlay(f),o=RED.projects.getActiveProject();RED.deploy.setDeployInflight(!0),O.sendRequest({url:"projects/"+o.name+"/branches",type:"POST",requireCleanWorkspace:!0,cancel:function(){t.remove()},responses:{0:function(e){t.remove(),console.log(e)},200:function(e){u(function(){t.remove()})},400:{git_local_overwrite:function(e){t.remove(),RED.notify(RED._("sidebar.project.versionControl.localOverwrite"),{type:"error",timeout:8e3})},unexpected_error:function(e){t.remove(),console.log(e)}}}},e).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}),g=$('<div class="red-ui-sidebar-vc-slide-box red-ui-sidebar-vc-slide-box-top" style="top:30px"></div>').hide().appendTo(t.content),v=function(){$("#red-ui-sidebar-vc-repo-toolbar-set-upstream").prop("checked",!1),p.removeClass("selected"),g.css("height","0"),M.hide(),setTimeout(function(){g.hide(),m()},200)},m=function(e){b.hasClass("selected")&&(b.removeClass("selected"),y.height(0),g.css("height","265px"),setTimeout(function(){y.hide(),e&&e()},200))};$('<div class="red-ui-sidebar-vc-slide-box-header"></div>').text(RED._("sidebar.project.versionControl.manageRemoteBranch")).appendTo(g);var e=$('<div style="margin-bottom: 5px;"></div>').appendTo(g),b=$('<button id="red-ui-sidebar-vc-repo-branch" class="red-ui-sidebar-vc-repo-action red-ui-button"><i class="fa fa-code-fork"></i> '+RED._("sidebar.project.versionControl.remote")+': <span id="red-ui-sidebar-vc-remote-branch"></span></button>').appendTo(e).on("click",function(e){e.preventDefault(),$(this).hasClass("selected")?m():($(this).addClass("selected"),e=RED.projects.getActiveProject(),w.refresh("projects/"+e.name+"/branches/remote"),y.show(),setTimeout(function(){y.height(180),g.css("height","445px"),w.focus()},100))});$('<div id="red-ui-sidebar-vc-repo-toolbar-message" class="red-ui-sidebar-vc-slide-box-header" style="min-height: 100px;"></div>').appendTo(g),t=$('<div id="red-ui-sidebar-vc-repo-toolbar-error-message" class="red-ui-sidebar-vc-slide-box-header" style="min-height: 100px;"></div>').hide().appendTo(g),$('<div style="margin-top: 10px;"><i class="fa fa-warning"></i> '+RED._("sidebar.project.versionControl.unableToAccess")+"</div>").appendTo(t),t=$('<div style="margin: 10px 30px; text-align: center"></div>').appendTo(t),$('<button class="red-ui-button" style="width: 80%;"><i class="fa fa-refresh"></i> '+RED._("sidebar.project.versionControl.retry")+"</button>").appendTo(t).on("click",function(e){e.preventDefault();var e=RED.projects.getActiveProject(),t=O.addSpinnerOverlay(g).addClass("red-ui-component-spinner-contain");O.sendRequest({url:"projects/"+e.name+"/branches/remote",type:"GET",responses:{0:function(e){console.log(e)},200:function(e){F(!0)},400:{git_connection_failed:function(e){RED.notify(e.message,"error")},git_not_a_repository:function(e){RED.notify(e.message,"error")},git_repository_not_found:function(e){RED.notify(e.message,"error")},unexpected_error:function(e){console.log(e)}}}}).always(function(){t.remove()})}),$('<div class="red-ui-sidebar-vc-slide-box-header" style="height: 20px;"><label id="red-ui-sidebar-vc-repo-toolbar-set-upstream-row" for="red-ui-sidebar-vc-repo-toolbar-set-upstream" class="hide"><input type="checkbox" id="red-ui-sidebar-vc-repo-toolbar-set-upstream"> '+RED._("sidebar.project.versionControl.setUpstreamBranch")+"</label></div>").appendTo(g);var y=$('<div style="height: 0;overflow:hidden; transition: height 0.2s ease-in-out;"></div>').hide().appendTo(e),w=O.createBranchList({placeholder:RED._("sidebar.project.versionControl.createRemoteBranchPlaceholder"),currentLabel:RED._("sidebar.project.versionControl.upstream"),remotes:function(){var e=RED.projects.getActiveProject();return Object.keys(e.git.remotes)},container:y,onselect:function(e){$("#red-ui-sidebar-vc-repo-toolbar-set-upstream").prop("checked",!1),$("#red-ui-sidebar-vc-repo-toolbar-set-upstream").prop("disabled",!1),$("#red-ui-sidebar-vc-remote-branch").text(e.name+(e.create?" *":""));var i=RED.projects.getActiveProject();i.git.branches.remote===e.name?delete i.git.branches.remoteAlt:i.git.branches.remoteAlt=e.name,$("#red-ui-sidebar-vc-repo-toolbar-set-upstream-row").toggle(!!i.git.branches.remoteAlt),m(function(){var t,o;e.create?(i.git.branches.remote?$("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.selectUpstreamBranch")):($("#red-ui-sidebar-vc-repo-toolbar-message").text(RED._("sidebar.project.versionControl.trackedUpstreamBranch")),$("#red-ui-sidebar-vc-repo-toolbar-set-upstream").prop("checked",!0),$("#red-ui-sidebar-vc-repo-toolbar-set-upstream").prop("disabled",!0)),$("#red-ui-sidebar-vc-repo-pull").prop("disabled",!0),$("#red-ui-sidebar-vc-repo-push").prop("disabled",!1)):(t=Date.now(),o=O.addSpinnerOverlay($("#red-ui-sidebar-vc-repo-toolbar-message")).addClass("red-ui-component-spinner-contain"),$.getJSON("projects/"+i.name+"/branches/remote/"+e.name+"/status",function(e){setTimeout(function(){U(e.commits.ahead,e.commits.behind),o.remove()},Math.max(400-(Date.now()-t),0))}))})}}),e=$('<div style="margin-bottom: 5px;"></div>').appendTo(g);function E(o){o=o||{};var e=O.addSpinnerOverlay(g).addClass("red-ui-component-spinner-contain"),t=$('<div style="position: relative; bottom: 60px;"></div>').appendTo(e);$('<button class="red-ui-button"></button>').text(RED._("eventLog.view")).appendTo(t).on("click",function(e){e.preventDefault(),RED.actions.invoke("core:show-event-log")});var i=RED.projects.getActiveProject();RED.eventLog.startEvent("Pull changes"+(i.git.branches.remoteAlt?" : "+i.git.branches.remoteAlt:"")),t="projects/"+i.name+"/pull",i.git.branches.remoteAlt&&(t+="/"+i.git.branches.remoteAlt),(o.setUpstream||o.allowUnrelatedHistories)&&(t+="?"),o.setUpstream&&(t+="setUpstream=true",o.allowUnrelatedHistories&&(t+="&")),o.allowUnrelatedHistories&&(t+="allowUnrelatedHistories=true"),O.sendRequest({url:t,type:"POST",responses:{0:function(e){console.log(e)},200:function(e){o.setUpstream&&i.git.branches.remoteAlt&&(i.git.branches.remote=i.git.branches.remoteAlt,delete i.git.branches.remoteAlt),F(!0),v()},400:{git_local_overwrite:function(e){RED.notify(RED._("sidebar.project.versionControl.unablePull")+'<p><a href="#" onclick="RED.sidebar.versionControl.showLocalChanges(); return false;">'+RED._("sidebar.project.versionControl.showUnstagedChanges")+"</a></p>","error",!1,1e7)},git_pull_merge_conflict:function(e){F(!0),v()},git_connection_failed:function(e){RED.notify(RED._("sidebar.project.versionControl.connectionFailed")+e.toString(),"warning")},git_pull_unrelated_history:function(e){var t=RED.notify(RED._("sidebar.project.versionControl.pullUnrelatedHistory"),{type:"error",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.close()}},{text:RED._("sidebar.project.versionControl.pullChanges"),click:function(){t.close(),o.allowUnrelatedHistories=!0,E(o)}}]})},"*":function(e){O.reportUnexpectedError(e)}}}},{}).always(function(){e.remove()})}$('<button id="red-ui-sidebar-vc-repo-push" class="red-ui-sidebar-vc-repo-sub-action red-ui-button"><i class="fa fa-long-arrow-up"></i> <span data-i18n="sidebar.project.versionControl.push"></span></button>').appendTo(e).on("click",function(e){e.preventDefault();var t=O.addSpinnerOverlay(g).addClass("red-ui-component-spinner-contain"),e=$('<div style="position: relative; bottom: 60px;"></div>').appendTo(t);$('<button class="red-ui-button"></button>').text(RED._("eventLog.view")).appendTo(e).on("click",function(e){e.preventDefault(),RED.actions.invoke("core:show-event-log")});var o=RED.projects.getActiveProject();RED.eventLog.startEvent("Push changes"+(o.git.branches.remoteAlt?" : "+o.git.branches.remoteAlt:""));e="projects/"+o.name+"/push";o.git.branches.remoteAlt&&(e+="/"+o.git.branches.remoteAlt);var i=$("#red-ui-sidebar-vc-repo-toolbar-set-upstream").prop("checked");i&&(e+="?u=true"),O.sendRequest({url:e,type:"POST",responses:{0:function(e){console.log(e)},200:function(e){i&&o.git.branches.remoteAlt&&(o.git.branches.remote=o.git.branches.remoteAlt,delete o.git.branches.remoteAlt),F(!0),v()},400:{git_push_failed:function(e){RED.notify(RED._("sidebar.project.versionControl.pushFailed"),"error")},unexpected_error:function(e){console.log(e)}}}},{}).always(function(){t.remove()})}),$('<button id="red-ui-sidebar-vc-repo-pull" class="red-ui-sidebar-vc-repo-sub-action red-ui-button"><i class="fa fa-long-arrow-down"></i> <span data-i18n="sidebar.project.versionControl.pull"></span></button>').appendTo(e).on("click",function(e){e.preventDefault(),E({setUpstream:$("#red-ui-sidebar-vc-repo-toolbar-set-upstream").prop("checked")})}),$('<div class="red-ui-shade red-ui-sidebar-vc-shade">').appendTo(D),RED.sidebar.addTab({id:"version-control",label:RED._("sidebar.project.versionControl.history"),name:RED._("sidebar.project.versionControl.projectHistory"),content:D,enableOnEdit:!1,pinned:!0,iconClass:"fa fa-code-fork",action:"core:show-version-control-tab",onchange:function(){setTimeout(function(){x.resize()},10)}})},show:J,refresh:F,showLocalChanges:function(){RED.sidebar.show("version-control"),z.expand()}}}(),RED.touch=RED.touch||{},RED.touch.radialMenu=function(){var u=null,f=!1,h=!1,g=null;return{show:function(e,a,t){f=!0;try{for(var i=(u=d3.select("body").append("div").classed("red-ui-editor-radial-menu",!0).on("touchstart",function(){p(),d3.event.preventDefault()})).append("div").style({top:a[1]-80+"px",left:a[0]-80+"px"}),r=[],o=t.length,n=Math.max(Math.PI/(o-1),Math.PI/4),s=Math.PI,d=0;d<o;d++){var l=Math.floor(80*Math.cos(s)),c=Math.floor(80*Math.sin(s));t[d].name&&function(e,t,o){o.el=i.append("div").classed("red-ui-editor-radial-menu-opt",!0).style({top:t+80-25+"px",left:e+80-25+"px"}).classed("red-ui-editor-radial-menu-opt-disabled",!!o.disabled),o.el.html(o.name),o.x=e,o.y=t,r.push(o),o.el.on("touchstart",function(){o.el.classed("red-ui-editor-radial-menu-opt-active",!0),d3.event.preventDefault(),d3.event.stopPropagation()}),o.el.on("touchend",function(){p(),o.onselect(),d3.event.preventDefault(),d3.event.stopPropagation()})}(l,c,t[d]),s+=n}var p=function(){f=!1,g=null,u.remove(),u=null};e.on("touchend.radial",function(){if(e.on("touchend.radial",null),e.on("touchmenu.radial",null),g){try{g.onselect()}catch(e){RED._debug(e)}p()}else h&&p()}),e.on("touchmove.radial",function(){try{for(var e,t=d3.event.touches.item(0),o=[t.pageX-a[0],t.pageY-a[1]],i=0;i<r.length;i++){var n=r[i];n.disabled||(o[0]>n.x-30&&o[0]<n.x+30&&o[1]>n.y-30&&o[1]<n.y+30?n!==g&&(n.el.classed("selected",!0),g=n):(n===g&&(g=null),n.el.classed("selected",!1)))}g||(e=Math.abs(o[0]*o[0]+o[1]*o[1]),h=6400<e)}catch(e){RED._debug(e)}})}catch(e){RED._debug(e)}},active:function(){return f}}}(),RED.tourGuide=function(){var p,u,f,h,g,v,m=[],i={};function t(t,o){i[t]?o(null,i[t]):import(t).then(function(e){i[t]=e.default,o(null,i[t])}).catch(function(e){o(e)})}function b(){var e,t;g&&(v?u.css({left:$(window).width()/2+"px",top:$(window).height()/2+"px",width:"0px",height:"0px"}):(e=g[0].getBoundingClientRect(),t=Math.max(50,1.5*Math.max(e.width,e.height)),u.css({left:e.left+e.width/2+"px",top:e.top+e.height/2+"px",width:2*t+"px",height:2*t+"px"}),u[0].offsetHeight,u.addClass("transition"),u.css({width:t+"px",height:t+"px"})),f&&f.move({target:g}))}function y(e,t,o){function i(){m.forEach(function(e){"dom-event"===e.type?e.target[0].removeEventListener(e.event,e.listener,e.opts):"nr-event"===e.type&&RED.events.off(e.event,e.listener)}),m=[],setTimeout(function(){o()},0)}if(e.complete){if(0!==e.complete.length)return f&&(f.element.hide(),v||(v=!0,b())),void e.complete.call(t,function(){f&&f.element.show(),i()});e.complete.call(t)}i()}function w(e){if("string"==typeof e)return e;var t=RED.i18n.lang()||"en-US",o=Object.keys(e);return e[t]||e["en-US"]||e[o[0]]}return{load:t,run:function(e,o){o=o||function(e){e&&console.error(e)},t(e,function(e,t){e?console.warn("Error loading tour:",e):function(o,t){p=$('<div class="red-ui-tourGuide-shade"></div>').appendTo(document.body),u=$('<div class="red-ui-tourGuide-shade-focus"></div>').appendTo(p),$(window).on("resize.red-ui-tourGuide",function(){b()});var i=0,n={index:0,count:o.steps.length};function a(e){$(window).off("resize.red-ui-tourGuide"),$(document).off("keydown.red-ui-tourGuide"),f&&f.close(),f=h=null,p.remove(),p=null,t(e)}!function e(t){if(!1!==t)if(i!==o.steps.length){n.index=i;try{d=o.steps[i++],l=n,c=e,p.fadeIn(),function(e,t,o){if(e.prepare){if(0!==e.prepare.length)return f&&(f.element.hide(),v||(v=!0,b())),e.prepare.call(t,function(){f&&f.element.show(),o()});e.prepare.call(t)}o()}(d,l,function(){var e,t=d.direction||"bottom";if(v=!1,"string"==typeof d.element?g=$(d.element):"function"==typeof d.element?g=d.element.call(l):d.element?g=d.element:(g=$(".red-ui-editor"),v=!0,t="inset"),0===g.length)throw g=null,p.hide(),new Error("Element not found");$(window).width()<400&&(g=$(".red-ui-editor"),v=!0,t="inset"),e=g.css("z-index"),v||!d.interactive&&!d.wait||g.css("z-index",2002),b(),h?h.empty():h=$('<div style="position:relative"></div>'),$('<button type="button" class="red-ui-button red-ui-button-small" style="float: right; margin-top: -4px; margin-right: -4px;"><i class="fa fa-times"></i></button>').appendTo(h).click(function(e){e.preventDefault(),y(d,l,function(){c(!1)})});var o=$('<div class="red-ui-tourGuide-popover-description"></div>').appendTo(h);d.titleIcon&&$('<h2><i class="'+d.titleIcon+'"></i></h2>').appendTo(o),d.title&&$("<h2>").text(w(d.title)).appendTo(o),$("<div>").css("text-align","left").html(w(d.description)).appendTo(o),d.image&&$(`<img src="red/tours/${d.image}" />`).appendTo(o);var i,n=$("<div>",{class:"red-ui-tourGuide-toolbar"}).appendTo(h);$("<small>").text(l.index+1+"/"+l.count).appendTo(n),!v&&d.wait||(i=$('<button type="button" class="red-ui-button" style="position: absolute; right:0;bottom:0;"></button>').appendTo(n).one("click",function(e){e.preventDefault(),s()}),l.index===l.count-1?$("<span></span>").text(RED._("common.label.close")).appendTo(i):0===l.index?($("<span>start</span>").text(RED._("tourGuide.start")).appendTo(i),$('<span style="margin-left: 6px"><i class="fa fa-chevron-right"></i></span>').appendTo(i)):l.index<l.count-1&&($("<span></span>").text(RED._("tourGuide.next")).appendTo(i),$('<span style="margin-left: 6px"><i class="fa fa-chevron-right"></i></span>').appendTo(i))),o=d.width,v&&(o=500),n=Math.min($(window).width()-10,Math.max(o||0,300)),f=f||RED.popover.create({target:g,width:o||"auto",maxWidth:n+"px",direction:t,class:"red-ui-tourGuide-popover"+(v?" ":""),trigger:"manual",content:h}).open(),$(document).off("keydown.red-ui-tourGuide"),$(document).on("keydown.red-ui-tourGuide",function(e){"Escape"!==e.key&&"Esc"!==e.key||(e.preventDefault(),e.stopPropagation(),y(d,l,function(){c(!1)}))}),f.element.toggleClass("red-ui-tourGuide-popover-full",!!v),f.move({target:g,width:o||"auto",maxWidth:n+"px",direction:t}),setTimeout(function(){f.element.position().left<0&&f.element.css({left:0})},100),i&&setTimeout(function(){i.focus()},100);var a=g[0]instanceof SVGElement;d.fallback&&u.one("mouseenter",function(e){setTimeout(function(){var e=g[0].getBoundingClientRect(),e=Math.max(50,1.5*Math.max(e.width,e.height));u.css({width:4*e+"px",height:4*e+"px"}),p.fadeOut(),f.move({target:$(".red-ui-editor"),direction:d.fallback,offset:10,transition:!0})},a?0:500)});var r,s=function(){u.removeClass("transition"),g.css("z-index",e),y(d,l,c)};d.wait&&("dom-event"===d.wait.type?(t=g,d.wait.element&&("string"==typeof d.wait.element?t=$(d.wait.element):"function"==typeof d.wait.element&&(t=d.wait.element.call(l))),r={type:d.wait.type,target:t,event:d.wait.event,listener:function(){s()},opts:{once:!0}},m.push(r),t[0].addEventListener(r.event,r.listener,r.opts)):"nr-event"===d.wait.type&&(r={type:d.wait.type,event:d.wait.event,listener:function(){d.wait.filter&&!d.wait.filter.apply(l,arguments)||s()}},m.push(r),RED.events.on(r.event,r.listener)))})}catch(e){return void a(e)}var d,l,c}else a();else a(!1)}()}(t,o)})},reset:function(){RED.settings.set("editor.tours.welcome","")}}}();